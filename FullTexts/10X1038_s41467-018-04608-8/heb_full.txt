חקר דפוסים מועשרים במערך נתונים באמצעות ניתוח רכיבים עיקריים ניגודיים

תקציר: הדמיה וחקר של נתונים בממדים גבוהים הם אתגר נפוץ בכל התחומים. טכניקות נפוצות כמו ניתוח רכיבים עיקריים (PCA) שואפות לזהות מגמות דומיננטיות במערך נתונים אחד. עם זאת, במצבים רבים יש לנו מערכי נתונים שנאספו בתנאים שונים, למשל, טיפול וניסוי ביקורת, ואנו מעוניינים להמחיש ולחקור דפוסים שהם ספציפיים למערך נתונים אחד. מאמר זה מציע שיטה, ניתוח רכיבים עיקריים ניגודיים (cPCA), שמזהה מבנים בממדים נמוכים המועשרים במערך נתונים ביחס לנתוני השוואה. במגוון רחב של ניסויים, אנו מראים כי cPCA עם מערך נתונים רקע מאפשר לנו להמחיש דפוסים ספציפיים למערך נתונים שלא זוהו על ידי PCA ושיטות סטנדרטיות אחרות. אנו מספקים גם פרשנות גיאומטרית של cPCA והבטחות מתמטיות חזקות. יישום של cPCA זמין לציבור, וניתן להשתמש בו לניתוח נתונים חקרני ביישומים רבים שבהם נעשה שימוש ב-PCA כיום.

ניתוח רכיבים עיקריים (PCA) הוא אחת השיטות הנפוצות ביותר לחקר ויזואליזציה של נתונים. PCA מקרין את הנתונים למרחב ממדי נמוך והוא חזק במיוחד כגישה לויזואליזציה של דפוסים, כגון אשכולות, קווים, וחריגים בסט נתונים. יש מספר רב של שיטות ויזואליזציה קשורות; לדוגמה, t-SNE וסקיילינג רב-ממדי (MDS) מאפשרים הקרנות נתונים לא ליניאריות ועשויים ללכוד טוב יותר דפוסים לא ליניאריים מאשר PCA. עם זאת, כל השיטות הללו נועדו לחקור סט נתונים אחד בכל פעם. כאשר לאנליסט יש מספר סטים של נתונים (או מספר תנאים בסט נתונים אחד להשוואה), אז המצב הנוכחי הוא לבצע PCA (או t-SNE, MDS, וכו') על כל סט נתונים בנפרד, ואז להשוות ידנית את ההקרנות השונות כדי לבדוק אם יש דמיון והבדלים מעניינים בין סטי הנתונים,. PCA קונטרסטיבי (cPCA) נועד למלא את הפער הזה בחקר ויזואליזציה של נתונים על ידי זיהוי אוטומטי של ההקרנות שמציגות את ההבדלים המעניינים ביותר בין סטי הנתונים. Fig.[1]מספק סקירה של cPCA שאנו מסבירים בפירוט רב יותר בהמשך.

cPCA מונע על ידי מגוון רחב של בעיות בין תחומיות. להמחשה, נזכיר כאן שתי בעיות כאלה ונציג אחרות דרך ניסויים בהמשך המאמר. ראשית, שקול סט נתונים של מדידות ביטוי גנים מאנשים ממוצאים אתניים ומינים שונים. נתונים אלה כוללים רמות ביטוי גנים של חולי סרטן {x i}, שאנו מעוניינים לנתח. יש לנו גם נתוני בקרה, המתאימים לרמות ביטוי הגנים של חולים בריאים {y i} מרקע דמוגרפי דומה. מטרתנו היא למצוא מגמות ושינויים בתוך חולי הסרטן (למשל, לזהות תת-סוגים מולקולריים של סרטן). אם ניישם ישירות PCA על {x i}, עם זאת, הרכיבים העיקריים העליונים עשויים להתאים לשינויים הדמוגרפיים של הפרטים במקום לתת-הסוגים של הסרטן מכיוון שהשינויים הגנטיים הנובעים מהראשונים עשויים להיות גדולים יותר מאלה של האחרונים. אנו ניגשים לבעיה זו על ידי ציון שהחולים הבריאים מכילים גם את השינוי הקשור להבדלים דמוגרפיים, אך לא את השינוי המתאים לתת-הסוגים של הסרטן. לכן, אנו יכולים לחפש רכיבים שבהם {x i} יש שונות גבוהה אך {y i} יש שונות נמוכה.

כדוגמה קשורה, שקול סט נתונים {x i} המורכב ממספרים כתובים ביד על רקע מורכב, כגון תמונות שונות של דשא (ראה Fig.[2(a), top]). מטרת משימת למידה לא מפוקחת טיפוסית עשויה להיות לאשכול את הנתונים, לחשוף את המספרים השונים בתמונה. עם זאת, אם ניישם PCA סטנדרטי על תמונות אלה, נגלה שהרכיבים העיקריים העליונים אינם מייצגים תכונות הקשורות למספרים הכתובים ביד, אלא משקפים את השינוי הדומיננטי בתכונות הקשורות לרקע התמונה (Fig.[2(b)], top). אנו מראים כי ניתן לתקן זאת על ידי שימוש בסט נתונים ייחוס {y i} המורכב אך ורק מתמונות של הדשא (לא בהכרח אותן תמונות ששימשו ב-{x i} אך עם דמיון בקווריאציה בין תכונות, כפי שמוצג ב-Fig.[2(a)], bottom), ולחפש את תת-המרחב של השונות הגבוהה יותר ב-{x i} בהשוואה ל-{y i}. על ידי הקרנה על תת-המרחב הזה, אנו יכולים למעשה להפריד ויזואלית את התמונות על פי ערך המספר הכתוב ביד (Fig. 2(b), bottom). על ידי השוואת הרכיבים העיקריים שהתגלו על ידי PCA לאלה שהתגלו על ידי cPCA, אנו רואים ש-cPCA מזהה תכונות רלוונטיות יותר (Fig.[2(c)]), מה שמאפשר לנו להשתמש ב-cPCA ליישומים כגון בחירת תכונות והפחתת רעש.

PCA קונטרסטיבי הוא כלי ללמידה לא מפוקחת, שמפחית ביעילות ממדיות כדי לאפשר ויזואליזציה וניתוח נתונים חוקר. זה מפריד את cPCA ממגוון רחב של שיטות למידה מפוקחות שמטרתן העיקרית היא לסווג או להבחין בין סטי נתונים שונים, כגון ניתוח הבחנה ליניארי (LDA), ניתוח הבחנה ריבועי (QDA), PCA מפוקח, ו-QUADRO. זה גם מבדיל את cPCA משיטות שמשלבות מספר סטי נתונים, במטרה לזהות דפוסים מתואמים בין שניים או יותר סטי נתונים, ולא כאלה הייחודיים לכל סט נתונים בודד. יש גם משפחה עשירה של שיטות לא מפוקחות להפחתת ממדים מלבד PCA. לדוגמה, סקיילינג רב-ממדי (MDS) מוצא הטבעה ממדית נמוכה ששומרת על המרחק במרחב הממד הגבוה; מרדף רכיבים עיקריים מוצא תת-מרחב מדרגה נמוכה שעמיד לרעש קטן ברמת הכניסה ולשגיאות דלילות גסות. אך אף אחת מהן לא נועדה לנצל מידע רלוונטי מסט נתונים שני, כפי שעושה cPCA. בתוספת, השווינו את cPCA לרבות מהטכניקות שהוזכרו קודם לכן על סטי נתונים מייצגים (ראה Supplementary Figs.[3]ו-[4]), , ,.

בתחום יישום ספציפי, עשויים להיות כלים מיוחדים בתחום זה עם מטרות דומות ל-cPCA, ,. לדוגמה, בתוצאות, אנו מראים כיצד cPCA המיושם על נתוני גנוטיפ מציג את המוצא הגיאוגרפי בתוך מקסיקו. חקר אשכולות עדינים של מוצאים גנטיים הוא בעיה חשובה בגנטיקה של אוכלוסיות, וחוקרים פיתחו לאחרונה אלגוריתם להמחשה ספציפית של אשכולות מוצא כאלה. בעוד ש-cPCA מבצע היטב כאן, האלגוריתם המומחה עשוי לבצע אפילו טוב יותר עבור סט נתונים ספציפי. עם זאת, האלגוריתם המיוחד דורש ידע תחום משמעותי לעיצוב, הוא יקר יותר חישובית, ויכול להיות מאתגר לשימוש. מטרת cPCA אינה להחליף את כל השיטות המיוחדות המתקדמות בכל אחד מהתחומים שלהן, אלא לספק שיטה כללית לחקר סטי נתונים שרירותיים.

אנו מציעים אלגוריתם קונקרטי ויעיל עבור cPCA במאמר זה. השיטה מקבלת כקלט סט נתונים יעד {x i} שאנו מעוניינים לויזואליזציה או זיהוי דפוסים בתוכו. כקלט משני, cPCA מקבל סט נתונים רקע {y i}, שאינו מכיל את הדפוסים המעניינים. אלגוריתם cPCA מחזיר תת-מרחבים שתופסים כמות גדולה של שונות בנתוני היעד {x i}, אך מעט ברקע {y i} (ראה Fig.[1], שיטות, ושיטות משלימות לפרטים נוספים). תת-מרחב זה מתאים לתכונות המכילות מבנה ספציפי ל-{x i}. לכן, כאשר נתוני היעד מוקרנים על תת-מרחב זה, אנו יכולים לויזואליזציה ולגלות את המבנה הנוסף בנתוני היעד ביחס לרקע. בדומה לרכיבים העיקריים (PCs), אנו קוראים לכיוונים שנמצאו על ידי cPCA הרכיבים העיקריים הקונטרסטיביים (cPCs). אנו מדגישים ש-cPCA הוא בעיקרון טכניקה לא מפוקחת, שנועדה לפתור דפוסים בסט נתונים אחד בצורה ברורה יותר על ידי שימוש בסט נתונים רקע כקונטרסט. במיוחד, cPCA אינו שואף להבחין בין סטי הנתונים של היעד והרקע; תת-המרחב שמכיל מגמות שמועשרות בסט הנתונים של היעד אינו בהכרח אותו תת-מרחב שהוא אופטימלי לסיווג בין סטי הנתונים.

חוקרים ציינו ש-PCA סטנדרטי לעיתים קרובות אינו יעיל בגילוי תת-קבוצות בתוך נתונים ביולוגיים, לפחות בחלקו מכיוון ש"רכיבים עיקריים דומיננטיים...מתואמים עם ארטיפקטים," ולא עם תכונות שמעניינות את החוקר. כיצד ניתן להשתמש ב-cPCA בהגדרות אלה כדי לזהות את תת-הקבוצות המשמעותיות יותר? על ידי שימוש בסט נתונים רקע כדי לבטל את השונות האוניברסלית אך הלא מעניינת ביעד, אנו יכולים לחפש מבנה שהוא ייחודי לסט הנתונים של היעד.

הניסוי הראשון שלנו משתמש בסט נתונים המורכב ממדידות ביטוי חלבון של עכברים שקיבלו טיפול בהלם,. חלק מהעכברים פיתחו תסמונת דאון (DS). כדי ליצור משימת למידה לא מפוקחת שבה יש לנו מידע אמת קרקע להערכת השיטות, אנו מניחים שמידע ה-DS הזה אינו ידוע לאנליסט ומשתמשים בו רק להערכת האלגוריתם. היינו רוצים לראות אם אנו מזהים הבדלים משמעותיים כלשהם בתוך אוכלוסיית העכברים המוכי ההלם בצורה לא מפוקחת (הנוכחות או היעדרות של תסמונת דאון כדוגמה מרכזית). ב-Fig. [3a] (top), אנו מראים את תוצאת יישום PCA על סט הנתונים של היעד: הנתונים המומרצים אינם חושפים כל אשכול משמעותי בתוך אוכלוסיית העכברים. מקורות השונות העיקריים בתוך העכברים עשויים להיות טבעיים, כגון מין או גיל.

אנו מיישמים cPCA על סט נתונים זה תוך שימוש ברקע המורכב ממדידות ביטוי חלבון מקבוצת עכברים שלא נחשפו לטיפול בהלם. הם עכברי בקרה שסביר להניח שיש להם שונות טבעית דומה לעכברים הניסיוניים, אך ללא ההבדלים הנובעים מהטיפול בהלם. עם סט נתונים זה כרקע, cPCA מסוגל לפתור שתי קבוצות שונות בנתוני היעד המומרצים, אחת המתאימה לעכברים שאין להם תסמונת דאון ואחת המתאימה (בעיקר) לעכברים שיש להם תסמונת דאון, כפי שמוצג ב-Fig. [3a] (bottom). כהשוואה, יישמנו גם 8 טכניקות אחרות להפחתת ממדים כדי לזהות כיוונים שמבדילים בין סטי הנתונים של היעד והרקע, אף אחת מהן לא הצליחה להפריד את העכברים כמו cPCA (ראה Supplementary Fig. [4] לפרטים).

לאחר מכן, אנו מנתחים סט נתונים ציבורי ממדי גבוה יותר המורכב מרמות ביטוי RNA של תא בודד של תערובת של תאי מח עצם מונונוקלאריים (BMMCs) שנלקחו מחולה לוקמיה לפני השתלת תאי גזע ו-BMMCs מאותו חולה לאחר השתלת תאי גזע. כל נתוני ה-RNA-Seq של תא בודד מעובדים מראש תוך שימוש בשיטות דומות כפי שתוארו על ידי המחברים. במיוחד, לפני יישום PCA או cPCA, כל סטי הנתונים מצומצמים ל-500 גנים, שנבחרים על בסיס הפיזור הגבוה ביותר [שונות מחולקת בממוצע] בתוך נתוני היעד. שוב, אנו מבצעים PCA כדי לראות אם אנו יכולים לגלות ויזואלית את שתי הדגימות בנתונים המומרצים. כפי שמוצג ב-Fig. [3b] (top left), שני סוגי התאים עוקבים אחר התפלגות דומה במרחב שנפרס על ידי שני ה-PCs הראשונים. זה כנראה מכיוון שההבדלים בין הדגימות קטנים וה-PCs במקום זאת משקפים את ההטרוגניות של סוגי תאים שונים בתוך כל דגימה או אפילו שינויים בתנאי הניסוי, שיכולים להיות בעלי השפעה משמעותית על מדידות RNA-Seq של תא בודד.

אנו מיישמים cPCA תוך שימוש במערך נתונים רקע המורכב ממדידות RNA-Seq מתאי BMMC של אדם בריא. אנו מצפים שמערך נתונים זה יכיל את השונות הנובעת מאוכלוסיית תאים הטרוגנית וכן שינויים בתנאי הניסוי. אנו עשויים לקוות, אם כן, ש-cPCA יוכל לשחזר כיוונים המועשרים בנתוני המטרה, התואמים להבדלים לפני ואחרי השתלת תאי גזע. אכן, זה מה שאנו מוצאים, כפי שמוצג ב-Fig. [3b] (שמאל תחתון).

אנו מרחיבים את מערך הנתונים המטרה שלנו עם דגימות BMMC מחולה לוקמיה שני, שוב לפני ואחרי השתלת תאי גזע. כך, ישנן בסך הכל ארבע תת-אוכלוסיות של תאים. יישום PCA על נתונים אלה מראה כי ארבע תת-האוכלוסיות אינן ניתנות להפרדה בתת-המרחב הנפרס על ידי שני הרכיבים הראשיים העליונים (PCs), כפי שמוצג ב-Fig. [3b] (ימין עליון). שוב, עם זאת, כאשר cPCA מיושם עם אותו מערך נתונים רקע, לפחות שלוש מתת-האוכלוסיות מראות הפרדה חזקה יותר, כפי שמוצג ב-Fig. [3b] (ימין תחתון). ההטבעה של cPCA גם מציעה כי דגימות התאים משני החולים דומות יותר זו לזו לאחר השתלת תאי גזע (נקודות כחולות וירוקות) מאשר לפני ההשתלה (נקודות זהובות וורודות), השערה סבירה שניתן לבדוק על ידי החוקר. ניתן לעיין ב-Fig. [5] הנוסף לפרטים נוספים של ניסוי זה. אנו רואים ש-cPCA יכול להיות כלי שימושי להסיק את הקשר בין תת-אוכלוסיות, נושא שנחקור בהמשך.

בדוגמאות קודמות, ראינו ש-cPCA מאפשר למשתמש לגלות תת-מחלקות בתוך מערך נתונים מטרה שאינן מתויגות מראש. עם זאת, גם כאשר תת-מחלקות ידועות מראש, הפחתת ממדים יכולה להיות דרך שימושית להמחיש את הקשר בתוך קבוצות. לדוגמה, PCA משמש לעיתים קרובות להמחשת הקשר בין אוכלוסיות אתניות על בסיס וריאנטים גנטיים, מכיוון שהשלכת הווריאנטים הגנטיים לשני ממדים לעיתים קרובות מייצרת מפות המציעות המחשות מרשימות של מגמות גיאוגרפיות והיסטוריות,. אך שוב, PCA מוגבל לזיהוי המבנה הדומיננטי ביותר; כאשר זה מייצג שונות אוניברסלית או לא מעניינת, cPCA יכול להיות יעיל יותר בהמחשת מגמות.

מערך הנתונים שאנו משתמשים בו לדוגמה זו מורכב מפולימורפיזמים של נוקלאוטיד יחיד (SNPs) מהגנומים של אנשים מחמש מדינות במקסיקו, שנאספו במחקר קודם. מוצא מקסיקני מאתגר לניתוח באמצעות PCA מכיוון שה-PCs בדרך כלל אינם משקפים את המקור הגיאוגרפי בתוך מקסיקו; במקום זאת, הם משקפים את שיעור המורשת האירופית/אמריקאית ילידית של כל אדם מקסיקני, מה שמדכא ומסתיר הבדלים הנובעים ממקור גיאוגרפי בתוך מקסיקו (ראה Fig. [4a] ). כדי להתגבר על בעיה זו, גנטיקאים של אוכלוסיות גוזמים ידנית SNPs, מסירים את אלה הידועים כמקורם ממוצא אירופי, לפני יישום PCA. עם זאת, הליך זה מוגבל ביישומו מכיוון שהוא דורש לדעת את מקור ה-SNPs ושמקור השונות הרקע שונה מאוד מהשונות המעניינת, מה שלעיתים קרובות אינו המקרה.

כחלופה, אנו משתמשים ב-cPCA עם מערך נתונים רקע המורכב מאנשים ממקסיקו ומאירופה. רקע זה נשלט על ידי שונות אמריקאית ילידית/אירופית, מה שמאפשר לנו לבודד את השונות הפנים-מקסיקנית במערך הנתונים המטרה. תוצאות יישום cPCA מוצגות ב-Fig. [4b]. אנו מוצאים שאנשים מאותה מדינה במקסיקו מוטבעים קרוב יותר זה לזה. יתר על כן, שתי הקבוצות שהן המגוונות ביותר הן הסונורנים והמאיה מיוקטן, שהן גם המרוחקות ביותר גיאוגרפית בתוך מקסיקו, בעוד שמקסיקנים משלוש המדינות האחרות קרובים זה לזה, הן גיאוגרפית והן בהטבעה שנתפסה על ידי cPCA (ראה Fig. [4c] ). ראה גם Fig. [6] הנוסף לפרטים נוספים.

בהגדרות רבות של מדעי הנתונים, אנו מעוניינים להמחיש ולחקור דפוסים המועשרים במערך נתונים אחד ביחס לנתונים אחרים. הצגנו את cPCA ככלי כללי לביצוע חקירה ניגודית כזו, והדגמנו את השימושיות שלו במגוון רחב של יישומים. היתרונות העיקריים של cPCA הם הכלליות והקלות השימוש שלו. חישוב cPCA מסוים לוקח למעשה את אותו זמן כמו חישוב PCA רגיל. יעילות חישובית זו מאפשרת ל-cPCA להיות שימושי לחקר נתונים אינטראקטיבי, שבו כל פעולה צריכה להיות כמעט מיידית. ככזה, כל הגדרות שבהן PCA מיושם על מערכי נתונים קשורים, cPCA יכול גם להיות מיושם. ב-Note[3]הנוסף ו-Fig.[8]הנוסף, אנו מראים כיצד ניתן להפעיל cPCA כדי לחשוף דפוסים ניגודיים לא ליניאריים במערכי נתונים.

הפרמטר החופשי היחיד של cPCA הניגודי הוא עוצמת הניגודα. באלגוריתם ברירת המחדל שלנו, פיתחנו תוכנית אוטומטית המבוססת על אשכולות של תת-מרחבים לבחירת הערכים המידעיים ביותר שלα (ראה שיטות). כל הניסויים שבוצעו עבור מאמר זה משתמשים בערכיα שנוצרו אוטומטית, ואנו מאמינים שברירת מחדל זו תהיה מספקת ביישומים רבים של cPCA. המשתמש יכול גם להזין ערכים ספציפיים עבורα אם נדרשת חקירה מעמיקה יותר.

cPCA, כמו PCA רגיל ושיטות אחרות להפחתת ממדים, אינו מספק ערכיp או כימותים אחרים של מובהקות סטטיסטית. הדפוסים שהתגלו באמצעות cPCA צריכים להיות מאומתים באמצעות בדיקת השערות או ניתוח נוסף תוך שימוש בידע תחום רלוונטי. שחררנו את הקוד עבור cPCA כחבילת פייתון יחד עם תיעוד ודוגמאות.

For thed -dimensional target dataxi ∈ Rd and background datayi ∈ Rd , letC X,C Ybe their corresponding empirical covariance matrices. LetR unit d = def v ∈ Rd :v2 = 1 be the set of unit vectors. For any directionv ∈ R unit d , the variance it accounts for in the target data and in the background data can be written as: Target data variance :λX ( v ) =defvTCXv , Background data variance :λY ( v ) =defvTCYv.Given a contrast parameterα ≥ 0 that quantifies the trade-off between having high target variance and low background variance, cPCA computes the contrastive directionv * by optimizing 1 v * = argmax v ∈ Runitd λ X(v)- α λ Y(v).  This problem can be rewritten asv * = argmax v ∈ Runitd v T CX - α CY v ,  which implies thatv * corresponds to the first eigenvector of the matrixC = def CX - α CY. Hence the contrastive directions can be efficiently computed using eigenvalue decomposition. Analogous to PCA, we call the leading eigenvectors ofC the contrastive principal components (cPCs). We note the cPCs are eigenvectors of the matrixC and are hence orthogonal to each other. For a fixedα , we compute ( [1] ) and return the subspace spanned by the first few (typically two) cPCs.

The contrast parameterα represents the trade-off between having the high target variance and the low background variance. Whenα = 0, cPCA selects the directions that only maximize the target variance, and hence reduces to PCA applied on the target data {x i}. Asα increases, directions with smaller background variance become more important and the cPCs are driven towards the null space of the background data {y i}. In the limiting caseα = ∞, any direction not in the null space of {y i} receives an infinite penalty. In this case, cPCA corresponds to first projecting the target data onto the null space of the background data, and then performing PCA on the projected data.

במקום לבחורα יחיד ולהחזיר את תת-המרחב שלו, cPCA מחשבת את תת-המרחבים של רשימתα ומחזירה כמה תת-המרחבים שרחוקים זה מזה במונחים של הזווית הראשית. השלכת הנתונים על כל אחד מתת-המרחבים הללו תחשוף מגמות שונות בתוך נתוני המטרה, ועל ידי בחינה חזותית של תרשימי הפיזור המוחזרים, המשתמש יכול להבחין במהירות בתת-המרחב הרלוונטי (והערך המתאים שלα ) לניתוח שלו או שלה. ראו Fig. [1] לדוגמה מפורטת.

האלגוריתם המלא של cPCA מתואר באלגוריתם 2 (שיטות משלימות). אנו בדרך כלל מגדירים את רשימת הערכים הפוטנציאליים שלα להיות 40 ערכים המפוזרים לוגריתמית בין 0.1 ל-1000 וזה משמש לכל הניסויים במאמר. כדי לבחור את תת-המרחבים המייצגים, cPCA משתמשת באשכולות ספקטרליים כדי לאגד את תת-המרחבים, כאשר הזיקה מוגדרת כמכפלת הקוסינוס של הזוויות הראשיות בין תת-המרחבים. לאחר מכן, המדיאנים (המייצגים) של כל אשכול משמשים כערכיα ליצירת תרשימי הפיזור הנראים על ידי המשתמש.

הבחירה של מערך הנתונים הרקע משפיעה רבות על תוצאת cPCA. באופן כללי, נתוני הרקע צריכים להיות בעלי המבנה שאנו רוצים להסיר מנתוני המטרה. מבנה כזה בדרך כלל תואם לכיוונים במטרה עם שונות גבוהה, אך שאינם מעניינים את האנליסט.

אנו מספקים כמה דוגמאות כלליות של מערכי נתונים רקע שיכולים לספק ניגודים שימושיים לנתוני המטרה: (1) קבוצת ביקורת {y i} בניגוד לאוכלוסייה חולה {x i} מכיוון שקבוצת הביקורת מכילה שונות ברמת האוכלוסייה דומה אך לא את השונות העדינה הנובעת מתתי-סוגים שונים של המחלה. (2) הנתונים בזמן אפס {y i} המשמשים לניגוד מול נתונים בנקודת זמן מאוחרת יותר {x i}. זה מאפשר ויזואליזציות של השינויים הבולטים ביותר לאורך זמן. (3) קבוצה הומוגנית {y i} בניגוד לקבוצה מעורבת {x i} מכיוון שלשתיהן יש שונות תוך-אוכלוסייתית ורעש מדידה, אך לראשונה אין שונות בין-אוכלוסייתית. (4) מערך נתונים לפני טיפול {y i} בניגוד לנתונים לאחר טיפול {x i} כדי להסיר רעש מדידה אך לשמר שינויים שנגרמו על ידי הטיפול. (5) סט של הקלטות ללא אות {y i} או תמונות המכילות רק רעש, בניגוד למדידות {x i} המכילות גם אות וגם רעש.

כדאי להוסיף שנתוני הרקע לא צריכים להיות בעלי מבנה השונות המדויק שאנו רוצים להסיר מנתוני המטרה. לדוגמה, בניסוי המוצג ב-Fig. [2] , מתברר שאין צורך להשתמש במערך נתונים רקע המורכב מתמונות של דשא. למעשה, תוצאות דומות מתקבלות גם אם במקום תמונות של דשא, משתמשים בתמונות של השמיים כמערך נתונים רקע. מכיוון שמבנה מטריצות השונות דומה מספיק, cPCA מסירה את מבנה הרקע מנתוני המטרה. בנוסף, cPCA לא דורשת שנתוני המטרה ונתוני הרקע יהיו בעלי מספר דגימות דומה. מכיוון שמטריצות השונות מחושבות באופן עצמאי, cPCA דורשת רק שמטריצות השונות האמפיריות יהיו הערכות טובות של מטריצות השונות של האוכלוסייה הבסיסית, שזה בעצם אותו דרישה כמו PCA.

כאן, אנו דנים בפרשנות הגיאומטרית של cPCA כמו גם בתכונות הסטטיסטיות שלה. ראשית, מעניין לשקול אילו כיוונים הם "טובים יותר" למטרת ניתוח ניגודי. עבור כיווןv ∈ R unit d , החשיבות שלו ב-cPCA נקבעת במלואה על ידי זוג השונות מטרה-רקע (λ X(v ),λ Y(v )); רצוי שתהיה שונות מטרה גבוהה ושונות רקע נמוכה. בהתבסס על אינטואיציה זו, אנו יכולים להגדיר סדר חלקי של ניגודיות עבור כיוונים שונים: עבור שני כיווניםv1 ו-v2 , אנו עשויים לומר ש-v1 הוא כיוון ניגודי טוב יותר אם יש לו שונות מטרה גבוהה יותר ושונות רקע נמוכה יותר. במקרה זה, זוג השונות מטרה-רקע שלv1 יהיה בצד הימני-תחתון של זה שלv2 בתרשים של זוגות השונות מטרה-רקע (λ X(v ),λ Y(v )), לדוגמה, Fig. [5]. בהתבסס על סדר חלקי זה, ניתן להגדיר את קבוצת הכיוונים הניגודיים ביותר באופן דומה להגדרת חזית פארטו. תנו ל-U  להיות קבוצת זוגות השונות מטרה-רקע עבור כל הכיוונים, כלומרU = def  ( λX ( v ) ,λY ( v ))v ∈Runitd. קבוצת הכיוונים הניגודיים ביותר תואמת לגבול הימני-תחתון שלU בתרשים של זוגות השונות מטרה-רקע, כפי שמוצג ב-Fig.[5]. (למקרה הספציפי של מטריצות רקע ומטרה הניתנות לדיאגונליזציה בו-זמנית, ראו Fig.[7].)

לגבי cPCA, אנו יכולים להוכיח (ראו הערה משלימה [2] ) כי על ידי שינויα , קבוצת ה-cPC העליונה זהה לקבוצת הכיוונים הניגודיים ביותר. יתר על כן, עבור הכיווןv שנבחר על ידי cPCA עם פרמטר הניגודיות המוגדר ל-α , זוג השונות שלו (λ X(v ),λ Y(v )) תואם לנקודת המגע של הגבול הימני-תחתון שלU  עם קו שיפוע-1/α. כתוצאה מכך, על ידי שינויα מאפס לאינסוף, cPCA בוחרת כיוונים עם זוגות שונות הנעים מהקצה השמאלי-תחתון לקצה הימני-עליון של הגבול הימני-תחתון שלU .

אנו גם מעירים כי לגבי האקראיות של הנתונים, קצב ההתכנסות של ה-cPC המדגמי ל-cPC של האוכלוסייה הואO p  dmin ( n,m ) תחת הנחות מתונות, כאשרd הוא הממד ו-n ,m הם הגדלים של נתוני המטרה והרקע. קצב זה דומה לקצב ההתכנסות הסטנדרטי של וקטור עצמי מדגמי עבור מטריצת שונות. ראו הערה משלימה [2].

שחררנו מימוש Python של cPCA ב-GitHub (https://github.com/abidlabs/contrastive ). מאגר ה-GitHub כולל גם מחברות Python ומערכי נתונים המשחזרים את רוב התרשימים במאמר זה ובמידע המשלים.

מערכי הנתונים ששימשו להערכת cPCA במאמר זה זמינים מאיתנו או מהמחברים של המחקרים המקוריים. אנא ראו את מאגר ה-GitHub המפורט בסעיף הקודם עבור מערכי הנתונים ששחררנו.

Fig. 1: סקירה סכמטית של cPCA. כדי לבצע cPCA, חשב את מטריצות השונות C X, C Yשל מערכי הנתונים המטרה והרקע. הווקטורים הסינגולריים של ההפרש המנוקד של מטריצות השונות, C X− α · C Y, הם הכיוונים המוחזרים על ידי cPCA. כפי שמוצג בתרשים הפיזור מימין, PCA (על נתוני המטרה) מזהה את הכיוון שיש לו את השונות הגבוהה ביותר בנתוני המטרה, בעוד cPCA מזהה את הכיוון שיש לו שונות גבוהה יותר בנתוני המטרה בהשוואה לנתוני הרקע. השלכת נתוני המטרה על הכיוון האחרון נותנת דפוסים ייחודיים לנתוני המטרה ולעיתים קרובות חושפת מבנה ש-PCA מפספסת. במיוחד, בדוגמה זו, הפחתת הממדיות של נתוני המטרה על ידי cPCA תחשוף שני אשכולות נפרדים

Fig. 2: PCA ניגודי על ספרות רועשות.a, למעלה: אנו יוצרים מערך נתונים מטרה של 5,000 תמונות סינתטיות על ידי חפיפה אקראית של תמונות של ספרות כתובות ידנית 0 ו-1 ממאגר הנתונים MNIST על גבי תמונות של דשא שנלקחו ממאגר הנתונים ImageNet השייכות לסינסת הדשא. התמונות של הדשא מומרות לגווני אפור, משנות גודל ל-100 × 100, ואז נחתכות אקראית לגודל זהה לספרות MNIST, 28 × 28.b, למעלה: כאן, אנו מציגים את תוצאת ההטמעה של התמונות הסינתטיות על שני הרכיבים הראשונים שלהם באמצעות PCA סטנדרטי. אנו רואים שהנקודות המתאימות לתמונות עם 0 ותמונות עם 1 קשות להבחנה.a, למטה: מערך נתונים רקע מוצג אז המורכב אך ורק מתמונות של דשא השייכות לאותו סינסת, אך אנו משתמשים בתמונות השונות מאלה ששימשו ליצירת מערך הנתונים המטרה.b, למטה: באמצעות cPCA על מערכי הנתונים המטרה והרקע (עם ערך של פרמטר הניגוד α שנקבע ל-2.0), שני אשכולות מופיעים בייצוג הממד הנמוך של מערך הנתונים המטרה, אחד המורכב מתמונות עם הספרה 0 והשני מתמונות עם הספרה 1.cאנו מסתכלים על התרומה היחסית של כל פיקסל לרכיב הראשי הראשון (PC) ולרכיב הראשי הניגודי הראשון (cPC). פיקסלים לבנים יותר הם אלה שנושאים משקל חיובי יותר, בעוד כהים מציינים את הפיקסלים שנושאים משקלים שליליים. PCA נוטה להדגיש פיקסלים בהיקף התמונה ולהפחית מעט את הדגש על פיקסלים במרכז ובתחתית התמונה, מה שמצביע על כך שרוב השונות נובעת מתכונות הרקע. מצד שני, cPCA נוטה להעלות את משקל הפיקסלים שנמצאים במיקום של הספרות הכתובות 1, להוריד את משקל הפיקסלים במיקום של הספרות הכתובות 0, ולהזניח את רוב הפיקסלים האחרים, ובכך לגלות את התכונות השימושיות להבחנה בין הספרות המונחות

Fig. 3: גילוי תת-קבוצות בנתונים ביולוגיים. a אנו משתמשים ב-PCA כדי להשליך מערך נתונים של ביטוי חלבון של עכברים עם וללא תסמונת דאון (DS) על שני הרכיבים הראשונים. הייצוג הממד הנמוך של מדידות ביטוי החלבון מעכברים עם וללא DS נראה מופץ באופן דומה (למעלה). אבל, כשאנו משתמשים ב-cPCA כדי להשליך את מערך הנתונים על שני ה-cPCs הראשונים שלו, אנו מגלים ייצוג ממד נמוך שמקבץ עכברים עם וללא DS בנפרד (למטה). b יתר על כן, אנו משתמשים ב-PCA ו-cPCA כדי להמחיש מערך נתונים של RNA-Seq חד-תאי בממד גבוה בשני ממדים. מערך הנתונים מורכב מארבע דגימות תאים משני חולי לוקמיה: דגימה לפני השתלה מחולה 1, דגימה לאחר השתלה מחולה 1, דגימה לפני השתלה מחולה 2, ודגימה לאחר השתלה מחולה 2. b , שמאל: התוצאות באמצעות רק הדגימות מחולה 1, שמדגימות ש-cPCA (למטה) מפריד את הדגימות בצורה יעילה יותר מ-PCA (למעלה). כאשר הדגימות מהחולה השני כלולות, ב- b , ימין, שוב cPCA (למטה) מפריד את הדגימות בצורה יעילה יותר מ-PCA (למעלה), למרות שהתאים לאחר ההשתלה משני החולים מופצים באופן דומה. אנו מציגים גרפים של כל דגימה בנפרד ב-Fig.[5] המשלים, שם קל יותר לראות את החפיפה בין דגימות שונות

Fig. 4: הקשר בין קבוצות מוצא מקסיקניות. a PCA שהוחל על נתונים גנטיים מאנשים מ-5 מדינות מקסיקניות אינו חושף דפוסים נראים לעין בנתונים המוטמעים. b cPCA שהוחל על אותו מערך נתונים חושף דפוסים בנתונים: אנשים מאותה מדינה מקובצים קרוב יותר זה לזה בהטמעת cPCA. c יתר על כן, התפלגות הנקודות חושפת קשרים בין הקבוצות שמתאימים למיקום הגיאוגרפי של המדינות השונות: לדוגמה, אנשים ממדינות סמוכות גיאוגרפית סמוכים בהטמעה. c מותאם ממפת מקסיקו שהיא במקור עבודתו של משתמש:Allstrak בוויקיפדיה, פורסם תחת רישיון CC-BY-SA, נלקח מ- https://commons.wikimedia.org/wiki/File:Mexico_Map.svg

Fig. 5: פרשנות גיאומטרית של cPCA. קבוצת זוגות השונות מטרה–רקעUמתוארת כאזור טורקיז עבור נתוני מטרה ורקע שנוצרו באקראי. הגבול התחתון-ימני, בצבע זהב, מתאים לקבוצת הכיוונים הניגודיים ביותרSλ. המשולשים הכחולים הם זוגות השונות עבור ה-cPCs שנבחרו עם ערכי α 0.92 ו-0.29 בהתאמה. אנו מציינים שהם תואמים לנקודות המגע של העקומה הזהובה והקווים המשיקים עם שיפוע1α= 1.08, 3.37, בהתאמה

