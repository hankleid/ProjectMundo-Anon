استكشاف الأنماط الغنية في مجموعة بيانات باستخدام تحليل المكونات الرئيسية التبايني

الملخص: يُعد تصور واستكشاف البيانات عالية الأبعاد تحديًا شائعًا عبر التخصصات. تهدف التقنيات المستخدمة على نطاق واسع مثل تحليل المكونات الرئيسية (PCA) إلى تحديد الاتجاهات السائدة في مجموعة بيانات واحدة. ومع ذلك، في العديد من الإعدادات، لدينا مجموعات بيانات تم جمعها في ظل ظروف مختلفة، مثل تجربة علاج وتجربة تحكم، ونحن مهتمون بتصور واستكشاف الأنماط الخاصة بمجموعة بيانات واحدة. يقترح هذا البحث طريقة، وهي تحليل المكونات الرئيسية التبايني (cPCA)، التي تحدد الهياكل منخفضة الأبعاد التي تكون غنية في مجموعة بيانات مقارنة ببيانات المقارنة. في مجموعة متنوعة من التجارب، نوضح أن cPCA مع مجموعة بيانات خلفية يمكننا من تصور الأنماط الخاصة بمجموعة البيانات التي لم يتم اكتشافها بواسطة PCA والطرق القياسية الأخرى. نقدم أيضًا تفسيرًا هندسيًا لـ cPCA وضمانات رياضية قوية. يتوفر تنفيذ لـ cPCA بشكل عام، ويمكن استخدامه لتحليل البيانات الاستكشافية في العديد من التطبيقات حيث يتم استخدام PCA حاليًا.

تحليل المكونات الرئيسية (PCA) هو أحد أكثر الأساليب استخدامًا لاستكشاف البيانات وتصورها. يقوم PCA بإسقاط البيانات على مساحة منخفضة الأبعاد ويعتبر قويًا بشكل خاص كنهج لتصور الأنماط، مثل التجمعات، والانحدارات، والقيم الشاذة في مجموعة البيانات. هناك عدد كبير من طرق التصور ذات الصلة؛ على سبيل المثال، t-SNE والتحجيم متعدد الأبعاد (MDS) يسمحان بإسقاطات غير خطية للبيانات وقد يلتقطان الأنماط غير الخطية بشكل أفضل من PCA. ومع ذلك، تم تصميم جميع هذه الأساليب لاستكشاف مجموعة بيانات واحدة في كل مرة. عندما يكون لدى المحلل مجموعات بيانات متعددة (أو ظروف متعددة في مجموعة بيانات واحدة للمقارنة)، فإن الحالة الحالية للممارسة هي إجراء PCA (أو t-SNE، MDS، إلخ) على كل مجموعة بيانات بشكل منفصل، ثم مقارنة الإسقاطات المختلفة يدويًا لاستكشاف ما إذا كانت هناك تشابهات واختلافات مثيرة للاهتمام عبر مجموعات البيانات,. تم تصميم PCA التبايني (cPCA) لملء هذه الفجوة في استكشاف البيانات وتصورها من خلال تحديد الإسقاطات التي تعرض الاختلافات الأكثر إثارة للاهتمام عبر مجموعات البيانات تلقائيًا. يوضح الشكل[1]نظرة عامة على cPCA التي نشرحها بمزيد من التفصيل لاحقًا.

يتم تحفيز cPCA من خلال مجموعة واسعة من المشاكل عبر التخصصات. للتوضيح، نذكر هنا مشكلتين من هذا القبيل ونوضح أخرى من خلال التجارب لاحقًا في الورقة. أولاً، ضع في اعتبارك مجموعة بيانات لقياسات التعبير الجيني من أفراد من أعراق وأجناس مختلفة. تتضمن هذه البيانات مستويات التعبير الجيني لمرضى السرطان {x i}، والتي نحن مهتمون بتحليلها. لدينا أيضًا بيانات تحكم، والتي تتوافق مع مستويات التعبير الجيني للمرضى الأصحاء {y i} من خلفية ديموغرافية مماثلة. هدفنا هو العثور على الاتجاهات والاختلافات داخل مرضى السرطان (على سبيل المثال، لتحديد الأنواع الفرعية الجزيئية للسرطان). إذا قمنا بتطبيق PCA مباشرة على {x i}، فقد تتوافق المكونات الرئيسية العليا مع الاختلافات الديموغرافية للأفراد بدلاً من الأنواع الفرعية للسرطانات لأن الاختلافات الجينية بسبب الأولى من المحتمل أن تكون أكبر من تلك الخاصة بالأخيرة. نتعامل مع هذه المشكلة من خلال ملاحظة أن المرضى الأصحاء يحتويون أيضًا على الاختلاف المرتبط بالاختلافات الديموغرافية، ولكن ليس الاختلاف المقابل للأنواع الفرعية للسرطانات. وبالتالي، يمكننا البحث عن المكونات التي يكون فيها {x i} لديه تباين عالي ولكن {y i} لديه تباين منخفض.

كمثال ذي صلة، ضع في اعتبارك مجموعة بيانات {x i} التي تتكون من أرقام مكتوبة بخط اليد على خلفية معقدة، مثل صور مختلفة للعشب (انظر Fig.[2(a), top]). قد يكون الهدف من مهمة تعلم غير خاضعة للإشراف هو تجميع البيانات، وكشف الأرقام المختلفة في الصورة. ومع ذلك، إذا قمنا بتطبيق PCA القياسي على هذه الصور، نجد أن المكونات الرئيسية العليا لا تمثل ميزات متعلقة بالأرقام المكتوبة بخط اليد، بل تعكس التباين السائد في الميزات المتعلقة بخلفية الصورة (Fig.[2(b)], top). نوضح أنه من الممكن تصحيح ذلك باستخدام مجموعة بيانات مرجعية {y i} تتكون فقط من صور للعشب (ليس بالضرورة نفس الصور المستخدمة في {x i} ولكن لها تباين مشابه بين الميزات، كما هو موضح في Fig.[2(a)], bottom)، والبحث عن الفضاء الفرعي ذو التباين الأعلى في {x i} مقارنة بـ {y i}. من خلال الإسقاط على هذا الفضاء الفرعي، يمكننا فعليًا فصل الصور بصريًا بناءً على قيمة الرقم المكتوب بخط اليد (Fig. 2(b), bottom). من خلال مقارنة المكونات الرئيسية المكتشفة بواسطة PCA مع تلك المكتشفة بواسطة cPCA، نرى أن cPCA يحدد ميزات أكثر صلة (Fig.[2(c)])، مما يسمح لنا باستخدام cPCA لمثل هذه التطبيقات مثل اختيار الميزات وإزالة الضوضاء.

PCA التبايني هو أداة للتعلم غير الخاضع للإشراف، والتي تقلل بكفاءة الأبعاد لتمكين التصور وتحليل البيانات الاستكشافي. يميز هذا cPCA عن فئة كبيرة من طرق التعلم الخاضعة للإشراف التي يكون هدفها الأساسي هو التصنيف أو التمييز بين مجموعات البيانات المختلفة، مثل التحليل التمييزي الخطي (LDA)، التحليل التمييزي التربيعي (QDA)، PCA الخاضع للإشراف، وQUADRO. يميز هذا أيضًا cPCA عن الأساليب التي تدمج مجموعات بيانات متعددة، بهدف تحديد الأنماط المرتبطة بين مجموعتين أو أكثر من مجموعات البيانات، بدلاً من تلك الفريدة لكل مجموعة بيانات فردية. هناك أيضًا عائلة غنية من الأساليب غير الخاضعة للإشراف لتقليل الأبعاد بجانب PCA. على سبيل المثال، التحجيم متعدد الأبعاد (MDS) يجد تضمينًا منخفض الأبعاد يحافظ على المسافة في الفضاء عالي الأبعاد؛ السعي وراء المكونات الرئيسية يجد فضاء فرعي منخفض الرتبة يكون قويًا ضد الضوضاء الصغيرة على مستوى الإدخال والأخطاء النادرة الكبيرة. ولكن لا يتم تصميم أي منها لاستخدام المعلومات ذات الصلة من مجموعة بيانات ثانية، كما يفعل cPCA. في الملحق، قمنا بمقارنة cPCA بالعديد من التقنيات المذكورة سابقًا على مجموعات بيانات تمثيلية (انظر الأشكال التكميلية[3]و[4]), , ,.

في مجال تطبيق محدد، قد تكون هناك أدوات متخصصة في ذلك المجال بأهداف مشابهة لـ cPCA, ,. على سبيل المثال، في النتائج، نعرض كيف أن cPCA المطبق على بيانات النمط الجيني يصور الأصول الجغرافية داخل المكسيك. استكشاف التجمعات الدقيقة للأصول الجينية هو مشكلة مهمة في علم الوراثة السكانية، وقد طور الباحثون مؤخرًا خوارزمية لتصور مثل هذه التجمعات الأصولية بشكل خاص. بينما يعمل cPCA بشكل جيد هنا، قد تعمل الخوارزمية المصممة من قبل الخبراء بشكل أفضل لمجموعة بيانات محددة. ومع ذلك، تتطلب الخوارزمية المتخصصة معرفة كبيرة بالمجال لتصميمها، وهي أكثر تكلفة من الناحية الحسابية، ويمكن أن تكون صعبة الاستخدام. الهدف من cPCA ليس استبدال جميع هذه الأساليب المتخصصة المتقدمة في كل من مجالاتها، بل توفير طريقة عامة لاستكشاف مجموعات البيانات العشوائية.

نقترح خوارزمية ملموسة وفعالة لـ cPCA في هذه الورقة. تأخذ الطريقة كمدخل مجموعة بيانات مستهدفة {x i} التي نحن مهتمون بتصورها أو تحديد الأنماط داخلها. كمدخل ثانوي، يأخذ cPCA مجموعة بيانات خلفية {y i}، والتي لا تحتوي على الأنماط ذات الاهتمام. تعيد خوارزمية cPCA الفضاءات الفرعية التي تلتقط كمية كبيرة من التباين في البيانات المستهدفة {x i}، ولكن القليل في الخلفية {y i} (انظر Fig.[1]، الطرق، والطرق التكميلية لمزيد من التفاصيل). يتوافق هذا الفضاء الفرعي مع الميزات التي تحتوي على هيكل محدد لـ {x i}. وبالتالي، عندما يتم إسقاط البيانات المستهدفة على هذا الفضاء الفرعي، نتمكن من تصور واكتشاف الهيكل الإضافي في البيانات المستهدفة بالنسبة للخلفية. مشابهًا للمكونات الرئيسية (PCs)، نسمي الاتجاهات التي وجدها cPCA المكونات الرئيسية التباينية (cPCs). نؤكد أن cPCA هو في الأساس تقنية غير خاضعة للإشراف، مصممة لحل الأنماط في مجموعة بيانات واحدة بشكل أوضح باستخدام مجموعة البيانات الخلفية كتناقض. على وجه الخصوص، لا يسعى cPCA إلى التمييز بين مجموعات البيانات المستهدفة والخلفية؛ الفضاء الفرعي الذي يحتوي على الاتجاهات التي يتم إثراؤها في مجموعة البيانات المستهدفة ليس بالضرورة نفس الفضاء الفرعي الذي يكون مثاليًا للتصنيف بين مجموعات البيانات.

لاحظ الباحثون أن PCA القياسي غالبًا ما يكون غير فعال في اكتشاف المجموعات الفرعية داخل البيانات البيولوجية، على الأقل جزئيًا لأن "المكونات الرئيسية السائدة... ترتبط بالقطع الأثرية"، بدلاً من الميزات التي تهم الباحث. كيف يمكن استخدام cPCA في هذه الإعدادات لاكتشاف المجموعات الفرعية الأكثر أهمية؟ باستخدام مجموعة بيانات خلفية لإلغاء التباين العالمي ولكن غير المثير للاهتمام في الهدف، يمكننا البحث عن هيكل فريد لمجموعة البيانات المستهدفة.

تستخدم تجربتنا الأولى مجموعة بيانات تتكون من قياسات التعبير البروتيني للفئران التي تلقت علاجًا بالصدمة,. بعض الفئران قد طورت متلازمة داون (DS). لإنشاء مهمة تعلم غير خاضعة للإشراف حيث لدينا معلومات حقيقية لتقييم الأساليب، نفترض أن هذه المعلومات عن DS غير معروفة للمحلل ونستخدمها فقط لتقييم الخوارزمية. نود أن نرى ما إذا كنا نكتشف أي اختلافات كبيرة داخل مجموعة الفئران المصابة بالصدمة بطريقة غير خاضعة للإشراف (وجود أو عدم وجود متلازمة داون كمثال رئيسي). في Fig. [3a] (أعلى)، نعرض نتيجة تطبيق PCA على مجموعة البيانات المستهدفة: البيانات المحولة لا تكشف عن أي تجمعات كبيرة داخل مجموعة الفئران. قد تكون المصادر الرئيسية للتباين داخل الفئران طبيعية، مثل الجنس أو العمر.

نطبق cPCA على هذه المجموعة من البيانات باستخدام خلفية تتكون من قياسات التعبير البروتيني لمجموعة من الفئران التي لم تتعرض لعلاج الصدمة. هم فئران تحكم من المحتمل أن يكون لديهم تباين طبيعي مشابه للفئران التجريبية، ولكن بدون الاختلافات الناتجة عن علاج الصدمة. مع هذه المجموعة من البيانات كخلفية، يكون cPCA قادرًا على حل مجموعتين مختلفتين في البيانات المستهدفة المحولة، واحدة تتوافق مع الفئران التي لا تعاني من متلازمة داون وواحدة تتوافق (في الغالب) مع الفئران التي تعاني من متلازمة داون، كما هو موضح في Fig. [3a] (أسفل). كمقارنة، قمنا أيضًا بتطبيق 8 تقنيات أخرى لتقليل الأبعاد لتحديد الاتجاهات التي تميز بين مجموعات البيانات المستهدفة والخلفية، لم يتمكن أي منها من فصل الفئران كما فعل cPCA (انظر الشكل التكميلي [4] للتفاصيل).

بعد ذلك، نقوم بتحليل مجموعة بيانات عامة ذات أبعاد أعلى تتكون من مستويات التعبير عن الحمض النووي الريبي أحادي الخلية لمزيج من خلايا النخاع العظمي وحيدة النواة (BMMCs) مأخوذة من مريض بسرطان الدم قبل زراعة الخلايا الجذعية وBMMCs من نفس المريض بعد زراعة الخلايا الجذعية. يتم معالجة جميع بيانات RNA-Seq أحادية الخلية باستخدام طرق مماثلة كما وصفها المؤلفون. على وجه الخصوص، قبل تطبيق PCA أو cPCA، يتم تقليل جميع مجموعات البيانات إلى 500 جين، والتي يتم اختيارها على أساس أعلى تشتت [التباين مقسومًا على المتوسط] داخل البيانات المستهدفة. مرة أخرى، نقوم بإجراء PCA لنرى ما إذا كان بإمكاننا اكتشاف العينتين بصريًا في البيانات المحولة. كما هو موضح في Fig. [3b] (أعلى اليسار)، يتبع كلا نوعي الخلايا توزيعًا مشابهًا في الفضاء الممتد بواسطة أول مكونين رئيسيين. من المحتمل أن يكون ذلك لأن الاختلافات بين العينات صغيرة والمكونات الرئيسية تعكس بدلاً من ذلك تباين أنواع مختلفة من الخلايا داخل كل عينة أو حتى التباينات في الظروف التجريبية، والتي يمكن أن يكون لها تأثير كبير على قياسات RNA-Seq أحادية الخلية.

نطبق cPCA باستخدام مجموعة بيانات خلفية تتكون من قياسات RNA-Seq من خلايا BMMC لفرد سليم. نتوقع أن تحتوي مجموعة البيانات الخلفية هذه على التباين الناتج عن التوزيع غير المتجانس للخلايا وكذلك التباينات في الظروف التجريبية. قد نأمل، إذن، أن يكون cPCA قادرًا على استعادة الاتجاهات التي تكون غنية في بيانات الهدف، والتي تتوافق مع الاختلافات قبل وبعد الزرع. في الواقع، هذا ما نجده، كما هو موضح في Fig. [3b] (أسفل اليسار).

نزيد من مجموعة بيانات الهدف لدينا بعينات BMMC من مريض ثانٍ بسرطان الدم، مرة أخرى قبل وبعد زرع الخلايا الجذعية. وبالتالي، هناك ما مجموعه أربع مجموعات فرعية من الخلايا. يُظهر تطبيق PCA على هذه البيانات أن المجموعات الفرعية الأربع غير قابلة للفصل في الفضاء الذي يمتد بواسطة المكونين الرئيسيين (PCs)، كما هو موضح في Fig. [3b] (أعلى اليمين). مرة أخرى، ومع ذلك، عندما يتم تطبيق cPCA مع نفس مجموعة البيانات الخلفية، تظهر على الأقل ثلاث من المجموعات الفرعية انفصالًا أقوى بكثير، كما هو موضح في Fig. [3b] (أسفل اليمين). يشير تضمين cPCA أيضًا إلى أن عينات الخلايا من كلا المريضين أكثر تشابهًا مع بعضها البعض بعد زرع الخلايا الجذعية (النقاط الزرقاء الفاتحة والخضراء) مقارنةً بما كانت عليه قبل الزرع (النقاط الذهبية والوردية)، وهي فرضية معقولة يمكن اختبارها من قبل الباحث. يمكن الرجوع إلى Fig. [5] التكميلية لمزيد من التفاصيل حول هذه التجربة. نرى أن cPCA يمكن أن يكون أداة مفيدة لاستنتاج العلاقة بين المجموعات الفرعية، وهو موضوع نستكشفه أكثر في القسم التالي.

في الأمثلة السابقة، رأينا أن cPCA يسمح للمستخدم باكتشاف الفئات الفرعية داخل مجموعة بيانات الهدف التي لم يتم تصنيفها مسبقًا. ومع ذلك، حتى عندما تكون الفئات الفرعية معروفة مسبقًا، يمكن أن يكون تقليل الأبعاد وسيلة مفيدة لتصور العلاقة داخل المجموعات. على سبيل المثال، غالبًا ما يُستخدم PCA لتصور العلاقة بين المجموعات العرقية بناءً على المتغيرات الجينية، لأن إسقاط المتغيرات الجينية على بعدين غالبًا ما ينتج خرائط تقدم تصورات مذهلة للاتجاهات الجغرافية والتاريخية,. ولكن مرة أخرى، يقتصر PCA على تحديد الهيكل الأكثر سيطرة؛ عندما يمثل هذا التباين العالمي أو غير المثير للاهتمام، يمكن أن يكون cPCA أكثر فعالية في تصور الاتجاهات.

تتكون مجموعة البيانات التي نستخدمها لهذا المثال من تعدد أشكال النوكليوتيدات المفردة (SNPs) من جينومات الأفراد من خمس ولايات في المكسيك، تم جمعها في دراسة سابقة. يعد تحليل الأصول المكسيكية باستخدام PCA تحديًا لأن المكونات الرئيسية عادةً لا تعكس الأصل الجغرافي داخل المكسيك؛ بدلاً من ذلك، تعكس نسبة التراث الأوروبي/الأمريكي الأصلي لكل فرد مكسيكي، مما يهيمن ويخفي الفروق الناتجة عن الأصل الجغرافي داخل المكسيك (انظر Fig. [4a] ). للتغلب على هذه المشكلة، يقوم علماء الوراثة السكانية بتقليم SNPs يدويًا، وإزالة تلك المعروفة بأنها مشتقة من الأصول الأوروبية، قبل تطبيق PCA. ومع ذلك، فإن هذا الإجراء محدود التطبيق لأنه يتطلب معرفة أصل SNPs وأن يكون مصدر التباين الخلفي مختلفًا جدًا عن التباين محل الاهتمام، وهو ما لا يكون الحال غالبًا.

كبديل، نستخدم cPCA مع مجموعة بيانات خلفية تتكون من أفراد من المكسيك وأوروبا. يهيمن على هذه الخلفية التباين الأمريكي الأصلي/الأوروبي، مما يسمح لنا بعزل التباين داخل المكسيك في مجموعة بيانات الهدف. تظهر نتائج تطبيق cPCA في Fig. [4b]. نجد أن الأفراد من نفس الولاية في المكسيك مدمجون بشكل أقرب معًا. علاوة على ذلك، فإن المجموعتين الأكثر تباعدًا هما السونوران والمايا من يوكاتان، واللذان هما أيضًا الأكثر تباعدًا جغرافيًا داخل المكسيك، بينما المكسيكيون من الولايات الثلاث الأخرى قريبون من بعضهم البعض، جغرافيًا وكذلك في التضمين الذي تم التقاطه بواسطة cPCA (انظر Fig. [4c] ). انظر أيضًا Fig. [6] التكميلية لمزيد من التفاصيل.

في العديد من إعدادات علوم البيانات، نحن مهتمون بتصور واستكشاف الأنماط التي تكون غنية في مجموعة بيانات واحدة بالنسبة للبيانات الأخرى. لقد قدمنا cPCA كأداة عامة لأداء مثل هذا الاستكشاف التبايني، وقد أوضحنا فائدته في مجموعة متنوعة من التطبيقات. المزايا الرئيسية لـ cPCA هي عموميته وسهولة استخدامه. يستغرق حساب cPCA معين في الأساس نفس مقدار الوقت الذي يستغرقه حساب PCA العادي. تُمكّن هذه الكفاءة الحسابية cPCA من أن تكون مفيدة لاستكشاف البيانات التفاعلي، حيث يجب أن تكون كل عملية تقريبًا فورية. على هذا النحو، يمكن تطبيق cPCA في أي إعدادات يتم فيها تطبيق PCA على مجموعات البيانات ذات الصلة. في الملاحظة التكميلية[3]وFig.[8]التكميلية، نوضح كيف يمكن تحويل cPCA إلى شكل نواة لاكتشاف الأنماط التباينية غير الخطية في مجموعات البيانات.

المعلمة الحرة الوحيدة لـ cPCA التبايني هي قوة التباينα. في خوارزميتنا الافتراضية، قمنا بتطوير مخطط تلقائي يعتمد على تجميعات الفضاءات الفرعية لاختيار القيم الأكثر إفادة لـα (انظر الطرق). جميع التجارب التي أجريت لهذه الورقة تستخدم القيمα التي تم إنشاؤها تلقائيًا، ونعتقد أن هذا الافتراضي سيكون كافيًا في العديد من تطبيقات cPCA. يمكن للمستخدم أيضًا إدخال قيم محددة لـα إذا كان الاستكشاف الأكثر دقة مطلوبًا.

cPCA، مثل PCA العادي وطرق تقليل الأبعاد الأخرى، لا يعطي قيمp أو كميات دلالة إحصائية أخرى. يجب التحقق من الأنماط المكتشفة من خلال cPCA من خلال اختبار الفرضيات أو التحليل الإضافي باستخدام المعرفة الميدانية ذات الصلة. لقد أصدرنا الكود الخاص بـ cPCA كحزمة بايثون مع الوثائق والأمثلة.

بالنسبة لبيانات الهدف ذات الأبعادdxi ∈ Rd وبيانات الخلفيةyi ∈ Rd ، دعC X،C Yتكون مصفوفات التباين التجريبية المقابلة لها. دعR unit d = def v ∈ Rd :v2 = 1 تكون مجموعة المتجهات الوحدة. لأي اتجاهv ∈ R unit d ، يمكن كتابة التباين الذي يحسبه في بيانات الهدف وبيانات الخلفية كالتالي: Target data variance :λX ( v ) =defvTCXv , Background data variance :λY ( v ) =defvTCYv.معطى معلمة التباينα ≥ 0 التي تحدد التوازن بين الحصول على تباين هدف عالٍ وتباين خلفية منخفض، يقوم cPCA بحساب الاتجاه التباينيv * عن طريق تحسين 1 v * = argmax v ∈ Runitd λ X(v)- α λ Y(v).  يمكن إعادة كتابة هذه المشكلة كالتاليv * = argmax v ∈ Runitd v T CX - α CY v ,  مما يعني أنv * يتوافق مع المتجه الذاتي الأول للمصفوفةC = def CX - α CY. ومن ثم يمكن حساب الاتجاهات التباينية بكفاءة باستخدام تحليل القيم الذاتية. على غرار PCA، نسمي المتجهات الذاتية الرائدة لـC المكونات الرئيسية التباينية (cPCs). نلاحظ أن cPCs هي متجهات ذاتية للمصفوفةC وبالتالي فهي متعامدة مع بعضها البعض. بالنسبة لقيمة ثابتة لـα ، نحسب ( [1] ) ونعيد الفضاء الفرعي الذي يمتد بواسطة أول عدد قليل (عادةً اثنين) من cPCs.

تمثل معلمة التباينα التوازن بين الحصول على تباين هدف عالٍ وتباين خلفية منخفض. عندماα = 0، يختار cPCA الاتجاهات التي تزيد فقط من تباين الهدف، وبالتالي يقلل إلى PCA المطبق على بيانات الهدف {x i}. مع زيادةα ، تصبح الاتجاهات ذات التباين الخلفي الأصغر أكثر أهمية ويتم دفع cPCs نحو الفضاء الصفري لبيانات الخلفية {y i}. في الحالة الحديةα = ∞، أي اتجاه ليس في الفضاء الصفري لـ {y i} يتلقى عقوبة لا نهائية. في هذه الحالة، يتوافق cPCA مع إسقاط بيانات الهدف أولاً على الفضاء الصفري لبيانات الخلفية، ثم إجراء PCA على البيانات المسقطة.

بدلاً من اختيار قيمة واحدة لـα وإرجاع فضائها الجزئي، يقوم cPCA بحساب الفضاءات الجزئية لقائمة من قيمα ويعيد بعض الفضاءات الجزئية التي تكون بعيدة عن بعضها البعض من حيث الزاوية الرئيسية. إسقاط البيانات على كل من هذه الفضاءات الجزئية سيكشف عن اتجاهات مختلفة داخل البيانات المستهدفة، ومن خلال فحص الرسوم البيانية المتناثرة التي يتم إرجاعها، يمكن للمستخدم بسرعة تمييز الفضاء الجزئي المناسب (وقيمةα المقابلة) لتحليله أو تحليلها. انظر الشكل التكميلي [1] لمثال مفصل.

يتم وصف الخوارزمية الكاملة لـ cPCA في الخوارزمية 2 (الطرق التكميلية). عادةً ما نحدد قائمة القيم المحتملة لـα لتكون 40 قيمة موزعة لوغاريتميًا بين 0.1 و1000 ويتم استخدام هذا لجميع التجارب في الورقة. لاختيار الفضاءات الجزئية التمثيلية، يستخدم cPCA التجميع الطيفي لتجميع الفضاءات الجزئية، حيث يتم تعريف الألفة على أنها ناتج جيب الزاوية الرئيسية بين الفضاءات الجزئية. ثم يتم استخدام الميدويد (التمثيلي) لكل مجموعة كقيم لـα لتوليد الرسوم البيانية المتناثرة التي يراها المستخدم.

يؤثر اختيار مجموعة البيانات الخلفية بشكل كبير على نتيجة cPCA. بشكل عام، يجب أن تحتوي البيانات الخلفية على البنية التي نود إزالتها من البيانات المستهدفة. عادةً ما تتوافق هذه البنية مع الاتجاهات في الهدف ذات التباين العالي، ولكنها ليست ذات اهتمام للمحلل.

نقدم بعض الأمثلة العامة لمجموعات البيانات الخلفية التي قد توفر تباينات مفيدة للبيانات المستهدفة: (1) مجموعة تحكم {y i} متناقضة مع مجموعة مرضى {x i} لأن مجموعة التحكم تحتوي على تباين على مستوى السكان مشابه ولكن ليس التباين الدقيق الناتج عن الأنواع الفرعية المختلفة للمرض. (2) البيانات عند الزمن صفر {y i} المستخدمة للتباين مع البيانات في نقطة زمنية لاحقة {x i}. يتيح ذلك تصور التغيرات الأكثر بروزًا بمرور الوقت. (3) مجموعة متجانسة {y i} متناقضة مع مجموعة مختلطة {x i} لأن كلاهما يحتوي على تباين داخل السكان وضوضاء قياس، ولكن الأول لا يحتوي على تباين بين السكان. (4) مجموعة بيانات قبل العلاج {y i} متناقضة مع بيانات بعد العلاج {x i} لإزالة ضوضاء القياس ولكن الحفاظ على التباينات الناتجة عن العلاج. (5) مجموعة من التسجيلات الخالية من الإشارة {y i} أو الصور التي تحتوي فقط على ضوضاء، متناقضة مع القياسات {x i} التي تتكون من كل من الإشارة والضوضاء.

من الجدير بالذكر أن البيانات الخلفية لا تحتاج إلى أن يكون لها نفس هيكل التغاير الذي نود إزالته من مجموعة البيانات المستهدفة. كمثال، في التجربة الموضحة في Fig. [2] ، يتبين أننا لا نحتاج إلى استخدام مجموعة بيانات خلفية تتكون من صور للعشب. في الواقع، يتم الحصول على نتائج مماثلة حتى إذا تم استخدام صور للسماء بدلاً من صور العشب كمجموعة بيانات خلفية. نظرًا لأن هيكل مصفوفات التغاير متشابه بما فيه الكفاية، يقوم cPCA بإزالة الهيكل الخلفي من البيانات المستهدفة. بالإضافة إلى ذلك، لا يتطلب cPCA أن تحتوي البيانات المستهدفة والبيانات الخلفية على عدد مماثل من العينات. نظرًا لأن مصفوفات التغاير تُحسب بشكل مستقل، يتطلب cPCA فقط أن تكون مصفوفات التغاير التجريبية تقديرات جيدة لمصفوفات التغاير السكانية الأساسية، وهو نفس المتطلب الأساسي لـ PCA.

هنا، نناقش التفسير الهندسي لـ cPCA وكذلك خصائصه الإحصائية. أولاً، من المثير للاهتمام النظر في أي الاتجاهات هي "أفضل" لغرض التحليل التبايني. بالنسبة لاتجاهv ∈ R unit d ، يتم تحديد أهميته في cPCA بالكامل من خلال زوج التباين الهدف-الخلفية (λ X(v ),λ Y(v )); من المرغوب فيه أن يكون هناك تباين هدف أعلى وتباين خلفية أقل. بناءً على هذه الفكرة، يمكننا تحديد ترتيب جزئي للتباين لمختلف الاتجاهات: بالنسبة لاتجاهينv1 وv2 ، قد نقول أنv1 هو اتجاه تبايني أفضل إذا كان لديه تباين هدف أعلى وتباين خلفية أقل. في هذه الحالة، سيكون زوج التباين الهدف-الخلفية لـv1 على الجانب السفلي الأيمن من ذلك لـv2 في مخطط أزواج التباين الهدف-الخلفية (λ X(v ),λ Y(v ))، على سبيل المثال، Fig. [5]. بناءً على هذا الترتيب الجزئي، يمكن تعريف مجموعة الاتجاهات الأكثر تباينًا بطريقة مشابهة لتعريف حدود باريتو. دعU  تكون مجموعة أزواج التباين الهدف-الخلفية لجميع الاتجاهات، أيU = def  ( λX ( v ) ,λY ( v ))v ∈Runitd. تتوافق مجموعة الاتجاهات الأكثر تباينًا مع الحدود السفلية اليمنى لـU في مخطط أزواج التباين الهدف-الخلفية، كما هو موضح في Fig.[5]. (لحالة معينة من المصفوفات الخلفية والهدف القابلة للتقطيع في نفس الوقت، انظر الشكل التكميلي[7].)

فيما يتعلق بـ cPCA، يمكننا إثبات (انظر الملاحظة التكميلية [2] ) أنه من خلال تغييرα ، تكون مجموعة cPCs العلوية متطابقة مع مجموعة الاتجاهات الأكثر تباينًا. علاوة على ذلك، بالنسبة للاتجاهv الذي تم اختياره بواسطة cPCA مع تعيين معلمة التباين إلىα ، يتوافق زوج التباين الخاص به (λ X(v ),λ Y(v )) مع نقطة التماس للحدود السفلية اليمنى لـU  مع خط ميله -1/α. نتيجة لذلك، من خلال تغييرα من الصفر إلى اللانهاية، يختار cPCA الاتجاهات مع أزواج التباين التي تنتقل من النهاية السفلية اليسرى إلى النهاية العلوية اليمنى للحدود السفلية اليمنى لـU .

نلاحظ أيضًا أنه فيما يتعلق بالعشوائية في البيانات، فإن معدل تقارب العينة cPC إلى cPC السكانية هوO p  dmin ( n,m ) تحت افتراضات معتدلة، حيثd هو البعد وn ,m هي أحجام البيانات المستهدفة والخلفية. هذا المعدل مشابه لمعدل التقارب القياسي للمتجه الذاتي للعينة لمصفوفة التغاير. انظر الملاحظة التكميلية [2].

لقد أصدرنا تنفيذًا لـ cPCA بلغة بايثون على GitHub (https://github.com/abidlabs/contrastive ). يتضمن مستودع GitHub أيضًا دفاتر بايثون ومجموعات بيانات تعيد إنتاج معظم الأشكال في هذه الورقة وفي المعلومات التكميلية.

مجموعات البيانات التي تم استخدامها لتقييم cPCA في هذه الورقة متاحة إما منا أو من مؤلفي الدراسات الأصلية. يرجى الاطلاع على مستودع GitHub المذكور في القسم السابق للحصول على مجموعات البيانات التي أصدرناها.

Fig. 1: نظرة عامة تخطيطية على cPCA. لتنفيذ cPCA، يتم حساب مصفوفات التغاير C X، C Yلمجموعات البيانات المستهدفة والخلفية. المتجهات الفردية للفرق الموزون لمصفوفات التغاير، C X− α · C Y، هي الاتجاهات التي تعيدها cPCA. كما هو موضح في مخطط الانتشار على اليمين، تحدد PCA (على البيانات المستهدفة) الاتجاه الذي يحتوي على أعلى تباين في البيانات المستهدفة، بينما تحدد cPCA الاتجاه الذي يحتوي على تباين أعلى في البيانات المستهدفة مقارنة بالبيانات الخلفية. إسقاط البيانات المستهدفة على الاتجاه الأخير يعطي أنماطًا فريدة للبيانات المستهدفة وغالبًا ما يكشف عن هيكل يتم تفويته بواسطة PCA. على وجه التحديد، في هذا المثال، تقليل الأبعاد للبيانات المستهدفة بواسطة cPCA سيكشف عن مجموعتين متميزتين

Fig. 2: تحليل المكونات الرئيسية التبايني على الأرقام المشوشة.a، أعلى: نقوم بإنشاء مجموعة بيانات مستهدفة من 5,000 صورة تركيبية عن طريق تراكب صور الأرقام المكتوبة بخط اليد 0 و1 من مجموعة بيانات MNIST على صور العشب المأخوذة من مجموعة بيانات ImageNet التي تنتمي إلى مجموعة العشب. يتم تحويل صور العشب إلى تدرج الرمادي، وتغيير حجمها لتكون 100 × 100، ثم يتم قصها عشوائيًا لتكون بنفس حجم أرقام MNIST، 28 × 28.b، أعلى: هنا، نرسم نتيجة تضمين الصور التركيبية على أول مكونين رئيسيين باستخدام PCA القياسية. نرى أن النقاط المقابلة للصور مع الأرقام 0 و1 يصعب تمييزها.a، أسفل: يتم تقديم مجموعة بيانات خلفية تتكون فقط من صور العشب التي تنتمي إلى نفس المجموعة، ولكننا نستخدم صورًا مختلفة عن تلك المستخدمة لإنشاء مجموعة البيانات المستهدفة.b، أسفل: باستخدام cPCA على مجموعات البيانات المستهدفة والخلفية (مع تعيين قيمة معامل التباين α إلى 2.0)، تظهر مجموعتان في التمثيل ذو الأبعاد المنخفضة لمجموعة البيانات المستهدفة، واحدة تتكون من صور مع الرقم 0 والأخرى من صور مع الرقم 1.cننظر إلى المساهمة النسبية لكل بكسل في المكون الرئيسي الأول (PC) والمكون الرئيسي التبايني الأول (cPC). البكسلات الأفتح هي تلك التي تحمل وزنًا إيجابيًا أكثر، بينما تشير البكسلات الأغمق إلى تلك التي تحمل أوزانًا سلبية. تميل PCA إلى التركيز على البكسلات في محيط الصورة وتقلل قليلاً من التركيز على البكسلات في مركز وأسفل الصورة، مما يشير إلى أن معظم التباين يرجع إلى ميزات الخلفية. من ناحية أخرى، تميل cPCA إلى زيادة وزن البكسلات التي تقع في موقع الأرقام المكتوبة بخط اليد 1، وتقليل وزن البكسلات في موقع الأرقام المكتوبة بخط اليد 0، وإهمال معظم البكسلات الأخرى، مما يكتشف بفعالية تلك الميزات المفيدة للتمييز بين الأرقام المتراكبة

Fig. 3: اكتشاف المجموعات الفرعية في البيانات البيولوجية. a نستخدم PCA لإسقاط مجموعة بيانات تعبير البروتين للفئران مع وبدون متلازمة داون (DS) على أول مكونين. يُرى أن التمثيل ذو الأبعاد المنخفضة لقياسات تعبير البروتين من الفئران مع وبدون DS موزعة بشكل مشابه (أعلى). ولكن، عندما نستخدم cPCA لإسقاط مجموعة البيانات على أول مكونين تباينيين (cPCs)، نكتشف تمثيلًا ذو أبعاد منخفضة يجمع الفئران مع وبدون DS بشكل منفصل (أسفل). b علاوة على ذلك، نستخدم PCA وcPCA لتصور مجموعة بيانات RNA-Seq أحادية الخلية ذات الأبعاد العالية في بعدين. تتكون مجموعة البيانات من أربع عينات خلوية من مريضين بسرطان الدم: عينة قبل الزرع من المريض 1، عينة بعد الزرع من المريض 1، عينة قبل الزرع من المريض 2، وعينة بعد الزرع من المريض 2. b ، اليسار: النتائج باستخدام العينات من المريض 1 فقط، والتي تظهر أن cPCA (أسفل) تفصل العينات بشكل أكثر فعالية من PCA (أعلى). عندما يتم تضمين العينات من المريض الثاني، في b ، اليمين، مرة أخرى cPCA (أسفل) أكثر فعالية من PCA (أعلى) في فصل العينات، على الرغم من أن الخلايا بعد الزرع من كلا المريضين موزعة بشكل مشابه. نعرض مخططات لكل عينة بشكل منفصل في الشكل التكميلي[5] ، حيث يكون من الأسهل رؤية التداخل بين العينات المختلفة

Fig. 4: العلاقة بين مجموعات الأنساب المكسيكية. a تطبيق PCA على البيانات الجينية من أفراد من 5 ولايات مكسيكية لا يكشف عن أي أنماط مرئية يمكن تمييزها في البيانات المدمجة. b تطبيق cPCA على نفس مجموعة البيانات يكشف عن أنماط في البيانات: الأفراد من نفس الولاية يتجمعون بالقرب من بعضهم البعض في تضمين cPCA. c علاوة على ذلك، يكشف توزيع النقاط عن العلاقات بين المجموعات التي تتطابق مع الموقع الجغرافي للولايات المختلفة: على سبيل المثال، الأفراد من الولايات المتجاورة جغرافيًا يكونون متجاورين في التضمين. c مقتبس من خريطة للمكسيك التي هي في الأصل عمل المستخدم: Allstrak في ويكيبيديا، منشورة تحت رخصة CC-BY-SA، مأخوذة من https://commons.wikimedia.org/wiki/File:Mexico_Map.svg

Fig. 5: التفسير الهندسي لـ cPCA. يتم رسم مجموعة أزواج التباين المستهدف والخلفيةUكمنطقة زرقاء مخضرة لبعض البيانات المستهدفة والخلفية المولدة عشوائيًا. الحد السفلي الأيمن، كما هو ملون بالذهب، يتوافق مع مجموعة الاتجاهات الأكثر تباينًاSλ. المثلثات الزرقاء هي أزواج التباين للمكونات الرئيسية التباينية (cPCs) المختارة بقيم α 0.92 و0.29 على التوالي. نلاحظ أنها تتوافق مع نقاط التماس للمنحنى الذهبي والخطوط المماسية مع الميل1α= 1.08، 3.37، على التوالي

