대조 주성분 분석을 통한 데이터셋에서의 패턴 탐색 

초록고차원 데이터의 시각화 및 탐색은 여러 학문 분야에서 보편적인 도전 과제입니다. 주성분 분석(PCA)과 같은 널리 사용되는 기술은 하나의 데이터셋에서 지배적인 경향을 식별하는 것을 목표로 합니다. 그러나 많은 상황에서 우리는 서로 다른 조건에서 수집된 데이터셋을 가지고 있으며, 예를 들어, 치료와 대조 실험, 우리는 특정 데이터셋에 특화된 패턴을 시각화하고 탐색하는 데 관심이 있습니다. 이 논문은 비교 데이터에 비해 데이터셋에서 풍부한 저차원 구조를 식별하는 방법인 대조 주성분 분석(cPCA)을 제안합니다. 다양한 실험에서, 우리는 배경 데이터셋과 함께 cPCA가 PCA 및 다른 표준 방법에서 놓친 데이터셋 특유의 패턴을 시각화할 수 있음을 보여줍니다. 우리는 또한 cPCA의 기하학적 해석과 강력한 수학적 보장을 제공합니다. cPCA의 구현은 공개적으로 제공되며, 현재 PCA가 사용되는 많은 응용 프로그램에서 탐색적 데이터 분석에 사용할 수 있습니다. 

 주성분 분석(PCA)은 데이터 탐색 및 시각화를 위한 가장 널리 사용되는 방법 중 하나입니다. PCA는 데이터를 저차원 공간에 투영하며, 특히 데이터셋 내의 클러스터, 경사, 이상치와 같은 패턴을 시각화하는 강력한 접근 방식입니다. 관련된 시각화 방법이 많이 있습니다; 예를 들어, t-SNE 및 다차원 척도법(MDS)은 비선형 데이터 투영을 허용하며, PCA보다 비선형 패턴을 더 잘 포착할 수 있습니다. 그러나 이러한 모든 방법은 한 번에 하나의 데이터셋을 탐색하도록 설계되었습니다. 분석가가 여러 데이터셋(또는 하나의 데이터셋 내에서 비교할 여러 조건)을 가지고 있을 때, 현재의 실무 상태는 각 데이터셋에 대해 별도로 PCA(또는 t-SNE, MDS 등)를 수행한 다음, 다양한 투영을 수동으로 비교하여 데이터셋 간에 흥미로운 유사점과 차이점이 있는지 탐색하는 것입니다. 대조 주성분 분석(cPCA)은 데이터 탐색 및 시각화에서 이 격차를 메우기 위해 설계되었으며, 데이터셋 간에 가장 흥미로운 차이를 나타내는 투영을 자동으로 식별합니다. Figure1 은 cPCA의 개요를 제공하며, 이후에 더 자세히 설명합니다. Fig. 1 cPCA의 개요도. cPCA를 수행하기 위해, 대상 데이터셋과 배경 데이터셋의 공분산 행렬 CX , CY 를 계산합니다. 공분산 행렬의 가중치 차이 CX − α· CY 의 특이 벡터가 cPCA에 의해 반환되는 방향입니다. 오른쪽의 산포도에 표시된 것처럼, PCA(대상 데이터에 대해)는 대상 데이터에서 가장 높은 분산을 가진 방향을 식별하는 반면, cPCA는 배경 데이터에 비해 대상 데이터에서 더 높은 분산을 가진 방향을 식별합니다. 대상 데이터를 후자의 방향으로 투영하면 대상 데이터에 고유한 패턴이 나타나며, 이는 종종 PCA에 의해 놓치는 구조를 드러냅니다. 특히, 이 예에서 cPCA를 통해 대상 데이터의 차원을 줄이면 두 개의 뚜렷한 클러스터가 드러납니다 

 cPCA는 여러 학문 분야에 걸친 다양한 문제에 의해 동기 부여됩니다. 예시로, 여기서 두 가지 문제를 언급하고, 나중에 실험을 통해 다른 문제들을 보여줍니다. 먼저, 다양한 인종과 성별의 개인으로부터 얻은 유전자 발현 측정 데이터셋을 고려해 보십시오. 이 데이터에는 분석에 관심이 있는 암 환자 {x i}의 유전자 발현 수준이 포함되어 있습니다. 또한, 유사한 인구 통계적 배경을 가진 건강한 환자 {y i}의 유전자 발현 수준에 해당하는 대조 데이터도 있습니다. 우리의 목표는 암 환자 내에서의 경향과 변화를 찾는 것입니다(예: 암의 분자적 아형을 식별하기 위해). 그러나 {x i}에 직접 PCA를 적용하면, 상위 주성분이 암의 아형이 아닌 개인의 인구 통계적 변이에 해당할 수 있습니다. 이는 전자가 후자보다 더 큰 유전적 변이를 가질 가능성이 있기 때문입니다. 이 문제에 접근하기 위해, 건강한 환자도 인구 통계적 차이와 관련된 변이를 포함하지만, 암의 아형에 해당하는 변이는 포함하지 않는다는 점을 주목합니다. 따라서, {x i}는 높은 분산을 가지지만 {y i}는 낮은 분산을 가지는 구성 요소를 검색할 수 있습니다.

 관련 예로, 복잡한 배경에 손으로 쓴 숫자가 포함된 데이터셋 {x i}을 고려해 보십시오. 예를 들어, 다양한 풀 이미지(see Fig.2(a), top )가 있습니다. 일반적인 비지도 학습 작업의 목표는 데이터를 클러스터링하여 이미지 내의 다른 숫자를 드러내는 것일 수 있습니다. 그러나 이러한 이미지에 표준 PCA를 적용하면, 상위 주성분이 손으로 쓴 숫자와 관련된 특징을 나타내지 않고, 이미지 배경과 관련된 특징의 지배적인 변이를 반영한다는 것을 알 수 있습니다(Fig.2(b) , top). 우리는 {y i}라는 참조 데이터셋을 사용하여 이를 수정할 수 있음을 보여줍니다. 이 데이터셋은 풀 이미지로만 구성되어 있으며, {x i}에 사용된 이미지와 반드시 동일하지는 않지만, 특징 간의 유사한 공분산을 가지고 있습니다(Fig.2(a) , bottom). {x i}에서 {y i}에 비해 더 높은 분산을 가진 부분 공간을 찾습니다. 이 부분 공간에 투영함으로써, 실제로 손으로 쓴 숫자의 값에 따라 이미지를 시각적으로 분리할 수 있습니다(Fig. 2(b), bottom). PCA로 발견된 주성분과 cPCA로 발견된 주성분을 비교함으로써, cPCA가 더 관련성 있는 특징을 식별한다는 것을 알 수 있습니다(Fig.2(c) ). 이는 cPCA를 특징 선택 및 노이즈 제거와 같은 응용에 사용할 수 있게 합니다. Fig. 2 노이즈가 있는 숫자에 대한 대조적 PCA. a, 상단: 우리는 MNIST 데이터셋에서 손으로 쓴 숫자 0과 1의 이미지를 ImageNet 데이터셋에서 가져온 풀 이미지 위에 무작위로 겹쳐 5,000개의 합성 이미지를 생성하여 대상 데이터셋을 만듭니다. 풀 이미지는 그레이스케일로 변환되고, 100 × 100 크기로 조정된 후, MNIST 숫자와 동일한 크기인 28 × 28로 무작위로 잘립니다. b, 상단: 여기서 우리는 합성 이미지를 표준 PCA를 사용하여 첫 두 주성분에 임베딩한 결과를 플롯합니다. 0의 이미지와 1의 이미지에 해당하는 점들을 구별하기 어렵습니다. a, 하단: 그런 다음 동일한 synset에 속하는 풀 이미지로만 구성된 배경 데이터셋이 도입되지만, 대상 데이터셋을 생성하는 데 사용된 이미지와는 다른 이미지를 사용합니다. b, 하단: 대상 및 배경 데이터셋에 cPCA를 적용하여(대조 매개변수 α값을 2.0으로 설정) 대상 데이터셋의 저차원 표현에서 두 개의 클러스터가 나타납니다. 하나는 숫자 0의 이미지로 구성되고, 다른 하나는 숫자 1의 이미지로 구성됩니다. c우리는 첫 번째 주성분(PC)과 첫 번째 대조 주성분(cPC)에 대한 각 픽셀의 상대적 기여도를 살펴봅니다. 더 밝은 픽셀은 더 긍정적인 가중치를 가지며, 더 어두운 픽셀은 부정적인 가중치를 가집니다. PCA는 이미지의 주변부 픽셀을 강조하고, 이미지의 중앙과 하단의 픽셀을 약간 덜 강조하는 경향이 있어 대부분의 분산이 배경 특징에 기인함을 나타냅니다. 반면에, cPCA는 손으로 쓴 1의 위치에 있는 픽셀의 가중치를 높이고, 손으로 쓴 0의 위치에 있는 픽셀의 가중치를 낮추며, 대부분의 다른 픽셀을 무시하여 중첩된 숫자를 구별하는 데 유용한 특징을 효과적으로 발견합니다 

 대조 주성분 분석(cPCA)은 비지도 학습을 위한 도구로, 시각화 및 탐색적 데이터 분석을 가능하게 하기 위해 차원을 효율적으로 줄입니다. 이는 주로 다양한 데이터셋 간의 분류 또는 구별을 목표로 하는 대규모의 지도 학습 방법과 cPCA를 구분합니다. 예를 들어, 선형 판별 분석(LDA), 이차 판별 분석(QDA), 지도 PCA, QUADRO 등이 있습니다. 또한, cPCA는 여러 데이터셋을 통합하여 두 개 이상의 데이터셋 간의 상관 패턴을 식별하는 것을 목표로 하는 방법과도 구별됩니다. PCA 외에도 차원 축소를 위한 풍부한 비지도 방법이 있습니다. 예를 들어, 다차원 척도법(MDS)은 고차원 공간의 거리를 보존하는 저차원 임베딩을 찾습니다; 주성분 추구는 작은 항목별 노이즈와 큰 희소 오류에 강한 저랭크 부분 공간을 찾습니다. 그러나 cPCA처럼 두 번째 데이터셋의 관련 정보를 활용하도록 설계된 것은 없습니다. 보충 자료에서, 우리는 대표적인 데이터셋에서 이전에 언급된 많은 기술과 cPCA를 비교했습니다(see Supplementary Figs.3 and4 ).

 특정 응용 분야에서는 cPCA와 유사한 목표를 가진 전문화된 도구가 있을 수 있습니다. 예를 들어, 결과에서 우리는 cPCA가 유전자형 데이터에 적용되어 멕시코 내의 지리적 조상을 시각화하는 방법을 보여줍니다. 유전적 조상의 세밀한 클러스터를 탐색하는 것은 인구 유전학에서 중요한 문제이며, 연구자들은 최근에 이러한 조상 클러스터를 시각화하기 위한 알고리즘을 개발했습니다. cPCA가 여기서 잘 수행되지만, 전문가가 만든 알고리즘이 특정 데이터셋에 대해 더 잘 수행될 수 있습니다. 그러나 전문화된 알고리즘은 설계에 상당한 도메인 지식을 필요로 하며, 계산 비용이 더 많이 들고 사용하기 어려울 수 있습니다. cPCA의 목표는 각 도메인에서 이러한 모든 전문화된 최첨단 방법을 대체하는 것이 아니라, 임의의 데이터셋을 탐색하기 위한 일반적인 방법을 제공하는 것입니다.

 우리는 이 논문에서 cPCA를 위한 구체적이고 효율적인 알고리즘을 제안합니다. 이 방법은 우리가 시각화하거나 패턴을 식별하는 데 관심이 있는 대상 데이터셋 {x i}을 입력으로 받습니다. 보조 입력으로, cPCA는 관심 있는 패턴을 포함하지 않는 배경 데이터셋 {y i}을 받습니다. cPCA 알고리즘은 대상 데이터 {x i}에서 많은 변화를 포착하지만, 배경 {y i}에서는 적은 변화를 포착하는 부분 공간을 반환합니다(see Fig.1 , Methods, and Supplementary Methods for more details). 이 부분 공간은 {x i}에 특정한 구조를 포함하는 특징에 해당합니다. 따라서, 대상 데이터를 이 부분 공간에 투영하면, 배경에 비해 대상 데이터의 추가 구조를 시각화하고 발견할 수 있습니다. 주성분(PC)과 유사하게, 우리는 cPCA에 의해 발견된 방향을 대조 주성분(cPC)이라고 부릅니다. 우리는 cPCA가 본질적으로 비지도 기법임을 강조하며, 배경 데이터셋을 대조로 사용하여 하나의 데이터셋에서 패턴을 더 명확하게 해결하도록 설계되었습니다. 특히, cPCA는 대상 데이터셋과 배경 데이터셋을 구별하려고 하지 않습니다; 대상 데이터셋에서 풍부한 경향을 포함하는 부분 공간은 데이터셋 간의 분류에 최적화된 부분 공간과 반드시 동일하지는 않습니다.

연구자들은 표준 PCA가 생물학적 데이터 내에서 하위 그룹을 발견하는 데 종종 비효율적이라는 점을 지적했습니다. 이는 적어도 부분적으로 "지배적인 주성분이... 인공물과 상관관계가 있다"는 이유 때문입니다. 연구자가 관심을 갖는 특징과는 다릅니다. 이러한 설정에서 더 중요한 하위 그룹을 감지하기 위해 cPCA를 어떻게 사용할 수 있을까요? 배경 데이터셋을 사용하여 대상의 보편적이지만 흥미롭지 않은 변이를 제거함으로써, 대상 데이터셋에 고유한 구조를 검색할 수 있습니다. 

우리의 첫 번째 실험은 충격 요법을 받은 쥐의 단백질 발현 측정으로 구성된 데이터셋을 사용합니다. 일부 쥐는 다운 증후군(DS)을 개발했습니다. 방법을 평가하기 위한 진실 정보가 있는 비지도 학습 작업을 만들기 위해, 우리는 이 DS 정보가 분석가에게 알려지지 않았다고 가정하고 알고리즘 평가에만 사용합니다. 우리는 충격을 받은 쥐 집단 내에서 비지도 방식으로 어떤 중요한 차이를 감지할 수 있는지 보고 싶습니다(다운 증후군의 존재 여부가 주요 예입니다). Fig.3a (top)에서, 우리는 대상 데이터셋에 PCA를 적용한 결과를 보여줍니다: 변환된 데이터는 쥐 집단 내에서 중요한 클러스터링을 드러내지 않습니다. 쥐 내의 주요 변이 원인은 성별이나 나이와 같은 자연적인 것일 수 있습니다. Fig. 3생물학적 데이터에서 하위 그룹 발견. a우리는 다운 증후군(DS)이 있는 쥐와 없는 쥐의 단백질 발현 데이터셋을 첫 두 구성 요소에 투영하기 위해 PCA를 사용합니다. DS가 있는 쥐와 없는 쥐의 단백질 발현 측정값의 저차원 표현은 유사하게 분포되어 있는 것으로 보입니다(상단). 그러나, cPCA를 사용하여 데이터셋을 첫 두 cPC에 투영하면 DS가 있는 쥐와 없는 쥐를 별도로 클러스터링하는 저차원 표현을 발견합니다(하단). b또한, 우리는 고차원 단일 세포 RNA-Seq 데이터셋을 2차원으로 시각화하기 위해 PCA와 cPCA를 사용합니다. 데이터셋은 두 명의 백혈병 환자로부터의 네 개의 세포 샘플로 구성됩니다: 환자 1의 이식 전 샘플, 환자 1의 이식 후 샘플, 환자 2의 이식 전 샘플, 환자 2의 이식 후 샘플. b, 왼쪽: 환자 1의 샘플만을 사용한 결과는 cPCA(하단)가 PCA(상단)보다 샘플을 더 효과적으로 분리함을 보여줍니다. 두 번째 환자의 샘플이 포함되면, b, 오른쪽에서 다시 cPCA(하단)가 PCA(상단)보다 샘플을 더 효과적으로 분리합니다. 비록 두 환자의 이식 후 세포가 유사하게 분포되어 있지만, 우리는 보충 Fig. 5에서 각 샘플을 별도로 플롯하여 서로 다른 샘플 간의 중첩을 더 쉽게 볼 수 있습니다

우리는 충격 요법을 받지 않은 쥐 집단의 단백질 발현 측정으로 구성된 배경을 사용하여 이 데이터셋에 cPCA를 적용합니다. 이들은 실험 쥐와 유사한 자연 변이를 가질 가능성이 있는 대조 쥐이지만, 충격 요법으로 인한 차이는 없습니다. 이 데이터셋을 배경으로 사용하면, cPCA는 변환된 대상 데이터에서 다운 증후군이 없는 쥐에 해당하는 그룹과 다운 증후군이 있는 쥐에 해당하는 그룹(대부분)을 해결할 수 있습니다. Fig.3a (bottom)에 설명된 대로입니다. 비교를 위해, 우리는 또한 대상 데이터셋과 배경 데이터셋을 구별하는 방향을 식별하기 위해 8개의 다른 차원 축소 기술을 적용했지만, 그 중 어느 것도 cPCA만큼 쥐를 잘 분리할 수 없었습니다(자세한 내용은 Supplementary Fig.4 를 참조하십시오). 

다음으로, 우리는 백혈병 환자로부터 줄기세포 이식 전과 같은 환자로부터 줄기세포 이식 후에 채취한 골수 단핵 세포(BMMC)의 혼합물의 단일 세포 RNA 발현 수준으로 구성된 고차원 공공 데이터셋을 분석합니다. 모든 단일 세포 RNA-Seq 데이터는 저자들이 설명한 유사한 방법을 사용하여 전처리됩니다. 특히, PCA 또는 cPCA를 적용하기 전에 모든 데이터셋은 대상 데이터 내에서 가장 높은 분산[분산을 평균으로 나눈 값]을 기준으로 선택된 500개의 유전자로 축소됩니다. 다시, 우리는 변환된 데이터에서 두 샘플을 시각적으로 발견할 수 있는지 확인하기 위해 PCA를 수행합니다. Fig.3b (top left)에 표시된 대로, 두 세포 유형 모두 첫 두 개의 PC에 의해 확장된 공간에서 유사한 분포를 따릅니다. 이는 샘플 간의 차이가 작고, 대신 PC가 각 샘플 내의 다양한 종류의 세포의 이질성 또는 실험 조건의 변이를 반영하기 때문일 가능성이 높습니다. 이는 단일 세포 RNA-Seq 측정에 상당한 영향을 미칠 수 있습니다. 

우리는 건강한 개인의 BMMC 세포에서 RNA-Seq 측정으로 구성된 배경 데이터셋을 사용하여 cPCA를 적용합니다. 이 배경 데이터셋은 세포의 이질적인 집단과 실험 조건의 변동을 포함할 것으로 예상됩니다. 따라서 cPCA가 이식 전후의 차이에 해당하는 타겟 데이터에서 풍부한 방향을 회복할 수 있을 것으로 기대할 수 있습니다. 실제로, Fig.3b (왼쪽 하단)에 나타난 것처럼 우리가 발견한 것입니다. 

우리는 두 번째 백혈병 환자로부터의 BMMC 샘플을 사용하여 타겟 데이터셋을 추가로 보강합니다. 따라서 총 네 개의 세포 하위 집단이 있습니다. 이 데이터에 PCA를 적용하면, Fig.3b (오른쪽 상단)에 나타난 것처럼 네 개의 하위 집단이 상위 두 개의 주성분(PCs)이 span하는 하위 공간에서 분리되지 않습니다. 그러나 동일한 배경 데이터셋을 사용하여 cPCA를 적용하면, 적어도 세 개의 하위 집단이 훨씬 더 강한 분리를 보여줍니다, Fig.3b (오른쪽 하단)에 나타난 것처럼. cPCA 임베딩은 또한 두 환자의 세포 샘플이 줄기세포 이식 후(청록색 및 녹색 점) 서로 더 유사하다는 것을 시사합니다, 이식 전(금색 및 분홍색 점)보다, 이는 조사자가 테스트할 수 있는 합리적인 가설입니다. 이 실험에 대한 자세한 내용은 보충 Fig.5 를 참조하십시오. 우리는 cPCA가 하위 집단 간의 관계를 추론하는 데 유용한 도구가 될 수 있음을 봅니다, 이는 우리가 다음에 더 탐구할 주제입니다. 

이전 예제에서, 우리는 cPCA가 사용자가 사전 라벨이 없는 타겟 데이터셋 내의 하위 클래스를 발견할 수 있게 한다는 것을 보았습니다. 그러나 하위 클래스가 미리 알려져 있는 경우에도, 차원 축소는 그룹 내 관계를 시각화하는 유용한 방법이 될 수 있습니다. 예를 들어, PCA는 종종 유전적 변이를 기반으로 민족 집단 간의 관계를 시각화하는 데 사용됩니다, 왜냐하면 유전적 변이를 2차원으로 투영하면 종종 지리적 및 역사적 경향의 놀라운 시각화를 제공하는 지도를 생성하기 때문입니다. 그러나 다시, PCA는 가장 지배적인 구조를 식별하는 데 제한됩니다; 이것이 보편적이거나 흥미롭지 않은 변동을 나타낼 때, cPCA는 경향을 시각화하는 데 더 효과적일 수 있습니다. 

이 예제를 위해 사용하는 데이터셋은 이전 연구에서 수집된 멕시코의 다섯 개 주에서 온 개인의 게놈에서 단일 뉴클레오타이드 다형성(SNPs)으로 구성됩니다. 멕시코 혈통은 PCA를 사용하여 분석하기 어려운데, 이는 PC가 일반적으로 멕시코 내의 지리적 기원을 반영하지 않기 때문입니다; 대신, 각 멕시코 개인의 유럽/원주민 혈통 비율을 반영하여 멕시코 내의 지리적 기원으로 인한 차이를 지배하고 가립니다 (Fig.4a 참조). 이 문제를 극복하기 위해, 인구 유전학자들은 PCA를 적용하기 전에 유럽 혈통에서 유래한 것으로 알려진 SNP를 수동으로 제거합니다. 그러나 이 절차는 SNP의 출처를 알고 있어야 하고 배경 변동의 출처가 관심 있는 변동과 매우 다르다는 것을 요구하기 때문에 제한된 적용성을 가집니다, 이는 종종 그렇지 않습니다. Fig. 4멕시코 조상 그룹 간의 관계. a5개의 멕시코 주에서 온 개인의 유전 데이터에 적용된 PCA는 임베디드 데이터에서 시각적으로 식별 가능한 패턴을 드러내지 않습니다. b동일한 데이터셋에 적용된 cPCA는 데이터에서 패턴을 드러냅니다: 동일한 주에서 온 개인들이 cPCA 임베딩에서 더 가깝게 클러스터링됩니다. c또한, 점들의 분포는 서로 다른 주의 지리적 위치와 일치하는 그룹 간의 관계를 드러냅니다: 예를 들어, 지리적으로 인접한 주에서 온 개인들은 임베딩에서 인접해 있습니다. c멕시코의 지도를 각색한 것으로, 원래는 Wikipedia의 User:Allstrak의 작업이며, CC-BY-SA 라이선스 하에 게시되었으며, https://commons.wikimedia.org/wiki/File:Mexico_Map.svg에서 출처를 확인할 수 있습니다

대안으로, 우리는 멕시코와 유럽에서 온 개인으로 구성된 배경 데이터셋을 사용하여 cPCA를 사용합니다. 이 배경은 원주민/유럽 변동에 의해 지배되어, 타겟 데이터셋 내의 멕시코 내 변동을 분리할 수 있게 합니다. cPCA를 적용한 결과는 Fig.4b 에 나타나 있습니다. 우리는 멕시코의 같은 주에서 온 개인들이 더 가깝게 임베딩된 것을 발견합니다. 더욱이, 가장 분기된 두 그룹은 소노란과 유카탄의 마야인들로, 이들은 멕시코 내에서 가장 지리적으로 먼 곳에 있으며, 다른 세 주의 멕시코인들은 서로 가깝습니다, 지리적으로나 cPCA에 의해 캡처된 임베딩에서 모두 (Fig.4c 참조). 자세한 내용은 보충 Fig.6 를 참조하십시오. 

 많은 데이터 과학 설정에서, 우리는 다른 데이터에 비해 한 데이터셋에서 풍부한 패턴을 시각화하고 탐색하는 데 관심이 있습니다. 우리는 이러한 대조 탐색을 수행하기 위한 일반 도구로 cPCA를 제시했으며, 다양한 응용 분야에서 그 유용성을 설명했습니다. cPCA의 주요 장점은 그 일반성과 사용의 용이성입니다. 특정 cPCA를 계산하는 데 걸리는 시간은 일반 PCA를 계산하는 데 걸리는 시간과 본질적으로 동일합니다. 이 계산 효율성은 cPCA가 대화형 데이터 탐색에 유용하도록 하며, 각 작업이 이상적으로 거의 즉각적이어야 합니다. 따라서 PCA가 관련 데이터셋에 적용되는 모든 설정에서 cPCA도 적용될 수 있습니다. 보충 노트3 및 보충 Fig.8 에서, 우리는 cPCA가 데이터셋에서 비선형 대조 패턴을 발견하기 위해 커널화될 수 있는 방법을 보여줍니다.

 대조 PCA의 유일한 자유 매개변수는 대조 강도α 입니다. 우리의 기본 알고리즘에서, 우리는α 의 가장 유익한 값을 선택하기 위해 하위 공간의 클러스터링을 기반으로 한 자동 스킴을 개발했습니다 (방법 참조). 이 논문에서 수행된 모든 실험은 자동으로 생성된α 값을 사용하며, 우리는 이 기본값이 cPCA의 많은 응용에서 충분할 것이라고 믿습니다. 사용자는 더 세밀한 탐색이 필요한 경우α 의 특정 값을 입력할 수도 있습니다.

 cPCA는 일반 PCA 및 다른 차원 축소 방법과 마찬가지로p -값이나 다른 통계적 유의성 정량화를 제공하지 않습니다. cPCA를 통해 발견된 패턴은 가설 검정이나 관련 도메인 지식을 사용한 추가 분석을 통해 검증되어야 합니다. 우리는 cPCA의 코드를 문서 및 예제와 함께 파이썬 패키지로 공개했습니다.

 d 차원 타겟 데이터 (equation) 및 배경 데이터 (equation) , 그들의 해당 경험적 공분산 행렬을C X,C Y라고 하자. 단위 벡터의 집합을 (equation) 라고 하자. 어떤 방향 (equation) 에 대해, 타겟 데이터와 배경 데이터에서 차지하는 분산은 다음과 같이 쓸 수 있습니다: (equation) 대조 매개변수α ≥ 0가 주어지면, 이는 높은 타겟 분산과 낮은 배경 분산 간의 균형을 정량화하며, cPCA는 최적화하여 대조 방향v *를 계산합니다 (equation) 이 문제는 다음과 같이 다시 쓸 수 있습니다 (equation) 이는v *가 행렬 (equation) 의 첫 번째 고유 벡터에 해당함을 의미합니다. 따라서 대조 방향은 고유값 분해를 사용하여 효율적으로 계산할 수 있습니다. PCA와 유사하게, 우리는C 의 주요 고유 벡터를 대조 주성분(cPCs)이라고 부릅니다. 우리는 cPCs가 행렬C 의 고유 벡터이며 따라서 서로 직교함을 주목합니다. 고정된α 에 대해, 우리는 (1 )을 계산하고 첫 몇 개의(일반적으로 두 개의) cPCs가 span하는 하위 공간을 반환합니다. 

대조 매개변수α 는 높은 타겟 분산과 낮은 배경 분산 간의 균형을 나타냅니다.α = 0일 때, cPCA는 타겟 분산만을 최대화하는 방향을 선택하며, 따라서 타겟 데이터 {x i}에 적용된 PCA로 축소됩니다.α 가 증가함에 따라, 더 작은 배경 분산을 가진 방향이 더 중요해지고 cPCs는 배경 데이터 {y i}의 영공간으로 향하게 됩니다. 극한의 경우α = ∞일 때, {y i}의 영공간에 있지 않은 모든 방향은 무한한 페널티를 받습니다. 이 경우, cPCA는 먼저 타겟 데이터를 배경 데이터의 영공간에 투영한 다음, 투영된 데이터에 PCA를 수행하는 것에 해당합니다. 

단일α 를 선택하고 그 하위 공간을 반환하는 대신, cPCA는α 목록의 하위 공간을 계산하고 주각 에 따라 서로 멀리 떨어진 몇 개의 하위 공간을 반환합니다. 이러한 하위 공간 각각에 데이터를 투영하면 대상 데이터 내의 다양한 경향이 드러나며, 반환된 산점도를 시각적으로 검사하여 사용자는 자신의 분석에 적합한 하위 공간(및 해당α 값)을 빠르게 식별할 수 있습니다. 자세한 예는 보충 Fig.1 을 참조하십시오. 

cPCA의 전체 알고리즘은 알고리즘 2(보충 방법)에 설명되어 있습니다. 우리는 일반적으로α 의 잠재적 값 목록을 0.1에서 1000 사이의 40개의 로그 간격 값으로 설정하며, 이는 논문의 모든 실험에 사용됩니다. 대표 하위 공간을 선택하기 위해 cPCA는 하위 공간을 클러스터링하기 위해 스펙트럼 클러스터링을 사용하며, 여기서 친화도는 하위 공간 간의 주각의 코사인 곱으로 정의됩니다. 그런 다음 각 클러스터의 메도이드(대표)가 사용자가 보는 산점도를 생성하기 위한α 값으로 사용됩니다. 

배경 데이터셋의 선택은 cPCA의 결과에 큰 영향을 미칩니다. 일반적으로 배경 데이터는 대상 데이터에서 제거하고자 하는 구조를 가져야 합니다. 이러한 구조는 일반적으로 대상에서 높은 분산을 가지지만 분석가에게는 관심이 없는 방향에 해당합니다. 

우리는 대상 데이터에 유용한 대조를 제공할 수 있는 몇 가지 일반적인 배경 데이터셋 예를 제공합니다: (1) 질병 인구 {x i}와 대조되는 대조군 {y i}, 대조군은 유사한 인구 수준의 변동을 포함하지만 질병의 다른 아형으로 인한 미세한 변동은 포함하지 않기 때문입니다. (2) 나중 시점의 데이터 {x i}와 대조하기 위해 사용되는 시간 0의 데이터 {y i}. 이는 시간 경과에 따른 가장 두드러진 변화를 시각화할 수 있게 합니다. (3) 혼합 그룹 {x i}와 대조되는 동질 그룹 {y i}, 둘 다 인구 내 변동과 측정 잡음을 가지지만 전자는 인구 간 변동이 없기 때문입니다. (4) 측정 잡음을 제거하고 치료로 인한 변동을 보존하기 위해 사전 치료 데이터셋 {y i}과 대조되는 사후 치료 데이터 {x i}. (5) 신호와 잡음 모두로 구성된 측정 {x i}와 대조되는 신호가 없는 녹음 {y i} 또는 이미지. 

배경 데이터가 대상 데이터셋에서 제거하고자 하는 것과 정확히 동일한 공분산 구조를 가질 필요는 없다는 점을 추가할 가치가 있습니다. 예를 들어, Fig.2 에 표시된 실험에서, 우리는 풀 이미지로 구성된 배경 데이터셋을 사용할 필요가 없다는 것이 밝혀졌습니다. 사실, 풀 이미지 대신 하늘 이미지를 배경 데이터셋으로 사용하더라도 유사한 결과가 얻어집니다. 공분산 행렬의 구조가 충분히 유사하기 때문에 cPCA는 대상 데이터에서 배경 구조를 제거합니다. 또한, cPCA는 대상 데이터와 배경 데이터가 유사한 샘플 수를 가질 필요가 없습니다. 공분산 행렬은 독립적으로 계산되므로, cPCA는 본질적으로 PCA와 동일한 요구 사항인 기본 인구 공분산 행렬의 좋은 추정치가 되는 경험적 공분산 행렬만 필요합니다. 

여기에서 우리는 cPCA의 기하학적 해석과 통계적 특성을 논의합니다. 먼저, 대조 분석의 목적에 "더 나은" 방향이 무엇인지 고려하는 것이 흥미롭습니다. 방향 (equation) 의 경우, cPCA에서의 중요성은 대상-배경 분산 쌍 (λ X(v ),λ Y(v ))에 의해 완전히 결정됩니다; 더 높은 대상 분산과 더 낮은 배경 분산을 갖는 것이 바람직합니다. 이 직관에 기반하여, 다양한 방향에 대한 대조성의 부분 순서를 추가로 정의할 수 있습니다: 두 방향v1 과v2 에 대해,v1 이 더 높은 대상 분산과 더 낮은 배경 분산을 갖는 경우v1 이 더 나은 대조 방향이라고 말할 수 있습니다. 이 경우,v1 의 대상-배경 분산 쌍은v2 의 하단 오른쪽에 위치하게 됩니다. 대상-배경 분산 쌍의 플롯에서 (λ X(v ),λ Y(v )), 예를 들어, Fig.5. 이 부분 순서에 기반하여, 가장 대조적인 방향의 집합은 파레토 전선 의 정의와 유사한 방식으로 정의될 수 있습니다. 모든 방향에 대한 대상-배경 분산 쌍의 집합을 (equation) 라고 하자, 즉 (equation). 가장 대조적인 방향의 집합은 Fig.5 에 표시된 것처럼 대상-배경 분산 쌍의 플롯에서 (equation) 의 하단 오른쪽 경계에 해당합니다. (동시에 대각화 가능한 배경 및 대상 행렬의 특정 경우에 대해서는 보충 Fig.7 을 참조하십시오.) Fig. 5cPCA의 기하학적 해석.(equation)의 대상-배경 분산 쌍 집합은 일부 무작위로 생성된 대상 및 배경 데이터에 대해 청록색 영역으로 플롯됩니다. 금색으로 색칠된 하단 오른쪽 경계는 가장 대조적인 방향의 집합(equation)에 해당합니다. 파란색 삼각형은 각각 α값 0.92와 0.29로 선택된 cPC의 분산 쌍입니다. 이들은 금색 곡선과 기울기(equation)= 1.08, 3.37의 접선과 접점에 해당합니다

cPCA에 관하여, 우리는α 를 변화시킴으로써, 상위 cPC의 집합이 가장 대조적인 방향의 집합과 동일하다는 것을 증명할 수 있습니다(보충 노트2 참조). 더욱이,α 로 설정된 대조 매개변수를 가진 cPCA에 의해 선택된 방향v 의 경우, 그 분산 쌍 (λ X(v ),λ Y(v ))은 (equation) 의 하단 오른쪽 경계의 접점에 해당합니다. 결과적으로,α 를 0에서 무한대로 변화시킴으로써, cPCA는 (equation) 의 하단 왼쪽 끝에서 상단 오른쪽 끝으로 이동하는 분산 쌍을 가진 방향을 선택합니다. 

데이터의 무작위성과 관련하여, 샘플 cPC가 모집단 cPC로 수렴하는 속도는 (equation) 입니다. 여기서d 는 차원이고n ,m 은 대상 및 배경 데이터의 크기입니다. 이 속도는 공분산 행렬의 샘플 고유 벡터의 표준 수렴 속도와 유사합니다. 보충 노트2 을 참조하십시오. 

우리는 GitHub(https://github.com/abidlabs/contrastive )에 대조 PCA의 Python 구현을 공개했습니다. GitHub 저장소에는 이 논문과 보충 정보의 대부분의 그림을 재현하는 Python 노트북과 데이터셋도 포함되어 있습니다. 

이 논문에서 대조 PCA를 평가하는 데 사용된 데이터셋은 우리 또는 원래 연구의 저자들로부터 제공됩니다. 우리가 공개한 데이터셋에 대해서는 이전 섹션에 나열된 GitHub 저장소를 참조하십시오. 

