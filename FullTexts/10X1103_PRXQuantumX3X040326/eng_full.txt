Error Propagation in NISQ Devices for Solving Classical Optimization Problems

We propose a random circuit model that attempts to capture the behavior of noisy intermediate-scale quantum devices when used for variationally solving classical optimization problems. Our model accounts for the propagation of arbitrary single-qubit errors through the circuit. We find that, even with a small noise rate, the quality of the obtained optima implies that a single-qubit error rate of 1/(nD) (where n is the number of qubits and D is the circuit depth) is needed for the possibility of a quantum advantage. We estimate that this translates to an error rate lower than 10−6 using the quantum approximate optimization algorithm for classical optimization problems with two-dimensional circuits.

Significant advances in the capabilities of quantum information processing hardware have recently been made, with the achievement of an important milestone of having reached quantum advantage. In addition to developing technologies towards the final goal of a fault-tolerant quantum computer, there is widespread interest in exploring the capabilities of the currently available noisy intermediate-scale quantum (NISQ) devices. This has inspired a number of heuristic quantum algorithms for NISQ devices , but it remains unclear if they can provide a quantum advantage for practically interesting problems.

One of the proposed applications for NISQ devices is to solve combinatorial optimization problems. Since this class of problems contains NP-hard instances, it is considered hard to solve on classical computers. Quantum circuits can explore larger state spaces (e.g., entangled states) compared to their classical counterparts and hence there is a possibility of quantum speedup in some instances of these problems. Several heuristic variational quantum algorithms have been proposed for solving optimization problems , most notably the quantum approximate optimization algorithm (QAOA). While variational algorithms in general lack provable guarantees for quantum speedups, there is a growing body of literature that suggests their use for practically interesting problems that remain hard to solve on classical computers , as well as provides evidence for their experimental feasibility. However, a number of algorithmic challenges to these heuristics that stem from the limitations on the accessible circuit architectures, such as barren plateaus , expressibility of the ansatz , or reachability deficits , have been identified.

The influence of noise in quantum devices on variational algorithms is an important consideration for assessing their utility in the near term. Noise-induced barren plateaus in the optimization landscape of the variational ansatz have been identified. Numerical modeling of the impact of noise has also been attempted , but this analysis is limited to very small circuit sizes. A set of rigorous results on the impact of noise in the quality of the optima obtained have recently been provided using entropic arguments. By simply tracking the von Neumann entropy of the quantum state, in Refs.  it was argued that beyond circuit depths of Θ[log(n)] with depolarizing noise, the output state is very close to the maximally mixed state. Stilck França and Garcia-Patron  improved on this result and showed that, even beyond circuit depths of Θ(1), the quality of the solution of a large class of classical optimization algorithms obtained from this circuit can be achieved with a classical algorithm.

However, while these analyses already provide provable limits on the quality of variational quantum algorithms that can inform current experiments, they likely underestimate the impact of noise in variational circuits used in practice. This underestimation arises from the fact that these bounds are applicable to any quantum circuit, and, consequently, they also bound the performance of circuits that do not create significant entanglement in the quantum state. Therefore, these bounds do not capture propagation of errors through the quantum circuit. Furthermore, these bounds are also loose for noise models, such as amplitude damping noise, which can possibly decrease the entropy in the quantum circuit; however, for a typical quantum circuit, it is expected that the presence of such noise would still degrade its performance.

In this paper, we propose a random circuit model that attempts to analyze the impact of noise in NISQ devices used to variationally solve classical optimization problems. Unlike previously proposed random circuit models, our model captures the fact that these circuits map product states for product states, i.e., ideally, a typical member of this circuit family starts with a product state, builds entanglement in between the qubits, and then disentangles it to another (product) state that is the bit string that solves the classical optimization problem. Our study here is thus different from recent works that have studied the impact of noise in Haar-random quantum circuits  with geometric constraints, where a typical member of these circuit families has an anticoncentrated output state, which is in stark contrast to what is expected for variational quantum circuits that ideally output a state close to the ground state.

We perform an average-case analysis on this distribution of circuits, and find that noise propagates very rapidly through the circuit, severely limiting the performance of the circuits. We provide both numerical results and analytical scalings for three different architectures: one dimensional (1D), 2D, and nonlocal. Our results indicate that to obtain a solution to a classical optimization problem within a fixed multiplicative error of its true solution with a constant rate of noise p, the circuit depth of a typical member of this distribution has to be smaller than max(O(p−1/2),O[1/(pn)]) in the 1D architecture and max(O(p−1/3),O[1/(pn)]) in the 2D architecture. Furthermore, it follows from our analysis that the impact of error is qualitatively similar for different noise models in contrast to Ref. , which relies on the noise-channel being primitive and unital. Moreover, our analysis technique can be easily extended to understanding the impact of noise on variational quantum algorithms for solving the quantum optimization problem (i.e., finding the ground state of a quantum many-body Hamiltonian).

In addition to this average-case analysis, we provide a concentration result for low-depth local circuits that shows that this average is representative of a typical circuit. However, we note that this does leave open the question of whether a clever method of choosing the parameters of a variational quantum circuit could be devised (e.g., with a closed-loop optimization of the noisy quantum circuit), such that the resulting circuit avoids the predicted proliferation of noise.

Consider the problem of solving a classical optimization problem over {0,1}n, and suppose that the unitary circuit that maps an initial product state |0⟩⊗n to the solution x∗∈{0,1}n is given by Usol. Since we are only interested in analyzing a lower bound on the impact of errors, we assume that the optimal circuit is already known and is noiseless, and do not address the problem of finding it. For depth D, we now consider a random quantum channel as Φ=◯t=1DTt, where the Tt are given byTt={N∘U(t)if t≤D/2,N∘[U(D−t)]†if t>D/2,(1)where N is a layer of the noise channel and U(t) is a layer of two-qubit Haar random unitaries. The effective channel for the circuit under consideration, depicted in Fig.  [1(a)] , will be constructed via Φ∘Usol.

Each member of the ensemble of circuits defined above solves the optimization problem in the absence of noise (i.e., when N=id). Furthermore, in the absence of noise, the circuit builds entanglement in the input state (which is a product state) for the first D/2 layers (which we call the entangling unitary), after which it uncomputes these unitaries to finally obtain a product state. However, any error in the unitary circuit propagates and alters the final result. Since we are interested in the propagation of noise, we assume that the one-qubit gates are noiseless. We point out that a similar model can be constructed for quantum optimization problems, i.e., finding the ground state of a quantum many-body Hamiltonian, with Usol being the circuit that maps |0⟩⊗n to the ground state. Even while assuming Usol to be noiseless, the noisy entangling and unentangling unitaries will still capture propagation of errors within this model.

We consider three different architectures for generating U(t) that model different interaction ranges that can be accessed on physical hardware [Fig.  [1(b)] ].(a)A 1D local architecture with periodic boundary conditions, where alternating layers of nearest-neighbor gates are applied.(b)A 2D local architecture with periodic boundary conditions on a square lattice. Alternating layers of horizontal and vertical two-qubit gates are applied.(c)A nonlocal architecture where, for each layer, n/2 pairs are chosen at random, and n/2 two-qubit gates are applied between the pairs. Given that, in the absence of noise, all instances of the random unitaries produce the same unitary, we consider the output of the channel averaged over the random unitaries for each of the architectures,ΦavgA(ρ)=∫UdUΦ(ρ)with A∈{1D,2D,NL},(2)where Φavg1D will represent the averaged channel with the 1D architecture, Φavg2D the 2D architecture, and ΦavgNL the nonlocal architecture [Fig.  [1(b)] ].

A 1D local architecture with periodic boundary conditions, where alternating layers of nearest-neighbor gates are applied.

A 2D local architecture with periodic boundary conditions on a square lattice. Alternating layers of horizontal and vertical two-qubit gates are applied.

A nonlocal architecture where, for each layer, n/2 pairs are chosen at random, and n/2 two-qubit gates are applied between the pairs.

An important fact that we use to calculate ΦavgA is that the twirl of a two-qubit quantum channel M over the Haar measure is a two-qubit depolarizing channel [Fig.  [2(a)] ] , i.e.,Edep(X)=∫UdU[U†MU](X)=λX+(1−λ)I⊗24tr(X),(3)where if Ak represents the kth Kraus operator of the channel M thenλ=115(∑k|tr(Ak)|2−1).(4)Since this expression applies to arbitrary noise channels, it follows that the specific choice of noise does not greatly impact the qualitative behavior of our model, with only the noise strength λ depending on the specific channel.

In the remainder of this paper, we consider the noise to be a depolarizing channel of strength p,N(ρ)=(1−p)ρ+ptr(ρ)I/2,i.e., an error, interpreted as tracing out the qubit and replacing it with I/2, occurring with probability p. When this noise channel acts on two qubits, there are three distinct possibilities—no errors occurred (i.e., ρ→ρ), both the qubits experienced errors (ρ→I⊗2/4), or only one qubit experienced error (i.e., ρ→I/2⊗tr1(ρ) or tr2(ρ)⊗I/2). Then, by direct application of Eqs.  [(3)]  and  [(4)] , we can compute the effective two-qubit depolarizing obtained after averaging over the two-qubit unitaries for these three cases.(a)For M(ρ)=ρ, i.e., no errors occur in either qubit between the application of U and U†, Edep(ρ)=ρ.(5a)(b) If M(ρ)=tr(ρ)I⊗2/4, i.e., errors occurred in both qubits between the application of U and U†,Edep(ρ)=tr(ρ)I⊗24.(5b)(c) If M(ρ)=I/2⊗tr1(ρ) or tr2(ρ)⊗I/2, i.e., an error occurred in only one of the qubits in between the application of U and U†, then, after averaging over U in Eq.  [(3)] ,Edep(ρ)=15ρ+45tr(ρ)I⊗24.(5c)Physically, this can be interpreted as the error in one of the qubits propagating to the other qubit with probability 4/5 due to the random two-qubit entangling gates. Let us now consider the quantum channel ΦavgA; the key idea to computing this average channel, depicted schematically in Fig.  [2(b)] , is to start analyzing the circuit from its center (i.e., in between the entangling and uncomputing unitary layers), and iteratively construct the channel obtained on including additional unitary layers. We denote by ΦtA the channel formed by including and averaging over t layers of the entangling and uncomputing unitary from the center of the circuit. For t=0, we have only a single layer of depolarizing noise and hence Φt=0A=N⊗n; this channel applies the noise independently on each qubit or leaves their state unchanged. After including unitary layers and averaging over them, it follows from the analysis of the two-qubit errors shown above that the resulting channels still either apply noise on each qubit or leave them unchanged, although the noise is no longer applied independently on each qubit. Therefore, we assume the following ansatz for ΦtA:ΦtA=∑j→∈{0,1}nptA(j→)[⨂α=1nτjα](6)withτ0(⋅)=id(⋅)andτ1(⋅)=tr(⋅)I2.Here, ptA(j→) for a given j→∈{0,1}n is the probability that the first qubit experiences noise if j0=1 and remains unchanged otherwise, the second qubit experiences noise if j1=1 and remains unchanged otherwise, and so on. We note that at t=0, i.e., when Φt=0A is a layer of depolarizing noise,pt=0A(j→)=(1−p)n−|j→|p|j→|,(7)where |j→|=∑i=1nji.

For M(ρ)=ρ, i.e., no errors occur in either qubit between the application of U and U†, Edep(ρ)=ρ.(5a)(b) If M(ρ)=tr(ρ)I⊗2/4, i.e., errors occurred in both qubits between the application of U and U†,Edep(ρ)=tr(ρ)I⊗24.(5b)(c) If M(ρ)=I/2⊗tr1(ρ) or tr2(ρ)⊗I/2, i.e., an error occurred in only one of the qubits in between the application of U and U†, then, after averaging over U in Eq.  [(3)] ,Edep(ρ)=15ρ+45tr(ρ)I⊗24.(5c)Physically, this can be interpreted as the error in one of the qubits propagating to the other qubit with probability 4/5 due to the random two-qubit entangling gates.

Next, we show that if ΦtA is of the form of Eq.  [(6)]  then so is Φt+1A and we relate probability distribution pt+1A to ptA. Note thatΦt+1A=EU(t)[N⊗nU(t)†ΦtAU(t)N⊗n],(8)where U(t) is the unitary applied at the tth layer from the center. Depending on the circuit architecture, U(t)=⨂(α,β)∈S(t)Uα,β(t), where Uα,β(t) is a two-qubit gate acting on qubits α,β and S(t) contains a list of qubits that interact with each other through the two-qubit unitaries. The averaging over each two-qubit unitary can now be done independently using Eq.  [(5)]. In particular, consider averaging over one of these unitaries acting on qubits α and β; from Eq.  [(6)] , it follows thatEUα,β(t)[Uα,β(t)†ΦtAUα,β(t)]=∑j→ptA(j→)EUα,β(t)[Uα,β(t)†(⨂γ=1nτjγ)Uα,β(t)]=∑j→ptA(j→)(⨂γ≠α,βτjγ)⊗EUα,β(t)[Uα,β(t)†τjα⊗τjβUα,β(t)].where in the last step we have used the fact that channels Uα,β(t),Uα,β(t)† commute with τjγ for γ≠{α,β} since they act only on qubits α,β. Now, from Eq.  [(5)] , it follows thatEUα,β(t)[Uα,β(t)†τjα⊗τjβUα,β(t)]={τjα⊗τjαif jα=jβ,15τ0⊗τ0+45τ1⊗τ1if jα≠jβ,and, therefore, it follows thatEUα,β(t)[Uα,β(t)†ΦtAUα,β(t)]=∑j→qα,β;t(j→)[⨂α∈j→τα],where probability distribution qα,β;t(j→) is related to ptA(j→) via a transition matrix that is identity on all but the αth and βth bits, given byMα,βU[(jα,jβ)→(jα′,jβ′)]={1 if (jα,jβ),(jα′,jβ′)=(0,0),1/5 if (jα,jβ)=(0,1) or (1,0),(jα′,jβ′)=(0,0),4/5 if (jα,jβ)=(0,1) or (1,0),(jα′,jβ′)=(1,1),1 if (jα,jβ),(jα′,jβ′)=(1,1).(9)Repeating this for all the two-qubit gates in unitary U(t), we obtainEU(t)[U(t)†ΦtAU(t)]=∑j→qtA(j→)[⨂α∈j→τα],where qtA(j→) is a probability distribution related to ptA(j→) via transition matrix MtU given byMtU=⨂(α,β)∈S(t)Mα,βU.Having averaged over the unitaries, we now consider applying the layers of depolarizing noise. This can be done explicitly; from Eq.  [(8)]  we obtainΦt+1A=∑j→∈{0,1}nqtA(j→)[⨂α∈j→(NταN)].Furthermore, it can be immediately seen from the definitions of the τα thatNταN={(1−p)2τ0+(2p−p2)τ1if α=0,τ1if α=1.Thus, probability distribution pt+1A(j→) is obtained from probability distribution qtA(j→) using transition matrix Mnoise that, independently for every bit in j→, has transition probabilitiesMnoise(j→j′)={(1−p)2if j=0,j′=0,2p−p2if j=0,j′=1,1if j=1,j′=1,0otherwise.(10)Combining the transition rules for both the unitary layer and the noise, we then obtain a Markov chain for probability distribution ptA,pt+1A=(MnoiseMtU)ptA.(11)To analyze the state obtained at the output of this circuit, after averaging over all the unitaries, we thus only need to compute probabilities pt=D/2A starting from initial distribution pt=0A [Eq.  [(7)] ], which then gives us access to channel Φt=D/2A (note that the effective time for which we need to evolve the Markov chain is half of the depth of the circuit, since each layer of the Markov chain accounts for a layer in the entangling and uncomputing unitaries). This can be computed by simulating the Markov chain with the transition matrices described above and allows us to analyze how many and which qubits in the solution of the optimization problem are, on average, correct. In the next section, we analyze this Markov chain both analytically and numerically to understand the impact of the noise and circuit depth on the quality of the output.

We first compute the expectation value of the number of qubits that are depolarized at the end of the computation, which we denote as ⟨q⟩. This can be done numerically by sampling from the Markov chain described in the previous section using Markov chain Monte Carlo. The results are shown in Fig.  [3] —our results show that, as expected, all the qubits depolarize exponentially fast with the circuit depths due to a rapid propagation of errors.

In order to better understand these numerical results, we would like to analyze theoretically the behavior of the Markov chain. We first provide heuristic estimates for the scalings of ⟨q⟩ with n. Note that every time a qubit is depolarized in the effective Markov chain, the neighboring qubit can be depolarized with a constant [i.e., Θ(1)] probability. Take, for instance, the 1D model—at the end of the circuit, an error in the middle of the circuit will have propagated to min(O(D),n) qubits. We can now estimate the probability that a specific qubit will be depolarized at the end of the computation—on average, it will be depolarized if at least one error has occurred in a qubit that is within a distance of min(O(D),n) of this qubit. Since there are Θ(D) steps of the Markov chain, the probability of a certain qubit not being depolarized is about (1−p)O(D2) for circuits that are shallow, and about (1−p)O(nD) for deep circuits. Similarly, in two dimensions a single error propagates on average to min(O(D2),n) qubits, and in the nonlocal case to min(eO(D),n). These scalings are displayed in Table  [I]. We note that, if the circuit is sufficiently deep, a single error can potentially propagate to all the other qubits, thus resulting in ⟨q⟩ scaling as 1−(1−p)O(nD).

In addition to the scalings presented in Table  [I] , we provide a heuristic formula that works very well in practice for the 1D case:⟨q⟩1Dn≃{1−(1−2p)9D2/80if D≤53n,1−(1−2p)3nD/8−5n2/16if D>53n.(12)The derivation of this formula and its numerical verification is given in Appendix  [C]. We also provide a semiempirical formula for the 2D case that has been obtained by fitting the data points to the expression in Table  [I] :⟨q⟩2Dn≃{1−(1−32p)0.026D3+0.054D2if D≤3.226n,1−(1−32p)nD/2−0.74n3/2+0.56nif D>3.226n.(13)Finally, in Appendix  [D]  we rigorously prove a lower bound on ⟨q⟩ for the 1D model with D<n that has the same scaling with p,D, and n as Eq.  [(12)].

We apply our error model to the specific case of quantum circuits that try to use QAOA to solve classical optimization problems, and analyze how the propagation of errors could limit the performance of the algorithm. We consider the max-cut problem since it is practically useful and hard to solve classically. Given a graph G=(V,E) on n vertices and adjacency matrix aij, finding the max-cut of G requires dividing the qubits into two groups, V′ and V∖V′, such that the sum of weights of edges between these two groups is maximal. It can be equivalently defined as the bitstring Z∈{−1,1}n maximizing the cost functionC=12∑(i,j)∈Eaij(1−ZiZj)(14)with the vertices corresponding to Z=−1 being in one group and those corresponding to Z=1 being in the other.

Let us denote by Cmax the solution of this problem, and denote the average value of the cost function when random guessing by Cavg, i.e.,Cavg=tr(CI2n)=12∑(i,j)∈Eaij.(15)The cost function Cavg is that obtained by a circuit in which all the qubits are depolarized. Since the output of the error propagation channel contains some qubits that are depolarized, the cost function obtained from the resulting state will be between Cavg and Cmax. As shown in Appendix  [A] , under the assumption that aij>0, we are able to upper bound the average energy of the output as a function of the average number of depolarized qubits ⟨q⟩ astr(CΦavg(ρ))≤12(1−⟨q⟩n)(2−⟨q⟩n)Cmax+(1−(1−⟨q⟩n)2)Cavg.(16)This expression readily provides an upper bound on the quality of the solution that we can compute given an error rate and a circuit depth. Given a lower bound on the maximum value Cmax of the cost function, it also allows us to upper bound the approximation ratio [α=Tr[CΦavgA(ρ0)]/Cmax]. This approximation ratio can often inform of the existence of an efficient classical algorithm that obtains a similar solution—for instance, the Goemans-Williamson algorithm is a classical approximation algorithm that has a performance guarantee of α>0.878. It is thus reasonable to make the assumption that near-term quantum circuits are only useful if the approximation ratio, in the presence of noise, is better than those achievable by classical algorithms.

As a specific example, we briefly study unweighted (i.e., aij=1) bounded degree-(Δ=3) graphs that cannot be solved trivially in general. For any bounded degree-(Δ=3) graph, the Edwards-Erdös inequality provides a lower bound for the max-cut in terms of the number of edges, Cmax≥(2/3)|E|. Combined with Eq.  [(16)] , this provides an upper bound for the approximation ratio,α≤1−(⟨q⟩2n)2.(17)For degree-3 graphs, there is a classical approximation algorithm that achieves an approximation ratio of 0.9326. We therefore find that only when ⟨q⟩/n≤0.52 can the quantum algorithm possibly output a better average energy than the classical one. That is, as soon as approximately half of the qubits are depolarized, we can be sure that the average quality of the solution is worse than the quality of the solution of classical approximation algorithms in the worst case. We represent an instance of this in Fig.  [4]  below. We note that this bound is not tight in every case, since we are considering all possible bounded degree-(Δ=3) graphs. For example, if we consider only the bipartite ones, Cmax=|E| and Cavg=|E|/2, which gives an approximation ratio that is bounded by α≤1−⟨q⟩/(2n), and therefore ⟨q⟩/n≤0.135. Therefore, in this case, it is already possible to certify the classical advantage when only around 15% of the qubits are depolarized.

Using the scalings from Table  [I] , we find that, for shallow circuits (as defined in the table), after a depth D=O(1/p) for the 1D architecture and D=O(1/p3) for the 2D architecture we already have a situation where the quality of the solution is worse than with classical approximation algorithms. This is respectively quadratically and cubically worse with respect to p than the scaling reported in Ref.. This is a consequence of the rapid spreading of errors.

The impact of errors in 2D (and even all-to-all) architectures is much higher than in 1D architectures due to a more rapid propagation of errors. However, this does not necessarily imply that 1D circuits are better for near-term quantum computation since our analysis thus far does not account for the increased connectivity of the quantum circuit. In order to take that into account, in the next subsection we consider a specific case, QAOA for solving a nonlocal problem, i.e., a graph with long-range vertices (a nonplanar graph). This necessarily places us in the deep circuit regime (as defined in Table  [I] ) in all cases.

We stress that this is an average-case analysis, which may not apply to particular situations or specific circuits. However, in Appendix  [B]  we derive a concentration bound for shallow local circuits,Pr[|C−tr(CΦavg(ρ))|≥α|E|]≤2e−O(α2|E|/Δ2D2k),(18)where Δ is the degree if the graph and k is the dimension of the architecture. Thus, for shallow local circuits, the output of a typical circuit is exponentially close to the average.

We also need to analyze the required circuit depth to run QAOA. Most quantum computing architectures have a planar design, similar to the 2D architecture that we are considering. However, the optimization problems that are useful in practice usually consist of nonplanar graphs. For example, planar max-cut can always be solved in polynomial time on classical computers. Since nonplanar graphs do not match the connectivity of the hardware, routing will be required to perform the computation. This can be done with swap gates that permute the different qubits, but comes at the cost of a growth in the circuit depth. Embedding a bounded degree graph on a square lattice results in an overhead of n in the gate count, while the cost is n for the 1D local architecture. Furthermore, at least a few QAOA layers are necessary for the algorithm to reach a satisfactory result. Following the scalings reported in Refs. , we assume that ten layers are enough to reach the solution, and that every QAOA layer, after the routing, needs on average about 7n two-qubit gates in the 2D architecture and 3n two-qubit gates in the 1D architecture. In this case, a circuit depth D2D≥107n for the 2D case is needed and D1D≥30n for the 1D case. This places us in the deep circuit regime, as seen in Table  [I]  and Eqs.  [(12)]  and  [(13)]. In this regime, the interpretation is the following: an error in any qubit will, with high likelihood, depolarize all the other qubits. Hence, even if there is just one error in the computation, the average output solution will not be much better than random guessing. Therefore, in order to have a good solution, we need to have a computation completely free of errors. This can only realistically happen if the error rate is as low as p∼1/(nD). We perform the exact calculation and represent it in Fig.  [4]. We see that in this simple example, we would need error rates orders of magnitude below what is currently achievable. Namely of the order of 10−7 for the 1D architecture, and 10−6 for the 2D architecture. We remark that these figures are obtained under arguably conservative assumptions. A more realistic computation would have to include all the one-qubit and two-qubit gates, thus restricting the error rate even more.

We have studied a model that captures the propagation of errors in noisy quantum devices when the final state is a product state. This is the case, for example, when trying to find the solution to classical optimization problems. For this model, we show that a single error in one qubit is propagated rapidly to the rest of the qubits. This would place stringent restrictions on the error rates that are compatible with a quantum advantage. We estimate the required error rate to be p∼1/(nD), where n is the system size and D is the circuit depth. As a consequence, assuming that our error model is representative of the circuits that solve the problem on real hardware, one would expect that noisy devices can only become useful for such problems when the error rates are extremely low, framing fault tolerance as the most realistic solution.

We emphasize that results are obtained by averaging different circuits, and it may be possible that for some particular instances they do not apply. However, due to the concentration result provided in Appendix  [B]  for low-depth circuits, we expect the average to be representative of a typical result.

Our results suggest that there is a trade-off between error propagation and entanglement spread. If we want to take advantage of a quantum computer, the quantum circuit should be able to generate entanglement, but this will generally be associated with the propagation of errors. Equivalently, trying to avoid the propagation of errors may well result in not fully exploiting the whole quantum computer. Perhaps, this deserves a more careful analysis.

Finally, we note that there are other situations where error propagation may not impose the stringent conditions obtained here. For instance, the adiabatic algorithm  (and its variational extension ) is a special kind of circuit where one is always close to the ground state of a particular Hamiltonian. In fact, in this setup there are indications  that the propagation of errors is relatively mild. Additionally, in the development of quantum algorithms for quantum problems, like quantum simulation, conservation laws might also prevent the propagation of errors and thus circumvent the restrictions found in the present work. The analysis in this work and these considerations indicate that the propagation of errors should be taken into account in the design of quantum algorithms for NISQ devices.

TABLE I.: Summary of the scaling of the expectation value of the fraction of depolarized qubits at the end of the computation, as a function of the circuit depth and system size. We identify two different regimes: a shallow-depth regime and a deep regime. The deep regime represents the cases in which the light cone of a single error can reach the edges (i.e., a single error can propagate to all other qubits), while for the shallow regime circuits, this is not the case.

FIG. 1.: (a) Schematic depiction of the ensemble of unitary circuits considered in this paper. The circuits consist of an entangling and uncomputing unitary that maps a product state to another product state in the absence of noise. (b) Different circuit architectures (1D, 2D, and nonlocal circuits) studied in this paper. All the circuit architectures are assumed to be translationally invariant—in particular, for the 1D and 2D architectures we assume periodic boundary conditions).

FIG. 2.: (a) Averaging over Haar-random unitary U  yields a two-qubit depolarizing channel Edep. (b) Schematic depiction of averaging over the circuit ensemble shown in Fig.  [1]  —we average from the center of the circuit outwards, and derive an effective Markov chain that describes the channels obtained.

FIG. 3.: We represent the expectation value of the fraction of depolarized qubits, ⟨q⟩/n , as a function of the circuit depth for the different architectures: 1D, 2D, and nonlocal. We use a system size n=900  and an error rate p=10−3. Additionally, we represent ⟨q⟩/n=1−(1−p)D , which is the number of depolarized qubits that one would get when applying only local depolarizing noise to all the qubits, without any unitaries (and therefore without entanglement). We see that the convergence to uniform is very fast with our model. The horizontal lines represent thresholds for classical superiority for unweighted max-cut problems on arbitrary bounded degree-3 graphs and bipartite bounded degree-3 graphs: for values of ⟨q⟩/n  greater than the threshold, there is a classical efficient algorithm that outputs a better solution than the averaged quantum channel (see Sec.  [III B]  ). The number of samples taken is 2000 , which reduces the error in the estimated mean to 2%.

FIG. 4.: In (a) we represent the relation between the system size and the error rate when the average number of depolarized qubits at the end of the computation is fixed to ⟨q⟩/n=0.5  for bounded degree-(Δ=3 ) graphs. In the 1D case the depth is D1D=30n , and in the 2D case D2D=107n. The horizontal dashed line corresponds to system sizes of n=1000 , which is when a potential quantum advantage could begin to be practically useful . In (b) we represent the upper bound for the approximation ratio of bounded degree-(Δ=3 ) graphs, given by Eq.  [(17)]  , as a function of the circuit depth for the different architectures: 1D, 2D, and nonlocal. We use a system size n=900  and an error rate p=10−3. The horizontal line represents the approximation ratio that is reachable by an efficient classical algorithm. The number of samples taken is 2000 , which reduces the error in the estimated mean to 2%.

