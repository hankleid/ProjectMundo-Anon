Variational quantum metrology for multiparameter estimation under dephasing noise

Abstract: We present a hybrid quantum-classical variational scheme to enhance precision in quantum metrology. In the scheme, both the initial state and the measurement basis in the quantum part are parameterized and optimized via the classical part. It enables the maximization of information gained about the measured quantity. We discuss specific applications to 3D magnetic field sensing under several dephasing noise models. Indeed, we demonstrate its ability to simultaneously estimate all parameters and surpass the standard quantum limit, making it a powerful tool for metrological applications.

Quantum metrology is an estimation process that utilizes unique quantum phenomena such as entanglement and squeezing to improve the precision of estimation beyond classical limits, –. Recent development in quantum computing leads to numerous optimal algorithms for enhancing precision in single-parameter estimation, such as adaptive measurements, , –, quantum error correction,, and optimal quantum control, –. So far, a variational algorithm has been demonstrated by combining the advantages of both quantum and classical systems for quantum-enhanced metrology, , –. A similar protocol for spin systems was also introduced,.

Multiparameter estimation is essential in various fields, such as Hamiltonian tomography, multiphase sensing, –, gravitational wave detection, and atomic clocks,. However, the estimation is more challenging due to the incompatibility. In these cases, simultaneous determination of all parameters is impossible, resulting in a tradeoff. Numerous techniques have been introduced to tackle this challenge, including establishing optimal measurement strategies,, employing parallel scheme, sequential feedback scheme, and implementing post-selection procedures. More recently, a variational toolbox for multiparameter estimation was proposed, which is a generalization from the previous work mentioned above.

While using variational schemes is promising, their potential significance in multiparameter quantum metrology has yet be fully understood, even in principle. Furthermore, determining the optimal quantum resources and measurement strategy to extract maximum information about all parameters is limited by the tradeoffs in estimating incompatible observables,, and required collective measurements over multiple copies of a probe state,. Therefore, finding a suitable and practical strategy for precise estimation of multiple parameters remains a thriving area of quantum metrology.

In this work, we propose a variational scheme to enhance the precision of multiparameter estimation in the presence of dephasing noise. The basic idea is to use a quantum computer to prepare a trial state (an ansatz) that depends on a set of trainable variables. The state is subjected to a series of control operations, representing unknown multiparameter and noise, and then is measured through observables determined by other trainable variables. The measurement results are used to update the trainable variables and optimize the estimation of the unknown parameters.

Optimizing both the initial probe state and the measurement operators allows us to identify suitable conditions for the quantum probe to increase sensitivity and achieve the ultimate quantum limit for all parameters. In numerical simulations, we estimate a 3D magnetic field under a dephasing noise model and find that sensitivity for all parameters can simultaneously reach the ultimate quantum bound, i.e., the classical bound equals the quantum bound. We also examine a time-dependent Ornstein-Uhlenbeck model and observe results surpassing the standard quantum limit by increasing the probe’s number of particles. This approach holds promise for a wide range of metrological applications, including external field sensing, precision spectroscopy, gravitational wave detection, and others, where the effects of noises cannot be ignored.

The goal of multiparameter estimation is to evaluate a set of unknown d parameters ϕ=(ϕ1,ϕ2,…,ϕd)⊺, which are imprinted onto a quantum probe via a unitary evolution U(ϕ)=exp(-itHϕ)=exp(-it∑k=1dHkϕk), where H=(H1,H2,…,Hd) are non-commuting Hermitian Hamiltonians. The precision of estimated parameters ϕˇ is evaluated using a mean square error matrix (MSEM) V=∑mp(m|ϕ)[ϕˇ(m)-ϕ][ϕˇ(m)-ϕ]⊺, where p(m|ϕ)=Tr[ρ(ϕ)Em] is the probability for obtaining an outcome m when measuring the final state ρ(ϕ) by an element Em in a positive, operator-value measure (POVM). For unbiased estimators, the MSEM obeys the Cramér-Rao bounds (CRBs), , –1Tr[WV]≥CF≥CNH≥CH≥CS,where W is a scalar weight matrix, which can be chosen as an identity matrix without loss of generality. The classical bound is CF=Tr[WF-1], where F is the classical Fisher information matrix (CFIM) with elements Fij=∑m1p(m|ϕ)[∂ϕip(m|ϕ)][∂ϕjp(m|ϕ)]. The Nagaoka–Hayashi bound CNH and Holevo bound CH are given via semidefinite programming, i.e., CNH=min{D,X}Tr[(W⊗ρ(ϕ))·D],, and CH=min{X}(Tr[WReZ+||WImZW]||1),, where D is a d-by-d matrix contains Hermitian operators Dij and satisfies D≥XX⊺, X=(X1,X2,…,Xd)⊺ satisfies Tr[ρ(ϕ)Xj]=ϕj and Tr[Xi∂ϕjρ(ϕ)]=δij, Z is a positive semidefinite matrix with elements Zij=Tr[XiXjρ(ϕ)]. Finally, CS=Tr[WQ-1] is a symmetric logarithmic derivative (SLD) quantum bound where Qij=Re[Tr[ρ(ϕ)LiLj]] is the real symmetric quantum Fisher information matrix (QFIM) that defined through the SLD 2∂ϕjρ(ϕ)={Lj,ρ(ϕ)}.

Although optimal estimators can achieve CF, the CNH can be attainted with separable measurements for qubits probes, and asymptotic achievement of CH is possible, , , –, it is not always possible to attain CS for multiparameter estimation. In this work, we attempt to reach this bound. In some instances, CH=CS if a weak commutativity condition Im(Tr[LjLiρ(ϕ)])=0 is met,. A similar condition for pure states is also applied to attain CF=CS,,. Further discussion on the interplay between CNH,CH, and CS has been reported. However, this condition alone is insufficient to achieve the quantum bounds practically; instead, attaining CS and CH also requires entangled measurements (POVM) over multiple copies,. Recently, Yang et al., have derived saturation conditions for general POVMs. To be more precise, when F≥Q>0 and for any arbitrary full-rank positive weight matrix W>0, the equally CF=CS implies F=Q.

This paper presents a variational quantum metrology (VQM) scheme following Meyer et al. toolbox as sketched in Fig.  [1]  to optimize both the preparation state and POVM. A quantum circuit U(θ) is used to generate a variational preparation state with trainable variables θ. Similar quantum circuit with variables μ is used to generate a variational POVM E(μ)={Em(μ)=U†(μ)EmU(μ)>0|∑mEm(μ)=I}. Using classical computers, a cost function C(θ,μ) can be optimized to update the variables for quantum circuits, resulting in enhanced information extraction. The scheme is repeated until it converges.

To investigate the attainable the ultimate SLD quantum bound, we define the cost function by a relative difference2C(θ,μ)=1-CSCF,which is positive semidefinite according to Eq. ( [1] ). The variables are trained by solving the optimization task argmin{θ,μ}C(θ,μ). As the value of C(θ,μ) approaches zero, we reach the ultimate SLD quantum bound where CF=CS. Notably, we strive for agreement between classical and SLD quantum bounds assuming Tr[WV]=CF, and thus, omit discussion on the estimator for achieving Tr[WV]=CF. Moreover, the cost function ( [2] ) serves as a technical tool to optimize the variational scheme, while the main analyzing quantities are CRBs. A vital feature of the VQM is using variational quantum circuits, which allows for optimizing the entangled probe state and measurements to extract the maximum information about the estimated parameters. This approach thus does not require entangled measurements over multiple copies. We further discuss various cost functions in the Discussion section.

We propose three variational circuits: a star topology ansatz, a ring topology ansatz, and a squeezing ansatz. The first two ansatzes are inspired by quantum graph states, which are useful resources for quantum metrology,. A conventional graph state is formed by a collection of vertices V and edges D as G(V,D)=∏i,j∈DCZij|+⟩V, where CZij represents the controlled-Z gate connecting the i and j qubits, and |+⟩ is an element in the basis of Pauli σx. The proposed ansatzes here incorporate y-rotation gates (Ry(θ)=e-iθσy/2) at every vertex prior to CZ gates (see Fig.  [2] a,b). The squeezing ansatz in Fig.  [2] c is inspired by squeezing states, which is another useful resource for quantum metrology, –. It has x(y)-rotation gates and global Mølmer–Sørensen gates Ux(z), where Ux(z)=exp(-i∑j=1N∑k=j+1Nσx(z)⊗σx(z)χjk2) for an N-qubit circuit. The trainable variables for one layer are 2N-2, 2N, and N(N+1) for the star, ring, and squeezing ansatz, respectively. Hereafter, we use these ansatzes for generating variational preparation states and variational POVM in the VQM scheme.

After preparing a variational state ρ(θ)=U(θ)ρ0U(θ), we use it to estimate a 3D magnetic field under dephasing noise. The field is imprinted onto every single qubit via the Hamiltonian H=∑i∈{x,y,z}ϕiσi, where ϕ=(ϕx,ϕy,ϕz), and σi is a Pauli matrix. Under dephasing noise, the variational state ρ(θ) evolves to3Et(ρ)=[∏k=1NeγtL(k)]e-itHρ,where we omitted θ in ρ(θ) for short. The superoperator H generates a unitary dynamic Hρ=[H,ρ], and L(k) is a non-unitary dephasing superoperator with γ is the decay rate. In terms of Kraus operators, the dephasing superoperator gives4eγtL(k)ρ=K1(k)ρ[K1(k)]†+K2(k)ρ[K2(k)]†,where K1=1-λ001 and K2=λ000 are Kraus operators, and λ=1-e-γt is the dephasing probability. Finally, the state is measured in the variational POVM E(μ) and yields the probability p(m)=Tr[Et(ρ)Em(μ)]. Note that p also depends on θ,ϕ, and μ.

It is important to attain the ultimate SLD quantum bound, i.e., CF=CS. We thus compare numerical results for the cost function, CF, and CS as shown in the top panels of Fig.  [3]. At each λ, the cost function and other quantities are plotted with the optimal θ obtained after stopping the training by EarlyStopping callback. The numerical results are presented at N=3, and the number of layers is chosen from their optimal values as shown in the Method and Fig.  [8]. Through the paper, we fixed (ϕx,ϕy,ϕz)=(π/6,π/6,π/6).

We find that for small noises, CF reaches CS, which is consistent with earlier numerical findings,. Remarkably, different from the previous findings where the convergence of these bounds is not clear, here we show that both CF and CS remain small (also in comparison to previous work) without any divergence. We further compare the performance of the star ansatz to that of the ring and squeezing ansatzes. It saturates the ultimate quantum limit for dephasing probabilities λ<0.5, whereas the ring and squeezing ansatzes only reach the limit for λ<0.2. The reason is that the star graph exhibits a central vertex connected to the remaining N-1 surrounding vertices, which facilitates robust quantum metrology, as discussed in.

Furthermore, we evaluate the tradeoff between the CFIM and QFIM by introducing a function T=Tr[FQ-1]. For unknown d parameters, the naive bound is max(T)=d, leading to simultaneous optimization of all parameters. The results are shown in the bottom panels of Fig.  [3]  and agree well with the CRBs presented in the top panels, wherein T→3 whenever the SLD quantum bound is reached. So far, we observe that T>d/2 for all cases, which is better than the theoretical prediction previously. This observation exhibits a practical advantage of the VQM approach across different levels of noise.

Variational quantum circuits under the influence of noises will exhibit a barren plateau (BP), where the gradient along any direction of the variables’ space vanishes exponentially with respect to the noise level. The BP prevents reaching the global optimization of the training space, thereby reducing the efficiency and trainability of the variational quantum circuit. However, BPs can be partially mitigated through carefully designing ansatzes and cost functions.

The deviation of CRBs shown in Fig.  [3]  may be subject to the BP raised by noise. We examine such dependent and show the results in Fig.  [4]. We plot |∂θ1C| (Fig.  [4] a) and Var[∂θ1C] (Fig.  [4] b), where C is defined in Eq. ( [2] ) after 200 runs with random initialization of θ and μ for each value of λ. As predicted, both of them demonstrate an exponential decline with an increase in the dephasing probability. Especially, Var[∂θ1C] exponentially vanishes with the slope of -2.259, -2.533, and -3.240 for the star, ring, and squeezing ansatz, respectively. The star ansatz exhibits slower gradient decay as λ approaches 1 due to its smaller trainable variables’ space than the ring and squeezing ansatz. This indicates better training and less susceptibility to vanishing gradients, leading to better achievement of the ultimate quantum bound.

We consider the Ornstein-Uhlenbeck model, where the noise is induced by the stochastic fluctuation of the external (magnetic) field. The Kraus operators are5K1(t)=1-q(t)001,K2(t)=q(t)000,where q(t)=1-e-f(t) with f(t)=γ[t+τc(e-t/τc-1)], and τc represents the memory time of the environment. In the Markovian limit (τc→0), f(t)=γt, which corresponds to the previous dephasing case. In the non-Markovian limit with large τc, such as t/τc≪1, we have f(t)=γt22τc. In the numerical simulation, we fixed γ=0.1 and τc=20 (for non-Markovian)6q(t)=1-exp(-0.1t)Markovian,1-exp(-t2400)non-Markovian.We use this model to study the relationship between sensing time, Markovianity, and ultimate attainability of the quantum bound. Figure  [5] a displays the optimal CRBs for Markovian and non-Markovian noises as functions of sensing time t. As previously reported in, there exists an optimal sensing time that minimizes the CRBs for each case examined here. Moreover, the non-Markovian dephasing (nMar) results in lower metrological bounds as compared to the Markovian case (Mar). So far, the minimum CRBs for different N are presented in Fig.  [5] b. The results demonstrate that with an increase in N, the non-Markovian noise attains a better bound than the standard quantum limit (SQL) for both classical and SLD quantum bounds. This observation agrees with previous results reported using semidefinite programming, indicating the potential of variational optimization for designing optimal non-Markovian metrology experiments. Finally, we note that in the Ornstein-Uhlenbeck model, the SLD quantum bound is unachievable, as indicated by CF>CS. It remains a question for future research on whether one can attain the SLD quantum bound CS with probe designs, and the existence of tight bounds in the non-Markovian scenario.

We discuss how the three ansatzes create entangled states and the role of entangled resources in achieving the SLD quantum bound in VQM. We analyze entanglement using the concentratable entanglement (CE) defined by7ξ(ψ)=1-12|s|∑α∈P(s)Tr[ρα2],where P(s) is the power set of s,∀s∈{1,2,…,N}, and ρα is the reduced state of |ψ⟩ in the subsystem α with ρ∅:=I. Practically, ξ(ψ) can be computed using the SWAP test circuit as stated in Ref., where ξ(ψ)=1-p(0), with p(0) is the probability of obtaining |00⋯0⟩. The ability of the SWAP test to compute CE is due to the equivalence between conditional probability distribution and the definition of CE.

We first train the three ansatzes to evaluate their ability of entangled-state generation. Particularly, the training process aims to generate quantum states with ξ(ψ)={ξsep,ξGHZ,ξAME}, where ξsep=0 for a separable state, ξGHZ=12-12N for a GHZ state, and ξAME=1-12N∑j=0NNj12min(j,N-j) for an absolutely maximally entangled (AME) state,. The top panels in Fig.  [6]  display the results for star, ring, and squeezing ansatz, from left to right, at N=4 and (2-2) layers of each ansatz as an example. All the ansatzes examined can reach the separable and GHZ state, but hard to achieve the AME state. This observation is consistent with the CEs for conventional graph states.

We next discuss the role of entanglement in achieving the ultimate SLD quantum bound. In the bottom panels of Fig.  [6] , we graph the corresponding CEs at the optimal CRBs shown in Fig.  [3] , which apparently do not require the maximum entanglement (e.g., GHZ) to achieve the ultimate SLD quantum bound. This phenomenon can be explained by the fact that maximum entanglement is not required for high-precision quantum metrology, as previously noted in Refs., –. Therefore, emphasizing the robustness of easily preparable entangled probe states and non-local POVM schemes would be advantageous for quantum metrological applications exposed to Markovian and non-Markovian noises.

We address the selection of the cost function used in the variational algorithm. The preference outlined in Eq. ( [2] ) is not the sole option. An alternative approach could involve adopting the classical bound CF as the cost function to maximize the information extraction. However, this way does not guarantee the classical bound can reach the quantum bound, a requirement in estimation theory. In Fig.  [7] a, we present a plot depicting the cost function C(θ,μ)=CF as a function of the number of iterations, considering various noise probabilities λ. It demonstrates that the cost function reaches its minimum value at a certain iteration. Correspondingly, in Fig.  [7] b, we provide the optimal values for both classical and quantum bounds, denoted as C′F and C′S, alongside this optimization. It’s important to emphasize that this approach does not guarantee that C′F equals C′S. For comparison, we include a grayscale representation of these quantities, originally presented in Fig.  [3] a. Here, optimizing the cost function Eq. ( [2] ) still ensures small values and convergence for both CF and CS. However, C′F and C′S consistently remain below CF and CS. This behavior occurs because the evaluation of CF and CS is based on the state that maximizes the figure of merit in Eq. ( [2] ), rather than solely minimizing CF or CS.

Furthermore, alternative physical quantities, such as the tradeoff T and the norm-2, can also be utilized as potential cost functions. For instance, a tradeoff cost function is analogous to the one presented in Eq. ( [2] ), taking the form:8C(θ,μ)=1-1dTr[FQ-1],where d is the number of estimated parameters. Notably, in scenarios where Q is a diagonal matrix and C(θ,μ)=0, it results in a zero tradeoff, i.e., F11Q11=⋯=FddQdd=1. Additionally, norm-2 can also function as a viable cost function.9C(θ,μ)=||F-Q||2,where ||A||2=λmax(A∗A) represents the norm-2, with λmax is the maximum eigenvalue. However, it is worth noting that these alternate cost functions might not be convex nor trainable. As a result, the selection of the cost function in Eq. ( [2] ) is indeed appropriate.

In numerical simulations, we employ the ADAM optimizer to train the VQM variables, where the variables at step k+1 are given by10θk+1=θk-αm^kv^k+ϵ,where mk=β1mk-1+1-β1∇θC(θ),vk=β2vk-1+(1-β2)∇θ2C(θ),m^k=mk/1-β1k,v^k=vk/1-β2k, with the hyper-parameters are chosen as α=0.2,β1=0.8,β2=0.999 and ϵ=10-8. The gradient ∂θiC(θ) is given through the parameter-shift rule,. The simulations are performed in Qiskit Aer simulator. The number of iterations is chosen using the EarlyStopping callback.

To determine the appropriate number of layers for the preparation state and POVM ansatzes, we analyze the cost function ( [2] ) with different number of layers. We use (⋆,†-‡) to denote the minimum cost function, the number of layers for variational state preparation, and the number of layers for variational POVM. The results are shown in Fig.  [8]  with (⋆,†-‡)= (0.057, 2-2), (0.04, 3-2), and (0.054, 2-2) for the star, ring, and squeezing ansatz, respectively. Obviously, the metrological performances of these ansatzes demonstrate that deep ansatzes are unnecessary, as also noted in where a shallow ansatz was able to saturate quantum bound. For the numerical simulations presented in this paper, we keep the number of layers fixed at these values.

Classical and quantum Fisher information matrices can be computed in quantum circuits using the finite difference approximation. For the CFIM, we first derive an output probability as ∂ϕip=p(ϕi+s)-p(ϕi-s)2s, for a small shift s. We then compute the CFIM from Fij=∑m1p(m|ϕ)[∂ϕip(m|ϕ)][∂ϕjp(m|ϕ)]. For the QFIM, we explicitly derive Qij=2vec[∂ϕiρ(ϕ)]†[ρ(ϕ)∗⊗I+I⊗ρ(ϕ)]+vec[∂ϕjρ(ϕ)], where vec[·] is the vectorization of a matrix, and the superscript ‘+’ denotes the pseudo-inversion. Again, we apply the finite difference to compute ∂ϕiρ=ρ(ϕi+s)-ρ(ϕi-s)2s, and substitute into the above equations to compute the QFIM.

Figure 1: Variational quantum metrology. (1) use quantum circuit U(θ)  to prepare a variational state; (2) encode multiparameter ϕ  and noise using U(ϕ)  and noise channels; (3) use circuit U(μ)  to create a variational POVM for measurement; (4) send measurement results to a classical computer to optimize cost function C(θ,μ)  using a gradient-based optimizer. Update new training variables and repeat the scheme until it converges.

Figure 2: Ansatzes for preparation state and POVM. (a  ) Star topology entangled ansatz. (b  ) Ring topology entangled ansatz. (c  ) Squeezing ansatz. In the circuits, Rx(y) : x (y )-rotation gate, Ux(z) : global Mølmer–Sørensen gate, ∙-∙ : controlled-Z gate.

Figure 3: Variational quantum metrology under dephasing noise. (Top): plot of the optimal cost function C(θ,μ) , classical bound CF , and SLD quantum bound CS  as functions of dephasing probability. From left to right: star, ring, and squeezing ansatz. (Bottom): plot of corresponding tradeoff T. Numerical results are calculated at N=3 , the optimal number of layers in Fig.  [8]  , and the results are averaged after 10 samples.

Figure 4: Barren plateau. (a  ) Plot of |∂θ1C|  as a function of the dephasing probability λ. (b  ) Plot of the variance of gradient Var[∂θ1C ]. The slope of each fit line indicates the exponential decay of the gradient, which is a sign of the barren plateau effect. The results are taken average after 200 runs.

Figure 5: Variational quantum metrology under time-dephasing noise. (a  ) We present the CRBs as functions of the sensing time, demonstrating an optimal sensing time for achieving each minimum CRB. The non-Markovian dephasing (nMar) produces lower metrological bounds in comparison to the Markovian one (Mar). (b  ) Plot of the minimal bounds for cases in (a  ), comparing them with the standard quantum limit (SQL) and the Heisenberg limit (HL). For non-Markovian metrology, the bounds surpass the SQL, as predicted.

Figure 6: Entanglement generation. (Top): from left to right: the distribution of training CEs corresponds to the star, ring, and squeezing ansatzes, respectively. All the ansatzes can produce separable and GHZ states, but generating an AME state is challenging. The results are shown at N=4  and (2–2) layers for each ansatz. (Bottom): the CEs are ploted at the optimal CRBs in Fig.  [3]  , using the same circuit setup that in the figure. Again, λ  is the dephasing probability.

Figure 7: Optimizing classical bound CF  through Variational Quantum Metrology. (a  ) Plot of the cost function C(θ,μ)=CF  versus the number of iterations across various noise probabilities λ. (b  ) Plot of the corresponding optimal values of C′F  and C′S , and their counterparts extracted from Fig.  [3]  a (in grayscale). These numerical results pertain to the star-graph configuration.

Figure 8: Cost function versus the optimal number of layers for different ansatzes. The plot of the cost function for (a  ) star ansatz, (b  ) ring ansatz, and (c  ) squeezing ansatz at N=3  without noise. The minimum cost function vs the number of layers are (0.057, 2-2), (0.044, 3-2), and (0.054, 2-2), respectively.

