Descoherencia inducida gravitacionalmente vs difusión del espacio-tiempo: probando la naturaleza cuántica de la gravedad 

ResumenConsideramos dos sistemas interactuantes cuando uno se trata clásicamente mientras que el otro sistema permanece cuántico. Se ha demostrado que existe una dinámica consistente de este acoplamiento, y se ha explorado en el contexto de tratar el espacio-tiempo clásicamente. Aquí, probamos que cualquier dinámica híbrida de este tipo resulta necesariamente en la descoherencia del sistema cuántico y en una ruptura de la predictibilidad en el espacio de fases clásico. Además, demostramos que un compromiso entre la tasa de esta descoherencia y el grado de difusión inducido en el sistema clásico es una característica general de toda dinámica cuántica clásica; los tiempos de coherencia largos requieren una fuerte difusión en el espacio de fases en relación con la fuerza del acoplamiento. Aplicando la relación de compromiso a la gravedad, encontramos una relación entre la fuerza de la descoherencia inducida gravitacionalmente frente a la difusión del métrico y sus momentos conjugados. Esto proporciona una firma experimental de teorías en las que la gravedad es fundamentalmente clásica. Los límites en las tasas de descoherencia que surgen de los experimentos de interferometría actuales, combinados con mediciones precisas de masa, imponen restricciones significativas a las teorías donde la teoría clásica de la gravedad de Einstein interactúa con la materia cuántica. Encontramos que parte del espacio de parámetros de tales teorías ya está restringido, y proporcionamos figuras de mérito que pueden ser utilizadas en futuras mediciones de masa y experimentos de interferencia. 

 When considering the dynamics of composite quantum systems, there are many regimes where one system can be taken to be classical and the other quantum-mechanical. For example, in quantum thermodynamics, we often have a quantum system interacting with a large thermal reservoir that can be treated classically, whilst in atomic physics it is common to consider the behaviour of quantum atoms in the presence of classical electromagnetic fields. Things become more complicated when one considers classical-quantum (CQ) dynamics where the quantum system back-reacts on the classical system. This is particularly relevant in gravity because we would like to study the back-reaction of thermal radiation being emitted from black holes in space–time, and while the matter fields can be described by quantum field theory, we only know how to treat space–time classically. Likewise in cosmology, vacuum fluctuations are a quantum effect that we believe seeds galaxy formation, while the expanding space–time they live on can only be treated classically. In addition to the need for an effective theory that treats space–time in the classical limit, there has long been a debate about whether one should quantise gravity.

 The prevailing view has been that a quantum–classical coupling is inconsistent. Many proposals for such dynamics are not completely positive (CP), meaning they are at best an approximation and fail outside a regime of validity. A map Λ is completely positive (CP), iff(equation)is positive. This is the required condition used to derive the GKSL equation. If it is violated, the dynamics acting on half of an entangled state, give negative probabilities. The semi-classical Einstein’s equation, which replaces the quantum operator corresponding to the stress-energy tensor by its expectation value, is another attempt to treat the classical limit from an effective point of view, but it is non-linear in the state, leading to pathological behaviour if quantum fluctuations are of comparable magnitude to the stress-energy tensor. This is often the precise regime we would like to understand.

 However, examples of classical–quantum dynamics such as those first introduced in refs.  and studied in refs.  do not suffer from such problems and are consistent. More generally, the master equation shown in Eq. (4 ), is linear in the state space, preserves the division of classical degrees of freedom and quantum ones, and is completely positive (CP), and preserves normalisation. This ensures that probabilities of measurement outcomes remain positive and always add to 1. The dynamics is related to the GKSL or Lindblad equation, which for bounded generators of the dynamics, is the most general Markovian dynamics for an open quantum system. More precisely, we consider dynamics which is autonomous, meaning the couplings in the theory do not depend on time. Likewise, Eq. (4 ) is the most general Markovian classical–quantum dynamics with bounded generators. Sub-classes of this master equation, along with measurement and feedback approaches, have been discussed in the context of Newtonian models of gravity and further developed into a spatially covariant framework so that Einstein gravity in the ADM formalism emerges as a limiting case. Dynamics which is manifestly diffeomorphism invariant has also been introduced using path integral methods.

 In this work, we move away from specific realisations of CQ dynamics, in order to discuss their common features and the experimental signatures that follow from this. An early precursor to the discussion here is the insight of Diósi, who added classical noise and quantum decoherence to the master equation of ref. , and found the noise and decoherence trade-off required for the dynamics to become completely positive. Here we prove that the phenomena found in refs.  are generic features of all CQ dynamics; the classical–quantum interaction necessarily induces decoherence on the quantum system, and there is a generic trade-off between the rate of decoherence and the amount of diffusion in the classical phase space. The stronger the interaction between the quantum system and the classical one, the greater the trade-off. One cannot have quantum systems with long-coherence times without inducing a lot of diffusion in the classical system. One can also generalise this result to a trade-off between the rate of diffusion and the strength of more general couplings to Lindblad operators, with decoherence being a special case.

 Our main result is expressed as Eqs. (26 ) and (23 ), which bounds the product of diffusion coefficients and Lindblad coupling constants in terms of the strength of the CQ-interaction. It is precisely this trade-off which allows the theories considered here, to evade the no-go arguments of Feynmann, Aharonov, Eppley and Hannah and others. The essence of arguments against quantum–classical interactions is that they would prohibit superpositions of quantum systems that source a classical field. Since different classical fields are perfectly distinguishable in principle, if the classical field is in a distinct state for each quantum state in the superposition, the classical field could always be used to determine the state of the quantum system, causing it to decohere instantly. By satisfying the trade-off, the quantum system preserves coherence because diffusion of the classical degrees of freedom means that the state of the classical field does not determine the state of the quantum system. Equation (26 ) and other variants we derive, quantify the amount of diffusion required to preserve any amount of coherence. If space–time curvature is treated classically, then complete positivity of the dynamics means its interaction with quantum fields necessarily results in unpredictability and gravitationally induced decoherence.

 This trade-off between the decoherence rate and diffusion provides an experimental signature, not only of models of hybrid Newtonian dynamics such as refs.  or post-quantum theories of general relativity such as refs.  but of any theory which treats gravity as being fundamentally classical. The metric and their conjugate momenta necessarily diffuse away from what Einstein’s general relativity predicts. This experimental signature squeezes classical–quantum theories of gravity from both sides: if one has shorter decoherence times for superpositions of different mass distributions, one necessarily has more diffusion of the metric and conjugate momenta. In the “Methods” subsection “Detecting gravitational diffusion” we show that the latter effect causes imprecision in measurements of mass such as those undertaken in the Cavendish experiment or in measurements of Newton’s constant “BigG ". The precision at which a mass can be measured in a short time, thus provides an upper bound on the amount of gravitational diffusion, as quantified by Eq. (42 ). In the other direction, decoherence experiments place a lower bound on the diffusion. Our estimates suggest that experimental lower bounds on the coherence time of large molecules, combined with gravitational experiments measuring the acceleration of small masses, already place strong restrictions on theories where space–time is not quantised. In the section “Physical constraints on the classicality of gravity” we show that several realisations of CQ-gravity are already ruled out, while other realisations produce enough diffusion away from general relativity to be detectable by future table-top experiments. Although the absence of such deviations from general relativity would not be as direct a confirmation of the quantum nature of gravity, such as experiments proposed in refs.  to exhibit entanglement or coherence generated by gravitons, it would effectively rule out any sensible theory that treats space–time classically. While confirmation of gravitational diffusion would suggest that space-time is fundamentally classical. Experiments to detect or bind gravitational diffusion also provide immediate-term prospects for probing the quantumness of gravity, while entanglement-based experiments will only be feasible in the long term.

 The outline of the remainder of this paper is as follows. In the subsection “Classical-quantum dynamics” we review the general form of the CQ master equation of classical–quantum systems as derived in refs.. TheCQ-map can be represented in a manner akin to the Kraus representation for quantum maps, with conditions for it to be completely positive and trace preserving (CPTP). We can perform a short time moment expansion of the CQ-map taking states at some initial time, to states at a later time. This gives us the CQ version of the Kramers–Moyal expansion, presented in the subsection “The CQ Kramers–Moyal expansion”. The physical meaning of the moments is given in the subsection “Physical interpretation of the moments”. Our main result is presented in the section “A trade-off between decoherence and diffusion”, where we show that there is a general trade-off between decoherence of the quantum system and diffusion in the classical system. We generalise the trade-off to the case of fields in the subsection “Trade-off in the presence of fields” and in the subsection “Physical constraints on the classicality of gravity”, we apply the inequality in the gravitational setting. The positivity constraints mean that the considerations do not depend on the specifics of the theory, only that it treats gravity classically, and is time-local. This allows us to discuss some of the observational implications of this result and we comment on the relevant figures of merit required in interference and precision mass measurements in order to constrain theories of gravity, as they are not always readily available in published reports. In addition to table-top constraints, we consider those due to cosmological observations. We then conclude with a discussion of our results. The “Methods” section collects or previews a number of technical results. Since this paper appeared on the arXiv, we have found that when the decoherence-diffusion trade-off is saturated, there are two important consequences. The first is that in the continuous class of dynamics, the quantum state remains pure, conditioned on the classical trajectory. The second is that in the path integral formulation, one can show that the dynamics are completely positive from the path integral alone. For a generic path integral of Feynman–Vernon form, one typically only knows that the dynamics are completely positive if it was derived from a CPTP master equation.

Let us first review the general map and master equation governing classical–quantum dynamics. The classical degrees of freedom are described by a differential manifold (equation) and we shall generically denote elements of the classical space byz. For example, we could take the classical degrees of freedom to be position and momenta in which case (equation) andz = (q ,p ). The quantum degrees of freedom are described by a Hilbert space (equation). Given the Hilbert space, we denote the set of positive semi-definite operators with trace at most unity as (equation). Then the CQ object defining the state of the CQ system at a given time is a map (equation) subject to a normalisation constraint (equation). To put it differently, we associate to each classical degree of freedom an un-normalised density operator,ϱ (z ), such that (equation) is a normalised probability distribution over the classical degrees of freedom and (equation) is a normalised density operator on (equation). An example of such aCQ-state is the CQ qubit depicted as a 2 × 2 matrix over phase space. More generally, we can define any CQ operator f(z ) which lives in the fibre bundle with base space (equation) and fibre (equation). 

Just as the Lindblad equation is the most general evolution law that maps density matrices to density matrices, we can ask what is the most general evolution law that preserves the quantum-classical state-space. Any such dynamics, if it is to preserve probabilities, must be completely positive, norm-preserving, and linear in the CQ-state. That dynamics must be linear can be seen as follows: if someone prepares a system in one of two statesσ0 orσ1 depending on the value of a coin toss ( (equation) with probability (equation) with probability 1−p ), then the evolution (equation) of the system must satisfy (equation) otherwise the system evolves differently depending on whether we are aware of the value of the coin toss. A violation of linearity further implies that when the system is in stateσ0 it evolves differently depending on what state the system would have been prepared in, had the coin been (equation) instead of (equation). This motivates our restriction to linear theories. We will also require the map to be Markovian on the combined classical–quantum system, which is equivalent to requiring that there is no hidden system that acts as a memory. This is natural if the interaction is taken to be fundamental, but is the assumption that one might want to remove if one thinks of the hybrid theory as an effective description. We thus take these as the minimal requirements that any fundamental classical–quantum theory must satisfy if it is to be consistent. 

The most general CQ-dynamics, which maps CQ states onto themselves can be written in the form (equation) where theL μis an orthogonal basis of operators and (equation) is positive semi-definite for each (equation). Henceforth, we will adopt the Einstein summation convention so that we can drop ∑ μ  νwith the understanding that equal upper and lower indices are presumed to be summed over. The normalisation of probabilities requires (equation) 

The choice of basisL μis arbitrary, although there may be one which allows for unique trajectories. Equation (1 ) can be viewed as a generalisation of the Kraus decomposition theorem. 

In the case where the classical degrees of freedom are taken to be discrete, Poulin used the diagonal form of this map to derive the most general form of Markovian master equation for bounded operators, which is the one introduced in ref.. When the classical degrees of freedom are taken to live in a continuous configuration space, we need to be a little more careful, sinceϱ (z ) may only be defined in a distributional sense; for example, (equation). In this case (1 ) is completely positive if the eigenvalues of (equation) , are positive so that (equation) for any vector with positive components (equation). One can derive the CQ master equation by performing a short time expansion of Eq. (1 ) in the case when theL μis bounded. To do so, we first introduce an arbitrary basis of traceless Lindblad operators on the Hilbert space,L μ= {I ,L α}. Now, atδt = 0, we know Eq. (1 ) is the identity map, which tells us that (equation). Looking at the short-time expansion coefficients, by Taylor expanding inδt ≪ 1, we can write (equation) 

By substituting the short-time expansion coefficients into Eq. (1 ) and taking the limitδt → 0 we can write the master equation in the form (equation) where {, }+ is the anti-commutator, and preservation of normalisation under the trace and ∫ dz defines (equation) 

We see the CQ master equation is a natural generalisation of the Lindblad equation and classical rate equation in the case of classical–quantum coupling. We give a more precise interpretation of the different terms arising when we perform the Kramers–Moyal expansion of the master equation at the end of the section. The positivity conditions from Eq. (1 ) transfer to positivity conditions on the master equation via (3 ). We can write the positivity conditions in an illuminating form by writing the short time expansion of the transition amplitude (equation) , as defined by Eq. (3 ), in block form (equation) and the dynamics will be positive if and only if (equation) is a positive matrix. It is possible to introduce an arbitrary set of Lindblad operators (equation) and appropriately redefine the couplings (equation) in Eq. (4 ). For most purposes, we shall work with a set of Lindblad operators that includes the identityL μ= (I ,L α); this is sufficient since any CQ master equation is completely positive if and only if it can be brought to the form in Eq. (4 ), where the matrix (6 ) is positive. 

In order to study the positivity conditions it is first useful to perform a moment expansion of the dynamics in a classical-quantum version of the Kramers–Moyal expansion as in ref.. In classical Markovian dynamics, the Kramers–Moyal expansion relates the master equation to the moments of the probability transition amplitude and proves to be useful for a multitude of reasons. Firstly, the moments are related to observable quantities; for example, the first and second moments of the probability transition amplitude characterise the amount of drift and diffusion in the system. This is reviewed in the subsection “Physical interpretation of the moments”. Secondly, the positivity conditions on the master equation transfer naturally to positivity conditions on the moments, which we can then relate to observable quantities. In the classical–quantum case, we shall perform a short time moment expansion of the transition amplitude (equation) and then show that the master equation can be written in terms of these moments. We then relate the moments to observational quantities, such as the decoherence of the quantum system and the diffusion in the classical system. 

We work with the form of the dynamics in Eq. (4 ), using an arbitrary orthogonal basis of Lindblad operators (equation). We take the classical degrees of freedom (equation) to bed dimensional,z = (z1 , …z d), and we label the components asz i,i ∈ {1, …d }. We begin by introducing the moments of the transition amplitude (equation) appearing in the CQ master Eq. (3 ) (equation) 

The subscriptsi j∈ {1, …d } label the different components of the vectors (equation). For example, in the case whered = 2 and the classical degrees of freedom are position and momenta of a particle,z = (z1 ,z2 ) = (q ,p ), then we have (equation). The components are then given by (equation) and (equation). (equation) is seen to be ann th rank tensor withd components. 

In terms of the components (equation) the short time expansion of the transition amplitude (equation) is given by (equation) and the master equation takes the form (equation) where we define the Hermitian operator (equation) (which is Hermitian since (equation) ). We see the first line of Eq. (9 ) describes purely classical dynamics, and is fully described by the moments of the identity component of the dynamics (equation). The second line describes pure quantum Lindbladian evolution described by the zeroth moments of the components (equation) ; specifically the (block) off diagonals, (equation) , describe the pure Hamiltonian evolution, whilst the components (equation) describe the dissipative part of the pure quantum evolution. Note that the Hamiltonian and Lindblad couplings can depend on the classical degrees of freedom so the second line describes the action of the classical system on the quantum one. The third line contains the non-trivial classical-quantum back-reaction, where changes in the distribution over phase space are induced and can be accompanied by changes in the quantum state. 

Let us now briefly review the physical interpretation of the moments that will appear in our trade-off relation. In particular, the zeroth moment determines the rate of decoherence (and Lindbladian coupling more generally), the first moment gives the force exerted by the quantum system on the classical system, and the second moment determines the diffusion of the classical degrees of freedom. For this discussion, we shall take the classical degrees of freedom to live in a phase space (equation) , whereω is the symplectic form. 

Consider the expectation value of any CQ operator (equation) which does not have an explicit time dependence. Its evolution law can be determined via Eq. (9 ) (equation) where we have used cyclicity of trace and integration by parts, to bring the equation of motion into a form that would enable us to write a CQ version of theHeisenberg representation for a CQ operator. If we are interested in the expectation value of phase space variables (equation) then Eq. (10 ) gives (equation) with all higher order terms vanishing, and we see that (equation) governs the average rate at which the quantum system moves the classical system through phase space, and with the back-reaction is quantified by the Hermitian matrix (equation). The force of this back-reaction is especially apparent if the equations of motion are Hamiltonian in the classical limit as in ref.. I.e. if we define (equation) and take (equation) withω the symplectic form andd jthe exterior derivative. Then Eq. (11 ) is analogous to Hamilton’s equations, and the CQ evolution equation after tracing out the quantum system has the form of a Liouville’s equation to first order and in the classical limit, (equation) with (equation). 

The significance of the second moment is also seen via Eq. (10 ) to be related to the variance of phase space variables (equation)  (equation) 

In the case when (equation) is uncorrelated with (equation) and (equation) uncorrelated with (equation) , then the growth of the variance only depends on the diffusion coefficient. 

The zeroth moment (equation) is just the pure Lindbladian couplings. The simplest example is the case of a pure decoherence process with a single Hermitian Lindblad operatorL and decoherence couplingD0. Then we can define a basis (equation) via the eigenvectors ofL and (equation) and we see that the matrix elements ofϱ which quantify coherence between the states (equation) decay exponentially fast with a decay rate ofD0 (L (a )−L (b )). For a damping/pumping process of a quantum harmonic oscillator with HamiltonianH =ωaa ,L ↓=a ,L ↑=a ,a the creation operator, and (equation) the non-zero couplings, then standard calculations show that an initial superposition (equation) withn ,m large andn ≫m will initially decohere at a rate of approximately (equation) , and the state will eventually thermalise to a temperature of (equation). So in this case, the Lindblad couplings not only determine the rate of decoherence but also the rate at which energy is pumped into the harmonic oscillator. In the next section, we will derive the trade-off between Lindblad couplings and the diffusion coefficients. Although we will sometimes refer to this as a trade-off between decoherence and diffusion, this terminology is only strictly appropriate for pure decoherence processes, while more generally, it is a trade-off between Lindblad couplings and diffusion coefficients. 

In this section, we present our main result by using positivity conditions to prove the trade-off between decoherence and diffusion seen in models such as those of refs.  are in fact a general feature of all classical-quantum interactions. We shall also generalise this, and derive a trade-off between diffusion and arbitrary Lindbladian coupling strengths. The trade-off is in relation to the strength of the dynamics and is captured by Eqs. (20 ), (23 ) and (26 ). In the subsection “Trade off in the presence of fields” we extend the trade-off to the case where the classical and quantum degrees of freedom can be fields and use this to show that treating the metric as being classical necessarily results in diffusion of the gravitational field. 

There are two separate possible sources for the force (ordrift ) of the back-reaction of the quantum system on phase space—it can be sourced by either the (equation) components or the Lindbladian components (equation). We shall deal with both sources simultaneously by considering a CQ Cauchy-Schwartz inequality which arises from the positivity of (equation) for any vector of CQ operatorsO μ. One can verify that this must be positive directly from the positivity conditions on (equation) and we go through the details in the Appendix section “Positivity conditions and the trade-off between decoherence and diffusion”. A common choice forO μwould be the set of operators (equation) appearing in the master equation. 

The inequality in Eq. (15 ) turns out to be especially useful since it can be used to define a (pseudo) inner product on a vector of operators with componentsO μvia (equation) where (equation) due to Eq. (15 ). Technically this is not positive definite, but this shall not be important for our purpose. Taking the combination (equation) for vectorsO1  μ,O2  μ, positivity of the norm gives (equation) and as long as (equation) we have a Cauchy–Schwartz inequality (equation) 

We can use Eq. (18 ) to get a trade-off between the observed diffusion and decoherence by picking (equation) and (equation) , where (equation) are the Lindblad operators appearing in the master equation andb are the components of an arbitrary vector. In this case (equation) and one can verify using CQ Pawula theorem that in order to have non-trivial back-reaction on the quantum system complete positivity demands that (equation) , meaning the Cauchy-Schwartz inequality in Equation (18 ) must hold. To reach this conclusion one can insert the CQ state into the CQ Cauchy–Schwartz inequality and repeat the proof of the Pawula theorem, which must now hold once averaged over the state. By using the short-time moment expansion of (equation) defined in Eq. (8 ) and using integration by parts, we then arrive at the observational trade-off between decoherence and diffusion (equation) which must hold for any positive CQ stateϱ (z ). Stripping out theb vectors, (19 ) is equivalent to the matrix positivity condition (equation) where we define (equation). 

Since Eq. (20 ) holds for all states, the tightest bound is provided by the infimum over all states (equation) 

The quantities 〈D2 〉 and 〈D0 〉 appearing in Eq. (20 ) are related to observational quantities. In particular 〈D2 〉 is the expectation value of the amount of classical diffusion which is observed and 〈D0 〉 is related to the amount of decoherence on the quantum system. The expectation value of the back-reaction matrix (equation) quantifies the amount of back-reaction on the classical system. In the trivial case (equation) , Eq. (20 ) places little restriction on the diffusion and Lindbladian rates appearing on the left-hand side. We already knew from refs.  that the (equation) must be a positive semi-definite matrix, and we also know that diffusion coefficients must be positive semi-definite. However, in the non-trivial case, the larger the back-reaction exerted by the quantum system, the stronger the trade-off between the diffusion coefficients and Lindbladian coupling. Equation (20 ) gives a general trade-off between observed diffusion and Lindbladian rates, but we can also find a trade-off in terms of a theory’s coupling coefficients alone. We show in the Appendix section “General trade-off between decoherence and diffusion coefficients” that the general matrix trade-off (equation) holds for the matrix whose elements are the couplings (equation) for any CQ dynamics. Moreover, (equation) , which tells us thatD0 cannot vanish if there is non-zero back-reaction. Equation (23 ) quantifies the required amount of decoherence and diffusion in order for the dynamics to be completely positive. In Eq. (23 ), and throughout, (equation) is the generalised inverse of (equation) , since (equation) is only required to be positive semi-definite. In the special case of a single Lindblad operatorα = 1 and classical degree of freedom, and when the only non-zero couplings are (equation) and (equation) this trade-off reduces to the conditionD2D0 ≥ 1 used in ref.. 

As a more general example, let us consider the class of theories that are continuous in phase space, and whose back-reaction is generated by a classical-quantum Hamiltonian (equation) which is only a function of the canonical coordinatesq i. These are given by (equation) whereHc is the purely classical Hamiltonian,p are the conjugate momenta, andD0 andD2 areq idependent matrices with elementsD0,  i  jandD2,  i  j. Then the trade-off (23 ) implies that they must obey the matrix equation 2D2D0 ⪯ 1. 

It is also useful to try to obtain an observational trade-off in terms of the total drift due to back-reaction as calculated in Eq. (11 ) (equation) 

It follows directly from Eq. (20 ) that when the back-reaction is sourced by either (equation) or (equation) we can arrive at the observational trade-off in terms of the total drift (equation) where the quantities appearing in Eq. (26 ) are now all observational quantities, related to drift, decoherence and diffusion as outlined in the previous subsection “Physical interpretation of the moments”. We believe that Eq. (26 ) should hold more generally, though we don’t have a general proof. 

In the case where the back-reaction is Hamiltonian at first order in the sense of Eq. (12 ), then Eq. (26 ) can be written as (equation) 

As a result, we can derive a trade-off between diffusion and decoherence for any theory that reproduces this classical limit and treats one of the systems classically. 

To summarise, whenever the back-reaction of the quantum system on the classical system induces a force on the phase space, then we have a trade-off between the amount of diffusion on the classical system and the strength of decoherence on the quantum system (or more precisely the strength of the Lindbladian couplings (equation) ). This can be expressed both as a condition on the matrix of coupling co-efficients in the master equation, via Eq. (23 ) or in terms of observable quantities using Eqs. (20 ) and (26 ). In the case when the back-reaction is Hamiltonian, we further have Equation (27 ). We would like to apply this trade-off to the case of gravity in the non-relativistic, Newtonian limit. In order to do so, we will need to generalise the trade-off to the case of quantum fields interacting with classical ones, which we do in the subsection “Trade-off in the presence of fields”. The goal will be to understand the implications of treating the metric (or Newtonian potential) as being classical by using the trade-off when the quantum back-reaction induces a force on the gravitational field which, on expectation, is the same as the weak field limit of General Relativity. 

We would like to explore the trade-off in the gravitational setting and explore the consequences of treating the gravitational field as being classical and matter quantum. Since gravity is a field theory, we must first discuss classical-quantum master equations in the presence of fields. In the field-theoretic case, both the Lindblad operators and the phase space degrees of freedom can have spatial dependence,z (x ),L μ(x ) and a general bounded CP map which preserves the classicality of the two systems can be written (equation) where, as is usually the case with fields, in Eq. (28 ) it should be implicitly understood that a smearing procedure has been implemented. We elaborate on some of the details when fields are introduced in the Appendix section “Classical-quantum dynamics with fields”. The condition for Eq. (28 ) to be completely positive on all CQ states is that for all vectors atx with components (equation)  (equation) meaning that Λ(x ,y ) can be viewed as a positive matrix inμν and a positive kernel inx ,y. In the field-theoretic case, one can still perform a Kramers–Moyal expansion and find a trade-off between the coefficientsD0 (x ,y ),D1 (x ,y ),D2 (x ,y ) appearing in the master equation. The coefficients now have anx ,y dependence, due to the spatial dependence of the Lindblad operators. The coefficientsD1 (x ,y ),D2 (x ,y ) still have a natural interpretation as measuring the amount of force (drift) and diffusion, whilstD0 (x ,y ) describes the purely quantum evolution on the system and can be related to decoherence. 

Using the positivity condition in Eq. (29 ) we find the same trade of between coupling constants in Eq. (23 ) but where nowD2 (x ,y ) is the (p + 1)n × (p + 1)n matrix-kernel with elements (equation) is the (p + 1)n ×p matrix-kernel with rows labelled byμi , columns labelled byβ , and elements (equation) , andD0 (x ,y ) is thep ×p decoherence matrix-kernel with elements (equation). Herei ∈ {1, …,n }α ∈ {1, …,p } andμ ∈ {1, …,p + 1}. In the field-theoretic trade off we are treating the objects in Eq. (23 ) as matrix-kernels, so that for any position-dependent vector (equation) , whilst for any position-dependent vector (equation). Explicitly, we find that positivity of the dynamics is equivalent to the matrix condition (equation) which should be positive for any position-dependent vectors (equation) anda α(x ). This is equivalent to trade-off between coupling constants in Eq. (23 ) if we view (23 ) as a matrix-kernel equation. 

In order for the theory to be diffeomorphism invariant, we expectD0 (x ,y ) andD2 (x ,y ) to approach delta functions. We will not assume this, but we shall assume that the drift back-reaction is local, so that (equation). As we shall see in the next section, this is a natural assumption if we want to have back-reaction which is given by a local Hamiltonian. However, one might not want to assume that the form of the Hamiltonian remains unchanged to arbitrarily small distances. With this locality assumption, Eq. (30 ) gives rise to the same trade-off of Eq. (23 ), where the trade-off is to be interpreted as a matrix kernel inequality. Writing this out explicitly we have (equation) where asking that this inequality holds for all vectors (equation) is equivalent to the matrix-kernel trade-off condition of Eq. (23 ). 

We give two examples of master equations satisfying the coupling constant trade-off in the Appendix section “Examples of Kernels saturating the decoherence diffusion coupling constants trade-off”. The decoherence-diffusion trade-off tells us how much diffusion and stochasticity are required to maintain coherence when the quantum system back-reacts on the classical one. If the interaction between the classical and quantum degrees of freedom is dictated by unbounded operators, such as the mass density, then there can exist states for which the back-reaction can be made arbitrarily large. This is the case for a quantum particle interacting with its Newtonian potential through its mass density at arbitrarily short distances. Hence, if one considers a particle in a superposition of two peaked mass densities, then there can be an arbitrarily large response in the Newtonian potential around those points, and either there must be an arbitrary amount of diffusion, or the decoherence must occur arbitrarily fast. The former is unphysical, while the latter turns out to be the case in simple examples of theories such as those discussed in the Methods subsection “Decoherence rates”. 

Since our goal is to experimentally constrain classical-quantum theories of gravity, we shall hereby ask that the map (28 ) is CP when acting on all physical statesρ. If one allows for arbitrarily peaked mass distributions then the coupling constant trade-off of Eq. (31 ) should be satisfied. In the field-theoretic case, we can similarly find an observational trade-off, relating the expected value of the diffusion matrix 〈D2 (x ,y )〉 to the expected value of the drift in a physical stateϱ as we did in subsection “A trade-off between decoherence and diffusion”. This is done explicitly in the “Methods” subsection “Classical-quantum dynamics with fields”, using a field-theoretic version of the Cauchy–Schwartz inequality given by Eq.n (73 ), we find (equation) where Eq. (34 ) is to be understood as a matrix inequality with entries (equation)  (equation)  (equation) 

Similarly, when the back-reaction is sourced by either (equation) or (equation) it follows from Eq. (32 ) we can arrive at the observational trade-off in terms of the total drift due to back-reaction (equation) where (equation) 

We shall now use the trade-off to study the consequences of treating the gravitational field classically. We will consider the back-reaction of the mass on the gravitational field to be governed by the Newtonian interaction (or more accurately, a weak field limit of General Relativity). We shall then find that experimental bounds on coherence lifetimes for particles in superposition require large diffusion in the gravitational field in order to be maintained and this can be upper bounded by gravitational experiments. 

To summarise this section, we have derived the trade-off between decoherence and diffusion for classical–quantum field theories, both in terms of coupling constants of the theory and in terms of observational quantities. This trade-off puts tight observational constraints on classical theories of gravity which we now discuss. 

In this section, we apply the trade-off of Eq. (30 ) to the case of gravity. A number of classical-quantum models of Newtonian gravity have been proposed, but since the trade-offs derived in the previous section depend only on the back-reaction, or drift term, they are insensitive to the particulars of the theory. We shall consider the Newtonian, non-relativistic limit of a classical gravitational field which we reproduce in the “Methods” subsection “Newtonian limit of CQ theory”. A fuller discussion, including a derivation of the Newtonian limit starting from the covariant theories of refs.  can be found in ref.. It is in taking this limit where some care should be taken, since one is gauge fixing the full general relativistic theory. We denote Φ to be the Newtonian potential and in the weak field limit of General Relativity, it has a conjugate momenta we denote byπΦ. We assume:  The theory satisfies the assumptions used to derive the master equation as in subsections “Trade-off in the presence of fields”; in particular that the theory be a completely positive norm-preserving Markovian map, and that we can perform a short-time Kramers–Moyal expansion as in “Methods” subsection “Classical-quantum dynamics with fields”. We apply the theory to the weak field limit of General Relativity, whereas recalled in “Methods” subsection “Newtonian limit of CQ theory” the Newtonian potential interacts with matter through its mass density m( x),(equation)and the conjugate momentum to Φ satisfies(equation)where in the c→ ∞limit the momentum constraint π Φ≈ 0 is imposed and we recover Poisson’s equation for the Newtonian potential. We assume this limit of General Relativity is satisfied on expectation, at least to leading order. This may be an overly strong assumption, since the weak field limit may cease to be valid at short distances when the diffusion becomes large. A relativistic treatment is initiated in (J. Oppenheim and A. Russo, manuscript in preparation). It is also worth noting that General Relativity has not been tested at distances shorter than the millimeter scale, and here we assume it holds to arbitrarily short distances. In relating D 0to the decoherence rate of a particle in superposition, we shall assume that the state of interest is well approximated by a state living in a Hilbert space of fixed particle number. We believe this is a mild assumption: ordinary non-relativistic quantum mechanics is described via a single particle Hilbert space, and we frequently place composite massive particles in superposition and they do not typically decay into multiple particles. We will assume that the diffusion kernel(equation)does not depend on π Φi.e. it is minimally coupled. This is reasonable, since in the purely classical case matter couples to the Newtonian potential and not its conjugate momenta.

 The theory satisfies the assumptions used to derive the master equation as in subsections “Trade-off in the presence of fields”; in particular that the theory be a completely positive norm-preserving Markovian map, and that we can perform a short-time Kramers–Moyal expansion as in “Methods” subsection “Classical-quantum dynamics with fields”.

 We apply the theory to the weak field limit of General Relativity, whereas recalled in “Methods” subsection “Newtonian limit of CQ theory” the Newtonian potential interacts with matter through its mass density m( x),(equation)and the conjugate momentum to Φ satisfies(equation)where in the c→ ∞limit the momentum constraint π Φ≈ 0 is imposed and we recover Poisson’s equation for the Newtonian potential. We assume this limit of General Relativity is satisfied on expectation, at least to leading order. This may be an overly strong assumption, since the weak field limit may cease to be valid at short distances when the diffusion becomes large. A relativistic treatment is initiated in (J. Oppenheim and A. Russo, manuscript in preparation). It is also worth noting that General Relativity has not been tested at distances shorter than the millimeter scale, and here we assume it holds to arbitrarily short distances.

 In relating D 0to the decoherence rate of a particle in superposition, we shall assume that the state of interest is well approximated by a state living in a Hilbert space of fixed particle number. We believe this is a mild assumption: ordinary non-relativistic quantum mechanics is described via a single particle Hilbert space, and we frequently place composite massive particles in superposition and they do not typically decay into multiple particles.

 We will assume that the diffusion kernel(equation)does not depend on π Φi.e. it is minimally coupled. This is reasonable, since in the purely classical case matter couples to the Newtonian potential and not its conjugate momenta.

With these assumptions, and treating the matter density as a quantum operator (equation) , this tells us that in order for the back-reaction term to reproduce the Newtonian interaction on average (equation) then we must pick (equation) meaning that the back-reaction matrix (equation) is nonvanishing. In the “Methods” subsection “Newtonian limit of CQ theory” we give examples of master equations for which Eq. (39 ) is satisfied, but their details are irrelevant since we only require the expectation of the back-reaction force to be the expectation value of the mass—a necessary condition for the theory to reproduce Newtonian gravity. 

As a consequence of the coupling constant and observational trade-offs derived in Eqs. (31 ) and (32 ), a non-zero (equation) implies that there must be diffusion in the momenta conjugate toπΦ. This diffusion is equivalent to adding a stochastic random processJ (x ,t ) (the Langevin picture), to the equation of motion (37 ) to give (equation) where we allow somecolouring to the noise via a function (equation) which can depend on Φ, and the matter distribution (equation) (assumption (iv)). The noise process satisfies (equation) where we have defined (equation) , andρ is the quantum state for the decohered mass density. Here them , Φ subscripts of (equation) allow for the possibility that the statistics of the noise process can be dependent on the Newtonian potential and mass distribution of the particle. The restriction on (equation) follows from assumption (ii). IfuJ (x ,t ) is Gaussian, Eq. (41 ) completely determines the noise process, but in general, higher-order correlations are possible, although they need not concern us here, since we are only interested in bounding the effects due toD2 (x ,y , Φ). 

In the non-relativistic limit, wherec →∞ , we impose the momentum constraintπΦ ≈ 0 and we recover Poisson’s equation for gravity, but with a stochastic contribution to the mass. This is precisely as expected on purely physical grounds: in order to maintain coherence of any mass in superposition, there must be noise in the Newtonian potential and this must be such that we cannot tell which element of the superposition the particle will be in, meaning the Newtonian potential should look like it is being sourced in part by a random mass distribution. In other words, the trade-off requires that the stochastic component of the coupling obscures the amount of massm at the different points in space where the mass may be found. 

In the case whereu is independent of Φ, it is simple to solve Eq. (40 ) in terms of Green’s function for Poisson’s equation as in the “Methods” subsection “Detecting gravitational diffusion”. A formal treatment of solutions to non-linear stochastic integrals of the more general form of Eq. (40 ) can be found in ref.. A higher precision calculation would involve a full simulation of CQ dynamics, for example using unravelling methods or the path integral as in ref.. However, care should be taken, as we have found that relativistic corrections put constraints on the degree of diffusion even at low energy (J. Oppenheim and A. Russo, manuscript in preparation), and one should bear this in mind when drawing conclusions on the models presented here. 

In it was shown that there are two classes of CQ dynamics, at least in the sense that there are those with continuous trajectories in phase space and those which contain discrete jumps. For the class of continuous CQ models (see ref.  and Appendix section “Continuous master equation”), we know thatJ (x ,t ) should be described by a white noise process in time, and its statistics should be independent of the mass density of the particle. 

For the discrete class (see ref.  and J. Oppenheim, “The constraints of a continuous realisation of post-quantum-classical gravity", manuscript in preparation) and “Methods” subsection “Discrete master equation”),J (x ,t ) can involve higher order moments, and will generally be described by a jump process. Its statistics can also depend on the mass density, since in general the diffusion matrix (equation) couples to Lindblad operators. It is worth noting that the discrete CQ theories considered in generically suppress higher order moments, and often we expect that we can approximate the dynamics by a Gaussian process, but this need not be the case in general. 

The stochastic contribution to the Newtonian potential leads to observational consequences which can be used to experimentally test and constrain CQ theories of gravity for various choices of kernels appearing in the CQ master equation. One immediate consequence is that the variation in Newtonian potential leads to a variation of force experienced by a particle or composite mass via (equation). We can also estimate the time-averaged force via (equation) where ΔT is the time resolution over which the force is measured and is the useful quantity when compared with experiments. In the “Methods” subsection “Table-top experiments” we impose the constraintπ ≈ 0 in Eq. (40 ) and find that the variance of the magnitude of the time-averaged force experienced by a particle in a Newtonian potential is given by Eq. (146 ), (equation) where the variation is averaged over the time resolution ΔT. We will use this to estimate the variation in precision measurements of mass, such as modern versions of the Cavendish experiment for various choices of (equation). 

On the other hand, experimentally measured decoherence rates can be related toD0. The important point is that the decoherence rate is dominated by the background Newtonian potential Φ bdue to the Earth. In the “Methods” subsection “Decoherence rates”, we show that for a mass whose quantum state is a superposition of two states (equation) and (equation) of approximately orthogonal mass densitiesmL (x ),mR (x ), and whose separation we take to be larger than the correlation range ofD0 (x ,y ), the decoherence rate is given by (equation) 

Via the coupling constant trade-off, Eqs. (42 ) and (43 ) then give rise to a double-sided squeeze on the couplingD2. Equation (42 ) upper boundsD2 in terms of the uncertainty of acceleration measurements seen in gravitational torsion experiments, whilst the coupling constant trade-off Eq. (43 ) lower boundsD2 in terms of experimentally measured decoherence rates arising from interferometry experiments. 

We now show this for various choices of diffusion kernel, with the details given in the “Methods” subsection “Table-top experiments”. The bounds are summarised in Table1. The diffusion coupling strength will be characterised by the coupling constantD2 , which we take to be a dimension-full quantity with units kg sm, and is related to the rate of diffusion for the conjugate momenta of the Newtonian potential. We upper boundD2 by considering the variation of the time averaged acceleration (equation) for a composite massM which containsN atoms which we treat as spheres of constant densityρ with radiusr Nand massm N. We lower boundD2 via the coupling constant trade-off of Eq. (30 ) and then by considering bounds on the coherence time for composite particles with total massM λand which are made up ofN λconstituents, each with typical length scale when in superpositionR λand volumeV λ. 

For continuous dynamics 〈D2 (x ,y , Φ)〉 =D2 (x ,y , Φ) since the diffusion is not associated with any Lindblad operators. Let us now consider a very natural kernel, namelyD2 (x ,y ; Φ) =D2 (Φ)δ (x ,y ) which is both translation invariant, and does not create any correlations over space-like separated regions. We call dynamics which does not create correlations over space-like separated regions ultra-local since theories that are not of this form can still be non-signalling. This is a natural kernel from the point of view of constructing theories which are diffeomorphism invariant. We also label this model as being non-relativistic since it does not include various relativistic corrections to the diffusion. 

The decoherence rate for this kernel is found in the “Method” subsection “Decoherence rates” and follows immediately from Eq. (137 ). For a nucleon of massM λand wavepacket volumeV λ, it is (equation). In general, the squeeze will depend on the functional choice ofD2 (Φ) on the Newtonian potential. However, in the presence of a large background potential Φb , such as that of the Earth’s, we will often be able to approximateD2 (Φ) =D2 (Φb ). This is true for kernels that depend on Φ and ∇ Φ, though the approximation does not hold for all kernels, for exampleD2 ~ −∇Φ of Eq. (118 ) which creates diffusion only where there is mass density. For diffusion kernelsD2 (Φb ) where the background potential is dominant, we find the promised squeeze onD2 (Φb ) (equation) whereVb is the volume of space over which the background Newtonian potential is significant.Vb enters since the variation in acceleration is found to be (equation) where the (equation) integral is over all space. 

This immediately rules out continuous theories of Newtonian gravity with noise everywhere, i.e., with a diffusion coefficient independent of the Newtonian potential, since the integral will diverge. We consider the relativistic case elsewhere. 

Standard Cavendish-type classical torsion balance experiments measure accelerations of the order 10 m s over minutes ΔT ~ 10, so a very conservative bound isσa ~ 10 m s, whilst for a kg massN ~ 10 andr N~ 10 m. Conservatively taking (equation) whererE is the radius of the Earth andh is the atmospheric height givesD2 ≤ 10 kg sm. The decoherence rateλ is bounded by various experiments. Typically, the goal of such experiments is to witness interference patterns of molecules that are as massive as possible. Taking a conservative bound onλ , for example, that arising from the interferometry experiment of which saw coherence in large organic fullerene molecules with total massM λ= 10 kg over a timescale of 0.1s , gives an upper bound on the decoherence rateλ < 10 s. Fullerene molecules are made up ofN λ~ 10 particles with a typical atomic size 10 m. After passing through the slits the molecule becomes delocalised in the transverse direction on the order of 10 m before being detected. Since the interference effects are due to the superposition in the transversex direction, which is the direction of alignment of the gratings, it seems like a reasonable assumption to take the size of the wavepacket in the remainingy ,z direction to be the size of the fullerene, since we could imagine measuring they ,z directions without effecting the coherence. We, therefore, take the volumeV λ~ 101010m = 10 m, which givesD2 ≥ 10 kg sm, and suggests that classical–quantum theories of Newtonian gravity with ultra-local continuous noise are ruled out by experiment. 

On the other hand, the discrete models appear less constrained due to the suppression of the noise away from the mass density. For example consider the ultra-local discrete jumping models, such as the one given in the section “Discrete master equation” which have (equation) , where (equation) is the Planck mass and (equation) is the Planck length, required to ensureD2 has the units of kg sm. We find the squeeze onD2 (equation) and plugging in the numbers tells us that discrete theories of classical gravity are not ruled out by experiments and we find (equation). 

We can also consider other noise kernels, with examples and some discussion is given in the section “Examples of Kernels saturating the decoherence diffusion coupling constants trade-off”. A natural kernel is (equation). The inverse Lindbladian kernel satisfying the coupling constants trade-off is to zeroeth order in Φ(x ), the Diosi-Penrose kernel (equation). We here consider higher-order terms such as those coming from the relativistic theory and in particular the diffusion kernel of Eq. (118 ). For this choice of dynamics, we find the squeeze forD2 in terms of the variation in acceleration (equation) 

Using the same numbers as for the ultra-local continuous model, with (equation) we find that classical torsion experiments upper boundD2 by (equation) , whilst interferometry experiments boundD2 from below via (equation). 

Equations (44 ), (46 ) and (47 ) show that classical theories of gravity are squeezed by experiments from both ways. We have here been extremely conservative, and we anticipate that further analysis, as well as near-term experiments, can tighten the bounds by orders of magnitude. There are several proposals for table-top experiments to precisely measure gravity, some of which have recently been performed, and which could give rise to tighter upper bounds onD2. Some of these experiments involve millimeter-sized masses whose gravitational coupling is measured via torsional pendula, or rotating attractors. With such devices, the gravitational coupling between small masses can be measured while limiting the amount of other sources of noise. There are proposals for further mitigating the noise due to the environment, including inertial noise, gas particle collisions, photon scattering on the masses, and curvature fluctuations due to other sources. Other experiments are based on interference between masses; for example, atomic interferometers allow for the measurement of the curvature of space-time over a macroscopic superposition. 

We can get stronger lower bounds via improved coherence experiments. Typically, the goal of such experiments is to witness interference patterns of molecules that are as massive as possible, while here, we see that the experimental bound on CQ theories is generically obtained by maximising the coherence time for massive particles with as small wave-packet sizeV λ. 

Thus far we have considered local effects on particles due to diffusion. While this enables us to rule out some types of theories, the bounds are generally weak if one wants to rule out all of them. However, it may be possible to do so via cosmological considerations. In attempting to place experimental constraints on this diffusion, it is also worth considering other regimes, such as longer range effects which might be detected by gravitational wave detectors such as LIGO, or table-top interferometers. We leave a detailed study of the effect of gravitational diffusion on cosmological scales and LIGO to future work. It suffices to mention that the effect will again depend on the form of the kernel (equation). Our estimates (J. Oppenheim and Z. Weller-Davies, “Estimating space-time diffusion in interferometers", unpublished note) suggest that local effects from table-top experiments currently place a stronger bound on gravitational theories than LIGO currently does. In particular, unlike gravitational wave measurements, which are reasonably high-frequency events requiring extraordinarily high precision in the relative displacement of the arm length from its average, it is preferential to have a lower precision measurement, which occurs over a longer time period to allows for the diffusion in path length to build up, and with a smaller uncertainty in the average length of the arm itself. Furthermore, since the LIGO arm is kept in a vacuum, we do not expect strong bounds on discrete models where the diffusion is associated with an energy density. 

 A number of direct proposals to test the quantum nature of gravity are expected to come online in the next decade or two. These are based on the detection of entanglement between mesoscopic masses inside matter-wave interferometers. For these experiments, some theoretical assumptions are needed: one requires that it is only gravitons that travel between the two masses and mediate the creation of entanglement. If this is the case, then the onset of entanglement implies that gravity is not a classical field. These can be thought of as experiments that if successful, would confirm the quantum nature of gravity (although other alternatives to quantum theory are possible).

 Here, we come from the other direction, by supposing that gravity is instead classical, and then exploring the consequences. Theories in which gravity is fundamentally classical were thought to have been ruled out by various no-go theorems and conceptual difficulties. However, these no-go theorems are avoided if one allows for non-deterministic coupling as in. We have here proven that this feature is indeed necessary and made it quantitative by exploring the consequences of complete positivity on any dynamics that couples quantum and classical degrees of freedom. Complete positivity is required to ensure the probabilities of measurement outcomes remain positive throughout the dynamics. We have shown that any theory which preserves probabilities and treats one system classically is required to have fundamental decoherence of the quantum system, and diffusion in phase space, both of which are signatures of information loss. Using a CQ version of the Kramers–Moyal expansion, we have derived a trade-off between decoherence on the quantum system, and the system’s diffusion in phase space. The trade-off is expressed in terms of the strength of the back-reaction of the quantum system on the classical one. We have derived the trade-off both in terms of coupling constants of the theory and in terms of observational quantities that can be measured experimentally.

 In the case of gravity, the trade-off places a lower bound on the rate of diffusion of the gravitational degrees of freedom in terms of the decoherence rate of particles in superposition. We find that theories that treat gravity as fundamentally classical, are not ruled out by current experiments, however, we have been able to rule out a broad parameter space of Newtonian theories. This is done partly through table-top observations via Eqs. (44 ), (46 ) and (47 ). Given any diffusion kernel, we can compute the inaccuracy of mass measurements due to fluctuations in the gravitational field, and using the trade-off, we can derive a bound on the associated decoherence rate. This allows us to rule out broad classes of theories in terms of their diffusion kernel. For example, we are able to rule out a number of non-relativistic theories which back-react continuously in phase space.

 Any theory that treats gravity classically has fairly limited freedom to evade the effects of the trade-off. There is the freedom to choose the diffusion or decoherence kernels(equation)and(equation), but the trade-off restricts one in terms of the other. Then, because of the results proven in, one can consider two classes of theory, those which are continuous realisations and whose diffusion can only depend on the gravitational degrees of freedom, and discrete theories whose diffusion can also depend directly on the matter fields. Examples of both classes of the theory are given in the “Methods” subsection “Newtonian limit of CQ theory”. Finally, one could consider theories that do not reproduce the weak field limit of General Relativity to all distances, namely we could imagine that the interaction Hamiltonian of Eq. (36 ) does not hold to arbitrarily short distances, or arbitrarily high mass densities. This is reasonable since we do expect the Newtonian theory to break down at short distances where relativistic corrections at high energy affect the low-energy behaviour of the theory. One could also consider modifying(equation)in some other way, for example, by making it slightly non-local, or by disallowing arbitrarily high mass densities, or by including an additional contribution such as the friction term discussed in the continuous master equation. All of these modifications would seem to violate Lorentz invariance in some way, and likely lead to observational consequences.

 Here, we have only given an order of magnitude estimate of when gravitational diffusion will lead to appreciable deviations from Newtonian gravity. The most promising experiments bounding the diffusion appear to be table-top experiments which precisely measure the mass of an object. This is an area that is important from the perspective of weight standards, for example, those undertaken by NIST on the 1 kg mass standard K20 and K4. The increased precision and measuring time of Kibble Balances and atomic interferometers would make such measurements an ideal testing ground, both to further constrain the diffusion kernel and to look for diffusion effects, whose dependence on the test mass is outlined in the “Methods” subsection “Detecting gravitational diffusion”. Here, we have found that the resolution time ΔT over which variations of acceleration are estimated affects the strength of the bound, and it would be helpful if future experiments reported this value. Since we have found that CQ theories predict an uncertainty in mass measurements it is perhaps intriguing that different experiments to measure Newton’s constantG yield results whose relative uncertainty differs by as much as 5 × 10 m kg s, which is more than an order of magnitude larger than the average reported uncertainty. If one were to try and explain the discrepancy inG measurements via gravitational diffusion, then for all the kernels we studied in Section ’Physical constraints on the classicality of gravity’ we find that the variation in acceleration depends on(equation)the number of nucleons in the test mass, so that masses with smaller volume should yield larger uncertainty and this would be the effect to look for in measurement discrepancies. The relatively large uncertainty in such measurements, also makes it challenging for table-top experiments to place strong upper bounds on gravitational diffusion.

 Turning to the other side of the trade-off, improved decoherence times would further squeeze theories in which gravity remains classical. While a current experimental challenge is to demonstrate interference patterns using larger and larger mass particles, we here find the bounds in Eqs. (44 ) and (46 ) depend on the expectation of the particle’s mass density in ways that depend on the particular kernel. Thus interference experiments with particles of highmass density rather than mass can be preferable. There are also kernels, for which the relevant quantity is the expectation of the mass density or(equation), which will depend on both the particle’s massM λand volumeV λof the wave-packet used in the interference experiment, a quantity which is not always obtainable from many reports on such experiments. While this dependence might initially appear counter-intuitive, it follows from the fact that in order to relate the trade-off in terms of coupling constants to observational quantities, and in particular, the decoherence rate, we took expectation values of the relevant quantities to get a trade-off in terms of only averages. And indeed the decoherence rate, which is an expectation value, can easily depend on the wave-packet density, as we see from examples in the section “Decoherence rates”.

 Since we here show that all theories that treat gravity classically necessarily decohere the quantum system, another constraint on theories that treat gravity classically is given by constraints on fundamental decoherence. These are usually constrained by bounds on anomalous heating of the quantum system. However, these constraints are not in themselves very strong, since fundamental decoherence effects can be made arbitrarily weak. In the simplified model in the “Methods” subsection “Newtonian limit of CQ theory”, the strength of the decoherence depends on the strength of the gravitational field, thus, constraints due to heating can be suppressed, either by scaling the Lindbladian coupling constants or by having strong decoherence effects more pronounced near stronger gravitational fields such as near black holes where one expects information loss to occur. The necessity for decoherence to heat the quantum system is further weakened by the fact that the dynamics are not Markovian on the quantum fields, if one integrates out the classical degrees of freedom, space-time acts as a memory. This potentially captures some of the non-Markovian features advocated in ref. , who recognised that Markovianity is a key assumption in attempts to rule out fundamental decoherence or information loss. Here, however, we see that there is less freedom than one might imagine. If the Lindbladian coupling constants are made small to reduce direct heating, the gravitational diffusion must be large. Thus, heating constraints which place bounds on(equation)place additional constraints on(equation). In, it was found that for the Newtonian models of ref. , large(equation)creates secondary heating which further constrain the theory experimentally. The decoherence-diffusion trade-off implies that this is a general feature of all theories which treat gravity classically.

 While the absence of diffusion could rule out theories where gravity is fundamentally classical, the presence of such deviations, at least on short time scales, might not by itself be a confirmation of the classical nature of gravity. Such effects could instead be caused by quantum theories of gravity whose classical limit is effectively described by Oppenheim. In other words, one might expect some gravitational diffusion, because, from an effective theory point of view, one is in a regime where space-time is behaving classically. There are even claims that holographic effects could cause stochasticity in the gravitational field. However, the trade-off we have derived is a direct consequence of treating the background space-time as fundamentally classical. In a fully quantum theory of gravity, the interaction of the gravitational field with particles in a superposition of two trajectories will cause decoherence, but coherence can then be restored when the two trajectories converge. This is because the particle’s position is entangled with the gravitational field (or dressed by it), and this entanglement is erased when the different paths of the superposition converge. This is what happens when electrons interact with the electromagnetic field while passing through a diffraction grating, yet still form an interference pattern at the screen. This is a non-Markovian effect—the which-path superposition decoheres almost immediately, but this isfalse-decoherence so the amount of diffusion can be arbitrarily small and is unrelated to the coherence time of the superposition.

 On the other hand, the trade-off we derived is a direct consequence of the positivity condition, which is a direct consequence of the Markovian assumption. In the non-Markovian theory where General Relativity is treated classically, one still expects the master equation to take the form found in, but without the matrix whose elements are(equation)needing to be positive semi-definite at all times. It would therefore be surprising, if a quantum theory of gravity predicted anything close to the level of diffusion predicted by the decoherence-vs-diffusion trade-off, as there would be no need for diffusion to explain the coherence of superpositions. The regime in which the classical–quantum theory can be regarded as an effective one is taken up in ref. , both to address the issue of false decoherence, and also to explore the regime in which the classical–quantum theory may be a useful tool to understand the back-reaction of quantum matter in space–time, such as during black-hole evaporation, and during inflation. If we instead regard the theory as describing a fundamentally classical space-time, then it follows from the decoherence-diffusion trade-off, that the diffusion is either fundamental or its source is not describable within quantum or classical mechanics (J. Oppenheim, “Post-quantum soup", unpublished note).

In this section, we will introduce two forms of positivity conditions used to prove the decoherence diffusion trade-off. 

The first inequality we would like to introduce is (equation) which holds for any (equation) for which Eq. (48 ) is well defined: i.e., so that the distributional derivatives in Eq. (48 ) are well defined. 

We can derive the positivity condition (48 ) from the positivity of (equation) , which must be a positive semi-definite matrix inμν. More precisely, the eigenvalues of (equation) , which we denote by (equation) must be positive. They must be positive in the distributional sense, since we allow for the case that (equation) is a positive distribution, for example (equation). Hence we require (equation) is positive for any positive smearing function (equation). Since eachλ must be positive, we can also pick a different smearing function for eachμ , so that (equation) should be positive for any vector (equation) with all positive entries. We can then write the matrix (equation) in terms of its eigenvalues (equation). 

We can then see the positivity of Eq. (48 ) directly since (equation) which is positive as a consequence of Eq. (50 ). 

As a consequence of Eq. (48 ) being positive, we also know that (equation) will be positive for any vector of operators (potentially phase space dependent) (equation). This follows from the cyclicity of the trace and the fact that (equation) will be a positive operator so long as Eq. (48 ) holds. A common choice ofO μwould be the Lindblad operatorL μappearing in the master equation. 

The inequality in Eq. (48 ) proves useful to derive positivity conditions on the coupling constants appearing in the master equation, whilst Eq. (53 ) is useful in deriving the observational trade-off for the continuous master equation as we shall now discuss. 

We can get a general trade-off between the decoherence and diffusion coefficients which appear in the master equation, arriving at a trade-off between the decoherence and diffusion coefficients in terms of the back-reaction drift coefficient (equation). 

Consider Eq. (48 ), and choose (equation). By integrating parts over the phase space degrees of freedom, we find (equation) 

Takingi ∈ {1, …,n }α ∈ {1, …,p } andμ ∈ {1, …,p + 1}, we can write this as a matrix positivity condition (equation) whereD2 is the (p + 1)n × (p + 1)n matrix with elements (equation) is the (p + 1)n ×p matrix with rows labelled byμi and columns labelled byβ with elements (equation) andD0 is thep ×p decoherence matrix with elements (equation). (equation) describes the quantum back-reacting components of the drift. Equation (55 ) is equivalent to the condition that the (equation) matrix (equation) Since we knowD2 andD0 must be positive semi-definite, we know from Schur decomposition that (equation) and (equation) , whereD0 is the generalised inverse ofD0. Furthermore, ifD0 vanishes, then clearly (equation) must also vanish in order for (56 ) to be positive semi-definite. 

In this section, we describe CQ dynamics in the case where the Lindblad operators and the phase-space degrees of freedom can have spatial dependencez (x ),L μ(x ). 

For the case of fields, operatorsO (x ) constructed out of local fieldsϕ (x ) will in general be unbounded and hence the Stinespring dilation theorem does not hold. This problem is a common one in the study of algebraic quantum field theory and we can get around it by considering the case in which operators of interest are obtained by smearing the local fields over bounded functionalsF. For example, we can first smear the local field fields over a smearing functionf ,ϕf = ∫dxϕ (x )f (x ) and then consider bounded functions ofϕf such as (equation). In doing this we can write a CQ version of the Stinespring dilation theorem exactly and proceed along the lines of Oppenheim to show that any completely positive CQ map can be written in the form (equation) where the positivity condition states (equation). 

We shall assume that we deal with dynamics which can be written in Lindblad form, as is usually assumed in the unbounded case. 

Just as in the section “The CQ Kramers–Moyal expansion”, we can formally introduce the moments of the transition amplitude (equation) which we assume to exist; which might involve a smearing of the operatorsz (x ). Defining (equation) , we can define the coefficients (equation) implicitly via (equation) 

The characteristic function then takes the form (equation) and expanding out the exponential this takes the form (equation) performing the inverse Fourier transform, allows us to write the transition amplitude in terms of functional derivatives of the delta function (equation) and we can use this to write a CQ master equation in the form (equation) 

Since we are interested in studying dynamics with local back-reaction, we shall hereby take (equation). By the decoherence diffusion trade-off, which we derive in the next subsection, this also means that the diffusion matrix (equation) is lower bounded by the matrix (equation). This can be seen more precisely, by taking Eq. (59 ) with (equation) and applying the same methods as in the subsection “Trade-off between diffusion and decoherence couplings in the presence of fields”. Without loss of generality we thus takeD2 (z ,w1 ,w2 ,x ,y ) =D2 (z ,x ,y )δ (x ,w1 )δ (y ,w2 ). 

In the field-theoretic case, the positivity condition is given by Eq. (59 ) and we can find a trade-off between decoherence and diffusion by considering (equation). So that (equation) where we use the shorthand notation (equation) and similarly (equation). 

Takingi ∈ {1, …,n }α ∈ {1, …,p } andμ ∈ {1, …,p + 1}, we can write this as a matrix positivity condition (equation) whereD2 (x ,y ) is the (p + 1)n × (p + 1)n matrix-kernel with elements (equation) is the (p + 1)n ×p matrix-kernel with rows labelled byμi and columns labelled byβ with elements (equation) andD0 (x ,y ) is thep ×p decoherence matrix-kernel with elements (equation). (equation) describes the quantum back-reacting components of the drift. 

Equation (67 ) is equivalent to the condition that the (equation) matrix of operators (equation) be positive semi-definite. Here we are viewing the objects of Eq. (68 ) as matrix-kernels, so that for any position-dependent vector (equation). 

Since we knowD2 andD0 must be positive semi-definite, we know from Schur decomposition that (equation) and (equation) where (equation) is the generalised inverse ofD0. Furthermore, from Equation (70 ), we see ifD0 vanishes, then clearly (equation) must also vanish in order for (68 ) to be positive semi-definite. 

We can use the same methods to arrive at an observational trade-off using the field-theoretic version of the Cauchy–Schwartz inequality in Eq. (18 ). This arises from the positivity of (equation) for any local vector of CQ operators (equation). We have to be careful, since (71 ) is not in general well defined sinceO μmay not be trace-class. We hence assume that we consider statesρ (z ) and operators (equation) for which Eq. (71 ) is well defined. Since we are interested in getting an observational trade-off we expect this to always be the case for physical classical–quantum statesρ (z ). 

We shall use Eq. (71 ) to arrive at a (pseudo) inner product on a vector of operatorsO μvia (equation) where (equation) due to Eq. (71 ). Technically this is not positive definite, but again, this will not worry us. Hence, so long as (equation) , which holds due to the CQ inequality derived in the derivation of the Pawula theorem, we again have a Cauchy–Schwartz inequality (equation). 

Choosing (equation) and (equation) , one finds (equation)  (equation)  (equation) 

Taking the limit (equation) , we arrive at a local trade-off between diffusion, drift and total decoherence. In particular, using (74), the definitions of the expectation values of couplings defined in Eq. (33 ) and the fact that for back-reaction the expectation value ofD0 cannot vanish, we arrive at the observational trade-off of Eq. (34 ) (equation) which we write in matrix form as (equation) 

It then follows directly from Eq. (76 ) that when the back-reaction is sourced by either (equation) or (equation) components we can arrive at the observational trade-off in terms of the total drift (equation) where in Eq. (77 ) recall that the definition of (equation) is given by Eq. (35 ) in the main body. 

It is also useful to note that one can arrive at a spatially averaged observational trade-off which can be used to bound all of the elements of the diffusion matrix, not just its diagonals. Specifically, taking Eq. (74) withb (x ) =b a constant, we arrive at the trade-off (equation) where we define the expectation matrix (equation). 

For the Newtonian limit discussed in the main body this bounds the diffusion in terms of the total mass of the particle (equation) 

We can also arrive at a trade-off in terms of the effective Newtonian potential sourced by the masses by taking (equation). In this case, we find the trade-off (equation) which for the Newtonian limit gives a trade-off between the diffusion matrix and the effective Newtonian potential of the particle as sourced by its expectation value (equation) where we have defined the effective Newtonian potential as (equation). 

In this section we motivate the Newtonian limit of gravity used in Section ’Physical constraints on the classicality of gravity’. A fuller treatment can be found in. We begin with classical General Relativity in the ADM formulation. To derive the Hamiltonian, we start from the 3+1 split of the four metric (equation) in which case, denotingϕm ,πm as canonical variables for the matter degrees of freedom, we can write the action for minimally coupled matter (equation) where we are ignoring the boundary contributions to the action. Here, (equation)  (equation) are the Hamiltonian and momentum constraints andπ is defined in terms of the extrinsic curvature tensor of constantt surfaces,K i  j, via (equation). 

It is useful to note that the matter densities (equation) can be related to the matter stress-energyT via (equation)  (equation). 

We here take the Newtonian limit of the gravitational field to be given by (equation) with Φ(x ) corresponding to the Newtonian potential. The choice of (equation) , is to ensure thatπΦ is canonically conjugate to Φ. A more detailed derivation starts from the full weak field metric, and gauge fixing of the shift can be found in. Here, we find the effective action can be written (equation) where the Newtonian Hamiltonian is given by (equation) with (equation) the pure gravity Hamiltonian, and (equation) is the interaction Hamiltonian, from which we see that non-relativistic matter couples to the Newtonian potential through its mass densitym (x ). In the case where we have the state of matter being described by a point particleδ (x −x (t )) of massm the pure matter Hamiltonian would be (equation) 

The equations of motion for the gravitational degrees of freedom reads (equation)  (equation) which, forπΦ = 0 yields the Newtonian solution for a stationary mass density. In a Louivile formulation the dynamics for the densityρ (Φ,πΦ ,x ,p i) is given by (equation) where the Hamiltonian and momentum constraints tell us thatρ (Φ,πΦ ,x ,p i) should only have support over phase space degrees of freedom which satisfy the constraintπΦρ (Φ,πΦ ) = 0. From Eq. (97 ) we can identify the classical drift associated to the back-reaction of the matter on the gravitational field from the (equation) term, so that (equation). 

In the classical-quantum case, we promotem (x ) to an operator (equation). In this case Eq. (93 ) is the interaction Hamiltonian used in ref.  to study CQ gravity. We see from Eq. (97 ) that in any theory whose first moment reproduces the Newtonian back-reaction on average (equation) must have a (equation) given by (equation) from which the discussion at the beginning of the section “Physical constraints on the classicality of gravity” follows. 

Note that the present discussion is insensitive to the details of the theory provided it satisfies Poisson’s equation on average. Nonetheless, it’s interesting that when starting from the relativistic theories of refs. , we find that the weak field limit resembles the models of Tilloy and Di´osi, which is discontinuous in Φ, rather than the continuous model of Di´osi. This is because allows for non-zero conjugate momentumπΦ with the kinetic energy of a different sign, while in ref. , the momentum is set to zero via the constraint equations and gauge fixing of the lapse. The discontinuity then arises because we are operating in thec →∞ limit, while in ref. , the discontinuity arises due to sourcing the Newtonian potential via a weak measurement process. We refer the reader to ref.  for details. 

Although the trade-off we derive does not depend on the particulars of the classical–quantum theory (provided it reproduces Newtonian gravity in the classical limit), we give two concrete examples for completeness. In ref.  we show that there are two classes of classical-quantum dynamics, one which is continuous in phase space, and one which has discrete jumps in phase space. We will give examples of each. Although they are the weak field limit of Oppenheim, it is worth stressing that taking the Newtonian limit entails certain coordinate choices and restrictions on the metric. For example, here, we have restricted ourselves to metrics of the form of Eq. (89 ). Any gauge fixing of General Relativity which is done before deriving the master equation, is generally not equivalent to taking the master equations of Oppenheim, and then taking the appropriate limit. 

For the class of master equations with continuous back-reaction, specifying that the first moment on average satisfies Eq. (100 ) is enough (up to drift terms which vanish under trace) to ensure the master Equation includes a term (equation) whereHc is the purely classical gravity Hamiltonian. We have taken the dynamics, i.e., the drift to be local inx , while we allow for the decoherence and diffusion terms to have some range. In this case, the evolution law is still local but correlations can be created. One can also add extra diffusion and decoherence into Eq. (101 ) which we do not consider here since it only leads to worse experimental bounds. However, adding additional diffusion in Φ will generally be required in order to impose the constraintπΦ ≈ 0. This master equation is close to the one considered in ref. , where the decoherence and diffusion kernels are chosen to be the ones discussed in the second example of Examples of Kernels saturating the decoherence diffusion coupling constants trade-off. This is the weak field limit of the simplest realisation in ref.. The case where the diffusion is spatially uncorrelated (equation) a regulator which approaches a scalar delta function corresponds to the Newtonian limit of the diffusion term (equation). Another natural diffusion kernel is (equation) , which can be understood as the Newtonian limit of the spatial diffeomorphism invariant kernel discussed in the section “Diffeomorphism invariant kernel”. 

One can supplement the kernel by some mechanism to control the diffusion. For example, a friction term such as (equation) 

In the weak field limit, this would add a term proportional to (equation) to the master equation of Eq. (101 ). Such a term would break Lorentz invariance since it sets a temperature scale, although this is not necessarily a deal breaker, since it is believed by many that quantum gravity is also likely to also have an anomaly. However, the friction term is a modification toD1 (x ), and if too large, could run afoul of precision tests of General Relativity, such as the orbital decay of binary pulsars. 

An example of a discrete master equation satisfying Eq. (100 ) is (equation) withτ a dimensionless constant, and (equation). We have here includedℏ andc to make it easier to compare with experiments. To leading order, we could drop terms proportional to Φ(x )/c in both the exponential and in (equation) inside the integral overx. This gives (equation) 

These dynamical equations are supplemented with modified constraint equations as outlined in ref.. In any case, the trade-off in Eq. (31 ) is a statement independent of constraints and constraint preservation, at least in the weak field limit. 

In this section, we give examples of kernels satisfying the decoherence diffusion coupling constant trade-off in Eq. (23 ). For any choice of kernel, we can compute the degree of diffusion it induces in precision mass measurements (see the section “Detecting gravitational diffusion”) and decoherence experiments (see the section “Decoherence rates”) which allows us to rule out certain kernels experimentally. Diffeomorphism invariance may single out having bothD0 (x ,y ) andD2 (x ,y ) approach delta functions at short distances, but other alternatives may be possible. 

As a first example, we shall take the Lindbladian coupling to be Gaussian, taking (equation) where (equation) is a normalised Gaussian distribution. The massm0 is a reference mass, and we shall take it equal to the mass of the nucleons which were considered in the section “Physical constraints on the classicality of gravity”, meanwhileλ is a coupling constant that determines the strength of the Lindbladian. 

It should be noted that with this choice of smearing function, the pure Lindbladian evolution appearing in Eq. (101 ) can be taken to resemble the Lindbladian part of spontaneous collapse models, except here, there is no need to think about any ad-hoc field, nor think of the collapse as being a physical process. Rather, one necessarily gets decoherence of the wave function for free, via gravitationally induced decoherenc. 

We now find the diffusion kernelD2 (x ,y ) using the coupling constants trade-off in (23 ). For simplicity, we shall assume the trade-off is saturated, and we will take the back-reaction to be local, so that (equation). In this case we find (equation) where (equation) is the kernel inverse of a normalised Gaussian distribution. 

It is shown in ref. , that the inverse distribution takes the form (equation) where (equation) and the limitN →∞ is taken. In Eq. (109 ) (equation) andd is the spatial dimension, so thatx = (x1 ,x2 , …,x d). 

In total then, we arrive at the expression for theD2 which saturates the bound (equation) 

If we further take the back-reaction that of the Newtonian limit in the section “Newtonian limit of CQ theory” (equation) then we find theD2 which saturates the bound is (equation) 

Another example of a Lindbladian coupling which is familiar in the literature is, (equation) 

For a single Lindblad operator, this is the coupling introduced in used to reproduce a CQ master equation of gravity with a decoherence rate given by the Diosi–Penrose formula. Here we consider the special case where thex ,y dependence ofD0 (x ,y ) is the same for allα ,β which need not hold in general. The fact that it gives the same decoherence rate as Diosi–Penrose can be seen by plugging Eq. (112 ) into the classical-quantum master equation in Eq. (101 ). 

To invert the kernel in Eq. (112 ) we use the fact that (equation) from which one can immediately read of the generalised inverse (equation) to be (equation) where (equation) are the matrix elements of the generalised inverse ofD0. As a consequence, we find for this specific choice of kernel that the diffusion matrix saturating the coupling constants bound in Eq. (31 ) is (equation) where we have also assumed the back-reaction is local. Taking the back-reaction to further be that of the Newtonian limit of Eq. (101 ) (equation) we find (equation) 

This diffusion kernel is argued for on the grounds of having the fluctuations satisfy a Poisson equation, in ref.. 

Attempts to derive the constraint algebra of a generally covariant CQ theory (and J. Oppenheim, “The constraints of a continuous realisation of post-quantum-classical gravity", manuscript in preparation), motivates the spatial diffeomorphism invariant kernel (equation) where Δ xis the Laplace–Beltrami operator. One can also consider the full 3 + 1 kernel, via (equation) along with the associated Green’s function of Δ but this is irrelevant for the Newtonian limit. It is however useful in removing the apparent asymmetry in the expressions below, since one must recall that the (equation) is a scalar in the first coordinate and a tensor density in the second, and likewise (equation) has an implicit lapse (equation) in the second position. This kernel’s weak field limit is (equation) which is close to that of Eq. (116 ), but with a correction term that turns out to be important. 

Using (equation) , the Lindbladian kernel in dimensiond which saturates the trade-off for this diffusion kernel is (equation) with (equation) the Green’s function for −Δ. It is a density in the (equation) coordinate and a scalar inx. In the weak field limit, and to 0th order in Φ(x ), this gives the Diosi–Penrose kernel, Eq. (112 ). 

One could also consider the kernel (equation) which in the weak field limit is (equation) 

The kernel examples given above give rise to divergent variance in the classical degrees of freedom, since in both cases the diffusion coefficient diverges when evaluated at the same pointD2 (x ,x ). Though we do not have a general proof, this seems to be a general feature of the coupling constant trade-off: for the examples where we can compute the kernel inverse, at least one ofD2 (x ,x ) andD0 (x ,x ) diverge. A divergentD2 (x ,x ) generally leads to a formally divergent classical energy production, whilst a divergent Lindbladian couplingD0 (x ,x ) can lead to a divergent energy production in the matter degrees of freedom. The latter is related to the BPS problem of anomalous heating, although it isn’t necessarily equivalent since some kernels may diverge and be well-behaved from the point of view of energy production. This is not an issue from a conceptual point of view, since the only reason we expect energy to be conserved is due to Noether’s theorem, and Noether’s theorem doesn’t apply when the evolution isn’t unitary. 

In the standard BPS problem, energy production in open quantum field theory can be made small by renormalizing the Lindbladian coefficientD0 (x ,y ) appearing in the master equation. Thus the problem is merely one akin to the hierarchy problem, where we are required to introduce another energy scale. However, in the case of classical–quantum coupling, the coupling constant trade-off tells us that we cannot re-normaliseD0 (x ,y ) without affectingD2 (x ,y ). In particular, tuning the diagonalsD0 (x ,x ) to be arbitrarily small (large) has the effect of tuningD2 (x ,x ) to be arbitrarily (large) small: heuristically, one trades energy production in the classical system with energy production in the quantum system, and the relationship is fixed by the trade-off. On expectation, the total energy could be preserved, and the back-reaction can even slow down the flow of energy, but it’s unclear if this is enough. 

However, it is worth noting that while (equation) may appear to diverge at a single point as (equation) , when integrated over test functions, (equation) is usually well-behaved. The kernels discussed above have this property. When it comes to physically relevant quantities, such as measuring the gravitational diffusion in tabletop experiments, it is the smeared well-behaved quantity that is physically relevant. However, in cosmology, we typically take the constraint equation of General Relativity to be exactly satisfied at each point, and so one might imagine that (equation) , and henceD2 (x ,x ) is the relevant quantity (see the discussion in the section “Detecting gravitational diffusion”). However, one can setπΦ ≈ 0 via a gauge freedom. In GR, the counterpart to the (equation) kinetic term isG i  j  k  l ππ (x ), and it’s perhaps worth noting that this quantity is not positive definite. It is also important to note that here, we have taken the weak field andc →∞ limit of General Relativity. At short distances when the diffusion becomes large, we expect this approximation to break down. One possible method of studying this problem rigorously would be through the regularisation properties of the classical-quantum path integral which we introduce in. 

In this section, we relate decoherence rates toD0 , and also to the average (equation). In particular, we shall show that the decoherence rate of a mass in superposition, is given by Eq. (131 ) in terms of the Lindblad operators and (equation) , and can be related to the quantity 〈D0 〉. 

We consider the case of a quantum mass initially in a partially decohered superposition of state (equation) and (equation). We describe the quantum state using creation and annihilation operatorsψ (x ),ψ (x ) on a Fock space, related to the usual momentum-based Fock operators as (equation). The mass density operator is defined via (equation) , wherem is the mass of the particle. We assume that the state remains well approximated by a state with fixed particle number, and the superposition can be taken to be distributions centred aroundx =xL andx =xR with total massM , i.e., for a one-particle state we could take (equation). We will take them to be well separated so thatfL (x )fR (x ) ≈ 0, and we take the separation distance to be larger than the scale of the non-locality inD0 (x ,y ). Mathematically this means that (equation) for any local operatorsL α(x ) andL β(y ). 

With this orthogonality condition, we can then (at least initially) consider the joint quantum classical state restricted to the two-dimensional Hilbert space of these two states so that the total quantum-classical system can be written as (equation) whereuL (Φ,πΦ ,t ) anduR (Φ,πΦ ,t ) correspond to some subnormalised probability distribution over the classical states of the gravitational field. 

We define the total quantum stateρQ by integrating over the classical degrees of freedom (equation) and we shall relate 〈D0 〉 appearing in the trade-off to the decoherence rate of the off diagonals ofρQ. Integrating over the classical phase space in Eq. (9 ), one finds the following expression for the evolution ofρQ (equation) 

In particular, one finds that the off-diagonals (equation) evolve in part according to the commutator, and in part due to the Lindbladian term (equation) 

Care must be taken however, because both the quantum Hamiltonian and the Lindbladian coupling constants depend on the classical degrees of freedom which are affected by the quantum degrees of freedom, and thus the evolution of the quantum system is non-Markovian in general. 

We shall now study the two terms appearing in Eq. (125 ) separately, starting with the first term. Since we assume that the state is well approximated by a state with fixed particle number then the contributions to the first term in Eq. (125 ) only come from terms whereL α(x ) andL β(y ) have the same number of creation and annihilation operators. To compute the expression, one commutes through the creation operators to act on the (equation) bra, and picks up a termfL (x ). Similarly, one commutes the annihilation operators to the act on the (equation) ket, and picks up a termfR (y ). As a consequence (equation) where the last equality follows from the fact that we are taking the masses to be well separated and the range ofD0 (x ,y ) is assumed to be much less than the separation between the masses. 

Hence, the evolution of the off-diagonals comes from the (off-diagonals) of the unitary evolution and the second term in Eq. (125 ), the so-called no-event term. The off-diagonals of the no-event term is (equation) which is negative definite and acts to exponentially suppress the coherence. To see this, note that expanding outϱ (Φ,πΦ ,t ) in terms of the approximate 2 dimensional Hilbert space (equation) and using the fact that the range ofD0 (x ,y ) is much less than the separation between the left and right masses, we can write the off-diagonals of the no-event term as (equation) 

Equation (129 ) already expresses the fact that the off-diagonal terms will decay, and the particle will decohere at a rate determined by the integrand of Eq. (129 ). 

We can go slightly further when in the presence of a background Newtonian potential which is dominant, such as the Earth’s Φb. The Earth’s background potential dominates over small fluctuations in Φ due to the particles and we can approximate Eq. (129 ) by (equation) where the coupling (equation) depends on the background Newtonian potential, but is otherwise phase-space independent. The result is to exponentially decrease the coherence 〈L ∣ρQ ∣R 〉 with a rateλ determined by (equation) 

Let us now show that the 〈D0 〉 term appearing in the trade-off (34 ) is always less than (twice) this decoherence rate when in the presence of a background potential. Specifically, we show that (equation) where we assume that we are in the presence of a background potential. To see this, we first expand out the CQ state in terms of Eq. (128 ) and use the fact thatD0 has a range less than the separation of the masses. We then arrive at the following expression for the left-hand side of Eq. (132 ) (equation) 

In the presence of a background potential, this dominates the contribution to the decoherence and we are left with (equation) 

Due to the positivity of the CQ density matrix 〈L ∣ρQ ∣L 〉 and 〈R ∣ρQ ∣R 〉 must both be positive. Furthermore, they must sum to one due to normalisation, from which Eq. (131 ) directly follows. 

It is also important to note that thoughλ is the decoherence rate of a particle in superposition ofL /R states, the bound (132 ) holds even for fully decohered masses in any mixture of (equation) states. This can be seen directly from (133 ) which depends only onuL ,uR. 

In this section, we give an explicit example of a decoherence rate calculation. Importantly, we see that in general, the decoherence rate can depend on the probability density. This suggests that the terms appearing in the trade-off relation will need to depend on expectation values such as the expectation value of the mass at a pointx , rather than a stronger bound in terms of the mass density. This is perhaps not surprising, since the decoherence rate itself can be thought of as an expectation value, being related to the average time it takes for off-diagonal elements to decay. In conclusion, this motivates us to advocate for the volume of the wave packet to be included in the figure of merit in future interference experiments. 

We take the Newtonian limit master equation defined by Eq. (101 ). We ignore the unitary part of the evolution, since it will not directly contribute to the decoherence rate, and can be small for a free particle in superposition. From Eq. (101 ) we find the relevant evolution for the quantum stateρQ , obtained by integrating over the classical degrees of freedom to be (equation) 

We now compute the off-diagonal elements for a particle in superposition of orthogonal (equation) states (equation) where (equation) and similarly for the right state. We see that the off-diagonals decay exponentially with a rate determined by (equation) 

In the main body, and the previous subsection, we have assumed that the superposition of the particle is much less than the typical scale ofD0 (x ,y ). In this example, this means that we take the particles sufficiently separated so that we can approximateD0 (x ,y )mL (x )mR (y ) ≈ 0, in which case Eq. (137 ) is precisely the decoherence rate calculated in Eq. (131 ) with (equation) , as is to be expected. 

The natural decoherence kernel from the point of view of diffeomorphism invariance isD0 (x ,y ) =D0δ (x ,y ), in which case for a particle of massM , and uniform wave-packet volumeV , Eq. (137 ) givesλ = 2D0M /V. 

As another example, we can take (equation) to be the Diosi–Penrose decoherence kernel defined via (equation) , so that the off-diagonals decay exponentially with a rate proportional to the Diosi–Penrose decoherence rate (equation) 

In this example, taking the superposition to be sufficiently separated means that we are approximating (equation) in comparison with the rest of the terms appearing in Eq. (138 ). We are then left with (equation) which for spherical distributions of radiusR and total massM is proportional to the average gravitational self-energy of each mass distribution (equation). 

For a composite particle of massM , made up ofN constituents each of radiusR , the mass density will be represented by a sum over all of the particlesm (x ) = ∑ i m i(x ). The decoherence rate is given by (equation) 

Since the cross terms involvingi ,j are suppressed by a factor of inter-atomic scales, to leading order the contribution to the decoherence rate is lower bounded by thei =j component of the sums in Eq. (140 ), which gives an extra factor ofN relative to the single particle case (equation). 

Both Eqs. (138 ) and (139 ) depend on the probability density of the mass. In particular, taking the probability density to be arbitrarily peaked, one finds that the decoherence rate also diverges. This has to be the case: recall from the section “A Trade-off between decoherence and diffusion” that if one considers a particle in a superposition of two arbitrarily peaked probability densities, then there can be an arbitrarily large response in the Newtonian potential around those points. As a consequence, for such states, the decoherence must occur arbitrarily fast, or there must be an arbitrarily large amount of diffusion to cover up the back-reaction and maintain coherence. For the continuous master equation, such as that of Eq. (101 ) this diffusion must also occur throughout space, although it can depend on the gravitational degrees of freedom. Since divergent energy production throughout space is clearly unphysical, it must be the case that the decoherence rate must also depend on the expected mass density, as is the case for this example. This argument allows us to rule out continuous master equations that have pure Lindbladian terms that predict decoherence rates which remain finite as the mass density becomes arbitrarily peaked since the coupling constant trade-off will demand that an infinite amount of diffusion is required to cover up the back-reaction and maintain coherence. This is the case for the class of models with CSL-type Lindbladian couplings which are phase space independent, for example in Eq. (106 ). 

In this section, we show how the diffusion induced on the Newtonian potential can be measured experimentally. metric leads to observable effects, such as variations in the accelerations involved in torsion experiments and stochastic wave production in cosmology. As shown in the main body of the text, in the non-relativistic limit,c →∞ , the CQ dynamics can be approximated by sourcing the Newtonian potential by a random mass term, and in order to maintain the coherence of any mass is superposition, there must be noise in the Newtonian potential such that we cannot tell which element of the superposition the particle will be in (equation) with (equation) where (equation) andρ is the quantum state for the decohered mass density. The diffusion coefficient in Eq. (142 ) is chosen in order for the dynamics to have the same moments as the CQ master equation (4 ). The solution to Eq. (141 ), having absorbedu intoJ is given by (equation) where the statistics ofJ are described by Eq. (142 ). A formal treatment of solutions to non-linear stochastic integrals of the form Eq. (141 ) can be found in ref.. 

One can also verify this behaviour in specific cases. In the continuous model of the section “Continuous master equation”, the noise is taken to be Gaussian, and this, as well as the evolution of the quantum state, is what determines the diffusion in Eq. (143 ). For the class of discrete models, the higher order moments such as (equation) are suppressed by an order parameter and whenever this is true we expect we can approximate the dynamics of the Newtonian potential by a Gaussian process. Whether this is the case or not, it is the second-order moment that enters into our discussion of the variance here. As such, for minimally coupled theories, the Newtonian potential will appear to be sourced by a random mass distribution. 

In the discrete case, a precise understanding of the effects of the diffusion beyond the Gaussian approximation involves solving the full classical-quantum dynamics, perhaps using the methods of Oppenheim et al.. In Eq. (141 ) we are also taking the time scale of the diffusion to be faster than the dynamics of the matter distribution. Likewise for the decoherence—we showed in the “Methods” subsection “Decoherence rates” for continuous models the evolution of the quantum state acts to decohere it into a mass density eigenbasism (x ). One could of course also include the quantum state evolution in a simulation of full CQ dynamics, but this is beyond the scope of the current work. 

Note that if the moments of the noise process are Galilean invariant, then the theory given by Eq. (141 ) is Galilean invariant as we would expect in the Newtonian limit. One can further derive Eq. (141 ) from manifestly diffeomorphism invariant theories, such as those of refs.. 

In this section we estimate the variation in force which would be seen in table-top experiments which bounds the diffusion of classical theories of gravity from above, giving a squeezed bound onD2 due to lower bounds on diffusion arising from coherence experiments. We do this for dynamics in Eq. (141 ), but the methodology is general and could also be used in a full simulation of CQ dynamics. 

The variation in force induced on a composite mass is found via (equation) 

Using the solution in Eq. (143 ), the total force can be written (equation) 

In reality, we measure time-averaged force by measuring time-averaged accelerations over the time resolution of the experiment (equation). The total variation in the force’s time-averaged magnitude. The full covariance matrix for various kernels in the Newtonian limit is given in (J. Oppenheim and A. Russo, manuscript in preparation), (equation) can be written as (equation) 

We shall use Eq. (146 ) to provide an upper bound on coupling constants of CQ theories for different choices of kernels (equation). Given a choice of functional form of the kernel, all that remains is the strength of the diffusion coupling, which for the translation invariant kernels we consider here takes the form of a single coupling constantD2. We takeD2 to be a dimension-full quantity with units kg sm which characterises the rate of diffusion for the conjugate momenta of the Newtonian potential. 

For a composite mass, we can approximate the mass density by summing overN individual atoms of mass densitym i(x ),m (x ) = ∑ i m i(x ). The total force is the given by (equation) , where (equation) is the force on each individual atom (equation) , and the total variation of force is then (equation). 

In general, the squeeze will depend on the functional choice ofD2 (x ,y , Φ) on the Newtonian potential. As mentioned in the main body, in the presence of a large background potential Φb , such as that of the Earth’s, we will often be able to approximateD2 (x ,y , Φ) =D2 (x ,y , Φb ). This is true for the kernels with functional dependence of the formD2 ~ Φ,D2 ~ ∇ Φ, though the approximation does not hold for all kernels, for example,D2 ~ ∇Φ which creates diffusion only where there is the mass density. We hereby shall only consider diffusion kernelsD2 (x ,y , Φb ) where the background potential is dominant, leaving more general considerations for future work. 

For local translation invariant dynamics for which the background Newtonian potential is dominant, for example,D2 ~ Φ, we have 〈D2 (x ,y , Φb )〉 = 〈D2 (Φb )〉δ (x ,y ) and we arrive at the expression for the total variation in time-averaged force (equation). 

To leading order, the integral in Eq. (147 ) is dominated by the self variation term wherei =j , since nuclear scales 10 m dominate over inter-atomic scales 10 m, so that (equation). Approximating the mass density of the atoms as coming from their nucleus, and taking them to be spheres of constant densityρ with radiusr Nand massm N, we find that the integral in Eq. (147 ) is approximately (equation) 

For the class of continuous dynamics 〈D2 (Φb )〉 =D2 (Φb ), since the diffusion is not associated with any Lindblad operators. If there is noise everywhere throughout space, then the integral in Eq. (148 ) diverges and gives evidence that continuous CQ theories with noise everywhere should be ruled out. 

As such, we expect that continuous CQ theory must contain non-linear terms proportional to the Newtonian potential appearing in Eq. (141 ), in which case we can approximate (equation) byVbD2 whereVb is the volume of the region over which the background Newtonian potential is significant. In total then, we find for continuous local CQ dynamics (equation) 

From this, we can calculateD2 in terms of the total variance of the acceleration (equation) to get a lower bound (equation) 

Standard Cavendish type classical torsion experiments measure accelerations of the order 10 m s, and we can take the time over which the acceleration is averaged to be that of minutes ΔT ~ 10 s, so a very conservative bound isσa ~ 10 m s, whilstN will beN ~ 10 andr N~ 10 m. We take the background Newtonian potential to be that of the Earth and we (conservatively) takeVb to be (equation) whererE is the Earth’s radius andh is the atmospheric height. We see that this boundsD2 from above byD2 ≤ 10 kg sm. 

On the other hand,D2 is bounded from below from interferometry experiments which bound the decoherence rate. From Eq. (137 ) and the coupling constant trade-off, for the kernelD2 (x ,y ) =D2δ (x ,y ) we see (ignoring constant factors) that the decoherence rate is found to be (equation) whereM λis the mass of a composite particle in the interferometry experiment, which is made up ofN λparticles, each with volumeV λ. This gives rise to the squeeze (equation) 

Using the numbers from ref. , withM λ~ 10 kg,N λ~ 10, andV λ~ 101010 m = 10 m,λ ~ 10 s we find thatD2 ≥ 10 kg sm. This suggests that theD2 (x ,y ) =D2δ (x ,y ) kernel for classical gravity is already ruled out by experiment. 

For the local discrete models, such as that of Eq. (104 ), the theory is less constrained due to the dependence of the diffusion on the mass density. In this case (equation) , where the factors of Planck length and Planck mass are to ensure thatD2 (Φb ) has the required units. We arrive at the upper bound forD2 (equation) 

Meanwhile, from Eq. (131 ), and coupling constant trade-off (30 ) the decoherence rate for local discreet jumping models goes as (equation) , which gives rise to the lower bound forD2. From this, we arrive at the squeeze (equation) and plugging in the numbers we find the bound given by Eq. (46 ) which gives rise to the squeeze for local discrete models (equation). 

We can also consider other diffusion kernels, for example, that of Eq. (118 ). In this case, for continuous dynamics, we have that (equation). The Lindbladian kernel saturating the coupling constants trade-off at zeroeth order in Φ(x ), is the Diosi–Penrose kernel (equation) , as we saw in the section “Examples of Kernels saturating the decoherence diffusion coupling constants trade-off”. Approximating the masses as spheres of constant density we find from a substitution of the kernel into Eq. (146 ) that the variation in time-averaged force is given by (equation) 

We therefore find a lower bound forD2 in terms of the variation in acceleration (equation) which for classical torsion experimentsσa ~ 10 m s,T ~ 10 s,N ~ 10 andr N~ 10 m gives (equation). On the other hand, for this kernel the decoherence rate can be calculated via Eq. (139 ) (equation) which gives the squeeze onD2 (equation) 

For the numbers used in the main body of the textM λ~ 10 kg,N λ~ 10,R λ~V = 10 m,λ ~ 10 s, this yields (equation) and so this model is not ruled out by experiment. 

In general then, we expect that by simulating full CQ dynamics satisfying the decoherence diffusion trade-off we will be able to squeezeD2 from above and below. We boundD2 from above by studying the effects of diffusion on gravitational experiments, and we boundD2 from below using the coupling constant trade-off and coherence experiments lower bounding the decoherence rate. As we have seen in this section, it appears that classes of continuous CQ hybrid theories of gravity, including models without spatial correlations, are already experimentally ruled out, whilst others, such as the kernels in subsection “Diffeomorphism invariant kernel” require stronger bounds from both gravitational and coherence experiments. We have been very conservative in our estimates, and so we expect a more thourough analysis will tighten the bounds by orders of magnitute. 

