Reconfigurable photonics with on-chip single-photon detectors

Abstract: Integrated quantum photonics offers a promising path to scale up quantum optics experiments by miniaturizing and stabilizing complex laboratory setups. Central elements of quantum integrated photonics are quantum emitters, memories, detectors, and reconfigurable photonic circuits. In particular, integrated detectors not only offer optical readout but, when interfaced with reconfigurable circuits, allow feedback and adaptive control, crucial for deterministic quantum teleportation, training of neural networks, and stabilization of complex circuits. However, the heat generated by thermally reconfigurable photonics is incompatible with heat-sensitive superconducting single-photon detectors, and thus their on-chip co-integration remains elusive. Here we show low-power microelectromechanical reconfiguration of integrated photonic circuits interfaced with superconducting single-photon detectors on the same chip. We demonstrate three key functionalities for photonic quantum technologies: 28 dB high-extinction routing of classical and quantum light, 90 dB high-dynamic range single-photon detection, and stabilization of optical excitation over 12 dB power variation. Our platform enables heat-load free reconfigurable linear optics and adaptive control, critical for quantum state preparation and quantum logic in large-scale quantum photonics applications.

Optical quantum technologies are crucial to materialize the promises of quantum communication, quantum computing, and quantum simulation. These applications require a leap in system complexity, only achievable via the miniaturization and stability provided by large-scale photonic integrated circuits (PICs).

A quantum PIC is formed by a set of building blocks such as single-photon sources, quantum memories, reconfigurable photonic circuits, and detectors, –. Reconfigurable photonic circuits not only provide the link between the other building blocks, but also enable the linear optic operations required for quantum state preparation and quantum logic. In particular, combining reconfigurable photonics with detectors is central for on-chip single-photon detection and to enable feedback and adaptive control. Feedback is essential for quantum communication and computation protocols based on deterministic teleportation, for self-configuration of arbitrary linear optics, and for monitoring and stabilization of power, phase, and polarization. Elements addressing these functions usually outnumber other devices in proposed protocols and experimental setups, and thus their on-chip integration is a central challenge, often overlooked, towards the upscaling of classical and quantum optics,. This requires reconfigurable elements with low optical loss, a small footprint, and low electrical power consumption for cryogenic compatibility. Traditional PIC reconfiguration based on thermo-optic, carrier dispersion, and electro-optic χ(2) effects suffers from high power consumption, high optical loss, and large footprint respectively. A promising cryogenic compatible reconfiguration method is microelectromechanical (MEMS) actuation, which combines low power consumption, low optical loss, and small footprint. However, to date, there has been no demonstration of the compatibility of reconfigurable photonics with single-photon detectors in the same quantum PIC.

Here, we integrate MEMS PIC reconfiguration with superconducting single-photon detection on the same chip, and show three crucial components of quantum optics experiments. We demonstrate reconfigurable routing of classical light and single photons, high-dynamic range detection of optical excitation powers and single photons, and power stabilization of optical excitation using a feedback loop.

Superconducting nanowire single-photon detectors (SNSPDs) provide broadband detection of single photons with high detection efficiency, high signal-to-noise ratio, fast recovery time, and low timing uncertainty. Their compatibility with mature PIC material platforms and their excellent on-waveguide performance makes them outstanding integrated single-photon detectors.

In this work we fabricate hairpin SNSPDs from a 9-nm-thin NbTiN film on top of Si3N4 waveguides (see Fig.  [1] a, and find a description of the sample and fabrication process in Methods section and in Supplementary sections I and II). The 90-nm wide and 40-μm long photo-sensitive part of the wire is connected in series to a lumped-element inductor that prevents latching. We simulated the absorption of our hairpin detectors to be 95.5% (see Supplementary section III). The detectors exhibit a saturated detection regime at 795 nm wavelength (measurement setup description in Supplementary section IV), revealed by the sigmoidal shape of the detection efficiency versus the bias current (Fig.  [1] c), which indicates unity internal quantum efficiency. The two detectors feature critical currents of 15.8 μA (Detector A) and 5.9 μA (Detector B). The difference in critical current between dark and illuminated measurement is linked to the stochastic nature of the superconducting to normal state transition, leading to a spread in the measured switching currents. The detectors show different on-chip detection efficiencies (Detector A is 44.6 times more efficient than Detector B), which we attribute to a lithographic defect in Detector B, which results in a nanowire constriction and lower current densities, and therefore lower detection efficiency in the remaining nanowire (see Fig. S [2] ). The devices show timing jitters of 121.0(19) ps and 253.0(14) ps with room temperature amplification, and reset times with an exponential decay of 4.73(3) ns and 4.71(1) ns (detectors A and B respectively, see Supplementary section IV).

Here, we demonstrate capacitive MEMS tuning as an SNSPD-compatible reconfiguration mechanism suitable for large-scale quantum PICs. Figure  [1] a shows a schematic of our device, and Fig.  [1] b shows a scanning electron microscope (SEM) image highlighting the two grating couplers for coupling of input light and part of the MEMS-tunable beam splitter. More information on our sample and SEM images of the other parts of the device, including the two output SNSPDs can be found in the Supplementary section I and Figs. S [1]  and S [2].

We use the same NbTiN layer to build the MEMS actuators, electrical connections, contact pads, and single-photon detectors. Our fabrication process, described in the Supplementary section II, is largely enabled by the etch-resistance of NbTiN to hydrofluoric acid. The MEMS actuator consists of a NbTiN-on-Si3N4 cantilever, suspended over the Si substrate. The application of an electrical potential between the cantilever and the substrate forms a charged capacitor, which is subject to an attractive force that bends the cantilever vertically. The cantilever is attached to one of the two air-clad waveguides forming a directional coupler, and actuation results in an increase of the vertical separation between the waveguides, as illustrated in Fig.  [1] a. This, in turn, reduces the modal overlap, and thus changes the splitting ratio of the beam splitter, which we measure using the integrated SNSPDs (a theoretical description of our device and simulated actuation curves can be found in Supplementary section V). The measured tuning curve is shown in Fig.  [1] d, and follows our simulations (see Supplementary section V), yielding a high extinction ratio of 28.1 dB. The lower part of Fig.  [1] d shows the power ratio (defined as PR=10log10countsBcountsA) between detectors, and highlights the actuation voltage at which the highest extinction ratio was achieved. We observe an on–off ratio for individual ports of 27.5 dB (detector A) and 11.7 dB (detector B). We attribute the difference in on–off ratio to different detector efficiencies, as described in Supplementary section VI.

The normalized frequency response of our device is shown in Fig.  [2] a, where the amplitude ∣A∣(ω) is defined as the normalized amplitude (∣A∣(ω)/∣A∣(ω → 0) = 1) of the modulated SNSPD counts under a sinusoidal actuation voltage with amplitude ΔV(ω) (see schematic in the inset of Fig.  [2] a, and find further description in the Supplementary section VII). We observe constant modulation amplitude up until the first mechanical resonance frequency between 1 MHz and 2 MHz, in line with our simulated value of 1.6 MHz (see Supplementary section V). Our device presents stable and reliable operation, with hysteresis below 2.4% and power stability with a standard deviation below 0.5% over 60 min (see Supplementary section VIII). During the frequency sweeps, we performed more than 20 million switching events proving the durability of integrated MEMS devices. To further demonstrate device robustness, we performed three cool-down cycles and confirmed the operation of the MEMS and detectors. In addition, the robustness of this geometry in terms of yield is confirmed by the operation of three copies of the same MEMS actuator on the same chip. In terms of power consumption, for a 100-kHz drive and full splitting ratio tuning, we estimate a power consumption below 75 μW, dominated by the capacitance of our contact, since the MEMS actuator consumes 2.24 μW under these conditions (see Supplementary section IX for power consumption derivation). This power, only consumed during dynamic actuation, is dissipated along the non-superconducting transmission line, which is limited to the off-chip components and in particular the high-resistivity voltage source, and thus far from our SNSPDs. Under DC actuation, the power consumption is driven by leakage currents. Due to the high insulation of vacuum and SiO2 in our capacitor, leakage currents are minimal, which leads to power dissipation in the fW-range despite the high voltages applied. For example, for a 50:50 beam splitting ratio we estimate the power dissipation to be 6 fW, and for full inversion of the signal, 8.5 fW.

Although measuring the power in any optical setup is a mundane task, it is crucial for the setup, troubleshooting, and success of any measurement. While a macroscopic power meter can be found in most beam paths, PICs make access to the optical signal more challenging and require integrated photodetectors. In PICs, these are commonly built using complex processes such as heterogeneous integration of Ge or InGaAs on Si. In contrast, we combine the two SNSPDs and the reconfigurable MEMS, fabricated with our simple fabrication process using the same NbTiN layer, to demonstrate a power meter with a linear dynamic range exceeding 90 dB and sensitivity down to the single-photon level.

Figure  [2] c shows three switchable regions of our high dynamic range power sensor that are connected by measuring detection counts while sweeping the MEMS actuation voltage. The first range is measured with most of the optical power routed into detector A. The second range is covered by detector A and detector B, where most of the optical power is routed to the lower efficiency detector B. The third range is covered by detector B with most of the optical power routed to detector A, thereby saturating detector A. The low efficiency of detector B, which enables this measurement, is attributed to fabrication variations and could be carefully engineered by varying the nanowire length coupled to the waveguide mode. More information on the device function and our characterization setup can be found in Supplementary section X.

Our measurement range is in line with dedicated commercial devices and experimental demonstrations, but is unique in which it is sensitive at the single-photon regime, as we demonstrate in following sections. This high sensitivity to very low power levels makes our sensor ideal for tap-based circuit sensing where only a fraction of the light in the waveguide is available to the photodetector. This is crucial for built-in self-tests and wafer-level testing. In the following paragraphs, we describe the use of this on-chip power sensor to generate direct feedback for power control in our circuit.

The large tunable extinction ratios and near-MHz speed of our device, combined with the on-chip detectors, enable dynamic stabilization of optical power in one of the beam splitter arms. Power stabilization and control is ubiquitous in classical and quantum optics experiments, with key examples being spectroscopy and deterministic single-photon generation. In current experiments, this is implemented off-chip and requires support hardware and laboratory space, which can be minimized or eliminated by using our on-chip device. While on-chip experiments present higher stability within the chip, the input coupling efficiency of an off-chip excitation laser is highly sensitive to polarization and mechanical movement. In a packaged photonic circuit with an on-chip light source, not only thermal fluctuations but also fabrication process variations and aging effects need to be compensated. We address these problems by providing direct feedback on the MEMS beam-splitter using the power measured on the on-chip detector A, while the excess power is routed into the second arm (detector B). Figure  [2] b shows the measurement results and a schematic of our device. A PID feedback loop uses the detection counts provided by the SNSPD driver electronics to stabilize the measured power without manual intervention. The circuit yields stable (within 1.3% standard deviation) on-chip power while we tune the off-chip input power over 12 dB. The control loop was run every 100 ms and the input laser power was swept from 0 μW to 300 μW in 1 μW s−1 steps. Details can be found in Supplementary section XI.

To demonstrate the performance of our device in the single-photon regime for quantum PICs, we characterized it using single photons from an on-demand single-photon source. The source consists of a GaAs quantum dot excited via two-photon resonant excitation with a 320-MHz repetition rate and a pulse length of 40 ps (see Supplementary section XII). Single photons from the exciton transition with an energy of 1.5636 eV (795 nm, spectrum in the inset in Fig.  [3] a), are coupled via an optical fiber and free-space optics into our device using one of the grating couplers.

We performed a lifetime measurement on-chip, as seen in Fig.  [3] a, resulting in an exciton lifetime τX = 232(2) ps, in line with the off-chip measurement of τX = 216.3(6) ps. We extract the lifetime by fitting a decay convoluted with the instrument response function of the detector measured at the same wavelength using a 3-ps pulsed laser (see Supplementary section XII). We then measured single-photon purity by performing a Hanbury Brown and Twiss (HBT) measurement by routing the photons from our source into an off-chip beam splitter with one arm coupled through our device into the on-chip detector A, and the other arm going into a commercial off-chip SNSPD (measurement setup schematic in Fig.  [3] c). Figure  [3] b shows our measurement results, yielding a g(2)(0) = 0.11 ± 0.05, clearly showing anti-bunching and single-photon detection, in line with the g(2)(0) = 2.97 × 10−4 measured using two commercial SNSPDs with the same emitter.

The discrepancy between our on-chip and off-chip g(2)(0) is due to the limited optical coupling efficiency into the chip leading to a degraded signal-to noise ratio between dark counts of the detector and detection events due to single photons. The optical coupling efficiency is limited by our grating coupler design, which was experimentally optimized based on the designs in Zhu et al.. We believe that our longer wavelength (and thus lower refractive index contrast) and the non-optimized distance to the substrate limits our achievable coupling efficiencies, which can be potentially improved by fabricating additional grating periods. Additionally, the coupling efficiency can be improved via low-loss fiber coupling, or quantum emitter integration using monolithic or hybrid approaches.

Our proof-of-principle implementation of this technology could benefit from established fabrication processes and reach state-of-the-art performance. For example, improved SNSPD designs and readout electronics have demonstrated longer wavelength detection, shorter reset times, and sub-3-ps detection jitter. While the number of devices in our proof of concept experiment is too small to estimate a yield (see Supplementary section II), in an industrial fabrication process, fabrication yield is expected to be no limiting factor,. For high frequency and high voltage signals (≈150 V and >10 kHz), our MEMS actuation signal creates detection events on the detector channels even on unbiased detectors due to the large amplification in the readout channel (see Supplementary section VII for a more in-depth discussion). This can be improved by better electrode design on-chip and by reducing the actuation voltage.

MEMS technology is inherently scalable and reliable, as evidenced by the success of MEMS sensors in commercial electronics. The high voltage actuation required by our device is due to (1) the large capacitive gap between device layer and substrate and (2) the out-of-plane bending of the device caused by stress relaxation on the Si3N4 and NbTiN layers, which requires stiff cantilevers to maintain evanescent coupling between the directional coupler waveguides. We believe that this is not a fundamental limit in our platform, the actuation voltage can be reduced by tuning the stack stress distribution, by designing strain-tolerant MEMS actuators, and by using in-plane actuators with smaller capacitive gaps. For example, capacitive MEMS in silicon have demonstrated sub-10-V actuation and excellent scalability, as evidenced by the demonstration of a 240 × 240 photonic MEMS switch matrix, i.e., the largest silicon photonic circuit demonstrated to date. These features make it likely that foundries will offer photonic MEMS soon, and our platform provides a clear pathway towards simultaneous integration of MEMS and SNSPDs in a simple fabrication process. Cryogenically compatible MEMS in quantum PICs provide seamless integration of displacement and strain actuators on-chip. This has been shown to be a fundamental part of other PIC building blocks, such as tunable filters and phase shifters,. Additionally, MEMS have demonstrated compatibility with integrated single-photon emitters for routing and filtering,, and the strain distribution created by capacitive MEMS has been used to improve the spectral overlap of quantum emitters,, and the spin coherence of color centers. The presented platform can be leveraged for these applications, as shown in Fig.  [4] , in which the quantum emitters are strain-tuned into spectral alignment using a MEMS cantilever.

Applications of the presented device span many relevant quantum optics experiments. The analog tunability of our device enables fine optimization and stabilization of beam splitting ratios, critical for random number generation and accurate HBT and Hong-Ou-Mandel (HOM) measurements. Fast reconfiguration in the MHz regime can be used to tap and measure properties of quantum emitters on-chip. This can be readily applied to existing quantum communication protocols such as quantum key distribution to identify multiphoton or blinding attacks. Additionally, by changing the device geometry to mismatch the waveguide modes (i.e. reducing the width of one of the waveguides), the device can act as a phase shifter, which, together with passive beam splitters, form a complete set of components for arbitrary linear optics and linear optical quantum computation. Figure  [4]  shows a monitored and stabilized on-chip single-photon source as a near-term application of our technology. The device consists of three parts: stabilized laser excitation of tunable single-photon emitters, switching between monitors and output, and monitoring circuit. A laser input is sent through a passive ~50:50 beam splitter into two π-pulse power stabilizers each formed by a MEMS splitter and an SNSPD. The laser pulses then excite two MEMS-tunable single-photon sources, and their emission is routed into MEMS beam splitters which act as a switch between the output waveguides and the integrated monitoring. The on-chip monitoring circuit is based on a single MEMS beam splitter terminated with two SNSPDs. This enables switching between the analysis of three crucial aspects of a single-photon source: (i) emitter intensity by routing all the emitted photons into an SNSPD (MEMS splitter in 100:0 splitting), (ii) photon anti-bunching from each emitter (MEMS splitter in 50:50) by routing only the photons from one emitter into the device forming an HBT setup, and (iii) photon indistinguishability (MEMS splitter in 50:50) by routing the photons from both emitters into quantum interference forming a HOM setup. A HOM measurement can then be performed by frequency shifting the spectrum of the emitted single photons of one of the emitters with respect to the other one by means of strain. The device can thus discretely or continuously monitor emitter properties by switching from on-chip to off-chip configurations or by using the MEMS splitters as a tap.

In conclusion, we have demonstrated the on-chip compatibility of MEMS reconfigurable photonics with superconducting single-photon detectors and used it to develop three key elements of quantum optics experiments. We measured routing of classical and quantum light with a high extinction ratio, a photodetector with high dynamic range, and input power stabilization. Using our device, we performed on-chip lifetime and, paired with a fiber-coupled commercial detector, second-order autocorrelation measurements on single photons from a quantum dot source. Our results show that the combination of MEMS and SNSPDs enables the on-chip integration of not only the main building blocks of quantum optics, but also devices for adaptive control, monitoring, and stabilization of classical and quantum optics. The presented technology can overcome current roadblocks towards large-scale quantum optics, and foster applications in quantum communication, metrology, computing, and simulation.

The sample fabrication started with a 250-nm thin film of stoichiometric Si3N4 on 3.3 μm SiO2 on a silicon handle substrate, provided by a foundry (Rogue Valley Microdevices). We deposited a 9 nm film of Nb0.86Ti0.14N by reactive co-sputtering from separate Nb (200W, DC) and Ti (200W, RF) targets at room temperature in nitrogen and argon atmosphere. After Cr/Au marker lift-off, aligned electron-beam lithography using 350 nm thin ma-N 2403 negative tone photoresist, followed by CF4-based reactive ion etching resulted in patterned NbTiN nanowires, contacts, and MEMS electrodes. A second electron-beam lithography with the same resist and a CHF3-based reactive ion etching yielded the Si3N4 waveguide devices. Then, we used optical lithography with positive-tone resist to open windows for a wet buffered hydrofluoric acid (BHF) process under-etching the SiO2 film under the MEMS actuators and grating couplers. To avoid the collapse of the suspended actuators due to capillary forces, we dried the sample using critical point drying (CPD). Detailed information of the fabrication, process charts, and additional imaging can be found in the Supplementary Information Section I.

The sample was silver-glued to a custom-designed printed circuit board (PCB), and wirebonded using an Al wedge bonder. The PCB was then mounted in a dilution cryostat (Bluefors) with optical window access and a sample stage temperature below 100 mK. The PCB was connected to coaxial cables leading to room temperature, where the SNSPDs are biased and amplified using a commercial driver system (Single Quantum Atlas). The MEMS components are either directly driven using a high-voltage power supply (Keithley 2410) or through a function generator amplified using a high-speed high-voltage amplifier (Falco Systems, WMA-300). Light was coupled into the chip through an objective (50x, NA 0.82, Partec) inside the cryostat from a CW-laser at 795 nm wavelength, a pulsed laser (795 nm, 2 ps) or the quantum dot single-photon source. The polarization was controlled using a λ/2 - waveplate on the input path. Detailed information on the individual experiments can be found in the Supplementary Information Sections IV, VII, VIII, X, XI, and XII.

We use a commercial finite element method (FEM)-based Eigenmode solver (COMSOL) to simulate the optical modes for the directional coupler and the absorption within the waveguide section below the SNSPD. The complex refractive index for NbTiN at 795 nm is nNbTiN = 2.6468, kNbTiN = 2.7622, for silicon nitride nSi3N4=2 and for silicon dioxide nSiO2=1.45, both with no imaginary part. More information on our simulation parameters and results can be found in the Supplementary Information Section III.

Fig. 1: aArtist view of the demonstrated device, composed of grating couplers for light input and a MEMS reconfigurable beam splitter connected to two superconducting single-photon detectors. bFalse-colored SEM of the input section of our device, showing the waveguides and grating couplers, and the MEMS actuator and electrodes. cPhoton count rate at a wavelength of 795 nm for the two on-chip detectors and the corresponding dark counts, normalized to their individual saturated detection. The reduced critical current in the dark count measurement of detector A is due to measurement-to-measurement fluctuations in the critical current. dMeasured photon detection counts versus MEMS actuation voltage, normalized to the individual maximum transmission and power ratio (PR) between detectors. Note that the detectors feature different detection efficiencies (44.6 times higher in A, see Results section).

Fig. 2: aFrequency response of the tunable beam splitter measured using an on-chip detector up to the first resonance frequency normalized to the DC amplitude. The arrows represent the low bound of those measured amplitudes. Inset: this measurement was performed by translating the actuation voltage into a modulation of the splitting ratio. bPID-controlled power stabilization on one arm (detector A, orange) using the on-chip detectors and the MEMS-tunable beam splitter. The other arm (detector B, green) detects the rerouted power. The detection events are counted by the driving electronics of the detectors. c90 dB dynamic range on-chip photodetector that combines a high and a low-efficiency detector with switchable measurement ranges. The vertical connections are the measured counts while changing the MEMS voltage from 0 V to 196.5 V. The insets show the active detectors and MEMS settings in each of the three ranges: for lowest input power, Detector A is used with most of the power routed to its waveguide. For medium input powers the MEMS splitter routes most of the optical power to lower-efficiency Detector B, and both detectors can be used. For highest optical power, no actuation is applied and low-efficiency Detector B is used.

Fig. 3: aLifetime measurements using our device (purple) compared to commercial fiber–coupled SNSPDs (black). Inset: spectrum of the deterministically excited quantum dot used in this work, under π  pulse excitation, with highlighted exciton (X) and biexciton (XX) lines. bHBT measurements, showing a comparison of detection off-chip (top) and detection with one SNSPD on-chip (bottom). cSketch outlining the experimental configuration. For athe lifetime of the QD is either fully measured on-chip or using the commercial SNSPD system. For bone arm of the HBT setup is on-chip while the second arm is connected to the SNSPD system. The coincidences are then measured using a time-to-digital converter. Optical components: BS beam splitter, NF notch filter, TG transmission grating, POL polarizer, (λ2 ) half waveplate, DUT device under test.

Fig. 4: Example of a monitored and stabilized on-chip photon source as a near-term application of our technology. The device includes two power stabilizers connected to two MEMS-tunable quantum emitters and MEMS splitters for switching into an HBT/HOM monitoring circuit.

