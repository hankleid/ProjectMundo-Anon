锂离子电池退化稳定建模和预后物理信息神经网络

摘要: 准确的状态健康（SOH）估计对于锂离子电池的可靠和安全操作至关重要。然而，依然存在挑战，即可靠和稳定的电池SOH估计由于多样化的电池类型和操作条件。 在本文中，我们提出了一种物理信息神经网络（PINN）用于准确和稳定的电池SOH估计。具体来说，我们从经验退化和状态空间方程的角度出发，建模影响电池退化的属性，并利用神经网络捕获电池退化动态。我们设计了一种通用的特征提取方法，从电池充电前短时间的数据中提取统计特征，使得我们的方法适用于不同的电池类型和充放电协议。此外，我们生成了一个由55个锂镍钴锰氧化物（NCM）电池组成的综合数据集。结合来自不同制造商的三个其他数据集，我们使用总共387个电池和310,705个样本来验证我们的方法。平均绝对百分比误差（MAPE）为0.87%。我们的提出的PINN在常规实验、小样本实验和转移实验中表现出卓越的性能，相比其他神经网络。该研究突出了物理信息机器学习在电池退化建模和SOH估计中的前景。

近年来，锂离子电池的数量以惊人的速度增长，这是可再生能源设备普及的前所未有的动力。凭借高能量密度、低自放电率和长寿命的优势，锂离子电池已成为便携式电子设备、电动汽车、航空航天和许多其他领域的主要能源存储设备, , , , , ,。2019年，新能源汽车的锂离子电池全球出货量仅达到116.6 GWh 。预计到2025年，全球锂离子电池的安装容量将达到800 GWh，市场价值将达到918亿美元 。锂离子电池的快速增长为人们的生活带来了便利，但是其老化和健康管理也引起了人们的关注和担忧。锂离子电池的老化是一个重要问题，其性能会随着时间的推移而下降，直到失效。为了确保长期、安全、连续的运行，锂离子电池必须得到适当的维护和控制，这包括状态健康（SOH）评估。电池的SOH定义为当前可用容量与初始容量的比率，可以用作衡量电池退化的指标 。当SOH下降到80%时，电池达到其第一次服务寿命。达到第一次服务寿命的电池仍然可以在能源存储电站等领域用于二次利用。因此，准确估计电池的SOH至关重要。

近年来，人们提出了各种锂离子电池的SOH估计方法，这大大推进了该领域的发展, , ,。然而，准确估计SOH仍然是一个具有挑战性的问题。一般来说，容量可以从上限电压到下限电压的完整放电曲线中获得，通过安时积分，从而获得SOH。在实际应用中，很难获得完整的充电或放电曲线，因为电池很少完全放电。一些学者通过建立电池老化模型来估计SOH。Baghdadi等人提出了基于Dakin退化方法的物理学方法来模拟电池的线性退化过程。考虑到时间变化的温度条件对锂离子电池的放电容量和老化规律有重要影响，Xu等人提出了基于Arrhenius温度模型的随机退化率模型，并基于Wiener过程建立了时间变化温度条件下的锂离子电池老化模型。Dong等人提出了结合化学和机械退化机制的物理学模型，通过模拟固体电解质介质（SEI）的形成和增长来预测容量衰减。Lui等人提出了基于模拟正负极活性材料损失和锂库存损失等退化机制的物理学方法来预测锂离子电池的容量 。

鉴于建立物理模型和获得完整放电容量的困难，许多研究使用数据驱动方法来估计SOH，基于充电和放电期间的电流和电压曲线。常用的数据驱动方法包括线性回归、支持向量机、高斯过程回归、深度神经网络等。Xia等人从增量容量（IC）曲线和差分电压（DV）曲线中提取特征来估计SOH。Wang等人从电化学阻抗谱（EIS）中提取有价值的健康指标作为高斯过程回归的输入来估计SOH。数据驱动方法不需要物理知识，只关注输入和输出之间的关系，因此提取退化特征是数据驱动方法的一个关键部分，这在很大程度上决定了SOH估计的性能, , , , ,。

然而，开发可靠、准确和通用的SOH估计方法仍然存在挑战,。物理学模型稳定且准确，但具有不同化学成分的电池需要不同的模型参数，且模型具有高计算成本 。数据驱动模型具有高准确率和效率，但其普遍性取决于提取的特征，并且具有较差的稳定性,。例如，由于使用变异性较高，现有的方法需要为不同的数据集或不同的工作条件提取特定的特征，从而导致模型是数据集特定的，结果浪费了计算资源。物理信息神经网络（PINN）的有前途的前景在于融合物理学和数据驱动方法的优势，可能解决上述挑战。由于考虑了物理信息，PINN可以使用相对较少的数据来训练模型，且模型更稳定。这是在电池预后和诊断领域的一个有前途的方法。Aykol等人将结合物理知识和机器学习的电池建模方法分为五类，包括三个顺序集成方法（A1-A3）和两个混合方法（B1-B2）。其中，顺序集成方法的一个明显特征是物理模型和机器学习模型是独立的，而混合方法则将两者融合在一起。在这个框架内，已经发表了一些工作, , , , , , ,。Nascimento等人直接通过循环神经网络实现了基于原理的控制方程的数值积分，以模拟电池的动态响应。Wang等人提出了基于等效电路模型（ECM）的电池神经网络（BattNN）用于放电电压预测。Hofmann等人使用了伪二维（P2D）Newman模型在不同健康状态点生成数据，并将其与实验数据和现场数据结合起来训练神经网络模型，该模型利用了内部状态和可测量的SOH之间的相关性。根据Aykol等人提出的分类，这些方法属于A2和A3类别, , ,。



在这项工作中，我们提出了一个用于电池SOH估计的PINN，它属于B2架构。这一方法实现了控制方程和神经网络的真正集成，实现了稳定和精确的SOH估计。与现有的PINN方法不同，我们还验证了其在小样本学习和不同化学成分和充放电特征的电池之间的迁移学习方面的优势。具体来说，首先，考虑到电化学方程的复杂性，它阻碍了B2型PINN的发展。因此，我们从经验退化和状态空间方程的角度出发，建模电池退化动力学，并利用神经网络捕获电池退化动力学。第二，为了使模型更具普遍性，我们开发了一种新的特征提取方法。电池的放电过程是用户特定的，电池很少完全放电。相比之下，一旦开始充电，完全充电的概率很高，而且更为固定和规律。因此，我们从电池完全充电之前的短时间数据中提取特征。第三，为了验证我们的方法，我们进行了电池退化实验，并发布了一个包含55个电池的故障数据集。此外，我们还在其他三个具有不同化学成分和充放电协议的大规模数据集上验证了我们的方法，证明了我们方法的优越性和通用性。我们还执行了从一个数据集到另一个数据集转移退化知识以估计SOH的任务。这些执行转移任务的数据集包含具有不同化学成分和充放电协议的电池。结果表明了所提出PINN在SOH估计中的有效性和通用性。

我们开发了一个用于锂离子电池SOH估计的PINN，其流程图如Fig. [1] 所示。我们的方法旨在通过考虑电池退化的动态行为以及退化趋势，实现更具普遍性、可靠性、稳定性和高精度的SOH估计。

在数据预处理阶段（如Fig. [1] b所示），我们从电池完全充电之前的短时间数据中提取统计特征作为模型的输入，这确保了这种数据在大多数电池数据集中存在，并解决了现有研究中非通用特征的问题。因此，我们的方法适用于具有不同化学成分和充放电协议的电池。

在SOH估计阶段，由于电化学方程的复杂性，目前尚无有效方法将其与神经网络集成。在这项工作中，我们从经验退化和状态空间方程的角度出发，建模影响电池退化的属性，并利用神经网络近似建立的退化模型，有效实现了控制方程和神经网络的集成。所提出的PINN由两部分组成：一个解函数f ( ⋅ )将特征映射到SOH，一个非线性函数g ( ⋅ )模拟电池退化动态行为，如Fig. [1] c所示。解f ( ⋅ )模拟特征与SOH之间的关系，表示为u =f (t ,x )，其中t 表示时间，x 表示提取的特征向量，u 表示第i 个循环的SOH。非线性函数g ( ⋅ )模拟电池的SOH衰减率。由于f ( ⋅ )和g ( ⋅ )在现实中受到许多因素的影响，其显式表达式未知，因此它们被替换为小型全连接神经网络，表示为F(⋅)和G(⋅)。在训练过程中，我们考虑数据项损失L data 、单调性损失L mono 和受偏微分方程描述的退化方程约束的损失L PDE 。它们最小化预测值和真实值之间的误差，同时使模型遵循退化轨迹的单调性属性并满足建立的退化模型的约束。

为了验证所提出的PINN的优越性，我们进行了小样本实验和迁移实验。在迁移实验中，我们冻结G(⋅)，并在具有不同化学成分的数据集上微调F(⋅)。实验结果表明，所提出的PINN框架可以有效地捕获电池退化的动态。我们的研究结合了电池退化的知识和神经网络，取得了有前途的结果。这项研究突出了物理信息神经网络在电池退化建模和SOH估计中的前景（更多的方法细节可以在“方法”部分找到）。

为了涵盖不同的电池类型和化学成分，我们使用了4个不同的大规模数据集中的310,705个样本，总共387个电池进行验证。第一个数据集来自我们为此研究进行的电池退化实验，其他三个数据集是来自Zhu et al.、Ye et al.和Severson et al. 的公开数据集。为了方便，我们将这四个数据集称为西安交通大学电池数据集、天津大学数据集、华中科技大学数据集和麻省理工学院数据集 。四个数据集的基本信息如表 [1] 所示。

我们在这项研究中开发了一项电池退化实验，如Fig. [S1] 所示。共有55个由LISHEN制造的电池（LiNi0.5 Co0.2 Mn0.3 O2 ，2000 mAh标称容量，3.6 V标称电压，充电和放电的截止电压分别为4.2 V和2.5 V）在室温下按照6种不同的充放电协议循环至故障。这些协议包括固定充电和放电、不同循环中具有固定电流的随机放电、随机行走和地球同步轨道卫星的充电和放电策略。我们使用批次1至批次6来表示这6种充放电协议。退化轨迹如Fig. [2] 所示。有关我们数据集的更多详细信息，请参见补充说明 [1] 。

天津大学数据集包含三种类型的电池：NCA电池（3500 mAh标称容量，2.65–4.2 V截止电压）、NCM电池（3500 mAh标称容量，2.5–4.2 V截止电压）和NCM + NCA电池（2500 mAh标称容量，2.5–4.2 V截止电压）。这些电池在具有不同温度和不同充电电流率的温度控制室中循环。温度候选集包括25、35和45 °C。电流率范围从0.25 C到4 C。我们使用批次1、批次2和批次3来表示NCA、NCM和NCM + NCA电池。

华中科技大学数据集包含77个LFP/石墨电池在77种不同多阶段放电协议下的数据。这些电池由A123（APR18650M1A）制造，具有1100 mAh的标称容量和3.3 V的标称电压。它们在30 °C的温度下按照相同的充电协议但不同的放电协议循环至故障。

麻省理工学院数据集中的电池与华中科技大学数据集中的电池具有相同的类型和化学成分。然而，与华中科技大学数据集的实验设置不同，麻省理工学院数据集考虑了多种快速充电策略和一种放电策略。具体来说，它们在具有单步或两步快速充电策略的快速充电实验中循环，并在4 C的条件下放电。实验温度为30 °C。

鲁棒的特征可以提高SOH估计的性能。然而，如何提取一般和鲁棒的特征是一个值得研究的问题。在现有的研究中，针对特定数据集和充放电协议的各种特征提取方法被提出，但特征的泛化性却没有被充分考虑。关于为不同电池类型或充放电协议提取一般特征的方法的研究很少。为了提取更鲁棒和更具泛化性的特征，我们提出了一种从多个数据集的充电电压曲线和电流曲线中提取特征的方法。电池的放电过程是用户特定的，而充电过程则是必不可少的，并且更为固定和规律，电池被充满电的概率相对较高。我们发现，大多数数据集都包含恒流和恒压（CC-CV）充电模式。对于我们使用的四个公共数据集，无论电池采用什么策略放电，还是是否完全放电，当充电时，最终都会被充满电。

因此，我们选择电池充满电之前的一段数据来提取特征，如Fig. [1] b所示。定义电池的充电截止电压为Vend ，并选择电压数据值在[Vend−0.2 ，Vend ] V范围内的数据。对于电流数据，我们选择在恒压充电期间电流在0.5 A和0.1 A之间的数据。无论电池是否完全放电，只要电池被充满电，电压范围和电流范围始终存在。

从选定的电流和电压曲线中分别提取均值、标准差、峰度、偏度、充电时间、累积电荷、曲线斜率和曲线熵（这些特征编号为1-16，见Supplementary Note [2] ）。XJTU数据集批次1中提取的特征示例如Fig. [3] a所示。进一步，我们从4个数据集中的387个电池中分别提取特征，并计算每个数据集中特征与SOH之间的Pearson相关系数，如Fig. [3] b所示。

基于实验现象和Fig. [3] b的分析，我们提出一个自然的猜想：每个特征与SOH之间的相关系数的大小与电池的化学成分有关，而与充放电协议的影响较小。据我们所知，我们是第一个关注这一现象的人。从Table [1] 可以看出，XJTU数据集和TJU数据集都是LiNiCo-x类型的电池。尽管它们具有完全不同的标称容量和充放电协议，但从我们选择的范围中提取的特征却非常相似。例如，特征11-16与SOH之间存在非常强的负相关性。特征9和10与SOH之间存在强的正相关性。相比之下，MIT数据集和HUST数据集都是LiFePO4 电池。特征11-16与SOH之间显示出弱的正相关性，而特征9和10与SOH之间显示出负相关性。此外，后两个数据集的特征3-6和8与SOH之间显示出强的正相关性。

提取的16个特征和时间（循环次数）被用作拟议的PINN的输入来估计SOH。为了减少特征幅度差异对模型的影响并使模型训练更加稳定，我们对特征进行了最小-最大归一化。也就是说，所有特征都被缩放到[-1,1]范围内。拟议的PINN在4个数据集上的SOH估计结果如Fig. [4] a所示（每个数据集的测试电池数量可以在Table [S2] 中找到）。

为了展示所提出PINN的优势，采用了具有相同结构和参数数量的多层感知器（MLP）和具有相似参数数量的卷积神经网络（CNN）作为比较方法。MLP和CNN的详细信息可以在补充说明 [3] 中找到。对于每个数据集，我们将训练电池、验证电池和测试电池大约按照6:2:2的比例分配。每个数据集的测试电池数量可以在表 [S2] 中找到。为了确保公平性，测试电池的数量在整个数据集中均匀分布，如表 [S3] – [S6] 所示。3个模型在4个数据集上的结果如表 [2] 所示（仅给出每个数据集的平均测试误差，各电池的测试结果可以在表 [S3] – [S6] 中查看）。从表中可以看出，我们的方法在大多数情况下具有最小的估计误差。所提出PINN在4个数据集上的平均MAPE分别为0.85%、1.21%、0.65%和0.78%，而MLP的平均MAPE分别为2.60%、1.72%、0.83%和0.83%。值得注意的是，在推理过程中，它们具有相同的参数数量和模型结构。

进一步地，为了反映模型的稳定性，每个模型在每个数据集上的训练和测试过程重复10次。测试结果如Fig. [4] b所示。从图中可以看出，我们所提出PINN在所有任务和所有指标上都是最稳定的。XJTU电池数据集的每个批次的样本数量较小，导致MLP和CNN的波动较大。相比之下，我们的方法更稳定，测试误差也更小。对于HUST数据集和MIT数据集，它们包含大量的训练样本，因此MLP和CNN的波动变小，测试误差也变小。然而，我们所提出PINN仍然是表现最好的模型。

我们所提出PINN可以模拟电池退化动态，考虑了更多的物理规律，因此可以使用较少的数据进行训练。与纯数据驱动方法相比，我们的方法可以在可用训练数据较少时表现出更大的优势。为了验证上述推断，我们在XJTU数据集和HUST数据集上进行了小样本实验。

具体来说，我们使用1个电池数据来训练3个模型，并在多个电池上测试（测试集与2.4节相同），并记录测试结果。此外，我们逐渐增加训练电池的数量，并观察每个模型在测试集上的性能变化。结果如表 [3] 和Fig. [5] 所示（仅给出XJTU数据集的批次1结果，更多结果可以在表 [S7] 和Fig. [S5] 中找到）。

可以看出，我们所提出PINN在所有任务和设置中都获得了最好的结果。随着训练电池数量的增加，3个模型的测试误差都减小了。这是一个公认的事实：增加训练样本的数量可以提高模型的性能，当训练数据较少时。在Fig. [4] b中，由于HUST数据集的样本数量较大，CNN和MLP的性能与我们所提出PINN相似。这也说明了当模型的结构或参数数量相同时，给定足够的训练样本，模型的性能不会有太大差异。然而，从Fig. [5] 中可以看出，我们的方法在训练样本数量较少时具有显著的优势。另外，值得注意的是，我们所提出PINN仅使用1个电池进行训练的性能与MLP和CNN使用3-4个电池进行训练的性能相似，这表明我们所提出PINN在小样本场景中的优势。

转移学习的一种实现是微调，它通过使用少量新收集的数据快速调整模型来提高学习能力。其优点是可以利用其他场景（源域）中收集的大量数据预训练模型，并学习特征和标签之间的基本关系。然后，使用少量目标域数据快速微调模型以获得良好的性能。目前，大多数关于SOH估计的转移学习研究都是在不同充放电协议之间进行转移，而不同数据集（不同化学成分）之间的转移研究较少。在本文中，我们将4个数据集成对进行微调实验。

我们认为，退化动态G(⋅)与充放电协议和数据集无关，而解F(⋅)与它们相关。从大量数据中学习后，G(⋅)应包含可以反映电池退化性质的通用信息，这对跨场景SOH估计有用。因此，我们只对解F(⋅)的权重进行微调，并将动态G(⋅)的权重固定，如Fig. [6] b所示。

我们进行了微调实验和源域仅实验，并将结果与小样本实验进行比较。所有结果见表 [4] 。从图中可以看出，微调模型的性能明显优于源域仅方法。此外，当只有1个标记目标域电池时，遵循“预训练-微调”范式的模型的性能优于直接使用1个目标域电池训练的模型。这表明“预训练-微调”范式的有效性。对于XJTU数据集和TJU数据集，即使模型使用2个目标域电池训练，其性能也不如使用1个目标域电池微调的模型。这也证明了动态G(⋅)从源域的大量数据中学习了有用的信息。

如果从更公平的角度重新审视表 [4] ，即忽略表格的最后一列，那么还有一些直觉上正确但不太明显的见解。XJTU数据集和TJU数据集都是LiNiCo-x电池，它们之间的特征和SOH的相关性更为相似（见“特征提取”部分的相关性），因此它们之间的微调效果更好。同样，MIT和HUST都是LiFePO4 电池，它们之间的微调效果也很有前景。这可能是一个有意义的发现，我们将在未来继续研究它。

准确的SOH估计有助于锂离子电池的健康管理和维护决策。现有的SOH估计方法需要为不同的数据集提取不同的特征，模型的性能会有很大波动。在本工作中，我们提出了一种通用的PINN用于电池SOH估计。具体来说，我们提出了一种通用的特征提取方法，从电池充电前的一段短时间数据中提取统计特征，这些数据包括恒流和恒压充电模式。然后，我们使用PINN对电池退化动态进行建模，并将提取的特征作为输入来估计SOH。

为了验证我们的方法，我们进行了电池老化实验，并开发了一个包含55个电池的数据集。最后，我们在4个大规模数据集中的387个具有不同化学性质和充放电协议的电池上验证了我们的方法。结果表明，我们提出的方法是有效且可行的。进一步，我们进行了小样本实验和迁移实验，证明了考虑物理知识可以帮助数据驱动模型更快、更好地从数据中学习。我们的研究突出了物理信息神经网络在电池退化建模和SOH估计中的潜力。它可以促进下一代电池的快速开发，使用现有的实验数据和少量新的数据。

电池退化建模和SOH估计是电池健康管理领域的热点研究。随着电池老化，各种界面退化过程发生，伴随着锂库存和活性材料的损失，导致离子和电子转移以及插层反应的电阻增加，从而导致其充电曲线的变化 。因此，充电曲线包含了丰富的退化过程信息。然而，使用充电和放电曲线来估计电池SOH可能会陷入信息泄露的陷阱。Geslin等人指出，不一致的充电和放电协议、使用条件等可能导致信息泄露，这是一个严重的问题，可能被学者忽略。他们认为，固定CC-CV模式可以缓解信息泄露的问题。因此，在进行SOH估计任务时，尽可能避免将与内部电池质量、制造变异性和使用条件相关的因素纳入其中是明智的。在我们的研究中，特征是从电池充电前CC-CV阶段的一个小数据段中提取的，这与电池使用条件无关。这确保了我们提取的特征的有用性和通用性，同时避免了由于不一致的充电协议或电池使用条件引起的信息泄露。在训练和测试阶段，我们使用电池A的数据训练模型，并在电池B上测试它；而不是使用电池A的早期数据训练模型，并使用后期数据测试它，这避免了从训练集到测试集的信息泄露 。

在构建SOH估计模型时，我们提出了一个PINN用于电池SOH估计。物理信息神经网络作为一种有效的途径，利用人工智能来解决实际的工程问题。通过将传统的物理模型与神经网络模型融合，可以更准确地捕捉电池系统的复杂动态行为，从而实现更可靠、更精确的状态估计。然而，这个新兴领域仍需要学者进一步探索。在Aykol等人提出的框架中，混合方法将成为长期的主导方法，这些方法利用物理方程来约束神经网络或将物理方程整合到神经网络中。这种混合方法具有将物理模型的因果关系和外推能力与神经网络的速度、灵活性和高维能力相结合的潜力。然而，这些方法的局限性在于电池的物理模型（例如P2D模型）的复杂性，它包含了众多参数，电池的内部参数难以收集。目前尚无满意的方法来无缝地整合物理模型和神经网络。本文提出的PINN从经验退化和状态空间方程的角度出发，仅仅作为对这种混合方法的探索，并作为进一步研究的催化剂。另外，我们仅考虑从容易获取的电流和电压数据中提取特征。随着更多数据和内部变量的可用，更加复杂的电化学模型可以被考虑。在现有数据和计算资源的约束下，电池管治方程和神经网络的最佳整合仍然需要进一步探索 。

电池老化主要表现为可用容量的减少和内部电阻的增加，通常遵循一个下降的轨迹。为了准确描述电池退化轨迹，学者们提出了各种经验模型来描述电池容量损失作为时间或循环次数的函数，包括线性模型、指数模型、幂律模型和故障预测模型（FFM）等。这些模型都将电池的退化轨迹描述为时间的单变量函数,。

然而，将电池退化轨迹仅表示为时间的单变量函数过于简化了这个过程。事实上，电池退化不仅与时间有关，还与充电速率、放电速率、日历时间、温度、放电深度（DOD）等因素有关。例如，Xu等人将电池老化分为日历老化和循环老化，这些因素考虑了状态-of-charge（SOC）、DOD、电池温度和固体电解质界面（SEI）薄膜生长等因素。他们将日历老化和循环老化建模为日历时间、SOC、DOD和温度的函数 。

因此，仅将电池退化轨迹建模为时间的函数是不够的。在这项研究中，我们提出将其建模为多变量函数： 1 u = f(t , x),  其中t 表示时间，x 表示一个向量，包括 SOC、DOD、温度、充电速率、放电速率、健康指标（HIs）和其他因素。在我们的工作中，x 表示从充电数据中提取的 HIs（请参见“特征提取”部分的更多细节）。

一般来说，为了描述电池的退化动态，其 SOH 衰减率可以表示为： 2 ∂ u ∂ t = g t , x , u ; θ.  上述方程是一个显式的偏微分方程（PDE），参数化为θ ，g ( ⋅ ) 表示t 、x 和u 的非线性函数。函数g ( ⋅ ) 表征电池的内部退化动态，通过改变这个非线性函数，可以表示各种形式的退化。线性模型、指数模型、幂律模型和 FFM 可以被视为方程（ [2] ）在仅考虑时间时的特定情况。

一个不可避免的问题是，g ( ⋅ ) 的显式形式是未知的且难以获得。对类似问题的回应，Sun 等人提出了一种利用稀疏性来学习g ( ⋅ ) 参数θ 的稀疏回归物理信息神经网络。Raissi 等人提出了一种深度隐式物理模型来模拟g ( ⋅ )。受此启发，我们提出使用一个更一般的函数近似器g ′(⋅)，其参数为θ ′ ，来表示非线性动态g ( ⋅ )。因此，方程（ [2] ）变为： 3 u t ≈ g ′ t , x , u , ut , ux , uxx , ⋯ ; θ′.  在方程中，u t = ∂ u ∂ t ，我们使用一个神经网络F t , x ; Φ ，其参数为 Φ，来模拟f (t ，x )，并利用自动微分机制来计算u t。u x = ∂u∂x1,∂u∂x2,⋯ ⊤ 表示u 关于x 的一阶偏导数，u xx表示二阶偏导数。这种方法的一个优点是，我们不需要指定一个候选基函数集来近似g ( ⋅ )，而是使用一个更一般的近似器g ′(⋅)。函数近似器g ′(⋅)提出了一种更灵活的关系来表示t 、u 、x 和它们的任意阶偏导数。一个神经网络G ⋅ ，其参数为 Θ，来模拟g ′(⋅)，使其能够从给定的x 、t 和其他偏导数中学习电池的老化机制。为了平衡准确性和计算复杂性，我们仅考虑一阶偏导数的影响，舍弃高阶偏导数。

基于上述分析，我们定义一个物理信息神经网络H  ，用于电池老化： 4 H : = ∂ F t,x;Φ ∂ t − G t , x , u , ut , ux ; Θ ,  其中∂ F t,x;Φ ∂ t 表示解神经网络F(⋅)关于t 的偏导数，G(⋅)表示电池退化动态方程，由神经网络模拟。提出的 PINN 结构如 Fig. [6] 所示。

方程（ [4] ）是由方程（ [2] ）和（ [3] ）推导而来。然而，由于它是由神经网络拟合的，其训练过程是离散的，因此不严格满足方程（ [2] ）。对于电池的 SOH，计算公式为： 5 u k = f(k , x)= QkQ0 ,  其中Q 表示第k 个循环的容量，Q 表示标称容量。SOH 值u 与退化轨迹f ( ⋅ ) 在t =k 时的点相吻合。我们需要使H(ti , xi)= 0  在样本点i 处成立，以近似方程（ [2] ）。因此，PINN 的优化过程需要遵循由方程（ [2] ）指定的 PDE 损失，即： 6 L PDE = ∑ i = 1 N Hti,xi2 ,  其中上标i 表示第i 个样本，N 表示样本数量。另外，优化目标包括数据损失和单调性损失： 7 L data = ∑ i = 1 Nui−ûi2 , 8 L mono = ∑ j = 1 M ∑ k = 1 Nj ReLU ûk+1 −ûk ,  其中û i 表示估计的 SOH，M 表示电池数量，N j表示第j 个电池的循环次数，ReLU( ⋅ ) 是修正线性单元。单调性损失L mono 基于电池退化的物理性质，即下一个循环的 SOH 应该小于或等于前一个循环的 SOH（除非发生容量再生）。总函数表述为： 9 L = L data + α L PDE + β L mono ,  其中α 和β 是权衡参数。更多关于我们的模型的细节可以在补充说明 3 中找到。

我们的 PINN 由两个部分组成：一个解神经网络F(⋅)，建立特征到 SOH 的映射；以及一个神经网络G(⋅)，模拟电池退化动态，如 Fig. [6] 所示。我们认为退化动态G(⋅)与充电/放电协议和数据集无关，而解F(⋅)与它们有关。因此，当我们的 PINN 应用于迁移学习场景时，动态G(⋅)被冻结，只有解F(⋅)被微调，如 Fig. [6] b 所示。

表 1: 四个数据集的化学成分和基本实验条件
数据集 | 批次 | 化学成分 | 标称容量 (mAh) | 截止电压 (V) | 实验温度 (°C) | 电池数量
XJTU | 1,2,3,4,5,6 | LiNi 0.5Co 0.2Mn 0.3O 2| 2000 | 2.5–4.2 | 室温 | 55
TJU | 1 | Li 0.86Ni 0.86Co 0.11Al 0.03O 2| 3500 | 2.65–4.2 | 25,35,45 | 66
| 2 | Li 0.84Ni 0.83Co 0.11Mn 0.07O 2| 3500 | 2.5–4.2 | 25,35,45 | 55
| 3 | 42（3）wt.% LiNiCoMnO 2和 58（3）wt.% LiNiCoAlO 2的混合物 | 2500 | 2.5–4.2 | 25 | 9
MIT | – | LiFePO 4| 1100 | 2.0–3.6 | 30 | 125
HUST | – | LiFePO 4| 1100 | 2.0–3.6 | 30 | 77
不同数据集的充放电协议各不相同。

表 2: 提出的 PINN（我们的）、多层感知器（MLP）和卷积神经网络（CNN）在四个数据集上的结果
数据集 | 批次 | 我们的 | MLP | CNN | | | MAPE | RMSE | MAPE | RMSE | MAPE | RMSE
XJTU | 1 |  0.0070|  0.0094| 0.0260 | 0.0277 | 0.0270 | 0.0330
| 2 |  0.0113|  0.0122| 0.0275 | 0.0304 | 0.0298 | 0.0352
| 3 |  0.0086|  0.0100| 0.0211 | 0.0237 | 0.0177 | 0.0212
| 4 |  0.0071|  0.0105| 0.0200 | 0.0235 | 0.0150 | 0.0189
| 5 |  0.0105|  0.0135| 0.0183 | 0.0217 | 0.0350 | 0.0453
| 6 |  0.0063|  0.0097| 0.0204 | 0.0242 | 0.0149 | 0.0194
TJU | 1 |  0.0164|  0.0158| 0.0206 | 0.0197 | 0.0198 | 0.0208
| 2 |  0.0119|  0.0132| 0.0149 | 0.0157 | 0.0143 | 0.0149
| 3 |  0.0080|  0.0079| 0.0150 | 0.0144 | 0.0124 | 0.0125
MIT | |  0.0065|  0.0074| 0.0079 | 0.0087 |  0.0065| 0.0075
HUST | | 0.0078 |  0.0087| 0.0080 | 0.0090 |  0.0074| 0.0087
MAPE 是平均绝对百分比误差，RMSE 是均方根误差。最佳结果以粗体显示。所有值都是从十次实验中平均得出的。

表 3: 小样本实验在 XJTU 数据集批次 1 和 HUST 数据集上的结果
数据集 | 训练电池 | 我们的方法 | MLP | CNN | | | MAPE | RMSE | MAPE | RMSE | MAPE | RMSE
XJTU | 1 |  0.0141|  0.0184| 0.0343 | 0.0390 | 0.0929 | 0.0949
| 2 |  0.0105|  0.0134| 0.0267 | 0.0304 | 0.0728 | 0.0826
| 3 |  0.0069|  0.0096| 0.0347 | 0.0383 | 0.0548 | 0.0666
| 4 |  0.0056|  0.0076| 0.0292 | 0.0327 | 0.0560 | 0.0647
HUST | 1 |  0.0446|  0.0485| 0.0601 | 0.0682 | 0.3614 | 0.1550
| 2 |  0.0178|  0.0202| 0.0391 | 0.0461 | 0.0826 | 0.0925
| 3 |  0.0154|  0.0181| 0.0251 | 0.0287 | 0.0514 | 0.0618
| 4 |  0.0144|  0.0173| 0.0253 | 0.0288 | 0.0429 | 0.0521
MAPE 是平均绝对百分比误差，RMSE 是均方根误差。最好的结果以粗体显示。所有值都是从十次实验中平均得出的。“训练电池”意味着我们使用 1、2、3 和 4 个电池分别训练模型，然后在测试集上测试。

表 4: 四个数据集之间的微调实验的测试均方根误差（RMSE）
| 微调 | 源域仅 | 训练目标电池 | | XJTU | TJU | MIT | HUST | XJTU | TJU | MIT | HUST | 1 | 2
XJTU | – |  0.0100| 0.0145 |  0.0104| – | 0.0967 | 0.1329 | 0.0733 | 0.0184 |  0.0134
TJU |  0.0093| – |  0.0119| 0.0146 | 0.1266 | – | 0.1674 | 0.1266 |  0.0121| 0.0202
MIT |  0.0239| 0.0272 | – |  0.0248| 0.0347 | 0.1277 | – | 0.0561 | 0.0324 |  0.0142
HUST |  0.0333| 0.0343 |  0.0307| – | 0.1131 | 0.2008 | 0.0801 | – | 0.0485 |  0.0202
前三名结果分别以粗体、斜体和下划线显示。所有值都是从十次实验中平均得出的。按行查看表格。第一行表示 XJTU 数据集作为目标域，其他数据集作为源域。“微调”意味着 PINN 在源域上训练，然后在目标域的第一个电池上微调，并在目标域的测试集上测试。“源域仅”意味着 PINN 在源域上训练，然后直接在目标域的测试集上测试。“训练目标电池”表示 PINN 在目标域的 1 或 2 个电池上训练，然后在目标域的测试集上测试（与小样本实验相同）。为方便起见，我们只选择 XJTU 数据集批次 1 的数据来代表 XJTU 数据集。同样，TJU 数据集批次 3 的数据用于代表 TJU 数据集。

Fig. 1: a 锂离子电池可能具有不同的化学成分（例如，锂镍钴锰酸盐（NCM）、锂镍钴铝酸盐（NCA）和锂铁磷酸盐（LFP）等）。不同的用户具有个性化的电池放电策略，导致不同的退化轨迹。 b 特征提取的选定数据的示意图。我们从电池充电前的一段短时间数据中提取特征。这些特征用作所提出PINN估计SOH的输入。上部图是第10个循环的曲线，下部图是整个生命周期的所有曲线。电池老化和充放电协议的变化导致曲线偏移。 c 所提出PINN的结构，其中 u 和û分别表示真实和估计的SOH， t 和 x 表示循环和特征，上标 i 表示样本索引，下标 t 和 x 表示相应的偏导数。函数 f ( ⋅ ) 和 g ( ⋅ ) 分别模拟特征到SOH的映射和电池的退化动力学，并且F  ( ⋅ ) 和G  ( ⋅ ) 表示用于近似 f ( ⋅ ) 和 g ( ⋅ ) 的神经网络（请参见“方法”部分的更多细节）。

Fig. 2: 总共有6批（55个电池），所有批次都包含8个电池，除了第2批包含15个电池。批次之间的充放电协议不同。请参见补充说明[1] 以获取更多细节。

Fig. 3: a XJTU 数据集批次 1 中 8 个电池的特征。每个子图的 x 轴为 SOH，每个子图的 y 轴为对应特征的归一化值。每个子图右侧的数字代表特征编号。 b 四个数据集中提取的特征与 SOH 之间的相关性热图。数字 1–16 代表 16 个特征，其顺序与 ( a ) 中的顺序一致。

Fig. 4: a 提出的 PINN 在四个数据集上的 SOH 估计结果。预测的 SOH 和真实的 SOH 分布在对角线附近，表明模型性能良好。 b 三个模型（提出的 PINN（Ours）、多层感知器（MLP）和卷积神经网络（CNN））在四个数据集上的平均绝对误差（MAE）、平均绝对百分比误差（MAPE）和根均方误差（RMSE）的分布。每个误差条包含 10 个点（10 次实验），并标有均值和标准差线。与其他两种方法相比，我们的方法具有更小的预测误差和更好的稳定性。源数据作为源数据文件提供。

Fig. 5: 每个误差条包含10个点（10次实验），并标记有均值和标准差线。图例中的“1个电池”表示我们只使用1个电池的数据来训练模型。其他的类似。随着电池数量的增加，三个模型的性能都在提高。然而，我们的方法仍然在他们中表现最好。 a XJTU数据集批次1的结果。 b HUST数据集的结果。源数据作为源数据文件提供。

Fig. 6: a 提取的特征 x 和循环 t 用于估计SOH u 。û表示估计的SOH，下标 t 和 x 表示相应的偏导数。神经网络F  ( ⋅ ) 和G  ( ⋅ ) 分别用于建模特征到SOH的映射和电池的退化动力学。 b 当提出的PINN应用于迁移学习场景时，动力学G  ( ⋅ ) 被冻结，只有解决方案F  ( ⋅ ) 被微调。

