基于物理信息的神经网络用于锂离子电池退化稳定建模和预测

摘要: 准确的健康状态（SOH）估计对于锂离子电池的可靠和安全运行至关重要。然而，由于电池类型和操作条件的多样性，可靠和稳定的电池SOH估计仍然具有挑战性。在本文中，我们提出了一种基于物理信息的神经网络（PINN），用于准确和稳定地估计电池SOH。具体而言，我们从经验退化和状态空间方程的角度对影响电池退化的属性进行建模，并利用神经网络捕捉电池退化动态。设计了一种通用特征提取方法，从电池完全充电前的一小段数据中提取统计特征，使我们的方法适用于不同的电池类型和充放电协议。此外，我们生成了一个由55个锂镍钴锰氧化物（NCM）电池组成的综合数据集。结合来自不同制造商的另外三个数据集，我们总共使用387个电池和310,705个样本来验证我们的方法。平均绝对百分比误差（MAPE）为0.87%。与其他神经网络相比，我们提出的PINN在常规实验、小样本实验和迁移实验中表现出色。这项研究突出了基于物理信息的机器学习在电池退化建模和SOH估计中的前景。

近年来，锂离子电池的数量在整个社会中以惊人的速度增长，这对可再生能源设备的普及起到了前所未有的推动作用。由于具有高能量密度、低自放电率和长使用寿命的优点，锂离子电池已成为便携式电子设备、电动汽车、航空航天及许多其他领域的主要储能设备, , , , , ,。2019年，仅用于新能源汽车的锂离子电池全球出货量就达到了116.6 GWh 。预计到2025年，全球锂离子电池的装机容量将达到800 GWh，市场价值将达到918亿美元 。锂离子电池的爆炸性增长给人们的生活带来了便利，但其老化和健康管理也引起了人们的关注和重视。锂离子电池的老化是一个重要问题，其性能会随着时间的推移而下降直至失效。为了确保长期、安全和持续的运行，锂离子电池必须得到适当的维护和控制，其中包括健康状态（SOH）的评估。电池的SOH定义为当前可用容量与初始容量的比值，可用作衡量电池退化的指标 。当SOH降至80%时，电池达到其首次使用寿命。达到首次使用寿命的电池仍可在如储能电站等领域进行二次利用。因此，准确估计电池的SOH尤为重要。

近年来，已经提出了各种锂离子电池的SOH估计方法，这极大地推动了该领域的发展, , ,。然而，准确估计SOH仍然是一个具有挑战性的问题。通常，可以通过从上截止电压到下截止电压的完整放电曲线通过安时积分获得容量，从而获得SOH。在实际应用中，很难获得完整的充电或放电曲线，因为电池很少完全放电。一些学者通过建立电池老化模型来估计SOH。Baghdadi等人提出了一种基于Dakin退化方法的物理方法来模拟电池的线性退化过程。考虑到时变温度条件对锂离子电池放电容量和老化规律有重要影响，Xu等人提出了一种基于Arrhenius温度模型的随机退化率模型，并基于Wiener过程建立了锂离子电池在时变温度条件下的老化模型。Dong等人提出了一种结合化学和机械退化机制的物理模型，通过模拟固体电解质界面（SEI）的形成和生长来预测容量衰减。Lui等人通过建模正负极活性材料损失和锂库存损失等退化机制，提出了一种预测锂离子电池容量的物理方法 。

鉴于建立物理模型的困难以及获得完整放电容量的困难，许多研究使用数据驱动的方法来基于充放电过程中的电流和电压曲线估计SOH。常用的数据驱动方法包括线性回归、支持向量机、高斯过程回归、深度神经网络等。Xia等人从增量容量（IC）曲线和微分电压（DV）曲线中提取特征来估计SOH。Wang等人从电化学阻抗谱（EIS）中提取有价值的健康指标作为高斯过程回归的输入来估计SOH。数据驱动方法不需要物理知识，只关注输入和输出之间的关系，因此退化特征的提取是数据驱动方法的关键部分，这在很大程度上决定了SOH估计的性能, , , , ,。

然而，开发可靠、准确和通用的SOH估计方法仍面临挑战,。基于物理的模型稳定且准确，但不同化学成分的电池需要不同的模型参数，并且模型的计算成本很高 。数据驱动模型具有高精度和高效率，但其通用性取决于提取的特征，且稳定性较差,。例如，由于使用的高度可变性，现有方法需要为不同的数据集或不同的工作条件提取特定特征，导致模型是数据集特定的，造成计算资源的浪费。物理信息神经网络（PINN）的前景在于结合基于物理和数据驱动方法的优势，可能解决上述挑战。由于考虑了物理信息，PINN可以使用相对较少的数据来训练模型，并且模型更稳定。这是电池预测和诊断领域的一种有前途的方法。Aykol等人将结合物理知识和机器学习的电池建模方法分为五类，包括三种顺序集成方法，A1–A3，以及两种混合方法，B1–B2。其中，顺序集成方法的一个明显特征是物理模型和机器学习模型是独立的，而混合方法则将两者融合在一起。在此框架内，已经发表了一些工作, , , , , , ,。Nascimento等人通过递归神经网络直接实现了基于原理的控制方程的数值积分，以模拟电池的动态响应。Wang等人提出了一种基于等效电路模型（ECM）的电池神经网络（BattNN）用于放电电压预测。Hofmann等人使用伪二维（P2D）Newman模型在不同健康状态点生成数据，并将其与实验数据和现场数据结合起来训练神经网络模型，该模型利用了内部状态与可测量SOH之间的相关性。根据Aykol等人提出的分类，这些方法属于A2和A3类别, , ,。

事实上，顺序集成方法相对容易实现，因为物理模型和机器学习模型是独立的，使其成为电池建模的一个实用的近期策略。本质上，顺序集成方法中的机器学习模型不受物理约束。另一方面，混合方法更为基础，因为它们真正将电池建模的主要控制方程与数据驱动方法结合在一起。然而，由于复杂的物理方程包含大量参数且难以求解，实施混合方法进行SOH估计的出版物很少。最近的评论指出，混合方法将在长期内成为主导方法，但这仍然是一个开放的研究问题 。

在这项工作中，我们提出了一种用于电池健康状态（SOH）估计的物理信息神经网络（PINN），属于B2架构。该方法实现了控制方程和神经网络的真正集成，从而实现了稳定和精确的SOH估计。与现有的PINN方法不同，我们还验证了其在小样本学习和不同化学成分及充放电特性电池之间的迁移学习中的进步。具体来说，首先，考虑到电化学方程的复杂性，它阻碍了B2型PINN的发展。因此，我们从经验退化和状态空间方程的角度对电池退化动态进行建模，并利用神经网络捕捉电池退化动态。其次，为了使模型更具通用性，我们开发了一种新的特征提取方法。电池的放电过程是用户特定的，电池很少完全放电。相反，一旦开始充电，完全充电的概率很高，并且更加固定和规律。因此，我们从电池完全充电前的一小段数据中提取特征。第三，为了验证我们的方法，我们进行了电池退化实验，并发布了一个包含55个电池失效数据的数据集。此外，我们还在其他三个具有不同化学成分和充放电协议的大规模数据集上验证了我们的方法，证明了我们方法的优越性和通用性。我们还通过将退化知识从一个数据集转移到另一个数据集来执行进一步的SOH估计任务。这些用于执行转移任务的数据集包含具有不同化学成分和充放电协议的电池。结果表明，所提出的PINN在SOH估计中的有效性和通用性。

我们开发了一种用于锂离子电池SOH估计的PINN，其流程图如Fig. [1] 所示。我们的方法旨在通过考虑电池退化的动态行为以及退化趋势，实现更通用、可靠、稳定和高精度的SOH估计。

在数据预处理阶段（如Fig. [1] b所示），从电池完全充电前的一小段数据中提取统计特征作为模型的输入，这确保了这段数据存在于大多数电池数据集中，并解决了现有研究中非通用特征的问题。因此，我们的方法适用于具有不同化学成分和充放电协议的电池。

在SOH估计阶段，由于电化学方程的复杂性，目前没有好的方法将其与神经网络集成。在这项工作中，我们从经验退化和状态空间方程的角度对影响电池退化的属性进行建模，并利用神经网络来逼近已建立的退化模型，有效地实现了控制方程和神经网络的集成。所提出的PINN由两部分组成：一个将特征映射到SOH的解函数f ( ⋅ )和一个建模电池退化动态行为的非线性函数g ( ⋅ )，如Fig. [1] c所示。解函数f ( ⋅ )建模特征与SOH之间的关系，表示为u =f (t ,x )，其中t 表示时间，x 表示提取的特征向量，u 表示循环i 的SOH。非线性函数g ( ⋅ )建模电池的SOH衰减率。由于f ( ⋅ )和g ( ⋅ )在现实中受许多因素影响且其显式表达式未知，因此它们被小型全连接神经网络替代，记为F(⋅)和G(⋅)。在训练过程中，我们考虑数据项损失L data 、单调性损失L mono 和由偏微分方程描述的退化方程约束的损失L PDE 。它们最小化预测值和真实值之间的误差，同时使模型遵循退化轨迹的单调性特性，并满足已建立的退化模型的约束。

为了验证所提出的PINN的优越性，我们进行了小样本实验和迁移实验。在迁移实验中，我们冻结了G(⋅)并在具有不同化学成分的数据集上微调F(⋅)。实验结果表明，所提出的PINN框架能够有效捕捉电池退化的动态。我们的研究结合了电池退化的知识和神经网络，取得了可喜的成果。这项研究突出了物理信息神经网络在电池退化建模和SOH估计中的前景（更多方法细节可在“方法”部分找到）。

为了涵盖不同类型和化学成分的电池，我们使用了来自4个不同大型数据集的387个电池的310,705个样本进行验证。第一个数据集来自我们为本研究进行的电池退化实验，其他三个数据集是Zhu等人、Ye等人和Severson等人 的知名公共数据集。为了方便起见，我们将这四个数据集分别称为XJTU电池数据集、TJU数据集、HUST数据集和MIT数据集 。四个数据集的基本信息见表格 [1] 。

我们在本研究中开发了一个电池退化实验，如Fig. [S1] 所示。总共有55个由力神公司制造的电池（LiNi0.5 Co0.2 Mn0.3 O2 ，2000 mAh标称容量，3.6 V标称电压，充电和放电的截止电压分别为4.2 V和2.5 V）在室温下按照6种充放电协议循环至失效。这些协议包括固定充电和放电、在不同循环中以固定电流随机放电、随机行走以及地球同步轨道（GEO）卫星的充放电策略。我们用批次1到批次6分别表示6种充放电协议。退化轨迹如Fig. [2] 所示。关于我们数据集的更多细节可以在补充说明 [1] 中找到。

TJU数据集包含三种类型的电池：NCA电池（3500 mAh标称容量和2.65–4.2 V截止电压）、NCM电池（3500 mAh标称容量和2.5–4.2 V截止电压）以及NCM + NCA电池（2500 mAh标称容量和2.5–4.2 V截止电压）。这些电池在温度控制的环境中以不同的温度和不同的充电电流速率进行循环。温度候选集包括25、35和45 °C。使用的电流速率范围从0.25 C到4 C。我们用批次1、批次2和批次3分别表示NCA、NCM和NCM + NCA电池。

HUST数据集包含77个LFP/石墨电池在77种不同的多阶段放电协议下的数据。这些电池由A123（APR18650M1A）制造，标称容量为1100 mAh，标称电压为3.3 V。它们在30 °C的温度下以相同的充电协议但不同的放电协议进行循环直至失效。

MIT数据集中的电池与HUST数据集中的电池具有相同的类型和化学成分。然而，与HUST数据集的实验设置不同，MIT数据集考虑了多种快速充电策略和一种放电策略。具体来说，它们在一个快速充电实验中以一步或两步快速充电策略进行循环，并以4 C放电。实验温度为30 °C。

稳健的特征往往可以提高SOH估计的性能。然而，如何提取通用且稳健的特征是一个值得研究的问题。在现有研究中，针对特定数据集和充放电协议提出了各种特征提取方法，但对特征的泛化性考虑不足。很少有研究针对不同电池类型或充放电协议提取通用特征的方法。为了提取更稳健和更具泛化性的特征，我们提出了一种通过观察和探索多个数据集，从充电电压曲线和电流曲线的短时间段中提取特征的方法。毫无疑问，电池的放电过程是用户特定的。相比之下，充电过程是必需的，更加固定和规律，电池完全充电的概率相对较高。我们发现大多数数据集包含恒流和恒压（CC-CV）充电模式。对于我们使用的四个公共数据集，无论电池以何种策略放电或是否完全放电，充电时最终都会完全充电。

因此，我们选择了电池完全充电前的短时间段数据来提取特征，如Fig. [1] b所示。将电池的充电截止电压定义为Vend ，选择电压值在[Vend−0.2 ,Vend ] V范围内的数据。对于电流数据，我们选择在恒压充电期间电流在0.5 A和0.1 A之间的数据。无论电池是否完全放电，只要电池完全充电，电压范围和电流范围始终存在。

分别从选定的电流和电压曲线中提取均值、标准差、峰度、偏度、充电时间、累积电量、曲线斜率和曲线熵（这些特征分别编号为1–16。更多细节见补充说明 [2] ）。Fig. [3] a给出了从XJTU数据集批次1中提取的特征示例。此外，我们分别从4个数据集中的387个电池中提取特征，并计算每个数据集中特征与SOH之间的皮尔逊相关系数，如Fig. [3] b所示。

基于Fig. [3] b的实验现象和分析，我们提出一个自然的猜想：每个特征与SOH之间的相关系数的大小与电池的化学成分有关，而受充放电协议的影响较小。据我们所知，我们是第一个关注这一现象的研究者。从表 [1] 可以看出，XJTU数据集和TJU数据集都是LiNiCo-x型电池。即使它们的标称容量和充放电协议完全不同，从我们选择的范围中提取的特征也高度相似。例如，特征11–16与SOH之间存在非常强的负相关。特征9和10与SOH之间存在强正相关。相比之下，MIT数据集和HUST数据集都是LiFePO4 电池。特征11–16与SOH之间表现出弱正相关，而特征9和10与SOH之间表现出负相关。此外，后两个数据集的特征3–6和8与SOH之间表现出强正相关。

提取的16个特征和时间（循环）用作所提出的PINN的输入以估计SOH。为了减少特征量级差异对模型的影响并使模型训练更加稳定，对特征进行最小-最大归一化。即，所有特征都缩放到[−1,1]范围内。所提出的PINN在4个数据集上的SOH估计结果如Fig. [4] a所示（每个数据集中测试电池的数量见表 [S2] ）。

为了展示所提出的物理信息神经网络（PINN）的进步，使用具有相同结构和参数数量的多层感知器（MLP）和具有相似参数数量的卷积神经网络（CNN）作为比较方法。MLP和CNN的详细信息可以在补充说明 [3] 中找到。对于每个数据集，我们将训练电池、验证电池和测试电池大致按6:2:2的比例划分。每个数据集中的测试电池数量可以在表格 [S2] 中找到。为了确保公平，测试电池的数量在整个数据集中均匀分布，如表格 [S3] – [S6] 所示。四个数据集上三个模型的结果显示在表格 [2] 中（仅给出了每个数据集的平均测试误差，每个电池的测试结果可以在表格 [S3] – [S6] 中查看）。从表中可以看出，我们的方法在大多数情况下具有最小的估计误差。所提出的PINN在四个数据集上的平均MAPE分别为0.85%、1.21%、0.65%和0.78%，而MLP的平均MAPE分别为2.60%、1.72%、0.83%和0.83%。值得注意的是，它们在推理过程中具有相同的参数数量和模型结构。

此外，为了反映模型的稳定性，每个模型在每个数据集上的训练和测试过程重复10次。测试结果显示在Fig. [4] b中。从图中可以看出，我们提出的PINN在所有任务和所有指标上都是最稳定的。XJTU电池数据集的每批样本量较小，导致MLP和CNN的显著波动。相比之下，我们的方法更稳定，测试误差更小。对于HUST数据集和MIT数据集，它们包含大量的训练样本，因此MLP和CNN的波动变小，测试误差也变小。然而，我们提出的PINN仍然是表现最好的模型。

我们提出的PINN模型考虑了更多的物理定律，因此可以用更少的数据进行训练。与纯数据驱动方法相比，当可用训练数据量较小时，我们的方法可以显示出更大的优势。为了验证上述推论，在XJTU数据集和HUST数据集上进行了小样本实验。

具体来说，我们使用1个电池数据来训练3个模型，并在多个电池上进行测试（测试集与2.4中的相同），并记录测试结果。此外，我们逐渐增加训练电池的数量，并观察每个模型在测试集上的性能变化。结果在表格 [3] 和Fig. [5] 中给出（XJTU数据集仅给出批次1的结果，更多结果可以在表格 [S7] 和Fig. [S5] 中找到）。

可以观察到，我们提出的PINN在所有任务和设置中都获得了最佳结果。随着训练电池数量的增加，所有3个模型的测试误差都在减少。这是一个普遍接受的事实：增加训练样本数量可以在训练数据较小时提高模型性能。在Fig. [4] b中，由于HUST数据集中样本数量众多，CNN和MLP的性能与我们的PINN相当。这也说明了当模型的结构或参数数量相同或相似时，给定足够的训练样本，模型性能差异不大。然而，从Fig. [5] 中可以明显看出，当训练样本数量较小时，我们的方法具有显著优势。此外，值得注意的是，我们的PINN仅用1个电池训练的性能与MLP和CNN用3-4个电池训练的性能相当，这证明了我们的PINN在小样本场景中的优越性。

微调是迁移学习的一种实现方式，通过使用少量新收集的数据快速调整模型来提高学习能力。其优势在于可以利用在其他场景（源域）中收集的大量数据来预训练模型，并学习特征与标签之间的基本关系。然后，使用少量目标域数据快速微调模型以获得良好的性能。现有的大多数关于SOH估计的迁移学习研究都是在不同充放电协议之间进行迁移，而在不同数据集（不同化学成分）之间进行迁移的研究较少。在本文中，我们将4个数据集成对组合进行微调实验。

我们认为退化动力学G(⋅)是独立于充放电协议和数据集的，而解F(⋅)与它们相关。在从大量数据中学习之后，G(⋅)应该包含能够反映电池退化本质的一般信息，这对于跨场景SOH估计是有用的。因此，我们只微调解F(⋅)的权重，并将动力学G(⋅)的权重冻结，如Fig. [6] b所示。

我们进行了微调实验和仅源实验，并将它们与小样本实验进行了比较。所有结果都在表格 [4] 中给出。从图中可以看出，微调后的模型明显优于仅源方法。更重要的是，当只有1个标记的目标域电池时，遵循“预训练—微调”范式的模型比直接使用1个目标域电池训练的模型表现更好。这证明了“预训练—微调”范式的有效性。对于XJTU数据集和TJU数据集，即使模型使用2个目标域电池进行训练，其性能也不如使用1个目标域电池微调的模型。这也证明了动力学G(⋅)从源域的大量数据中学习到了有用的信息。

如果从更公平的角度重新审视表格 [4] ，即忽略表格的最后一列，似乎还有一些直观正确但不太明显的见解。XJTU数据集和TJU数据集都是LiNiCo-x电池，特征与SOH之间的相关性更为相似（参见“特征提取”部分的相关性），因此它们之间的微调效果更好。同样，MIT和HUST都是LiFePO4 电池，它们之间的微调效果也很有前景。这可能是一个有意义的发现，我们将在未来继续研究。

准确的SOH估计有助于锂离子电池的健康管理和维护决策。现有的SOH估计方法需要为不同的数据集提取不同的特征，模型的性能波动很大。在这项工作中，我们提出了一种通用的PINN用于电池SOH估计。具体来说，我们提出了一种通用的特征提取方法，从电池完全充电前的一小段数据中提取统计特征，这包括在恒流恒压模式下充电的电池中。然后，我们使用PINN对电池退化动力学进行建模，并通过将提取的特征作为输入来估计SOH。

为了验证我们的方法，我们进行了电池老化实验，并开发了一个包含55个电池的数据集。最后，我们在来自4个大型数据集的387个具有不同化学成分和充放电协议的电池上验证了我们的方法。结果证明了我们提出方法的有效性和可行性。此外，我们进行了小样本实验和迁移实验，证明考虑物理知识有助于数据驱动模型更快更好地从数据中学习。我们的研究强调了物理信息机器学习在电池退化建模和SOH估计中的前景。它可以利用现有的实验数据和少量新数据促进下一代电池管理系统的快速发展。

电池退化建模和SOH估计是电池健康管理领域的研究热点。随着电池的老化，各种界面退化过程发生，同时锂库存和活性材料的损失导致离子和电子传输以及嵌入反应的电阻增加，从而导致其充电曲线的变化 。因此，充电曲线包含了丰富的退化过程信息。然而，使用充放电曲线来估计电池SOH可能会陷入信息泄漏的陷阱。Geslin等人指出，不一致的充放电协议、使用条件等可能导致信息泄漏，这是一个可能被学者忽视的严重问题。他们认为固定的CC-CV模式可以缓解信息泄漏问题。因此，在执行SOH估计任务时，尽量避免纳入与电池内部质量、制造变异性和使用条件相关的因素。在我们的研究中，特征是从电池完全充电前的CC-CV阶段的小段数据中提取的，这与电池的使用条件无关。这确保了我们提取的特征的实用性和多样性，同时避免了由于充电协议或电池使用条件不一致而导致的信息泄漏问题。在训练和测试阶段，我们用电池A的数据训练模型，并在电池B上测试；而不是用电池A的早期数据训练模型并用后期数据测试，从而避免了训练集到测试集的信息泄漏 。

在构建SOH估计模型时，我们提出了一种用于电池SOH估计的PINN。物理信息神经网络作为一种有效的途径，利用人工智能解决实际工程问题，具有很大的潜力。通过将传统物理模型与神经网络模型结合，它可以更准确地捕捉电池系统的复杂动态行为，从而促进更可靠和精确的状态估计。然而，这一新兴领域仍需学者进一步探索。在Aykol等人提出的框架内，利用物理方程约束神经网络或将物理方程整合到神经网络中的混合方法将在长期内占据主导地位。这类混合方法有可能将基于物理的模型的因果性和外推能力与神经网络的速度、灵活性和高维能力相结合。然而，这些方法的局限性在于电池物理模型的复杂性（例如P2D模型），其包含大量参数，且电池的内部参数难以收集。目前尚无满意的方法可以无缝整合物理模型和神经网络。本文提出的PINN是从经验退化和状态空间方程的角度建模的，仅作为对这种混合方法的探索，并作为进一步研究的催化剂。此外，我们仅考虑从易于获取的电流和电压数据中提取特征。随着更多数据和内部变量的可用，可以考虑更复杂的电化学模型。在现有数据和计算资源的约束下，电池控制方程和神经网络的最佳整合仍有待进一步探索 。

电池老化主要表现为可用容量的减少和内部电阻的增加，通常遵循下降轨迹。为了准确描述电池退化轨迹，学者们提出了各种经验模型来描述电池容量损失与时间或循环次数的关系，包括线性模型、指数模型、幂律模型和故障预测模型（FFM）等。这些模型都将电池的退化轨迹描述为时间的单变量函数,。

然而，仅将电池退化轨迹表示为时间的单变量函数过于简化了这一过程。事实上，电池退化不仅与时间有关，还与充电速率、放电速率、日历时间、温度、放电深度（DOD）等有关。例如，Xu等人将电池老化分为日历老化和循环老化，考虑了充电状态（SOC）、DOD、电池温度和固体电解质界面（SEI）膜的生长等因素。他们将日历老化和循环老化建模为日历时间、SOC、DOD和温度的函数 。

因此，仅将电池的退化轨迹建模为时间的函数是不够的。在本研究中，我们提出将其建模为多变量函数： 1 u = f(t , x),  其中t 表示时间，x 表示由SOC、DOD、温度、充电速率、放电速率、健康指标（HIs）和所有其他因素组成的向量。在我们的工作中，x 表示从充电数据中提取的HIs（详见“特征提取”部分）。

在不失一般性的情况下，为描述电池的退化动态，其SOH衰减率可以描述为： 2 ∂ u ∂ t = g t , x , u ; θ.  上述方程是一个由θ 参数化的显式偏微分方程（PDE），g ( ⋅ )表示t 、x 和u 的非线性函数。通过改变这个非线性函数，可以表示各种形式的退化。线性模型、指数模型、幂律模型和FFM等模型可以被视为仅考虑时间时方程( [2] )的特例。

一个不可避免的问题是g ( ⋅ )的显式形式是未知的且难以获得。为应对类似问题，Sun等人提出了一种稀疏回归物理信息神经网络，通过稀疏性从给定的候选集学习g ( ⋅ )的参数θ 。Raissi等人提出了深度隐藏物理模型来建模g ( ⋅ )。受此启发，我们提出使用一个更通用的函数逼近器g ′(⋅)，其参数为θ ′ 来表示非线性动态g ( ⋅ )。因此，方程( [2] )变为： 3 u t ≈ g ′ t , x , u , ut , ux , uxx , ⋯ ; θ′.  在方程中，u t = ∂ u ∂ t ，我们使用一个具有可学习参数Φ的神经网络F t , x ; Φ 来建模f (t ,x )，并利用自动微分机制计算u t ,。u x = ∂u∂x1,∂u∂x2,⋯ ⊤ 表示u 关于x 的一阶偏导数，u xx表示二阶偏导数。这种方法的一个优点是我们不需要为g ( ⋅ )指定候选基函数集，而是使用更通用的逼近器g ′(⋅)。函数逼近器g ′(⋅)提出了一个更灵活的关系到t 、u 、x 及其任意阶偏导数。一个具有可学习参数Θ的神经网络G ⋅ 用于建模g ′(⋅)，以便它可以从给定的x,t 和其他偏导数中学习电池的老化机制。为了平衡精度和计算复杂性，我们只考虑一阶偏导数的影响，舍弃高阶导数。

基于上述分析，我们定义了一个用于电池老化的物理信息神经网络H  ： 4 H : = ∂ F t,x;Φ ∂ t − G t , x , u , ut , ux ; Θ ,  其中∂ F t,x;Φ ∂ t 表示解神经网络F(⋅)关于t 的偏导数，G(⋅)表示由神经网络建模的电池退化动态方程。所提出的PINN的结构如Fig. [6],所示。

方程( [4] )是从方程( [2] )和( [3] )推导而来的。然而，由于它是通过神经网络拟合的，其训练过程是离散的，因此它不严格满足方程( [2] )。对于电池SOH，其计算公式为： 5 u k = f(k , x)= QkQ0 ,  其中Q 表示循环k 的容量，Q 表示名义容量。SOH值u 与当t =k 时的退化轨迹f ( ⋅ )上的点重合 。我们需要使H(ti , xi)= 0  在样本点i 处成立以逼近方程( [2] )。因此，PINN的优化过程需要遵循方程( [2] )指定的PDE损失，即： 6 L PDE = ∑ i = 1 N Hti,xi2 ,  其中上标i 表示第i 个样本，N 表示样本数量。此外，优化目标包括数据项损失和单调性损失： 7 L data = ∑ i = 1 Nui−ûi2 , 8 L mono = ∑ j = 1 M ∑ k = 1 Nj ReLU ûk+1 −ûk ,  其中û i 表示估计的SOH，M 表示电池数量，N j表示电池j 的循环次数，ReLU( ⋅ )是修正线性单元。单调性损失L mono 基于电池退化的物理特性，即下一个循环的SOH应小于或等于前一个循环的SOH（除非发生容量再生）。总函数公式为： 9 L = L data + α L PDE + β L mono ,  其中α 和β 是权衡参数。关于我们模型的更多细节可以在补充说明 [3] 中找到。

我们用于电池老化的PINN由两部分组成：一个构建特征到SOH映射的解神经网络F(⋅)和一个建模电池退化动态的神经网络G(⋅)，如Fig. [6] 所示。我们认为退化动态G(⋅)与充放电协议和数据集无关，而解F(⋅)与它们相关。因此，当我们的PINN应用于迁移学习场景时，动态G(⋅)被冻结，只有解F(⋅)被微调，如Fig. [6] b所示。

Table 1: 四个数据集的化学成分和基本实验条件
数据集 | 批次 | 化学成分 | 标称容量 (mAh) | 截止电压 (V) | 实验温度 (°C) | 电池数量
XJTU | 1,2,3,4,5,6 | LiNi 0.5Co 0.2Mn 0.3O 2| 2000 | 2.5–4.2 | 室温 | 55
TJU | 1 | Li 0.86Ni 0.86Co 0.11Al 0.03O 2| 3500 | 2.65–4.2 | 25,35,45 | 66
| 2 | Li 0.84Ni 0.83Co 0.11Mn 0.07O 2| 3500 | 2.5–4.2 | 25,35,45 | 55
| 3 | 42 (3) wt.% LiNiCoMnO 2和 58 (3) wt.% LiNiCoAlO 2的混合物 | 2500 | 2.5–4.2 | 25 | 9
MIT | – | LiFePO 4| 1100 | 2.0–3.6 | 30 | 125
HUST | – | LiFePO 4| 1100 | 2.0–3.6 | 30 | 77
不同数据集的充放电协议各不相同。

Table 2: 我们提出的PINN、多层感知器（MLP）和卷积神经网络（CNN）在四个数据集上的结果
数据集 | 批次 | 我们的 | MLP | CNN | | | MAPE | RMSE | MAPE | RMSE | MAPE | RMSE
XJTU | 1 |  0.0070|  0.0094| 0.0260 | 0.0277 | 0.0270 | 0.0330
| 2 |  0.0113|  0.0122| 0.0275 | 0.0304 | 0.0298 | 0.0352
| 3 |  0.0086|  0.0100| 0.0211 | 0.0237 | 0.0177 | 0.0212
| 4 |  0.0071|  0.0105| 0.0200 | 0.0235 | 0.0150 | 0.0189
| 5 |  0.0105|  0.0135| 0.0183 | 0.0217 | 0.0350 | 0.0453
| 6 |  0.0063|  0.0097| 0.0204 | 0.0242 | 0.0149 | 0.0194
TJU | 1 |  0.0164|  0.0158| 0.0206 | 0.0197 | 0.0198 | 0.0208
| 2 |  0.0119|  0.0132| 0.0149 | 0.0157 | 0.0143 | 0.0149
| 3 |  0.0080|  0.0079| 0.0150 | 0.0144 | 0.0124 | 0.0125
MIT | |  0.0065|  0.0074| 0.0079 | 0.0087 |  0.0065| 0.0075
HUST | | 0.0078 |  0.0087| 0.0080 | 0.0090 |  0.0074| 0.0087
MAPE是平均绝对百分比误差，RMSE是均方根误差。最佳结果以粗体显示。所有值均为十次实验的平均值。

Table 3: 小样本实验在XJTU数据集批次1和HUST数据集上的结果
数据集 | 训练电池数量 | 我们的方法 | MLP | CNN | | | MAPE | RMSE | MAPE | RMSE | MAPE | RMSE
XJTU | 1 |  0.0141|  0.0184| 0.0343 | 0.0390 | 0.0929 | 0.0949
| 2 |  0.0105|  0.0134| 0.0267 | 0.0304 | 0.0728 | 0.0826
| 3 |  0.0069|  0.0096| 0.0347 | 0.0383 | 0.0548 | 0.0666
| 4 |  0.0056|  0.0076| 0.0292 | 0.0327 | 0.0560 | 0.0647
HUST | 1 |  0.0446|  0.0485| 0.0601 | 0.0682 | 0.3614 | 0.1550
| 2 |  0.0178|  0.0202| 0.0391 | 0.0461 | 0.0826 | 0.0925
| 3 |  0.0154|  0.0181| 0.0251 | 0.0287 | 0.0514 | 0.0618
| 4 |  0.0144|  0.0173| 0.0253 | 0.0288 | 0.0429 | 0.0521
MAPE是平均绝对百分比误差，RMSE是均方根误差。最佳结果以粗体显示。所有值均为十次实验的平均值。“训练电池数量”表示我们分别使用1、2、3和4个电池来训练模型，然后在测试集上进行测试。

Table 4: 四个数据集之间微调实验的测试均方根误差（RMSE）
| 微调 | 仅源域 | 目标电池训练 | | XJTU | TJU | MIT | HUST | XJTU | TJU | MIT | HUST | 1 | 2
XJTU | – |  0.0100| 0.0145 |  0.0104| – | 0.0967 | 0.1329 | 0.0733 | 0.0184 |  0.0134
TJU |  0.0093| – |  0.0119| 0.0146 | 0.1266 | – | 0.1674 | 0.1266 |  0.0121| 0.0202
MIT |  0.0239| 0.0272 | – |  0.0248| 0.0347 | 0.1277 | – | 0.0561 | 0.0324 |  0.0142
HUST |  0.0333| 0.0343 |  0.0307| – | 0.1131 | 0.2008 | 0.0801 | – | 0.0485 |  0.0202
前三个结果分别以粗体、斜体和下划线显示。所有值均为十次实验的平均值。按行查看表格。第一行表示XJTU数据集用作目标域，其他数据集用作源域。“微调”表示PINN在源域上训练，然后用目标域中第一个电池的数据进行微调，并在目标域的测试集上进行测试。“仅源域”表示PINN在源域上训练，然后直接在目标域的测试集上进行测试。“目标电池训练”表示PINN用目标域中的1或2个电池进行训练，然后在目标域的测试集上进行测试（与小样本实验相同）。为方便起见，我们仅选择XJTU批次1的数据来代表XJTU数据集。同样，TJU数据集的批次3用于代表TJU数据集。

Fig. 1: a 锂离子电池可能具有不同的化学成分（例如，镍钴锰酸锂（NCM）、镍钴铝酸锂（NCA）和磷酸铁锂（LFP）等）。不同用户有个性化的电池放电策略，导致不同的退化轨迹。 b 所选数据用于特征提取的示意图。我们从电池完全充电前的一小段数据中提取特征。这些特征用作所提出的PINN的输入以估计SOH。上图是第10个循环的曲线，下图是整个生命周期内的所有曲线。电池老化和充放电协议的变化会导致曲线发生偏移。 c 所提出的PINN的结构，其中 u 和û表示真实和估计的SOH， t 和 x 表示循环和特征，上标 i 表示样本索引，下标 t 和 x 表示相应的偏导数。函数 f ( ⋅ )和 g ( ⋅ )分别建模特征到SOH的映射和电池的退化动态，F  ( ⋅ ) 和G  ( ⋅ ) 表示用于逼近 f ( ⋅ )和 g ( ⋅ )的神经网络（更多细节见“方法”部分）。

Fig. 2: 总共有6批（55个电池），除了第2批包含15个电池外，所有批次都包含8个电池。不同批次的充放电协议不同。更多细节见补充说明[1] 。

Fig. 3: a XJTU数据集批次1中8个电池的特征。每个子图的 x 轴是SOH， y 轴是相应特征的归一化值。每个子图右侧的数字表示特征编号。 b 四个数据集中提取特征与SOH之间的相关性热图。数字1–16代表16个特征，特征的顺序与( a )中的一致。

Fig. 4: a 提出的PINN在四个数据集上的SOH估计结果。预测的SOH和真实的SOH分布在对角线附近，表明模型表现良好。 b 三种模型（提出的PINN（我们的）、多层感知器（MLP）和卷积神经网络（CNN））在四个数据集上的平均绝对误差（MAE）、平均绝对百分比误差（MAPE）和均方根误差（RMSE）的分布。每个误差条包含10个点（10次实验），并标有均值和标准差线。与其他两种方法相比，我们的方法预测误差更小且更稳定。源数据作为源数据文件提供。

Fig. 5: 每个误差条包含10个点（10次实验），并标有均值和标准差线。图例中的“1 battery”表示我们仅使用1个电池的数据来训练模型。其他类似。随着电池数量的增加，三个模型的性能都在提升。然而，我们的方法在其中仍然表现最佳。 a XJTU数据集批次1的结果。 b HUST数据集的结果。源数据作为源数据文件提供。

Fig. 6: a 提取的特征 x 和循环 t 用于估计SOH u 。û表示估计的SOH， t 和 x 的下标表示相应的偏导数。神经网络F  ( ⋅ ) 和G  ( ⋅ ) 分别用于建模特征到SOH的映射和电池的退化动态。 b 当所提出的PINN应用于迁移学习场景时，动态G  ( ⋅ ) 被冻结，只有解F  ( ⋅ ) 被微调。

