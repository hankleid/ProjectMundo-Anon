DynamicBind: предсказание лиганд-специфической структуры комплекса белок-лиганд с помощью глубокой эквивариантной генеративной модели

Аннотация: Хотя были достигнуты значительные успехи в предсказании статических структур белков, внутренняя динамика белков, модулируемая лигандами, имеет решающее значение для понимания функции белков и облегчения открытия лекарств. Традиционные методы докинга, часто используемые при изучении взаимодействий белок-лиганд, обычно рассматривают белки как жесткие. Хотя молекулярно-динамические симуляции могут предложить подходящие конформации белков, они требуют значительных вычислительных ресурсов из-за редких переходов между биологически релевантными состояниями равновесия. В этом исследовании мы представляем DynamicBind, метод глубокого обучения, который использует эквивариантные геометрические диффузионные сети для построения гладкого энергетического ландшафта, способствующего эффективным переходам между различными состояниями равновесия. DynamicBind точно восстанавливает лиганд-специфические конформации из не связанных структур белков без необходимости в голо-структурах или обширном выборе. Замечательно, что он демонстрирует передовую производительность в докинге и виртуальном скрининге. Наши эксперименты показывают, что DynamicBind может приспособиться к широкому диапазону больших конформационных изменений белков и выявить скрытые карманы в не виденных ранее белковых мишенях. В результате DynamicBind показывает потенциал в ускорении разработки малых молекул для ранее недоступных мишеней и расширении горизонтов вычислительного открытия лекарств.

Заметный прогресс был достигнут в области предсказания структуры белков из последовательности данных. Некоторые методы предсказания используют машинное обучение в сочетании с молекулярной динамикой или Монте-Карло, , ,. Эти методы генерируют набор структур. AlphaFold, который является лидером в предсказании почти всех структур в человеческом протеоме, однако, обычно генерирует только несколько конформаций для каждой последовательности белка, несмотря на то, что белки по своей природе динамичны и обычно принимают несколько конформаций для выполнения своих функций, , , ,. Способность белков переходить между разными конформациями является центральной для их биологической активности во всех доменах жизни. Терапевтический эффект молекул лекарств возникает из-за их специфического связывания с только некоторыми конформациями целевых белков и, таким образом, модулирования важных биологических активностей путем изменения конформационного ландшафта этих белков, , ,. На практике, в настоящее время взаимодействия между белками и лигандами изучаются с помощью методов молекулярного докинга, вычислительного моделирования. Докинг является ключевым компонентом структурно-ориентированного открытия лекарств. Однако, несмотря на широкое признание важности динамики белков, традиционные методы докинга часто рассматривают белки как жесткие, или в некоторых случаях, как частично гибкие, разрешая движение только выбранных боковых цепей, для управления вычислительными затратами,. В результате, структуры апобелков, предсказанные AlphaFold, при использовании в качестве входных данных для докинга, дают предсказания положения лигандов, которые не совпадают хорошо с лиганд-связанными ко-кристаллизованными голо-структурами,. Структуры, предсказанные AlphaFold, часто не представляют наиболее благоприятные конфигурации боковых цепей для связывания лигандов, и, следовательно, соответствующая связывающая полость кажется недоступной, поскольку апобелок принимает конформацию, существенно отличающуюся от голо-состояния.

В данной работе мы представляем DynamicBind, геометрическую глубокую генеративную модель, предназначенную для "динамического докинга". В отличие от традиционных методов докинга, которые рассматривают белки как в основном жесткие объекты, DynamicBind эффективно корректирует конформацию белка из его начального предсказания AlphaFold в голо-podobное состояние. Наша модель способна обрабатывать широкий диапазон больших конформационных изменений во время предсказания, таких как хорошо известный переход DFG-in в DFG-out в киназных белках, который представляет собой сложную задачу для других методов, таких как молекулярная динамика (МД) симуляции,. Мы достигли этой эффективности в выборке больших конформационных изменений белков, изучая фьюндированный энергетический ландшафт, где переходы между биологически релевантными состояниями минимально фрустрированы. Это стало возможным благодаря инновационному использованию морф-podobной трансформации для генерации декоев во время обучения (подробнее в "DynamicBind архитектуре" и "Методах"). Настоящий метод имеет сходства с генератором Больцмана, поскольку он позволяет для прямого и эффективного выборки низкоэнергетических состояний из изученной модели. В отличие от традиционных генераторов Больцмана, которые обычно ограничены системами, для которых они обучены, однако, DynamicBind является обобщаемой моделью, которая может обрабатывать новые белки и лиганды,.

В предстоящем разделе результатов мы представляем всестороннюю оценку DynamicBind, демонстрирующую его потенциал для помощи в открытии лекарств. Наша презентация организована в шесть разделов: первым, описывающим модель DynamicBind; затем, оценивающим DynamicBind по сравнению с текущими методами докинга; затем, подчеркивающим способность метода выборки больших конформационных изменений белков в лиганд-специфичном порядке; затем, демонстрирующим объем конформационных изменений, которые он может обработать; иллюстрируя его способность предсказывать криптические полости через кейс-стади; и, наконец, демонстрируя его применение к протеом-широкому виртуальному скринингу с использованием набора данных антибиотиков. Эти исследования коллективно подчеркивают потенциал DynamicBind, создавая основу для дальнейшего понимания и манипулирования ландшафтом взаимодействия белок-лиганд.

DynamicBind выполняет "динамический докинг", процесс, который выполняет предсказание структуры комплекса белок-лиганд, учитывая существенные конформационные изменения белка. DynamicBind принимает апо-podobные структуры (в настоящем исследовании, предсказанные конформации AlphaFold) в формате PDB и малые молекулы лигандов в нескольких широко доступных форматах, таких как Simplified Molecular Input Line Entry System (SMILES) или структура-данные файл (SDF) формат. Во время вывода модель случайным образом размещает лиганд, чья начальная конформация генерируется с помощью RDKit, вокруг белка. Затем, в течение 20 итераций (подробнее в "Модельной архитектуре"), используя прогрессивно меньшие шаги времени, модель постепенно переводит и поворачивает лиганд, корректируя его внутренние торсионные углы. После первых пяти шагов, где изменяется только конформация лиганда, модель затем одновременно переводит и поворачивает остатки белка, изменяя углы хи боковых цепей, в оставшихся шагах.

Как показано на Fig. [1] a, на каждом шаге, особенности и координаты белка и лиганда вводятся в SE(3)-эквивариантный модуль взаимодействия. Последующим, модули белка и вывода генерируют предсказанные перевод, поворот и диэдрические обновления для текущего состояния. Более подробную информацию о модели можно найти в "Трансформации конформации белка". В отличие от традиционного протокола, используемого в обучении моделей диффузии, который генерирует декои, нарушающие родное состояние с помощью гауссовского шума различной величины, наш метод использует морф-podobную трансформацию для генерации декоев белка. В процессе этого родная конформация постепенно переходит в предсказанную конформацию AlphaFold. Структура белков сильно ограничена во многих отношениях, с остатками, связанными пептидными связями, и длины связей управляются химическими принципами. Когда декои генерируются с помощью гауссовского шума, модель в основном учится только возвращаться к наиболее химически стабильной конформации, часто конформации до добавления шума. В настоящей задаче лиганд-связанная голо-конформация неизвестна, и наиболее доступная структура белка - это та, которая предсказана AlphaFold, которая часто существенно отличается от голо-конформации. Учитывая, что предсказанная структура AlphaFold часто уже удовлетворяет большинству химических ограничений, сложно предсказать, как модель, обученная на декоях, сделанных только из гауссовского шума, может точно предсказать долгосрочные трансформации биологической релевантности, которые являются нашей основной задачей. В отличие от этого, декои, сгенерированные нашей морф-podobной трансформацией, обычно удовлетворяют основным химическим ограничениям, позволяя нашей модели сосредоточиться на изучении биофизически релевантных событий изменения состояния. В неограниченных молекулярных динамика симуляциях переходы между мета-стабильными состояниями, такими как переход DFG 'в' и 'из', являются редкими из-за реалистичного, но неровного энергетического ландшафта, intrinsic в силовом поле всех атомов, , , ,. Наш метод, в отличие, имеет значительно более фьюндированный энергетический ландшафт, эффективно снижая свободный энергетический барьер между биологически значимыми состояниями. Следовательно, подобно другим методам генератора Больцмана, настоящий подход демонстрирует заметно повышенную эффективность в выборке альтернативных состояний, релевантных для связывания лигандов. Схематическая фигура включена для иллюстрации этих различий (Fig. [1] b),.

Чтобы оценить наш метод, мы сначала использовали набор данных PDBbind и, в соответствии с предыдущими работами, обучили модель с использованием хронологического, временного разделения наборов обучения, проверки и тестирования. Поскольку тестовый набор PDBbind, включающий около 300 структур 2019 года, включает много нongan-молекулярных лигандов (53 случая - полипептидов), мы расширили объем нашей оценки с использованием отобранного набора тестов Major Drug Target (MDT). Набор MDT включает 599 структур, депонированных в 2020 году или позже, с как лигандами, подобными лекарствам, так и белками из четырех основных семей белков: киназ, GPCR, ядерных рецепторов и ионных каналов (см. «Конструкция набора данных» для более подробной информации). Эти семьи белков представляют собой мишени около 70% одобренных FDA малых молекулярных препаратов, ,.

Вместо использования голо-структур в качестве входных данных, мы приняли более сложный и реалистичный сценарий при тестировании, где мы предположили, что голо-конформация белка недоступна, и использовали только конформации белков, предсказанные AlphaFold, в качестве наших входных данных. Голо-конформации проявляют сильную форму и зарядовую комплементарность к ко-кристаллизованным лигандам, что уже, нереалистично, упрощает предсказание позы лиганда. Напротив, апо-конформации или те, которые предсказаны AlphaFold, могут сталкиваться с трансплантированными лигандами, полученными путем наложения кристаллических структур.

Как показано на Fig. [2] a и b, DynamicBind предсказывает больше случаев с RMSD лиганда ниже различных порогов, чем другие базовые модели. В частности, он достигает доли RMSD лиганда ниже 2 Å (5 Å), составляющей 33% (65%) на тестовом наборе PDBbind и 39% (68%) на тестовом наборе MDT, соответственно.

Оценка моделей только по RMSD лиганда может отдавать предпочтение моделям, основанным на глубоком обучении (DiffDock, TankBind и DynamicBind), благодаря их более высокой толерантности к столкновениям, в то время как может поставить в невыгодное положение методы, основанные на силовых полях (GNINA, GLIDE, VINA), которые строго обеспечивают силы Ван-дер-Ваальса. Значительные столкновения могут препятствовать анализу взаимодействий в структурном проектировании лекарств, затеняя важные молекулярные взаимодействия и усложняя разработку улучшений молекул. Следовательно, мы используем как RMSD лиганда, так и баллы столкновений (определенные по Hekkelman et al.) для оценки скоростей успеха. Fig. [2] c показывает скорости успеха с использованием как строгого критерия, RMSD лиганда

Чтобы оценить обобщение модели на новые белки и лиганды, мы проанализировали результаты, stratified по максимальной последовательности лиганда и белка к обучающему набору (дополнительные Fig. [3] и [4] ). Этот анализ показывает, что DynamicBind работает хорошо с новыми лигандами, превосходя другие методы, но менее эффективен с новыми белками, где он превосходит классические методы докинга с предопределенными истинными карманами связывания. Другие методы глубокого обучения также показывают аналогичные спады с новыми белками, намекая на необходимость более крупного обучающего набора и улучшенных индуктивных предубеждений. Кроме того, учитывая, что определение мест связывания на новых белках является активной областью исследований, проблемы, с которыми сталкиваются методы глубокого обучения, включая наш, вероятно, являются общими для различных подходов. В целом, способность DynamicBind работать с новыми лигандами значима в открытии лекарств, подчеркивая его потенциал в определении конформационных изменений белка, важных для создания эффективных, специфических препаратов.

Традиционные протоколы докинга обычно выполняют выборку конформации белка как отдельный шаг от процесса докинга,. Однако в многих случаях два различных лиганда могут входить в взаимно исключающие конформации белка. Например, киназа c-Met может принимать две различные конформации, соответствующие активным и неактивным состояниям, обычно называемым конформациями Asp–Phe–Gly (DFG)-in и DFG-out (Fig. [3] b, d). Мотив DFG может вывернуться, блокируя или открывая различные области белка. В предыдущих моделях докинга белок должен быть предварительно установлен в правильную конформацию, чтобы иметь возможность выявления подходящей позы лиганда. Напротив, DynamicBind, использующий предсказанную конформацию белка AlphaFold (Fig. [3] a), может динамически корректировать конформацию белка, чтобы найти оптимальную конформацию, которая может вместить лиганд интереса. В качестве представительного примера, для PDB 6UBW предсказанная RMSD лиганда составляет 0,49 Å, а RMSD кармана - 1,97 Å, в то время как RMSD кармана для структуры AlphaFold составляет 9,44 Å. Для PDB 7V3S предсказанная RMSD лиганда составляет 0,51 Å, а RMSD кармана - 1,19 Å (AlphaFold 6,02 Å). Ни один из двух лигандов не был виден ранее в обучающем наборе (Fig. [3] c, e). В нашем количественном анализе только семь белков из тестового набора, представленных в 79 структурах PDB, были найдены в обеих конформациях DFG-in и DFG-out, как отмечено на веб-сервере Kinase–Ligand Interaction Fingerprints and Structures (KLIFS). Fig. [3] f и g демонстрируют, как эти белки (обозначенные их идентификаторами UniProt), начиная с одной и той же начальной структуры, прогрессивно движутся к конформации DFG-in при связывании с ингибитором типа I и наклоняются к конформации DFG-out при взаимодействии с ингибитором типа II. Кроме того, Fig. [3] h показывает, что большинство предсказанных структур белка имеют более низкую RMSD кармана по сравнению с начальными структурами AlphaFold. Эти результаты демонстрируют, что DynamicBind способен захватывать лиганд-специфические конформационные изменения. Эта функция критически важна для предотвращения пропуска потенциальных "хит"-соединений, которые могут связываться хорошо с конформациями, отличными от исходной структуры белка.

Конформация DFG-in/DFG-out была тщательно изучена, и некоторые проблемы могут быть частично решены с помощью ансамблевого докинга, при котором используются белки в обеих конформациях,. Однако ансамблевый докинг повышает вычислительные затраты и может быть не подходящим для менее хорошо охарактеризованных конформаций. В этом разделе мы предоставляем всесторонний анализ шести различных конформационных изменений на уровне пикосекунд до миллисекунд, каждый из которых проиллюстрирован примером из нашего тестового набора PDBbind. На Fig. [4] показана кристаллическая структура, обозначенная розовым цветом, структура AlphaFold - белым цветом, а наш прогноз - зеленым цветом. Собственный лиганд изображен синим цветом, а предсказанный лиганд - оранжевым цветом. ΔRMSD кармана измеряет разницу в RMSD кармана между предсказанной структурой белка и структурой AlphaFold, основанной на сравнении с кристаллической структурой. Отрицательное значение ΔRMSD кармана указывает на то, что предсказанная структура более близко соответствует кристаллической структуре по сравнению с предсказанием AlphaFold. Δclash измеряет разницу в значениях clash между предсказанной парой белок-лиганд и структурой AlphaFold с трансплантированным лигандом. Отрицательное значение Δclash указывает на меньшее количество clash в предсказанном комплексе. На Fig. [4] a собственный лиганд сталкивается с боковой цепью суперимпозированной структуры AlphaFold; в нашем прогнозе эта боковая цепь смещается к native-конформации, тем самым разрешая столкновение. На Fig. [4] b часть кармана блокируется тирозином в структуре AlphaFold; она становится доступной в обоих нашем предсказании и native-структурах. На Fig. [4] c гибкая петля пересекается с лигандом, и она отодвигается в нашем прогнозе, согласно native-структуре. На Fig. [4] d альфа-спирали превращаются в петли возле места связывания лиганда. На Fig. [4] e наблюдается значительное движение вторичной структуры в белке Hsp90α , переходящем от закрытого состояния к открытому. На Fig. [4] f два домена киназы AKT1 сливаются, образуя карман, который ранее не существовал. В целом, настоящая модель может предсказывать различные типы конформационных изменений, связанных с связыванием лиганда, когда карман связывания лиганда либо недостаточно просторен, либо не сформирован в предсказанных конформациях AlphaFold.

Динамическая природа белков часто приводит к образованию скрытых карманов. Эти скрытые карманы, которые появляются во время динамики белка, могут выявить потенциальные мишени для лекарств, не найденные в статических структурах, тем самым превращая ранее "нелекарственные" белки в потенциальные мишени для лекарств. Мы демонстрируем полезность DynamicBind в выявлении этих скрытых карманов, используя белок SETD2, гистонметилтрансферазу, в качестве примера. SETD2, критически важный для лечения множественной миеломы (MM) и диффузной большой клеточной лимфомы (DLBCL), имеет скрытый карман, нацеленный на высокоселективное соединение EZM0414, которое в настоящее время проходит клинические испытания первой фазы. Как показано на Fig. [5] a, b, все гомологи SETD2 в обучающем наборе, определенные сходством белка Смита-Уотермана более 0,4, ко-кристаллизованы с S-аденозилметионином (SAM) или аналогами синефунгина, изображенными линиями. Синефунгин и его аналоги широко ингибируют метилтрансферазы, занимая место SAM, что делает селективное ингибирование SETD2 сложным. До 2019 года не было известно ни одной структуры SETD2 или его гомологов, ко-кристаллизованной с соединением, связанным с местом, нацеленным на EZM0414 (изображенным синими палочками). Следовательно, наш модель не была обучена на структурах с соединением, связанным с этим новым местом. На Fig. [5] c структура AlphaFold и ее поверхность показаны белым цветом. Скрытый сайт кажется заблокированным, вызывая значительные столкновения с трансплантированным EZM0414. Fig. [5] d подтверждает, что EZM0414 является незнакомым лигандом, даже наиболее похожие лиганды Танимото значительно отличаются от EZM0414. Fig. [5] e показывает предсказанную структуру комплекса белок-лиганд, полученную нашей моделью, принимающей предсказанную структуру SETD2 и представление SMILES EZM0414 в качестве входных данных. Fig. [5] f накладывает наш прогноз на кристаллическую структуру комплекса SETD2-EZM0414 (PDB 7TY2). Результатирующая RMSD лиганда составляет 1,4 Å, а RMSD кармана - 2,16 Å. Кроме того, мы включили в дополнительную информацию несколько примеров из набора данных Cryptosite, которые имеют низкое последовательное сходство с нашим обучающим набором,.

При целевой открытии лекарств как скрининг потенциальных кандидатов на лекарства, так и обратный скрининг, при котором выявляются белковые мишени для конкретных соединений, являются важными. Эти процессы требуют точного предсказания аффинности связывания, меры силы взаимодействия между белком и соединением, на уровне протеома. Поэтому мы добавили модуль предсказания аффинности к нашей модели, обученной с использованием экспериментально измеренных данных аффинности связывания из набора данных PDBbind. Чтобы оценить DynamicBind в реальной виртуальной скрининговой задаче, мы использовали недавно опубликованный экспериментальный бенчмарк антибиотиков. Этот набор данных включает панель из 2616 пар белок-соединение, ни одна из которых не встречалась во время нашей фазы обучения. Он включает 12 белков из эссенциального протеома Escherichia coli, объединенных с 218 активными антибактериальными соединениями. Fig. [6] a показывает, что DynamicBind превосходит общие методы докинга, такие как VINA и DOCK6.9, и лучшие методы машинного обучения, основанные на переоценке, достигая среднего значения площади под кривой оперативной характеристики приема-отклонения (auROC) 0,68. Базовые значения напрямую взяты из бенчмарк-пapers. Это улучшение производительности обусловлено динамической возможностью докинга DynamicBind, которая уточняет структуру AlphaFold до более native-подобного состояния, что приводит к более точному предсказанию аффинности связывания. Как показано на Fig. [6] b, предсказанные структуры белка murD более плотно окружают лиганд, образуя больше взаимодействий, которые были невозможны с исходной структурой AlphaFold. Эта оценка на бенчмарке антибиотиков согласуется с нашими бенчмарками на тестовых наборах PDBbind для предсказаний аффинности связывания (Дополнительная таблица [1] ), где DynamicBind последовательно превосходит традиционные методы докинга и методы машинного обучения, основанные на жестком докинге. Эти результаты указывают на то, что DynamicBind, с его возможностью предсказания аффинности связывания, демонстрирует значительный потенциал для виртуальной скрининговой задачи на уровне протеома.

DynamicBind объединяет два традиционно разделенных шага, генерацию конформации белка и предсказание позы лиганда, в единую структуру. Как метод машинного обучения от конца до конца, он на несколько порядков быстрее традиционных симуляций MD при выборке обширных конформационных изменений белка. Напротив, традиционные методы докинга требуют предварительно определенных карманов связывания, DynamicBind имеет возможность выполнять глобальный докинг, что становится важным, когда карман связывания еще не определен. Эти преимущества наделяют DynamicBind возможностью виртуальной скрининговой задачи для соединений, связывающихся с скрытыми карманами. Такие соединения, вероятно, будут связываться исключительно с целевым белком, потенциально минимизируя побочные эффекты. Кроме того, DynamicBind может предсказывать, может ли новый кандидат на лекарство связаться с непреднамеренной белковой мишенью или может помочь в выявлении мишени при открытии активного соединения методом фенотипного скрининга.

DynamicBind, демонстрируя состояние-оф-арт производительность в наших бенчмарках, все еще предлагает возможности для улучшения, особенно в повышении его способности обобщать на белки с низкой последовательной гомологией по сравнению с теми, что в обучающем наборе,. Как модель, основанная на данных, она значительно выигрывает от быстрого прогресса в методах Cryo-EM, ,. Эти технологические достижения расширят разнообразие и полноту наших обучающих данных, предоставляя более разнообразные конформации комплексов белок-лиганд на более быстрой скорости. Также есть потенциал для улучшения DynamicBind путем использования большого количества неструктурных данных об аффинности связывания, которые в настоящее время более многочисленны, чем кристаллизованные структуры. Применяя подход само-дистилляции, аналогичный AlphaFold, мы могли бы дополнить наш обучающий набор, интегрируя высокоconfidence-предсказания структур комплексов белок-лиганд, которые ранее имели только данные об аффинности.

В итоге, DynamicBind представляет собой подход «динамического докинга» для изучения взаимодействий белок-лиганд, отличающийся от традиционных методов докинга, которые рассматривают белки как статические, и молекулярной динамики (МД) симуляций, которые требуют значительных вычислительных ресурсов. Способность к крупномасштабной динамике белков имеет особенно значительные последствия для открытия молекул лекарств, особенно тех, которые нацелены на криптические карманы. Кроме того, лиганд-специфические конформации белков, генерируемые DynamicBind, могут предложить ценные представления о влиянии лигандов на белки, потенциально проясняя структура-функциональные отношения и дополняя наше механистическое понимание.

Наша модель является E(3)-эквивариантной, диффузионной, графической нейронной сетью, использующей грубую зернистость.

E(3)-эквивариантная модель преобразует выходные данные,y , в соответствии с транс-ротацией и операциями паритета, применяемыми к входным даннымx в 3D-пространстве. Исследования показали, что эквивариантные модели могут быть обучены с 1000 раз меньшим количеством данных, при этом давая лучшие результаты на структурах bulk воды. Несмотря на значительные достижения в крио-электронной микроскопии и кристаллографии, существующая база данных комплексов белок-лиганд остается относительно ограниченной, насчитывая только десятки тысяч структур. Следовательно, требуется эффективная модель, способная различать наиболее актуальную информацию и избегать поверхностной информации, которая не сохраняется при перемещении или вращении всей структуры. Традиционный подход к выполнению симметрии SO(3) включает исключительное использование или предсказание инвариантных величин, таких как карта контактов. Однако карта контактов или расстояний не всегда коррелирует с физически возможными конфигурациями. Например, остаток может быть предсказан как находящийся в контакте с двумя сильно удаленными атомами. Кроме того, карта контактов может не учитывать хиральность, значимый аспект в открытии лекарств.

Как диффузионная модель, DynamicBind обучается через процесс, который постепенно искажает native конформацию в различных степенях, позволяя модели изучить, как восстановить правильную конформацию. Искажение исходной конфигурации обычно включает добавление транс-локационного гауссовского шума к атомам. С ограничениями расстояний связи, налагаемыми химическими связями, и исключенными объемными эффектами, обеспечиваемыми силами Ван-дер-Ваальса, восстановление из таких искажений является простым, когда искажение относительно небольшое. Однако мы обнаружили, что добавление только гауссовского шума является недостаточным для обучения модели, которая может предсказать преобразование из одной биологически значимой конфигурации в другую. Чтобы решить эту проблему, мы ввели морфоподобное преобразование, которое интерполирует между кристаллической структурой белка и структурой, предсказанной AlphaFold, тем самым уменьшая барьеры перехода между метастабильными конфигурациями, такими как предсказанная AlphaFold конформация и лиганд-связанная голо-конформация. В отличие от других генеративных моделей, которые обучают функцию счета,s θ(x , t)≈ ∇ log p t(x), наша диффузионная архитектура направлена на отображение искаженных структур непосредственно на исходные конформации, подобно модели согласованности,. Выходные данные модели обозначаются какf θ xt , t = − ϕ xt , t , гдеϕ xt , t представляет добавленное морфоподобное преобразование к native конформации.

Традиционные методы используют все-атомное представление, моделируя координаты каждого атома явно. Однако атомы не движутся независимо из-за их связей через химические связи, и местная геометрия сильно ограничена - например, бензольное кольцо обычно плоское. Чтобы уменьшить количество степеней свободы этих нефизических конфигураций, мы приняли грубую зернистость для белка и лиганда. В нашей модели каждый остаток белка представлен узлом с двумя векторами - координатами и направлениями, и диэдральными углами боковой цепи. Более подробная информация представлена в «Featurization». Для лиганда каждый тяжелый атом представлен узлом, и эти узлы преобразуются внешне-внутренним образом, при котором изменения диэдральных углов преобразуются в изменения декартовых координат. Дополнительная информация может быть найдена в «Transformation of the ligand conformation». Заметно, что, несмотря на грубую зернистость, координаты всех не-водородных атомов все еще могут быть сопоставлены в один-к-одному соотношении.

Входными данными для нашей модели являются текущая конформация белка и лигандa. Выходными данными являются прогнозируемые обновления доk скалярных торсионных углов и два вектора перевода и вращения для каждого лиганда, а также обновления доk i p скалярных диэдральных углов боковой цепи и два вектора перевода и вращения основной цепи для каждого остатка белка. Более подробную информацию можно найти в разделе «Преобразование конформации белка». Кроме того, модель производит два скалярных выхода: один для оценки степени родной конформации по оценке cLDDT (контакт-LDDT), и другой для прогнозирования сродства связывания между белком и лигандом.

Лиганд в нашей модели представляет собой атрибутированный графG l =(Vl , El), в котором каждый узелv i l ∈ V l представляет тяжелый атом, а ароматические, одинарные, двойные или тройные связи представляют собой ребра. Признаки узла графа лиганда включают атомный номер, хиральность, степень и формальный заряд. Кроме типа связи, в качестве скалярных признаков ребер используется также вложение длины ребра.

Граф белка обозначается какG p =(Vp , Ep), где каждый узелv i p ∈ V p соответствует остатку в позицииC α. Признаки узла в графе белка включают тип аминокислоты, вложение языковой модели изesm , и диэдральные углы боковой цепи, которые представлены как (7 × 2)-мерные скалярные признаки с заполнением нулями (пять поворотных угловchi [chi1, chi2,..., chi5] и два симметричных углаchi [altchi1, altchi2] для каждой аминокислоты, и эти углы преобразуются в синус и косинус). Чтобы обеспечить уникальность углов боковой цепи для данной структуры, мы последовательно обрабатываем их как [max( chi1,altchi1 ), min( chi1,altchi1 ), max( chi2,altchi2 ), min( chi2,altchi2 ), chi3, chi4, chi5]. Кроме того, ориентация основной цепи представлена двумя единичными векторными признаками, которые являютсяxN − xCαxN−xCα иxC − xCαxC−xCα. Для ребер в качестве скалярных признаков используется вложение длины.

DynamicBind является графической нейронной сетью, которая использует как эквивариантные, так и инвариантные признаки. Она распространяет информацию с помощью тензорных произведений неприводимых представлений (irreps) в соответствии с определениями в библиотеке e3nn.

Скалярные признаки узлов и ребер соединяются с синусоидальными вложениями времени диффузии, а затем кодируются разными многослойными перцептронами (MLP). Для узла белка два единичных векторных признака аминокислот соединяются с новыми скалярными представлениями для формирования начальных признаков для слоев взаимодействия. Аналогично DiffDock, на каждом шаге процесса распространения графа графы лиганда и белка проходят одно внутри-взаимодействие и одно меж-взаимодействие. В внутри-взаимодействии лиганда представление каждого атома лиганда обновляется другими атомами лиганда в пределах расстояния 5 Å. Для белка каждый остаток обновляется другими остатками в пределах расстояния 15 Å. Чтобы уменьшить время обучения и использование памяти модели, для каждого остатка разрешено не более 24 соседей. Ребра для меж-взаимодействия определяются на основе того, находится ли остаток в пределах расстояния (3σ t  r+ 12) Å от любого атома лиганда, гдеσ t  r— текущее стандартное отклонение шума трансляции диффузии. Этот динамический порог предназначен для обеспечения межсоединений даже тогда, когда лиганд находится далеко от рецептора, когдаσ t  rвелик. После определения связанного графа сообщения узла обновляются с помощью TensorProductLayer.























Чтобы оценить взаимодействие между белком и лигандом в предсказанной комплексной структуре, мы определяем степень формирования межмолекулярных native контактов. Мы принимаем определение, аналогичное тому, которое используется для Local Distance Difference Test (LDDT) балла, ранее использованного для количественной оценки натуральности предсказанных белковых структур. Балл Contact-LDDT (cLDDT) рассчитывается путем рассмотрения расстояний менее 15 Å среди всех пар атомов лиганда и белка. Разница расстояний определяется между эталонной и предсказанной комплексной структурой, с учетом симметрии. Окончательный балл cLDDT получается из средней доли сохраненных расстояний через четыре порога толерантности: 0,5, 1, 2 и 4 Å.

Чтобы оценить отклонение предсказанной белковой структуры от native белковой структуры, окружающей карман связывания, мы вычисляем корень среднего квадрата отклонения (RMSD) кармана. Это выполняется с использованием атомов белка, расположенных в пределах 5 Å от атомов лиганда-эталона. Первоначально предсказанная белковая структура выравнивается с кристаллической белковой структурой. Затем RMSD между предсказанными атомами кармана и кристаллическими атомами кармана определяется.

Аналогично AlphaFill, балл столкновения является корнем среднего квадрата (RMS) перекрытий ван-дер-ваальсовых радиусов по всем расстояниям между атомами лиганда и белка, которые меньше 4 Å. Он рассчитывается следующим образом: 16 балл столкновения  =∑  i  =  0  Nперекрытие ВдWi  2NгдеN — количество рассматриваемых расстояний.

Наш набор данных для обучения и тестирования был построен на основе базы данных PDBbind2020, которая включает в себя отобранную коллекцию из 19 443 кристаллических структур комплексов белок-лиганд, каждая из которых сопоставлена с экспериментально измеренной связывающей способностью. Мы использовали тот же временной разрез, что и в предыдущих работах, используя структуры, депонированные до 2019 года для обучения и валидации, а те, что были депонированы в 2019 году, были оставлены для тестирования. Каждый белок был выровнен с предсказанной структурой AlphaFold, соответствующей одной и той же последовательности белка. Выровненные структуры AlphaFold и кристаллические структуры используются для генерации образцов обучения белковой части методом морфологической интерполяции. Набор тестов Major Drug Targets (MDT) был построен с использованием следующих критериев: PDB, депонированные в 2020 году или позже; белки, относящиеся к одной из четырех основных групп мишеней лекарств - киназ, GPCR, ядерных рецепторов и ионных каналов; предсказанные структуры белка AlphaFold имеют RMSD кармана выше 2 Å (или LDDT кармана ниже 0,8) с кристаллической структурой; лиганды являются малыми молекулами, подобными лекарствам, с молекулярной массой между 200 и 650 Дальтонами; не более 10 PDB из одного исследования включены. Эти критерии обеспечивают то, что набор тестов является сложным, с начальными входными белками, отличающимися от native конформации, и представительным, охватывающим широкий спектр мишеней белков. Кроме того, это предотвращает доминирование нескольких белков в整个 наборе тестов, поскольку некоторые исследования депонировали значительно больше PDB, структуры одного и того же белка, ко-кристаллизованные с немного разными лигандами, чем другие исследования, ,.

Мы выполнили докинг на наборах тестов PDBbind (303 пары лиганд-рецептор) и Major drug targets (MDT) (599 пар лиганд-рецептор) с использованием различных методов докинга, перечисленных ниже. Лиганды докинга были извлечены из ко-кристаллизованных структур без изменения их координат, а структуры рецепторов докинга были предсказаны AlphaFold. Мы используем метод, учитывающий симметрию, а именно функцию symmrmsd из пакета spyrmsd для всех вычислений RMSD.

В Autodock Vina лиганды были преобразованы из формата SDF в формат PDBQT с помощью Meeko 2.0.0. Подготовка белка была выполнена с помощью команды «prepare_receptor» в ADFR Suite 1.0. Ящик докинга был определен с помощью автоматического ящика вокруг native лиганда с буфером по умолчанию 4 Å на всех шести сторонах. И центр ящика был центром массы native лиганда. Поскольку борный атом не является допустимым типом атома AutoDock, лиганды с этим атомом не могут быть докированы. Поэтому только 301 пара лиганд-рецептор в наборе данных PDBbind и 597 пар лиганд-рецептор в наборе данных MDT имели выход докинга в VINA rigid docking.

По сравнению с VINA rigid docking, в VINA flexible docking есть дополнительный шаг подготовки гибкого рецептора. Он был выполнен с помощью скрипта python под названием «prepare_flexreceptor.py», который доступен по адресуhttps://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts. Через этот шаг файл белка в формате PDBQT был разделен на два файла формата PDBQT, один для жесткой части и один для гибких боковых цепей. Для режима Vina Flex гибкие боковые цепи должны быть предопределены. Мы определили все остатки с атомами боковых цепей в пределах 5 Å от атомов лиганда как гибкие. В этом режиме остов белка остается жестким. Подготовка лиганда и настройка ящика dokinга былиconsistent с VINA rigid docking.

Файлы ввода лиганда для GNINA находятся в формате PDBQT, созданном с помощью OpenBabel после добавления атомов водорода с помощью RDKit. Файлы ввода белка находятся в формате PDB. Настройка ящика dokinга былаconsistent с VINA rigid docking. Для набора данных PDBbind все пары лиганд-рецептор имели выход докинга. Для набора данных MDT 1 пара не имела выхода, потому что лиганд в исходном файле PDB (PDB ID:8HMU ) не был полностью решен, что имело пропущенные атомы.

GLIDE - это жесткий модуль докинга белка в программном обеспечении Schrödinger. Лиганды были подготовлены с помощью модуля LigPrep. Подготовка белка была выполнена с помощью модуля Protein Preparation Wizard. Файлы сетки были сгенерированы модулем Receptor Grid Generation с внутренним ящиком 10 Å и автоматическим внешним ящиком вокруг лиганда с буфером по умолчанию 4 Å на всех шести сторонах, центрированным на центре массы лиганда. Затем был выполнен докинг с высокой точностью SP. Некоторые лиганды в наборе данных PDBbind являются полипептидами, которые не могут быть обработаны модулем LigPrep. Кроме того, лиганды с сильными столкновениями с атомами кармана не имели выходной позы при докинге. Поэтому 266 пар лиганд-рецептор в наборе данных PDBbind и 472 пары лиганд-рецептор в наборе данных MDT имели выход докинга в GLIDE rigid docking.

Модуль докинга с индуцированной подгонкой (IFD) в программном обеспечении Schrödinger обеспечивает функцию докинга с гибким рецептором для пользователя. В отличие от VINA и GNINA, не только боковые цепи остатков, но и остов белка могут слегка двигаться. Подготовка лиганда и белка была такой же, как в GLIDE rigid docking. Пространство поиска было определено по умолчанию, внутренний ящик 10 Å и внешний ящик с автоматическим размером (аналогичным размеру лиганда), центрированным на центре массы native лиганда. Аминоацильные остатки в пределах 5 Å от атомов лиганда были определены как гибкие остатки. Процесс докинга был выполнен по стандартному протоколу, который генерирует до 20 поз. Всего 284 пары лиганд-рецептор в наборе данных PDBbind и 580 в наборе данных MDT были успешно докированы с помощью модуля IFD. Докинг с индуцированной подгонкой может давать выходные позы успешно для большего количества пар лиганд-рецептор в наборе данных PDBbind, чем GLIDE rigid docking, что указывает на то, что этот метод докинга может расширить карман, двигая остатки кармана.

Дополнительная информация о конструкции исследования доступна в [Nature Portfolio Reporting Summary] , связанном с этой статьей.

Fig. 1: a Голое состояние представлено в розовом цвете, начальное апо- и предсказанная моделью конформация - в зеленом. Родственный лиганд изображен в циановом цвете, а предсказанный лиганд - в оранжевом. Модель принимает на вход как признаки, так и текущую конформацию белка и лиганда. Выходные данные включают предсказанные обновления: глобальное перевод и вращение для обоих лиганда и каждого остатка белка, вращение торсионных углов для лигандов и углов χ для остатков белка, а также два модуля предсказания (связывающая способность, A и оценка достоверности, D). На этапе обучения модель предназначена для изучения преобразования из апо-конформации в голую конформацию. На этапе вывода модель итеративно обновляет начальную входную структуру двадцать раз. b Схематическая фигура показывает, что наш модель может предсказать две разные голые конформации, когда белок связывается с двумя разными лигандами. Наша модель может предсказать связанную конформацию белка в течение 20 шагов, в то время как для нахождения того же связанного состояния требуются миллионы шагов молекулярно-динамических симуляций всех атомов.

Fig. 2: a , b DynamicBind превосходит другие методы в предсказании положений лигандов для обоих наборов данных PDBbind ( a ) и основных мишеней лекарств (MDT) ( b ) на разных порогах RMSD. c Темные и светлые оттенки представляют собой скорости успеха при строгих (RMSD лиганда

Fig. 3: Структуры, предсказанные AlphaFold, изображены белым цветом, кристаллическая структура с белком и лигандом - розовым и синим цветом соответственно. Предсказания нашей модели показаны зеленым и оранжевым цветом для белка и лиганда соответственно. Боковые цепи остатков Asp–Phe–Gly (DFG) показаны в виде палочек. Красные стрелки подчеркивают значительные конформационные изменения кристаллической структуры от структуры, предсказанной AlphaFold. Входная конформация - это конформация, предсказанная AlphaFold. a Когда лиганд 84S ( b ) связывается с белком c-Met, белок принимает конформацию DFG-in. Когда лиганд 5I9 ( d ) связывается с тем же белком, белок принимает конформацию DFG-out. Наше предсказание для обоих лигандов ( c , e ) хорошо согласуется с кристаллической структурой. RMSD лиганда составляет 0,49 Å и 0,51 Å. Улучшение RMSD кармана от первоначальной AlphaFold составляет 7,47 Å и 4,83 Å для DFG-in и DFG-out соответственно. Среди тестового набора семь белков (идентифицированных по их UniProt ID), содержащих обе кристаллизованные голо-конформации DFG-in и DFG-out, их RMSD кармана как первоначальной AlphaFold, так и предсказанных структур показаны в ( f , n = 39) и ( g , n = 34) для голо-конформаций DFG-in и DFG-out соответственно, где центральная линия обозначает медиану, края коробки указывают на верхний и нижний квартили, усики распространяются до 1,5 раза межквартильного диапазона, и отдельные точки в точках. h Гистограмма улучшения RMSD кармана от AlphaFold для всех 79 PDB. Исходные данные предоставлены в виде файла Source Data.

Fig. 4: Белки подвергаются конформационным изменениям, которые могут происходить в различных масштабах времени при связывании с малыми молекулярными лигандами. Отрицательное значение ΔRMSD кармана указывает на то, что предсказанная структура имеет более низкое значение RMSD с реальной структурой по сравнению со структурой, предсказанной AlphaFold. Отрицательное значение Δclash означает, что предсказанный лиганд имеет более низкий балл столкновения с предсказанной структурой по сравнению с трансплантированным лигандом со структурой AlphaFold. a Боковая цепь аргинина поворачивается, смягчая столкновения с лигандом. b Тирозин в структуре AlphaFold, который препятствовал связыванию лиганда, смещается в предсказанной структуре. c Область петли структуры AlphaFold пересекается с лигандом и переориентируется в предсказанной структуре. d Альфа-спирали near места связывания превращаются в петли, выравниваясь с кристаллической структурой. e Альфа-спираль Hsp90 испытывает значительное перемещение. f Два домена сливаются, образуя карман связывания. Исходные данные предоставлены в виде файла Source Data.

Fig. 5: a Только шесть PDB в обучающем наборе имеют белковую последовательность Смита-Уотермана, подобную белку SETD2, и все они кристаллизованы с лигандами, подобными SAM, также показанными линиями в ( b ). Лиганд PDB 7TY2, EZM0414, отображается палочками циана, а белок показан розовым. c Полость связывания для EZM0414 отсутствует в структуре AlphaFold, изображенной белым. d Эта панель показывает Танимото-подобность лигандов в обучающем наборе по сравнению с EZM0414, и три наиболее подобных лиганда изображены. e Предсказанная структура комплекса белок-лиганд DynamicBind, где белок представлен зеленым, а лиганд - оранжевым. f Суперпозиция комплекса, предсказанного DynamicBind, и соответствующей кристаллической структуры. Исходные данные предоставлены в файле Source Data.

Fig. 6: a Сравнительная оценка производительности виртуального скрининга на тесте антибиотиков разными методами, измеренная в терминах auROC (площадь под кривой ROC). Тест включает n = 12 различных белковых систем. Каждый график ящиков показывает медиану (центральная линия), верхний и нижний квартили (края ящика), усики, протянувшиеся до 1,5 раза межквартильного диапазона, и отдельные точки данных (точки). Мы точно включили все шесть базовых чисел, представленных в статье теста. b Структура белка, предсказанная AlphaFold, показана белым, а структуры белка, сгенерированные DynamicBind для трех активных соединений, показаны зеленым. Красные стрелки указывают области, где белок приближается к лиганду, образуя дополнительные взаимодействия. Исходные данные предоставлены в файле Source Data.

