DynamicBind: predicting ligand-specific protein-ligand complex structure with a deep equivariant generative model

Abstract: 尽管在预测静态蛋白质结构方面取得了显著进展，但蛋白质的固有动态性，受配体调节，对于理解蛋白质功能和促进药物发现至关重要。传统对接方法通常用于研究蛋白质-配体相互作用，通常将蛋白质视为刚性。虽然分子动力学模拟可以提出适当的蛋白质构象，但由于生物相关平衡状态之间的罕见转变，它们的计算需求很高。在本研究中，我们介绍了DynamicBind，这是一种深度学习方法，采用等变几何扩散网络构建平滑的能量景观，促进不同平衡状态之间的高效转换。DynamicBind能够从无配体的蛋白质结构中准确恢复配体特异性构象，无需全结构或广泛的采样。值得注意的是，它在对接和虚拟筛选基准测试中表现出最先进的性能。我们的实验表明，DynamicBind可以适应广泛的大型蛋白质构象变化，并在未见过的蛋白质靶标中识别隐秘口袋。因此，DynamicBind在加速针对先前难以成药的目标的小分子开发和扩展计算药物发现的视野方面显示出潜力。

在从序列数据预测蛋白质结构的领域中，已经取得了显著进展。一些预测技术结合了机器学习与分子动力学或蒙特卡洛方法, , ,。这些方法生成了一组结构。尽管AlphaFold在预测人类蛋白质组中几乎所有结构方面处于领先地位，但通常只为每个蛋白质序列生成少数几种构象，尽管蛋白质本质上是动态的，通常会采用多种构象来执行其功能, , , ,。蛋白质在不同构象之间相互转换的能力是其在所有生命领域中生物活性的核心。药物分子的治疗效果源于它们仅与目标蛋白质的某些构象特异性结合，从而通过改变这些蛋白质的构象景观来调节关键的生物活性, , ,。在实践中，现在通常通过计算方法研究蛋白质与配体之间的相互作用。对接是基于结构的药物发现的关键组成部分 。然而，尽管广泛认识到蛋白质动态性的重要性，传统对接方法通常将蛋白质视为刚性，或在某些情况下，仅部分灵活，仅允许选定的侧链移动，以管理计算成本,。因此，当使用AlphaFold预测的无配体蛋白结构作为对接的输入时，配体姿态预测通常与配体结合的共晶全结构不一致,。AlphaFold预测的结构通常不呈现有利于配体结合的最有利的侧链旋转异构体构象，因此相关的结合口袋似乎不可达，因为无配体蛋白采用了与全状态显著不同的构象。

在这里，我们介绍了DynamicBind，这是一种用于“动态对接”的几何深度生成模型。与传统对接方法将蛋白质视为主要刚性实体不同，DynamicBind能够从其初始AlphaFold预测中高效地调整蛋白质构象至类似全状态。我们的模型能够处理预测过程中广泛的大型构象变化，例如激酶蛋白中著名的DFG-in到DFG-out的转变，这是其他方法（如分子动力学（MD）模拟）难以应对的挑战,。我们通过学习一个漏斗状的能量景观，使生物相关状态之间的转换最小化，从而实现了对大型蛋白质构象变化的有效采样 。这是通过在训练过程中采用类似形态的转换生成诱饵来实现的（更多内容见“DynamicBind架构”和“方法”）。该方法与Boltzmann生成器类似，因为它允许从学习模型中直接且高效地采样低能态。然而，与传统Boltzmann生成器通常仅限于其训练系统不同，DynamicBind是一种通用模型，可以处理新的蛋白质和配体,。

在接下来的结果部分，我们将全面评估DynamicBind，展示其在药物发现中的潜力。我们的展示分为六个部分：首先，概述DynamicBind模型；然后将DynamicBind与当前对接方法进行基准测试；然后突出该方法以配体特异性方式采样大型蛋白质构象变化的能力；然后具体展示其处理构象变化范围的能力；通过案例研究说明其预测隐秘口袋的能力；最后展示其在使用抗生素数据集进行全蛋白质组虚拟筛选任务中的应用 。这些研究共同突显了DynamicBind的潜力，为深入理解和操纵蛋白质-配体相互作用景观奠定了基础。

DynamicBind执行“动态对接”，即在预测蛋白质-配体复合物结构时适应显著的蛋白质构象变化。DynamicBind接受类似无配体的结构（在本研究中，AlphaFold预测的构象）的PDB格式和几种广泛可用格式的小分子配体，如简化分子输入行输入系统（SMILES）或结构数据文件（SDF）格式。在推理过程中，模型随机放置配体，其初始构象由RDKit生成，围绕蛋白质。然后，在20次迭代过程中（更多细节见“模型架构”），使用逐渐减小的时间步长，模型逐渐平移和旋转配体，同时调整其内部扭转角。在最初的五个步骤中，仅改变配体构象，然后在剩余步骤中同时平移和旋转蛋白质残基，同时修改侧链chi角 。

如图1a所示，在每一步中，蛋白质和配体的特征和坐标被输入到SE(3)-等变交互模块中。随后，蛋白质和读出模块生成当前状态的预测平移、旋转和二面角更新。关于模型的更多细节见“蛋白质构象转换”。与基于扩散模型训练的传统协议不同，后者通过添加不同幅度的高斯噪声来生成诱饵，我们的方法采用类似形态的转换生成蛋白质诱饵。在这个过程中，天然构象逐渐过渡到AlphaFold预测的构象。蛋白质的结构在许多方面受到高度限制，残基通过肽键连接，键长受化学原理的支配。当使用高斯噪声生成诱饵时，模型主要学习恢复到最稳定的化学构象，通常是添加噪声前的构象。在当前任务中，配体结合的全构象未知，最易获得的蛋白质结构是AlphaFold预测的结构，通常与全构象显著不同。鉴于AlphaFold预测的结构通常已经符合大多数化学约束，很难预测仅通过高斯噪声生成的诱饵训练的模型如何准确预测我们主要关注的生物相关长时尺度转变。相比之下，通过我们的类似形态的转换生成的诱饵通常满足基本的化学约束，使我们的模型能够专注于学习生物物理相关的状态变化事件。在无偏分子动力学模拟中，由于全原子力场固有的现实但崎岖的能量景观，元稳定状态之间的转变（如DFG ‘in’和‘out’转变）很少见, , , ,。相比之下，我们的方法具有显著更漏斗状的能量景观，有效降低了生物意义状态之间的自由能障碍。因此，类似于其他Boltzmann生成器方法，当前方法在采样与配体结合相关的替代状态方面表现出显著增强的效率。图1b包含了一个示意图，以阐明这些差异,。

为了评估我们的方法，我们首先使用了PDBbind数据集，并按照先前的工作，我们使用时间顺序的时间分割训练、验证和测试集来训练模型。由于PDBbind测试集（约300个结构，来自2019年）包含许多非小分子配体（53个为多肽），我们扩展了评估范围，使用了一个精心策划的主要药物靶标（MDT）测试集。MDT集包括599个结构，这些结构在2020年或之后存入，包括来自四个主要蛋白家族的药物样配体和蛋白质：激酶、GPCRs、核受体和离子通道（更多细节见“数据集构建”）。这些蛋白家族代表了约70%的FDA批准的小分子药物的目标, ,。

而不是使用全结构作为输入，我们在测试过程中采用了更具挑战性和现实性的场景，假设全蛋白构象不可用，仅使用AlphaFold预测的蛋白质构象作为输入。全构象与共晶配体具有强烈的形状和电荷互补性，这已经不切实际地简化了配体姿态预测 。相比之下，无配体构象或AlphaFold预测的构象可能与通过叠加晶体结构获得的移植配体发生冲突 。

如图 [2] a和b所示，DynamicBind在各种阈值下预测的配体RMSD低于其他基线方法。特别是，它在PDBbind测试集上实现了配体RMSD低于2 Å（5 Å）的比例为33%（65%），在MDT测试集上为39%（68%）。

仅使用配体RMSD评估模型可能会有利于深度学习模型（DiffDock、TankBind和DynamicBind），因为它们具有更高的冲突容忍度，而可能不利于基于力场的方法（GNINA、GLIDE、VINA），后者严格强制范德华力。显著的冲突可能阻碍基于结构的药物设计中的相互作用分析，模糊关键的分子相互作用，并使分子改进设计复杂化。因此，我们使用配体RMSD和冲突评分（由Hekkelman等人定义）来评估成功率。图 [2] c显示了使用严格标准（配体RMSD < 2 Å，冲突评分 <0.35）和宽松标准（配体RMSD < 5 Å，冲突评分 < 0.5）的成功率。DynamicBind的成功率（0.33）在更严格的条件下是最佳基线DiffDock（0.19）的1.7倍。此外，DynamicBind展示了相对于初始AlphaFold结构减少口袋RMSD的能力，即使在原始口袋RMSD较大的情况下（图 [2] d）。这一观察结果表明，当前方法能够管理显著的构象变化，恢复全结构，而其他方法可能难以做到。鉴于我们模型生成多样构象的能力，我们开发了接触-LDDT（cLDDT）评分模块，这一概念受到AlphaFold的LDDT评分的启发。该模块的目的是从预测输出中选择最合适的复合物结构。如图 [2] e所示，我们预测的cLDDT与实际配体RMSD相关性良好，表明其在选择高质量复合物结构方面的有效性。以配体RMSD低于2 Å为真阳性，auROC得分为0.764。尽管我们的cLDDT评分函数有效，但仍有改进的潜力。完美的选择可以将我们的成功率从0.33提高到0.5，如图 [2] f所示。即使在没有理想选择模型的情况下，我们的方法也显著优于DiffDock和顶级基于力场的方法GLIDE。由于Glide生成的样本数量因过滤方案消除不现实的构象而变化，Glide的最佳性能用一条水平线表示。这条线反映了由Glide最有效的样本确定的成功率。DynamicBind的卓越性能源于其能够进行显著的蛋白质构象变化，从而更好地适应蛋白质和配体之间的匹配 。

为了评估模型对新蛋白质和配体的泛化能力，我们分析了按最大配体和蛋白质序列与训练集相似性分层的结果（补充图 [3] 和 [4] ）。这一分析表明，DynamicBind在处理新配体时表现良好，优于其他方法，但在处理新蛋白质时效果较差，被具有预定义真实结合口袋的经典对接方法超越。其他深度学习方法在处理新蛋白质时也表现出类似的下降，暗示需要更大的训练集和改进的归纳偏差。此外，考虑到新蛋白质结合位点的识别是一个活跃的研究领域，深度学习方法（包括我们的方法）在盲全局对接中遇到的挑战可能在不同方法之间是共享的。总体而言，DynamicBind在处理新配体方面的熟练程度在药物发现中具有重要意义，突显了其在识别对创建有效、特异性药物至关重要的蛋白质构象变化方面的潜力。

传统的对接协议通常将蛋白质构象采样作为与对接过程分开的步骤,。然而，在许多情况下，两种不同的配体可能适合互斥的蛋白质构象。例如，c-Met激酶可以采用两种不同的构象，分别对应于活性和非活性状态，通常称为天冬氨酸-苯丙氨酸-甘氨酸（DFG）-in和DFG-out构象（图 [3] b, d）。DFG基序可以翻出，随后阻塞或打开蛋白质的不同区域。在以前的对接模型中，蛋白质必须预设为正确的构象，才有机会识别配体的适当结合姿势 。相比之下，DynamicBind利用AlphaFold预测的蛋白质构象（图 [3] a），可以动态调整蛋白质构象，以找到适合目标配体的最优构象。作为一个代表性案例，对于PDB 6UBW，预测的配体RMSD为0.49 Å，口袋RMSD为1.97 Å，而AlphaFold结构的口袋RMSD为9.44 Å。对于PDB 7V3S，预测的配体RMSD为0.51 Å，口袋RMSD为1.19 Å（AlphaFold 6.02 Å）。这两个配体在训练集中都未曾见过（图 [3] c, e）。在我们的定量分析中，测试集中只有7种蛋白质，代表79个PDB结构，被发现采用DFG-in和DFG-out构象，这些构象由激酶-配体相互作用指纹和结构（KLIFS）网络服务器注释 。图 [3] f和g展示了这些蛋白质（用其UniProt ID表示），从相同的初始结构开始，在I型抑制剂结合时逐渐向DFG-in构象移动，而在与II型抑制剂相互作用时倾向于DFG-out构象。此外，图 [3] h显示，大多数预测的蛋白质结构的口袋RMSD低于初始AlphaFold结构。这些结果表明，DynamicBind能够捕捉配体特异性构象变化。这一特性对于防止忽略可能与初始提供的蛋白质构象不同的构象结合良好的潜在“命中”化合物至关重要。

DFG-in/out构象已广泛研究，一些挑战可以通过使用集合对接部分解决，其中在两种构象中的蛋白质用于对接,。然而，集合对接会增加计算成本，并且可能不适合特征不明显的构象。在本节中，我们对从皮秒级到毫秒级的六种不同的构象变化进行了全面分析，每种变化都以我们在PDBbind测试集中找到的案例为例。在图 [4] 中，晶体结构用粉红色表示，AlphaFold结构用白色表示，我们的预测用绿色表示。天然配体用青色表示，我们的预测配体用橙色表示。Δ口袋RMSD衡量预测的蛋白质结构与AlphaFold结构之间的口袋RMSD差异，基于与晶体结构的比较。负的Δ口袋RMSD表示预测的结构与晶体结构的对齐程度高于AlphaFold预测。Δ冲突衡量预测的蛋白质-配体对与移植了配体的AlphaFold结构之间的冲突评分差异 。负的Δ冲突表示预测的复合物中的冲突较少。在图 [4] a中，天然配体与叠加的AlphaFold结构中的一个侧链发生冲突；在我们的预测中，这个侧链向天然构象移动，从而解决了冲突。在图 [4] b中，AlphaFold结构中的一个口袋部分被酪氨酸阻塞；在我们的预测和天然结构中，它变得可访问。在图 [4] c中，一个灵活的环与配体相交，在我们的预测中，它远离配体，与天然结构一致。在图 [4] d中，α螺旋在配体结合位点附近转变为环。在图 [4] e中，热休克蛋白Hsp90α观察到显著的二级结构运动，从闭合状态转变为开放状态。在图 [4] f中，AKT1激酶的两个结构域合并，形成一个之前不存在的口袋。综上所述，当前模型可以在配体结合口袋在AlphaFold预测的构象中空间不足或未形成时，预测与配体结合相关的多种构象变化。

蛋白质的动态性质经常导致隐秘口袋的出现。这些隐秘口袋在蛋白质动态过程中出现，可以揭示在静态结构中未发现的可药物化位点，从而使以前“不可药物化”的蛋白质成为潜在的药物靶标。我们使用含有SET结构域的蛋白2（SETD2），一种组蛋白甲基转移酶，作为案例研究，展示了DynamicBind在揭示这些隐秘口袋方面的实用性。SETD2对于多发性骨髓瘤（MM）和弥漫性大B细胞淋巴瘤（DLBCL）的治疗至关重要，有一个隐秘口袋被一种高选择性化合物EZM0414靶向，目前正在进行I期临床试验。如图 [5] a, b所示，训练集中所有SETD2同源物，定义为蛋白质Smith-Waterman相似度超过0.4，都与S-腺苷甲硫氨酸（SAM）或Sinefungin类似物共晶，用线条表示。Sinefungin及其类似物通过占据SAM位点广泛抑制甲基转移酶，使SETD2的选择性抑制变得困难。在2019年之前，没有SETD2或其同源物的结构与EZM0414靶向的位点结合的化合物共晶（用青色棍棒表示）。因此，我们的模型没有训练过任何与这一新识别位点结合的化合物结构。在图 [5] c中，AlphaFold结构及其表面用白色表示。隐秘位点被阻塞，导致移植的EZM0414发生显著冲突。图 [5] d确认EZM0414是一个未见过的配体，即使是最相似的Tanimoto配体也与EZM0414有显著差异。图 [5] e显示了我们的模型预测的蛋白质-配体复合物结构，输入为SETD2的AlphaFold预测结构和EZM0414的SMILES表示。图 [5] f将我们的预测与SETD2-EZM0414复合物的晶体结构（PDB 7TY2）叠加。结果的配体RMSD为1.4 Å，口袋RMSD为2.16 Å。此外，我们在补充信息中包括了几个来自Cryptosite数据集的案例，这些案例与我们的训练集序列相似性较低,。







总之，DynamicBind 提出了一种“动态对接”方法，用于研究蛋白质-配体相互作用，使其区别于将蛋白质视为静态的传统对接方法和计算需求高的分子动力学（MD）模拟。其大规模蛋白质动态的能力对药物分子的发现具有特别重要的意义，尤其是针对隐秘口袋的药物分子。此外，DynamicBind 生成的配体特异性蛋白质构象可能为配体对蛋白质的影响提供有价值的见解，有助于阐明结构-功能关系并增强我们的机制理解。

我们的模型是一个E(3)-等变的、基于扩散的图神经网络，使用粗粒度表示。

E(3)-等变模型根据应用于输入x 的3D空间中的平移-旋转和奇偶操作来转换输出y 。研究表明，等变模型可以用少1000倍的数据进行训练，同时在大块水的结构上获得更好的结果 。尽管在低温电子显微镜和晶体学方面取得了实质性进展，现有的蛋白质-配体复合物数据库仍然相对有限，仅扩展到数万个。因此，需要一个高效的模型，能够识别最相关的信息，避免在结构整体移动或旋转时不成立的表面信息。传统方法满足SO(3)对称性的方法是仅使用或预测不变量，如接触图。然而，接触图或距离图并不总是与物理上可行的构象相关。例如，一个残基可能被预测与两个相距甚远的原子接触。此外，接触图可能忽略手性，这是药物发现中的一个重要方面 。





输入到我们模型的是当前蛋白质和配体的构象。输出包括预测的更新：k 个标量扭转角和每个配体的两个平移-旋转向量，以及每个蛋白质残基的k i p 个侧链标量二面角和两个主链的平移-旋转向量。更多细节见“蛋白质构象转换”。此外，模型生成两个标量输出：一个用于估计cLDDT（接触-LDDT）评估的天然构象程度，另一个用于预测蛋白质和配体之间的结合亲和力 。

我们模型中的配体是属性图G l =(Vl , El)，其中每个节点v i l ∈ V l 表示一个重原子，边表示芳香、单、双或三键。配体图的节点特征包括原子序数、手性、度数和形式电荷。除了键类型，边长嵌入也用作标量边特征。





























为了评估预测复合物结构中蛋白质与配体之间的相互作用，我们确定了分子间天然接触形成的程度。我们采用了与之前用于量化预测蛋白质结构天然性的局部距离差异测试（LDDT）评分相似的定义 。接触-LDDT（cLDDT）评分是通过考虑所有配体原子和蛋白质原子之间小于15 Å的距离来计算的。距离差异是在考虑对称性的情况下，确定地面真值和预测复合物结构之间的差异。最终的cLDDT评分是从四个容差阈值（0.5、1、2和4 Å）下保守距离的平均分数得出的。

为了评估预测蛋白质结构与结合口袋周围天然蛋白质结构的偏差，我们计算了口袋均方根偏差（pocket RMSD）。这是使用位于参考配体原子5 Å范围内的蛋白质原子进行的。首先，将预测的蛋白质结构与晶体蛋白质结构对齐。随后，确定预测的口袋原子与晶体口袋原子之间的RMSD。

类似于AlphaFill，冲突评分是配体原子和蛋白质原子之间所有小于4 Å的距离的范德华重叠的均方根（RMS）。计算公式如下： 16 clash score  =∑  i  =  0  NVdW overlapi  2N其中N 是考虑的距离数 。

我们的训练和测试数据集基于PDBbind2020数据库，该数据库包含19,443个蛋白质-配体复合物的晶体结构，每个复合物都配有一个实验测量的结合亲和力。我们采用了与先前工作相同的时间分割，使用2019年之前存入的结构进行训练和验证，而2019年存入的结构则保留用于测试。每个蛋白质都与对应相同蛋白质序列的AlphaFold预测结构对齐。对齐的AlphaFold结构和晶体结构通过类似形态的插值生成蛋白质部分的训练样本。主要药物靶标（MDT）测试集是根据以下标准构建的：2020年或之后存入的PDB；属于四个主要药物靶标组之一的蛋白质——激酶、GPCRs、核受体和离子通道；AlphaFold预测的蛋白质结构与晶体结构的口袋RMSD高于2 Å（或口袋LDDT低于0.8）；配体是分子量在200到650道尔顿之间的药物样小分子；每个研究最多包含10个PDB。这些标准确保了测试集具有挑战性，初始输入蛋白质与天然构象不同，并且具有代表性，涵盖了广泛的蛋白质靶标。此外，它防止了少数蛋白质主导整个测试集，因为某些研究存入的PDB数量显著多于其他研究, ,。

我们使用不同的对接方法对PDBbind测试集（303个配体-受体对）和主要药物靶标（MDT）测试集（599个配体-受体对）进行了对接。对接配体从共晶结构中提取，不改变其原子坐标，对接受体结构由AlphaFold预测。我们使用了一种对称性感知方法，具体是spyrmsd包中的symmrmsd函数进行所有RMSD计算 。

在Autodock Vina中，配体由Meeko 2.0.0从SDF格式转换为PDBQT格式。蛋白质准备使用ADFR Suite 1.0中的“prepare_receptor”命令完成。对接盒使用围绕天然配体的自动盒定义，默认缓冲区为4 Å，所有六个侧面。盒中心是天然配体的质心。由于硼原子不是有效的AutoDock原子类型，因此含有该原子的配体无法对接。因此，PDBbind数据集中只有301个配体-受体对和MDT数据集中597个配体-受体对在VINA刚性对接中有对接输出 。

与VINA刚性对接相比，VINA柔性对接有一个额外的柔性受体准备步骤。该步骤由一个名为“prepare_flexreceptor.py”的Python脚本完成，该脚本可在https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts 上找到 。通过这一步骤，蛋白质PDBQT格式文件被分为两个PDBQT格式文件，一个用于刚性部分，一个用于柔性侧链。对于Vina Flex模式，柔性侧链必须预先确定。我们识别了所有侧链原子在5 Å范围内的配体原子的残基作为柔性残基。在这种模式下，蛋白质主链保持刚性。配体准备和网格盒设置与VINA刚性对接一致。

GNINA的配体输入文件为PDBQT格式，使用OpenBabel在添加氢原子后生成。蛋白质输入文件为PDB格式文件。网格盒设置与VINA刚性对接一致。对于PDBbind数据集，所有配体-受体对都有对接输出。对于MDT数据集，1对没有输出，因为原始PDB文件（PDB ID:8HMU ）中的配体未完全解析，缺少原子 。

GLIDE是Schrödinger软件中的刚性蛋白质对接模块。配体使用LigPrep模块准备。蛋白质准备使用Protein Preparation Wizard模块完成。受体网格文件由Receptor Grid Generation模块生成，内盒为10 Å，外盒为自动大小，围绕配体，默认缓冲区为4 Å，所有六个侧面，中心为配体质心。然后进行SP精度对接。PDBbind数据集中的某些配体是多肽，无法由LigPrep模块处理。此外，与口袋原子严重冲突的配体在对接过程中没有输出构象。因此，PDBbind数据集中266个配体-受体对和MDT数据集中472个配体-受体对在GLIDE刚性对接中有对接输出 。

Schrödinger软件中的诱导拟合对接（IFD）模块为用户提供了一个蛋白质柔性对接功能。与VINA和GNINA不同，不仅残基侧链可以移动，残基主链也可以稍微移动。配体准备和蛋白质准备与GLIDE刚性对接相同。搜索空间由默认参数定义，内盒为10 Å，外盒为自动大小（与配体大小相似），中心为天然配体质心。距离配体原子5 Å范围内的氨基酸残基被定义为柔性残基。对接过程按照标准协议进行，最多生成20个构象。总共，PDBbind数据集中284个配体-受体对和MDT数据集中580个配体-受体对使用IFD模块成功对接。诱导拟合对接可以为PDBbind数据集中的更多配体-受体对成功生成输出构象，表明这种对接方法可以通过移动口袋残基来扩展口袋 。

有关研究设计的更多信息，请参阅与本文链接的 [Nature Portfolio Reporting Summary] 。

Fig. 1: a 全状态用粉红色表示，初始无配体状态和模型预测的构象用绿色表示。天然配体用青色表示，预测的配体用橙色表示。模型接受蛋白质和配体的特征和当前构象作为输入。输出读数包括预测的更新：配体和每个蛋白质残基的全局平移和旋转，配体的扭转角旋转和蛋白质残基的chi角，以及两个预测模块（结合亲和力A和置信度得分D）。在训练阶段，模型旨在学习从类似无配体的构象到全构象的转换。在推理过程中，模型迭代更新初始输入结构20次。 b 一个示意图显示，当蛋白质与两种不同的配体结合时，我们的模型可以预测两种不同的全构象。我们的模型可以在20步内预测出结合的蛋白质构象，而全原子MD模拟需要数百万步才能找到相同的结合状态。

Fig. 2: a , b DynamicBind在预测配体姿态方面优于其他方法，适用于PDBbind数据集（ a ）和主要药物靶标（MDT）数据集（ b ），在不同的RMSD阈值下。 c 深色和浅色阴影分别表示在严格（配体RMSD

Fig. 3: AlphaFold 预测的结构以白色表示，晶体结构中的蛋白质和配体分别以粉红色和青色表示。我们的模型预测的蛋白质和配体分别以绿色和橙色表示。Asp–Phe–Gly (DFG) 残基的侧链以棍状表示。红色箭头突出显示了晶体结构相对于 AlphaFold 结构的显著构象变化。输入构象是 AlphaFold 预测的构象。 a 当配体 84S ( b ) 与 c-Met 蛋白结合时，蛋白质采用 DFG-in 构象。当配体 5I9 ( d ) 与同一蛋白质结合时，蛋白质采用 DFG-out 构象。我们对这两种配体的预测 ( c , e ) 与晶体结构非常一致。配体 RMSD 为 0.49 Å 和 0.51 Å。相对于初始 AlphaFold，DFG-in 和 DFG-out 的口袋 RMSD 改善分别为 7.47 Å 和 4.83 Å。在测试集中，七种蛋白质（通过其 UniProt ID 识别）包含 DFG-in 和 DFG-out 的结晶全构象，它们的初始 AlphaFold 和预测结构的口袋 RMSD 分别在 ( f , n = 39) 和 ( g , n = 34) 中显示，其中中位数由中心线标记，上四分位数和下四分位数由箱线表示，须线延伸至四分位数范围的 1.5 倍，个别点以点表示。 h 所有 79 个 PDB 的口袋 RMSD 改善的直方图。源数据作为源数据文件提供。

Fig. 4: 蛋白质在与小分子配体结合时会发生构象变化，这些变化可能发生在不同的时间尺度上。负的 Δpocket RMSD 表示预测结构相对于 AlphaFold 结构与真实值的 RMSD 更低。负的 Δclash 表示预测配体与预测结构的冲突评分低于移植配体与 AlphaFold 结构的冲突评分。 a 精氨酸的侧链旋转，减轻了与配体的冲突。 b AlphaFold 结构中阻碍结合口袋的酪氨酸在预测结构中移开。 c AlphaFold 结构中的环区与配体相交，在预测结构中重新定位。 d 结合位点附近的 α 螺旋转变为环，与晶体结构一致。 e Hsp90 的 α 螺旋经历了显著的重新定位。 f 两个结构域合并，从而形成结合口袋。源数据作为源数据文件提供。

Fig. 5: a 训练集中只有六个PDB与SETD2蛋白的Smith–Waterman相似度大于0.4，并且所有这些PDB都与SAM样配体共晶，如（ b ）所示。PDB 7TY2的配体EZM0414以青色棒状显示，蛋白质以粉红色显示。 c EZM0414的结合口袋在AlphaFold结构中缺失，该结构以白色显示。 d 该面板显示了训练集中配体与EZM0414的Tanimoto相似度，并绘制了最相似的三个配体。 e DynamicBind预测的蛋白质-配体复合物结构，蛋白质以绿色表示，配体以橙色表示。 f DynamicBind预测的复合物与相应的晶体结构的叠加。源数据作为源数据文件提供。

Fig. 6: a 不同方法在抗生素基准测试中的虚拟筛选性能的比较评估，以auROC（ROC曲线下的面积）衡量。该基准测试涵盖了 n = 12个不同的蛋白质系统。每个箱线图显示了中位数（中心线）、上四分位数和下四分位数（箱边）、延伸至1.5倍四分位数范围的须线，以及个别数据点（点）。我们忠实地纳入了基准论文中呈现的所有六个基线数字 。 b AlphaFold预测的蛋白质结构以白色显示，而DynamicBind生成的三种活性化合物的蛋白质结构以绿色显示。红色箭头指示蛋白质向配体移动的区域，形成额外的相互作用。源数据作为源数据文件提供。

