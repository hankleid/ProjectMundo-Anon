<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="/ProjectMundo/style/jats-html.xsl"?>
<!DOCTYPE response>
<article article-type="research-article" dtd-version="1.2" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
 <front>
  <journal-meta>
   <journal-id journal-id-type="publisher-id">
    41467
   </journal-id>
   <journal-id journal-id-type="doi">
    10.1038/41467.2041-1723
   </journal-id>
   <journal-title-group>
    <journal-title>
     Nature Communications
    </journal-title>
    <abbrev-journal-title abbrev-type="publisher">
     Nat Commun
    </abbrev-journal-title>
   </journal-title-group>
   <issn pub-type="epub">
    2041-1723
   </issn>
   <publisher>
    <publisher-name>
     Nature Publishing Group UK
    </publisher-name>
    <publisher-loc>
     London
    </publisher-loc>
   </publisher>
  </journal-meta>
  <article-meta>
   <article-id pub-id-type="publisher-id">
    s41467-024-48779-z
   </article-id>
   <article-id pub-id-type="manuscript">
    48779
   </article-id>
   <article-id pub-id-type="doi">
    10.1038/s41467-024-48779-z
   </article-id>
   <article-categories>
    <subj-group subj-group-type="heading">
     <subject>
      Article
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /639/4077/4079/891
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /639/301/299/891
     </subject>
    </subj-group>
    <subj-group subj-group-type="NatureArticleTypeID">
     <subject>
      article
     </subject>
    </subj-group>
   </article-categories>
   <title-group>
    <article-title xml:lang="en">
     Physics-informed neural network for lithium-ion battery degradation stable modeling and prognosis
    </article-title>
   </title-group>
   <contrib-group>
    <contrib contrib-type="author" equal-contrib="yes" id="Au1">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0003-0236-3705
     </contrib-id>
     <name name-style="western">
      <surname>
       Wang
      </surname>
      <given-names>
       Fujin
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
     <xref ref-type="author-notes" rid="fn1"/>
    </contrib>
    <contrib contrib-type="author" equal-contrib="yes" id="Au2">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0003-1746-260X
     </contrib-id>
     <name name-style="western">
      <surname>
       Zhai
      </surname>
      <given-names>
       Zhi
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
     <xref ref-type="author-notes" rid="fn1"/>
    </contrib>
    <contrib contrib-type="author" corresp="yes" id="Au3">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0003-4180-7137
     </contrib-id>
     <name name-style="western">
      <surname>
       Zhao
      </surname>
      <given-names>
       Zhibin
      </given-names>
     </name>
     <address>
      <email>
       zhaozhibin@xjtu.edu.cn
      </email>
     </address>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
     <xref ref-type="corresp" rid="IDs4146702448779z_cor3">
      c
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au4">
     <name name-style="western">
      <surname>
       Di
      </surname>
      <given-names>
       Yi
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
    </contrib>
    <contrib contrib-type="author" corresp="yes" id="Au5">
     <name name-style="western">
      <surname>
       Chen
      </surname>
      <given-names>
       Xuefeng
      </given-names>
     </name>
     <address>
      <email>
       chenxf@mail.xjtu.edu.cn
      </email>
     </address>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
     <xref ref-type="corresp" rid="IDs4146702448779z_cor5">
      e
     </xref>
    </contrib>
    <aff id="Aff1">
     <label>
      1
     </label>
     <institution-wrap>
      <institution-id institution-id-type="ROR">
       https://ror.org/017zhmm22
      </institution-id>
      <institution-id institution-id-type="GRID">
       grid.43169.39
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 0599 1243
      </institution-id>
      <institution content-type="org-division">
       National and Local Joint Engineering Research Center of Equipment Operation Safety and Intelligent Monitoring
      </institution>
      <institution content-type="org-name">
       Xi’an Jiaotong University
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      710049
     </addr-line>
     <addr-line content-type="city">
      Xi’an
     </addr-line>
     <addr-line content-type="state">
      Shaanxi
     </addr-line>
     <country country="CN">
      PR China
     </country>
    </aff>
    <aff id="Aff2">
     <label>
      2
     </label>
     <institution-wrap>
      <institution-id institution-id-type="ROR">
       https://ror.org/017zhmm22
      </institution-id>
      <institution-id institution-id-type="GRID">
       grid.43169.39
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 0599 1243
      </institution-id>
      <institution content-type="org-division">
       School of Mechanical Engineering
      </institution>
      <institution content-type="org-name">
       Xi’an Jiaotong University
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      710049
     </addr-line>
     <addr-line content-type="city">
      Xi’an
     </addr-line>
     <addr-line content-type="state">
      Shaanxi
     </addr-line>
     <country country="CN">
      PR China
     </country>
    </aff>
   </contrib-group>
   <author-notes>
    <fn fn-type="equal" id="fn1">
     <p>
      These authors contributed equally: Fujin Wang, Zhi Zhai.
     </p>
    </fn>
    <corresp id="IDs4146702448779z_cor3">
     <label>
      c
     </label>
     <email>
      zhaozhibin@xjtu.edu.cn
     </email>
    </corresp>
    <corresp id="IDs4146702448779z_cor5">
     <label>
      e
     </label>
     <email>
      chenxf@mail.xjtu.edu.cn
     </email>
    </corresp>
   </author-notes>
   <pub-date date-type="pub" publication-format="electronic">
    <day>
     21
    </day>
    <month>
     5
    </month>
    <year>
     2024
    </year>
   </pub-date>
   <pub-date date-type="collection" publication-format="electronic">
    <month>
     12
    </month>
    <year>
     2024
    </year>
   </pub-date>
   <volume>
    15
   </volume>
   <issue seq="4332">
    1
   </issue>
   <elocation-id>
    4332
   </elocation-id>
   <history>
    <date date-type="registration">
     <day>
      14
     </day>
     <month>
      5
     </month>
     <year>
      2024
     </year>
    </date>
    <date date-type="received">
     <day>
      28
     </day>
     <month>
      9
     </month>
     <year>
      2023
     </year>
    </date>
    <date date-type="accepted">
     <day>
      7
     </day>
     <month>
      5
     </month>
     <year>
      2024
     </year>
    </date>
    <date date-type="online">
     <day>
      21
     </day>
     <month>
      5
     </month>
     <year>
      2024
     </year>
    </date>
   </history>
   <permissions>
    <copyright-statement content-type="compact">
     © The Author(s) 2024
    </copyright-statement>
    <copyright-year>
     2024
    </copyright-year>
    <copyright-holder>
     The Author(s)
    </copyright-holder>
    <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
     <license-p>
      <bold>
       Open Access
      </bold>
      This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit
      <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">
       http://creativecommons.org/licenses/by/4.0/
      </ext-link>
      .
     </license-p>
    </license>
   </permissions>
   <abstract id="Abs1" xml:lang="en">
    <title>
     Abstract
    </title>
    <p id="Par1">
     Accurate state-of-health (SOH) estimation is critical for reliable and safe operation of lithium-ion batteries. However, reliable and stable battery SOH estimation remains challenging due to diverse battery types and operating conditions. In this paper, we propose a physics-informed neural network (PINN) for accurate and stable estimation of battery SOH. Specifically, we model the attributes that affect the battery degradation from the perspective of empirical degradation and state space equations, and utilize neural networks to capture battery degradation dynamics. A general feature extraction method is designed to extract statistical features from a short period of data before the battery is fully charged, enabling our method applicable to different battery types and charge/discharge protocols. Additionally, we generate a comprehensive dataset consisting of 55 lithium-nickel-cobalt-manganese-oxide (NCM) batteries. Combined with three other datasets from different manufacturers, we use a total of 387 batteries with 310,705 samples to validate our method. The mean absolute percentage error (MAPE) is 0.87%. Our proposed PINN has demonstrated remarkable performance in regular experiments, small sample experiments, and transfer experiments when compared to alternative neural networks. This study highlights the promise of physics-informed machine learning for battery degradation modeling and SOH estimation.
    </p>
   </abstract>
   <abstract abstract-type="ShortSummary" id="Abs2" xml:lang="en">
    <p id="Par2">
     Reliable lithium-ion battery health assessment is vital for safety. Here, authors present a physics-informed neural network for accurate and stable state-of-health estimation, overcoming challenges of varied battery types and usage conditions.
    </p>
   </abstract>
   <kwd-group kwd-group-type="hierarchical" vocab="FoR" vocab-identifier="ANZSRC 2008">
    <kwd content-type="term" vocab-term-identifier="03">
     Chemical Sciences
    </kwd>
    <nested-kwd>
     <kwd content-type="term" vocab-term-identifier="0306">
      Physical Chemistry (incl. Structural)
     </kwd>
    </nested-kwd>
   </kwd-group>
   <funding-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        Fundamental Research Funds for the Central Universities (xzy022023060)
       </institution>
      </institution-wrap>
     </funding-source>
    </award-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        National Natural Science Foundation of China (National Science Foundation of China)
       </institution>
       <institution-id institution-id-type="doi" vocab="open-funder-registry">
        501100001809
       </institution-id>
      </institution-wrap>
     </funding-source>
     <award-id award-type="FundRef grant">
      52105113
     </award-id>
    </award-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        China Postdoctoral Science Foundation
       </institution>
       <institution-id institution-id-type="doi" vocab="open-funder-registry">
        501100002858
       </institution-id>
      </institution-wrap>
     </funding-source>
     <award-id award-type="FundRef grant">
      2021M692557
     </award-id>
    </award-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        China Postdoctoral Science Foundation
       </institution>
       <institution-id institution-id-type="doi" vocab="open-funder-registry">
        501100002858
       </institution-id>
      </institution-wrap>
     </funding-source>
     <award-id award-type="FundRef grant">
      2021TQ0263
     </award-id>
    </award-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        National Natural Science Foundation of China (National Science Foundation of China)
       </institution>
       <institution-id institution-id-type="doi" vocab="open-funder-registry">
        501100001809
       </institution-id>
      </institution-wrap>
     </funding-source>
     <award-id award-type="FundRef grant">
      U22B2013
     </award-id>
    </award-group>
   </funding-group>
   <custom-meta-group>
    <custom-meta>
     <meta-name>
      publisher-imprint-name
     </meta-name>
     <meta-value>
      Nature Portfolio
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      volume-issue-count
     </meta-name>
     <meta-value>
      1
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-article-count
     </meta-name>
     <meta-value>
      4332
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-pricelist-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-copyright-holder
     </meta-name>
     <meta-value>
      Springer Nature Limited
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-copyright-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-contains-esm
     </meta-name>
     <meta-value>
      Yes
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-numbering-style
     </meta-name>
     <meta-value>
      Unnumbered
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-month
     </meta-name>
     <meta-value>
      5
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-day
     </meta-name>
     <meta-value>
      14
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      volume-type
     </meta-name>
     <meta-value>
      Regular
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-product
     </meta-name>
     <meta-value>
      NonStandardArchiveJournal
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      numbering-style
     </meta-name>
     <meta-value>
      Unnumbered
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-grants-type
     </meta-name>
     <meta-value>
      OpenChoice
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      metadata-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      abstract-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bodypdf-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bodyhtml-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bibliography-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      esm-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      online-first
     </meta-name>
     <meta-value>
      false
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      pdf-file-reference
     </meta-name>
     <meta-value>
      BodyRef/PDF/41467_2024_Article_48779.pdf
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      pdf-type
     </meta-name>
     <meta-value>
      Typeset
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      target-type
     </meta-name>
     <meta-value>
      OnlinePDF
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-type
     </meta-name>
     <meta-value>
      Regular
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-type
     </meta-name>
     <meta-value>
      OriginalPaper
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-primary
     </meta-name>
     <meta-value>
      Science, Humanities and Social Sciences, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-secondary
     </meta-name>
     <meta-value>
      Science, Humanities and Social Sciences, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-secondary
     </meta-name>
     <meta-value>
      Science, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-collection
     </meta-name>
     <meta-value>
      Science (multidisciplinary)
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      open-access
     </meta-name>
     <meta-value>
      true
     </meta-value>
    </custom-meta>
   </custom-meta-group>
  </article-meta>
 </front>
 <body>
  <sec id="Sec1" sec-type="introduction">
   <title>
    Introduction
   </title>
   <p id="Par3">
    In recent years, the number of lithium-ion batteries is growing at an alarming rate in the whole society, which is an unprecedented impetus to the popularization of renewable energy equipment. With the advantages of high energy density, low self-discharge rate, and long service life
    <sup>
     <xref ref-type="bibr" rid="CR1">
      1
     </xref>
    </sup>
    , lithium-ion batteries have become the main energy storage devices in portable electronic devices, electric vehicles, aerospace, and many other fields
    <sup>
     <xref ref-type="bibr" rid="CR2">
      2
     </xref>
     ,
     <xref ref-type="bibr" rid="CR3">
      3
     </xref>
     ,
     <xref ref-type="bibr" rid="CR4">
      4
     </xref>
     ,
     <xref ref-type="bibr" rid="CR5">
      5
     </xref>
     ,
     <xref ref-type="bibr" rid="CR6">
      6
     </xref>
     ,
     <xref ref-type="bibr" rid="CR7">
      7
     </xref>
     –
     <xref ref-type="bibr" rid="CR8">
      8
     </xref>
    </sup>
    . In 2019, the global shipments of lithium-ion batteries for new energy vehicles alone reached 116.6 GWh
    <sup>
     <xref ref-type="bibr" rid="CR9">
      9
     </xref>
    </sup>
    . It is estimated that by 2025, the global lithium-ion batteries installed capacity will reach 800 GWh, and the market value will reach 91.8 billion dollars
    <sup>
     <xref ref-type="bibr" rid="CR10">
      10
     </xref>
    </sup>
    . The explosive growth of lithium-ion batteries has brought convenience to people’s lives, however, its aging and health management have also attracted people’s concerns and attention. The aging of lithium-ion batteries is an important issue, and their performance will decline with time until it fails. To ensure long-term, safe, and continuous operation, lithium-ion batteries must be properly maintained and controlled, which includes state-of-health (SOH) assessments. The SOH of a battery is defined as the ratio of the current available capacity to the initial capacity, which can be used as an indicator to measure battery degradation
    <sup>
     <xref ref-type="bibr" rid="CR11">
      11
     </xref>
    </sup>
    . When the SOH drops to 80%, the battery reaches its first service life. Batteries that have reached their first service life can still be used in fields such as energy storage power stations for secondary utilization. Therefore, it is particularly important to accurately estimate the SOH of the battery.
   </p>
   <p id="Par4">
    In recent years, various SOH estimation methods of lithium-ion batteries have been proposed, which greatly advance the development of this field
    <sup>
     <xref ref-type="bibr" rid="CR12">
      12
     </xref>
     ,
     <xref ref-type="bibr" rid="CR13">
      13
     </xref>
     ,
     <xref ref-type="bibr" rid="CR14">
      14
     </xref>
     –
     <xref ref-type="bibr" rid="CR15">
      15
     </xref>
    </sup>
    . However, accurately estimating SOH is still a challenging problem. Generally, the capacity can be obtained from a complete discharge curve from an upper cut-off voltage to a lower cut-off voltage via the ampere-hour integration, thereby obtaining SOH. In actual application, it is difficult to obtain a complete charge or discharge curve because the battery is rarely fully discharged. Some scholars estimate SOH by establishing battery aging models. Baghdadi et al.
    <sup>
     <xref ref-type="bibr" rid="CR16">
      16
     </xref>
    </sup>
    proposed a physics-based approach based on Dakin’s degradation method to simulate the linear degradation process of batteries. Considering that time-varying temperature conditions have an important impact on the discharge capacity and aging law of lithium-ion batteries, Xu et al.
    <sup>
     <xref ref-type="bibr" rid="CR17">
      17
     </xref>
    </sup>
    proposed a stochastic degradation rate model based on the Arrhenius temperature model and established an aging model of lithium-ion batteries under time-varying temperature conditions based on the Wiener process. Dong et al.
    <sup>
     <xref ref-type="bibr" rid="CR18">
      18
     </xref>
    </sup>
    proposed a physics-based model that combines chemical and mechanical degradation mechanisms to predict capacity fade by simulating the formation and growth of solid electrolyte interphase (SEI). Lui et al.
    <sup>
     <xref ref-type="bibr" rid="CR19">
      19
     </xref>
    </sup>
    proposed a physics-based approach to predict the capacity of lithium-ion batteries by modeling degradation mechanisms such as losses of active materials of the positive and negative electrodes and the loss of lithium inventory.
   </p>
   <p id="Par5">
    Given the difficulty in establishing physical models and the difficulty in obtaining complete discharge capacity, many studies have used data-driven methods
    <sup>
     <xref ref-type="bibr" rid="CR20">
      20
     </xref>
     ,
     <xref ref-type="bibr" rid="CR21">
      21
     </xref>
     ,
     <xref ref-type="bibr" rid="CR22">
      22
     </xref>
     ,
     <xref ref-type="bibr" rid="CR23">
      23
     </xref>
     –
     <xref ref-type="bibr" rid="CR24">
      24
     </xref>
    </sup>
    to estimate SOH based on current and voltage curves during charge and discharge. Commonly used data-driven methods include linear regression
    <sup>
     <xref ref-type="bibr" rid="CR25">
      25
     </xref>
    </sup>
    , support vector machines
    <sup>
     <xref ref-type="bibr" rid="CR26">
      26
     </xref>
    </sup>
    , Gaussian process regression
    <sup>
     <xref ref-type="bibr" rid="CR27">
      27
     </xref>
    </sup>
    , deep neural networks
    <sup>
     <xref ref-type="bibr" rid="CR28">
      28
     </xref>
     ,
     <xref ref-type="bibr" rid="CR29">
      29
     </xref>
    </sup>
    , etc. Xia et al.
    <sup>
     <xref ref-type="bibr" rid="CR30">
      30
     </xref>
    </sup>
    extracted features from incremental capacity (IC) curves and differential voltage (DV) curves to estimate SOH. Wang et al.
    <sup>
     <xref ref-type="bibr" rid="CR31">
      31
     </xref>
    </sup>
    extracted valuable health indicators from electrochemical impedance spectroscopy (EIS) as input for Gaussian process regression to estimate SOH. Data-driven methods do not require physical knowledge and only focus on the relationship between input and output, so the extraction of degenerated features is a key part of data-driven methods, which largely determines the performance of the SOH estimation.
   </p>
   <p id="Par6">
    However, challenges still stand in the way of developing reliable, accurate, and general SOH estimation methods
    <sup>
     <xref ref-type="bibr" rid="CR14">
      14
     </xref>
     ,
     <xref ref-type="bibr" rid="CR21">
      21
     </xref>
    </sup>
    . Physics-based models are stable and accurate, but batteries with different chemical compositions require different model parameters, and the models have high computational costs
    <sup>
     <xref ref-type="bibr" rid="CR32">
      32
     </xref>
    </sup>
    . The data-driven models have high accuracy and efficiency, but its generalizability depends on the extracted features and have poor stability
    <sup>
     <xref ref-type="bibr" rid="CR14">
      14
     </xref>
     ,
     <xref ref-type="bibr" rid="CR33">
      33
     </xref>
    </sup>
    . For instance, due to the high usage variability, existing methods
    <sup>
     <xref ref-type="bibr" rid="CR30">
      30
     </xref>
     ,
     <xref ref-type="bibr" rid="CR34">
      34
     </xref>
     ,
     <xref ref-type="bibr" rid="CR35">
      35
     </xref>
    </sup>
    need to extract specific features for different datasets or different working conditions, leading to the fact that models are dataset-specific, resulting in a waste of computing resources. The promising prospect of physics-informed neural network (PINN)
    <sup>
     <xref ref-type="bibr" rid="CR36">
      36
     </xref>
     ,
     <xref ref-type="bibr" rid="CR37">
      37
     </xref>
    </sup>
    lies in amalgamating the strengths of physics-based and data-driven approaches, potentially addressing the aforementioned challenges. Due to the consideration of physical information, PINN can use relatively less data to train the model, and the model is more stable. It is a promising approach in the field of battery prognosis and diagnostics. Aykol et al.
    <sup>
     <xref ref-type="bibr" rid="CR38">
      38
     </xref>
    </sup>
    classified battery modeling methods that combine physical knowledge and machine learning into five categories, including three Sequential Integration methods, A1–A3, and two Hybrid methods, B1–B2. Among them, an obvious feature of the Sequential Integration method is that the physical model and the machine learning model are standalone, while the Hybrid method fuses the two together. Within this framework, some works has been published
    <sup>
     <xref ref-type="bibr" rid="CR39">
      39
     </xref>
     ,
     <xref ref-type="bibr" rid="CR40">
      40
     </xref>
     ,
     <xref ref-type="bibr" rid="CR41">
      41
     </xref>
     ,
     <xref ref-type="bibr" rid="CR42">
      42
     </xref>
     –
     <xref ref-type="bibr" rid="CR43">
      43
     </xref>
    </sup>
    . Nascimento et al.
    <sup>
     <xref ref-type="bibr" rid="CR39">
      39
     </xref>
    </sup>
    directly implemented the numerical integration of principle-based governing equations through recurrent neural networks to simulate the dynamic response of the battery. Wang et al.
    <sup>
     <xref ref-type="bibr" rid="CR42">
      42
     </xref>
    </sup>
    proposed a battery neural network (BattNN) for discharge voltage prediction based on the equivalent circuit model (ECM). Hofmann et al.
    <sup>
     <xref ref-type="bibr" rid="CR43">
      43
     </xref>
    </sup>
    used the pseudo-two-dimensional (P2D) Newman model to generate data at different health status points and combined it with experimental data and field data to train the neural network model, which takes advantage of the correlation between internal states and measurable SOH. According to the categories proposed by Aykol et al.
    <sup>
     <xref ref-type="bibr" rid="CR38">
      38
     </xref>
    </sup>
    , these methods belong to the A2
    <sup>
     <xref ref-type="bibr" rid="CR40">
      40
     </xref>
     ,
     <xref ref-type="bibr" rid="CR41">
      41
     </xref>
     ,
     <xref ref-type="bibr" rid="CR43">
      43
     </xref>
    </sup>
    and A3
    <sup>
     <xref ref-type="bibr" rid="CR39">
      39
     </xref>
     ,
     <xref ref-type="bibr" rid="CR42">
      42
     </xref>
    </sup>
    categories.
   </p>
   <p id="Par7">
    In fact, the Sequential Integration method is relatively straightforward to implement because the physical model and the machine learning model are standalone, making it a practical near-term strategy for battery modeling. Essentially, machine learning models in Sequential Integration method are not subject to physical constraints. The Hybrid methods, on the other hand, are more fundamental as they truly integrate the primary governing equations for battery modeling with data-driven methods. However, due to the complex physical equations contain numerous parameters and are difficult to solve, there are few publications that implement Hybrid methods for SOH estimation. Recent review
    <sup>
     <xref ref-type="bibr" rid="CR38">
      38
     </xref>
    </sup>
    pointed out that Hybrid methods will become the dominant method in the long term, but it is still an open research question.
   </p>
   <p id="Par8">
    In this work, we proposed a PINN for battery SOH estimation, which belong to the B2 architecture. This approach achieves true integration of governing equations and neural networks, resulting in stable and precise SOH estimation. Unlike existing PINN approaches, we also validated its advancements in small sample learning and transfer learning among batteries with different chemistries and charge/discharge profiles. Specifically, first, considering the complexity of the electrochemical equations, it hinders the development of B2-type PINNs. Therefore, we model battery degradation dynamics from the perspective of empirical degradation and state space equations, and utilize neural networks to capture battery degradation dynamics. Second, to make the model more general, we develop a new feature extraction method. The discharge process of a battery is user-specific, and the battery is rarely fully discharged. In contrast, once charging starts, the probability of full charge is high, and it is more fixed and regular. Therefore, we extract features from a short period of data before the battery is fully charged. Third, to verify our method, we carried out battery degradation experiments and released a dataset containing run-to-failure data from 55 batteries. In addition, we also verified our method on other three large-scale datasets with different chemical compositions and charge/discharge protocols, proving the superiority and versatility of our method. We also perform the further task of estimating SOH by transferring degradation knowledge from one dataset to another. These datasets for performing transfer tasks contain batteries with different chemistries and charge/discharge protocols. The results illustrate the effectiveness and generality of the proposed PINN in SOH estimation.
   </p>
  </sec>
  <sec id="Sec2" sec-type="results">
   <title>
    Results
   </title>
   <sec id="Sec3">
    <title>
     Framework overview and flowchart
    </title>
    <p id="Par9">
     We developed a PINN for lithium-ion battery SOH estimation, and its flowchart is shown in Fig.
     <xref ref-type="fig" rid="Fig1">
      1
     </xref>
     . Our method is designed for more general, reliable, stable, and high-precision SOH estimation by considering the dynamic behavior of battery degradation as well as the degradation trend.
     <fig id="Fig1" position="float">
      <label>
       Fig. 1
      </label>
      <caption xml:lang="en">
       <title>
        The flowchart of the proposed PINN for lithium-ion battery SOH estimation.
       </title>
       <p>
        <bold>
         a
        </bold>
        The lithium-ion batteries may have different chemistries (e.g., lithium nickel-cobalt-manganate (NCM), lithium nickel-cobalt-aluminate (NCA), and lithium iron phosphate (LFP), etc.). Different users have personalized battery discharge strategies resulting in different degradation trajectories.
        <bold>
         b
        </bold>
        An illustration of the selected data for feature extraction. We extracted features from a short period of data before the battery is fully charged. These features are used as the inputs of the proposed PINN to estimate SOH. The upper figures are the curves from the 10th cycle, and lower figures are all the curves during the entire life cycle. Aging of the battery and changes in charge/discharge protocols cause the curves to shift.
        <bold>
         c
        </bold>
        The structure of the proposed PINN, where
        <italic>
         u
        </italic>
        and
        <inline-formula id="IEq1">
         <alternatives>
          <mml:math id="IEq1_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mover accent="true">
            <mml:mrow>
             <mml:mi>
              u
             </mml:mi>
            </mml:mrow>
            <mml:mrow>
             <mml:mo>
              ̂
             </mml:mo>
            </mml:mrow>
           </mml:mover>
          </mml:math>
          <tex-math id="IEq1_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{u}$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq1.gif"/>
         </alternatives>
        </inline-formula>
        represent the true and estimated SOH,
        <italic>
         t
        </italic>
        and
        <bold>
         x
        </bold>
        represent cycle and features, the superscript
        <italic>
         i
        </italic>
        represents sample index, and the subscripts
        <italic>
         t
        </italic>
        and
        <bold>
         x
        </bold>
        represent the corresponding partial derivatives. The functions
        <italic>
         f
        </italic>
        ( ⋅ ) and
        <italic>
         g
        </italic>
        ( ⋅ ) respectively model the mapping between features to SOH and the degradation dynamics of the battery, and
        <inline-formula id="IEq2">
         <alternatives>
          <mml:math id="IEq2_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
            F
           </mml:mi>
           <mml:mrow>
            <mml:mo>
             (
            </mml:mo>
            <mml:mrow>
             <mml:mo>
              ⋅
             </mml:mo>
            </mml:mrow>
            <mml:mo>
             )
            </mml:mo>
           </mml:mrow>
          </mml:math>
          <tex-math id="IEq2_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq2.gif"/>
         </alternatives>
        </inline-formula>
        and
        <inline-formula id="IEq3">
         <alternatives>
          <mml:math id="IEq3_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
            G
           </mml:mi>
           <mml:mrow>
            <mml:mo>
             (
            </mml:mo>
            <mml:mrow>
             <mml:mo>
              ⋅
             </mml:mo>
            </mml:mrow>
            <mml:mo>
             )
            </mml:mo>
           </mml:mrow>
          </mml:math>
          <tex-math id="IEq3_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq3.gif"/>
         </alternatives>
        </inline-formula>
        represent the neural networks used to approximate
        <italic>
         f
        </italic>
        ( ⋅ ) and
        <italic>
         g
        </italic>
        ( ⋅ ) (see section “Methods” for more details).
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-48779-z/41467_2024_48779_Fig1_HTML.png"/>
     </fig>
    </p>
    <p id="Par10">
     In the data preprocessing stage (shown in Fig.
     <xref ref-type="fig" rid="Fig1">
      1
     </xref>
     b), statistical features are extracted from a short period of data before the battery is fully charged as the input of the model, which ensures that this period of data exists in most battery datasets, and solves the problem of non-universal features in existing studies. Therefore, our method is applicable to batteries with different chemistries and charge/discharge protocols.
    </p>
    <p id="Par11">
     In the SOH estimation stage, due to the complexity of electrochemical equations, there is currently no good way to integrate them with the neural networks. In this work, we modeled the attributes that affect the battery degradation from the perspective of the empirical degradation and state space equation, and utilized neural networks to approximate the established degradation model, effectively achieving the integration of governing equations and neural networks. The proposed PINN consists of two parts: a solution function
     <italic>
      f
     </italic>
     ( ⋅ ) that maps features to SOH and a nonlinear function
     <italic>
      g
     </italic>
     ( ⋅ ) that models battery degradation dynamic behaviors, as shown in Fig.
     <xref ref-type="fig" rid="Fig1">
      1
     </xref>
     c. The solution
     <italic>
      f
     </italic>
     ( ⋅ ), modeling the relationship between features and SOH, is expressed as
     <italic>
      u
     </italic>
     <sup>
      <italic>
       i
      </italic>
     </sup>
     =
     <italic>
      f
     </italic>
     (
     <italic>
      t
     </italic>
     <sup>
      <italic>
       i
      </italic>
     </sup>
     ,
     <bold>
      x
     </bold>
     <sup>
      <italic>
       i
      </italic>
     </sup>
     ), where
     <italic>
      t
     </italic>
     <sup>
      <italic>
       i
      </italic>
     </sup>
     represents time,
     <bold>
      x
     </bold>
     <sup>
      <italic>
       i
      </italic>
     </sup>
     represents the extracted feature vector, and
     <italic>
      u
     </italic>
     <sup>
      <italic>
       i
      </italic>
     </sup>
     denotes the SOH of the cycle
     <italic>
      i
     </italic>
     . The nonlinear function
     <italic>
      g
     </italic>
     ( ⋅ ) models the SOH decay rate of the battery. Since
     <italic>
      f
     </italic>
     ( ⋅ ) and
     <italic>
      g
     </italic>
     ( ⋅ ) are affected by many factors in reality and their explicit expressions are unknown, they are replaced by small fully connected neural networks, denote as
     <inline-formula id="IEq01">
      <alternatives>
       <mml:math id="IEq01_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq01_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq01.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq02">
      <alternatives>
       <mml:math id="IEq02_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq02_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq02.gif"/>
      </alternatives>
     </inline-formula>
     . During training, we consider data term loss
     <inline-formula id="IEq03">
      <alternatives>
       <mml:math id="IEq03_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           data
          </mml:mi>
         </mml:mrow>
        </mml:msub>
       </mml:math>
       <tex-math id="IEq03_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{data}}}}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq03.gif"/>
      </alternatives>
     </inline-formula>
     , monotonicity loss
     <inline-formula id="IEq4">
      <alternatives>
       <mml:math id="IEq4_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           mono
          </mml:mi>
         </mml:mrow>
        </mml:msub>
       </mml:math>
       <tex-math id="IEq4_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{mono}}}}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq4.gif"/>
      </alternatives>
     </inline-formula>
     , and loss
     <inline-formula id="IEq5">
      <alternatives>
       <mml:math id="IEq5_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           PDE
          </mml:mi>
         </mml:mrow>
        </mml:msub>
       </mml:math>
       <tex-math id="IEq5_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{PDE}}}}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq5.gif"/>
      </alternatives>
     </inline-formula>
     constrained by the degradation equation described by partial differential equation. They minimize the errors between the predicted and the true values, while making the model follow the properties of monotonicity of the degradation trajectory and satisfy the constraints of the established degradation model.
    </p>
    <p id="Par12">
     To validate the superiority of the proposed PINN, we conducted small sample experiments and transfer experiments. During the transfer experiments, we froze
     <inline-formula id="IEq6">
      <alternatives>
       <mml:math id="IEq6_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq6_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq6.gif"/>
      </alternatives>
     </inline-formula>
     and fine-tuned
     <inline-formula id="IEq7">
      <alternatives>
       <mml:math id="IEq7_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq7_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq7.gif"/>
      </alternatives>
     </inline-formula>
     on datasets with different chemical compositions. The experimental outcomes demonstrate that the proposed PINN framework can effectively capture the dynamics of battery degradation. Our study combines knowledge of the battery degradation with neural networks and achieves promising results. This study highlights the promise of physics-informed neural network for battery degradation modeling and SOH estimation (more methodological details can be found in the “Methods” section).
    </p>
   </sec>
   <sec id="Sec4">
    <title>
     Data generation
    </title>
    <p id="Par13">
     To cover different battery types and chemistries, we employ 310,705 samples of 387 batteries from 4 different large-scale datasets for validation. The first dataset comes from the battery degradation experiments we conducted for this study, the other three datasets are well-known public datasets from Zhu et al.
     <sup>
      <xref ref-type="bibr" rid="CR44">
       44
      </xref>
     </sup>
     , Ye et al.
     <sup>
      <xref ref-type="bibr" rid="CR45">
       45
      </xref>
     </sup>
     , and Severson et al.
     <sup>
      <xref ref-type="bibr" rid="CR25">
       25
      </xref>
     </sup>
     . For convenience, we refer to the four datasets as the XJTU battery dataset, TJU dataset
     <sup>
      <xref ref-type="bibr" rid="CR44">
       44
      </xref>
     </sup>
     , HUST dataset
     <sup>
      <xref ref-type="bibr" rid="CR45">
       45
      </xref>
     </sup>
     , and MIT dataset
     <sup>
      <xref ref-type="bibr" rid="CR25">
       25
      </xref>
     </sup>
     . The basic information of the four datasets is given in Table
     <xref ref-type="table" rid="Tab1">
      1
     </xref>
     .
     <table-wrap id="Tab1">
      <label>
       Table 1
      </label>
      <caption xml:lang="en">
       <p>
        The chemical components and basic experiment conditions for four datasets
       </p>
      </caption>
      <table frame="hsides" rules="groups">
       <thead>
        <tr>
         <th>
          <p>
           Dataset
          </p>
         </th>
         <th>
          <p>
           Batch
          </p>
         </th>
         <th>
          <p>
           Chemical component
          </p>
         </th>
         <th>
          <p>
           Nominal capacity (mAh)
          </p>
         </th>
         <th>
          <p>
           Cut-off voltage (V)
          </p>
         </th>
         <th>
          <p>
           Experiment temperature (°C)
          </p>
         </th>
         <th>
          <p>
           Number of cells
          </p>
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td>
          <p>
           XJTU
          </p>
         </td>
         <td>
          <p>
           1,2,3,4,5,6
          </p>
         </td>
         <td>
          <p>
           LiNi
           <sub>
            0.5
           </sub>
           Co
           <sub>
            0.2
           </sub>
           Mn
           <sub>
            0.3
           </sub>
           O
           <sub>
            2
           </sub>
          </p>
         </td>
         <td>
          <p>
           2000
          </p>
         </td>
         <td>
          <p>
           2.5–4.2
          </p>
         </td>
         <td>
          <p>
           Room temperature
          </p>
         </td>
         <td>
          <p>
           55
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           TJU
          </p>
         </td>
         <td>
          <p>
           1
          </p>
         </td>
         <td>
          <p>
           Li
           <sub>
            0.86
           </sub>
           Ni
           <sub>
            0.86
           </sub>
           Co
           <sub>
            0.11
           </sub>
           Al
           <sub>
            0.03
           </sub>
           O
           <sub>
            2
           </sub>
          </p>
         </td>
         <td>
          <p>
           3500
          </p>
         </td>
         <td>
          <p>
           2.65–4.2
          </p>
         </td>
         <td>
          <p>
           25,35,45
          </p>
         </td>
         <td>
          <p>
           66
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           2
          </p>
         </td>
         <td>
          <p>
           Li
           <sub>
            0.84
           </sub>
           Ni
           <sub>
            0.83
           </sub>
           Co
           <sub>
            0.11
           </sub>
           Mn
           <sub>
            0.07
           </sub>
           O
           <sub>
            2
           </sub>
          </p>
         </td>
         <td>
          <p>
           3500
          </p>
         </td>
         <td>
          <p>
           2.5–4.2
          </p>
         </td>
         <td>
          <p>
           25,35,45
          </p>
         </td>
         <td>
          <p>
           55
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           3
          </p>
         </td>
         <td>
          <p>
           Blend of 42 (3) wt.% LiNiCoMnO
           <sub>
            2
           </sub>
           and 58 (3) wt.% LiNiCoAlO
           <sub>
            2
           </sub>
          </p>
         </td>
         <td>
          <p>
           2500
          </p>
         </td>
         <td>
          <p>
           2.5–4.2
          </p>
         </td>
         <td>
          <p>
           25
          </p>
         </td>
         <td>
          <p>
           9
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           MIT
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           LiFePO
           <sub>
            4
           </sub>
          </p>
         </td>
         <td>
          <p>
           1100
          </p>
         </td>
         <td>
          <p>
           2.0–3.6
          </p>
         </td>
         <td>
          <p>
           30
          </p>
         </td>
         <td>
          <p>
           125
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           HUST
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           LiFePO
           <sub>
            4
           </sub>
          </p>
         </td>
         <td>
          <p>
           1100
          </p>
         </td>
         <td>
          <p>
           2.0–3.6
          </p>
         </td>
         <td>
          <p>
           30
          </p>
         </td>
         <td>
          <p>
           77
          </p>
         </td>
        </tr>
       </tbody>
      </table>
      <table-wrap-foot>
       <p>
        The charge/discharge protocol varies among different datasets.
       </p>
      </table-wrap-foot>
     </table-wrap>
    </p>
    <p id="Par14">
     We developed a battery degradation experiment in this study, as shown in Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      S1
     </xref>
     . A total of 55 batteries manufactured by LISHEN (LiNi
     <sub>
      0.5
     </sub>
     Co
     <sub>
      0.2
     </sub>
     Mn
     <sub>
      0.3
     </sub>
     O
     <sub>
      2
     </sub>
     , 2000 mAh nominal capacity, and 3.6 V nominal voltage, the cut-off voltages of charging and discharging are 4.2 V and 2.5 V) were cycled to failure under 6 charge/discharge protocols at the room temperature. The protocols include fixed charging and discharging, random discharging with a fixed current in different cycles, random walking, and the charging and discharging strategy of a satellite in geosynchronous earth orbit (GEO). We use batch 1 to batch 6 to represent the 6 charge/discharge protocols, respectively. The degradation trajectories are shown in Fig.
     <xref ref-type="fig" rid="Fig2">
      2
     </xref>
     . More details about our dataset can be found in Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     .
    </p>
    <p id="Par15">
     The TJU dataset contains three types of battery: NCA battery (3500 mAh nominal capacity and 2.65–4.2 V cut-off voltage), NCM battery (3500 mAh nominal capacity and 2.5–4.2 V cut-off voltages), and NCM + NCA battery (2500 mAh nominal capacity and 2.5–4.2 V cut-off voltage). These batteries are cycled in a temperature-controlled chamber with different temperatures and different charge current rates. Candidate sets for temperatures include 25, 35, and 45 °C. Current rates ranging from 0.25 C to 4 C were used. We use batch 1, batch 2, and batch 3 to represent NCA, NCM, and NCM + NCA batteries, respectively.
     <fig id="Fig2" position="float">
      <label>
       Fig. 2
      </label>
      <caption xml:lang="en">
       <title>
        The degradation trajectories of the XJTU battery dataset.
       </title>
       <p>
        There are 6 batches (55 batteries) in total, all batches contain 8 batteries except batch 2 which contains 15 batteries. The charge/discharge protocols are different among batches. See Supplementary Note
        <xref ref-type="supplementary-material" rid="MOESM1">
         1
        </xref>
        for more details.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-48779-z/41467_2024_48779_Fig2_HTML.png"/>
     </fig>
    </p>
    <p id="Par16">
     The HUST dataset contains data from 77 LFP/graphite cells under 77 different multi-stage discharge protocols. These batteries, manufactured by A123 (APR18650M1A), have a nominal capacity of 1100 mAh and a nominal voltage of 3.3 V. They were cycled at a temperature of 30 °C with an identical charge protocol but different discharge protocols until failure.
    </p>
    <p id="Par17">
     The batteries in the MIT dataset have the same type and chemical composition as the batteries in the HUST dataset. However, unlike the experimental setup at the HUST dataset, the MIT dataset considered multiple fast-charging strategies and one discharging strategy. Specifically, they were cycled under a fast-charging experiment with a one-step or two-step fast-charging policy, and discharged at 4 C. The experiment temperature is 30 °C.
    </p>
   </sec>
   <sec id="Sec5">
    <title>
     Feature extraction
    </title>
    <p id="Par18">
     Robust features can often improve the performance of SOH estimation. However, how to extract general and robust features is a worthy research problem. In existing studies, various feature extraction methods for specific datasets and charge/discharge protocols were proposed, yet the generalization of features has been insufficiently considered. There are few studies on methods for extracting general features for different battery types or charge/discharge protocols. To extract more robust and generalizable features, we propose a method to extract features from a short period of charging voltage curve and current curve through observation and exploration of multiple datasets. It is an undoubted fact that the discharging process of the battery is user-specific. In contrast, the charging process is essential and more fixed and regular, and the probability of the battery being fully charged is relatively high. We found that most datasets contain constant current and constant voltage (CC-CV) charging modes. For the four public datasets we used, no matter what strategy the battery is discharged with or whether it is fully discharged, it will eventually be fully charged when charging.
    </p>
    <p id="Par19">
     Therefore, we selected a short period of data before the battery was fully charged to extract features, as shown in Fig.
     <xref ref-type="fig" rid="Fig1">
      1
     </xref>
     b. Define the charge cut-off voltage of a battery as
     <italic>
      V
     </italic>
     <sub>
      end
     </sub>
     , and the voltage data whose value is within [
     <italic>
      V
     </italic>
     <sub>
      end−0.2
     </sub>
     ,
     <italic>
      V
     </italic>
     <sub>
      end
     </sub>
     ] V is selected. For the current data, we choose the data with the current between 0.5 A and 0.1 A during the constant voltage charging. Regardless of whether the battery is fully discharged, as long as the battery is fully charged, the voltage range and current range always exist.
    </p>
    <p id="Par20">
     The mean, standard deviation, kurtosis, skewness, charging time, accumulated charge, curve slope, and curve entropy from the selected current and voltage curves, respectively (these features are numbered 1–16, respectively. See Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      2
     </xref>
     for more details) are extracted. An illustration of extracted features from XJTU dataset batch 1 is given in Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     a. Further, we extracted features from 387 batteries in 4 datasets respectively, and calculated the Pearson correlation coefficient between features and SOH within each dataset, as shown in Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     b.
     <fig id="Fig3" position="float">
      <label>
       Fig. 3
      </label>
      <caption xml:lang="en">
       <title>
        An illustration of extracted features and correlation coefficients.
       </title>
       <p>
        <bold>
         a
        </bold>
        Features of 8 batteries from the XJTU dataset batch 1. The
        <italic>
         x
        </italic>
        -axis of each subfigure is SOH, and the
        <italic>
         y
        </italic>
        -axis is the normalized value of the corresponding feature. The number on the right side of each subfigure represents the feature number.
        <bold>
         b
        </bold>
        Correlation heatmap between extracted features and SOH in four datasets. The numbers 1–16 represent 16 features, and the order of features is consistent with that in (
        <bold>
         a
        </bold>
        ).
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-48779-z/41467_2024_48779_Fig3_HTML.png"/>
     </fig>
    </p>
    <p id="Par21">
     Based on experimental phenomena and analysis of Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     b, we give a natural conjecture: the magnitude of the correlation coefficient between each feature and SOH is related to the chemical composition of a battery and is less affected by the charge/discharge protocols. To the best knowledge, we are the first to focus on this phenomenon. It can be seen from Table
     <xref ref-type="table" rid="Tab1">
      1
     </xref>
     that both the XJTU dataset and the TJU dataset are LiNiCo-x type batteries. Even though they have completely different nominal capacities and charge/discharge protocols, the features extracted from our selected range are highly similar. For example, there is a very strong negative correlation between features 11–16 and SOH. Features 9 and 10 have a strong positive correlation with SOH. In contrast, the MIT dataset and the HUST dataset are both LiFePO
     <sub>
      4
     </sub>
     batteries. Features 11–16 show a weak positive correlation with SOH, while features 9 and 10 show a negative correlation with SOH. Besides, features 3–6 and 8 of the latter two datasets show a strong positive correlation with SOH.
    </p>
   </sec>
   <sec id="Sec6">
    <title>
     SOH estimation
    </title>
    <p id="Par22">
     The extracted 16 features and time (cycle) are used as inputs of the proposed PINN to estimate SOH. To reduce the impact of the difference in feature magnitude on the model and make the model training more stable, the min–max normalization is performed on the features. That is, all features are scaled to the range [−1,1]. The SOH estimation results of the proposed PINN on 4 datasets are given in Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     a (the number of test batteries in each dataset can be found in Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      S2
     </xref>
     .
     <fig id="Fig4" position="float">
      <label>
       Fig. 4
      </label>
      <caption xml:lang="en">
       <title>
        The illustrations of SOH estimation results.
       </title>
       <p>
        <bold>
         a
        </bold>
        The SOH estimation results of proposed PINN on four datasets. The predicted and true SOH are distributed near the diagonal, indicating that the model performs well.
        <bold>
         b
        </bold>
        Distributions of mean absolute error (MAE), mean absolute percentage error (MAPE), and root mean square error (RMSE) of 3 models (the proposed PINN (Ours), multi-layer perceptron (MLP), and convolutional neural network (CNN)) on four datasets. Each error bar contains 10 points (10 experiment) and is marked with mean and standard deviation lines. Compared with the other two methods, our method has smaller prediction errors and is more stable. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-48779-z/41467_2024_48779_Fig4_HTML.png"/>
     </fig>
    </p>
    <p id="Par23">
     To demonstrate the advancement of the proposed PINN, Multi-Layer Perceptron (MLP) with the same structure and parameter amounts and Convolutional Neural Network (CNN) with similar parameter amounts are used as comparison methods. The details of MLP and CNN can be found in Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      3
     </xref>
     . For each dataset, we divide the training batteries, validation batteries, and test batteries approximately in a ratio of 6:2:2. The number of test batteries in each dataset can be found in Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      S2
     </xref>
     . To ensure fairness, the numbers of test batteries are evenly distributed throughout the dataset, as shown in Tables
     <xref ref-type="supplementary-material" rid="MOESM1">
      S3
     </xref>
     –
     <xref ref-type="supplementary-material" rid="MOESM1">
      S6
     </xref>
     . The results of the 3 models on the 4 datasets are shown in Table
     <xref ref-type="table" rid="Tab2">
      2
     </xref>
     (only the average test errors on each dataset are given, and the test results of each battery can be viewed in Tables
     <xref ref-type="supplementary-material" rid="MOESM1">
      S3
     </xref>
     –
     <xref ref-type="supplementary-material" rid="MOESM1">
      S6
     </xref>
     . It can be seen from the table that our method has the smallest estimation errors in most cases. The average MAPE of the proposed PINN on the 4 datasets is 0.85%, 1.21%, 0.65%, and 0.78%, while that of MLP is 2.60%, 1.72%, 0.83%, and 0.83%. It is worth noting that they have the same number of parameters and model structure during inference.
     <table-wrap id="Tab2">
      <label>
       Table 2
      </label>
      <caption xml:lang="en">
       <p>
        The results of proposed PINN (Ours), multi-layer perceptron (MLP), and convolutional neural network (CNN) on four datasets
       </p>
      </caption>
      <table frame="hsides" rules="groups">
       <thead>
        <tr>
         <th>
          <p>
           Dataset
          </p>
         </th>
         <th>
          <p>
           Batch
          </p>
         </th>
         <th colspan="2">
          <p>
           Ours
          </p>
         </th>
         <th colspan="2">
          <p>
           MLP
          </p>
         </th>
         <th colspan="2">
          <p>
           CNN
          </p>
         </th>
        </tr>
        <tr>
         <th/>
         <th/>
         <th>
          <p>
           MAPE
          </p>
         </th>
         <th>
          <p>
           RMSE
          </p>
         </th>
         <th>
          <p>
           MAPE
          </p>
         </th>
         <th>
          <p>
           RMSE
          </p>
         </th>
         <th>
          <p>
           MAPE
          </p>
         </th>
         <th>
          <p>
           RMSE
          </p>
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td>
          <p>
           XJTU
          </p>
         </td>
         <td>
          <p>
           1
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0070
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0094
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0260
          </p>
         </td>
         <td>
          <p>
           0.0277
          </p>
         </td>
         <td>
          <p>
           0.0270
          </p>
         </td>
         <td>
          <p>
           0.0330
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           2
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0113
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0122
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0275
          </p>
         </td>
         <td>
          <p>
           0.0304
          </p>
         </td>
         <td>
          <p>
           0.0298
          </p>
         </td>
         <td>
          <p>
           0.0352
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           3
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0086
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0100
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0211
          </p>
         </td>
         <td>
          <p>
           0.0237
          </p>
         </td>
         <td>
          <p>
           0.0177
          </p>
         </td>
         <td>
          <p>
           0.0212
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           4
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0071
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0105
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0200
          </p>
         </td>
         <td>
          <p>
           0.0235
          </p>
         </td>
         <td>
          <p>
           0.0150
          </p>
         </td>
         <td>
          <p>
           0.0189
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           5
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0105
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0135
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0183
          </p>
         </td>
         <td>
          <p>
           0.0217
          </p>
         </td>
         <td>
          <p>
           0.0350
          </p>
         </td>
         <td>
          <p>
           0.0453
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           6
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0063
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0097
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0204
          </p>
         </td>
         <td>
          <p>
           0.0242
          </p>
         </td>
         <td>
          <p>
           0.0149
          </p>
         </td>
         <td>
          <p>
           0.0194
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           TJU
          </p>
         </td>
         <td>
          <p>
           1
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0164
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0158
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0206
          </p>
         </td>
         <td>
          <p>
           0.0197
          </p>
         </td>
         <td>
          <p>
           0.0198
          </p>
         </td>
         <td>
          <p>
           0.0208
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           2
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0119
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0132
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0149
          </p>
         </td>
         <td>
          <p>
           0.0157
          </p>
         </td>
         <td>
          <p>
           0.0143
          </p>
         </td>
         <td>
          <p>
           0.0149
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           3
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0080
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0079
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0150
          </p>
         </td>
         <td>
          <p>
           0.0144
          </p>
         </td>
         <td>
          <p>
           0.0124
          </p>
         </td>
         <td>
          <p>
           0.0125
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           MIT
          </p>
         </td>
         <td/>
         <td>
          <p>
           <bold>
            0.0065
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0074
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0079
          </p>
         </td>
         <td>
          <p>
           0.0087
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0065
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0075
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           HUST
          </p>
         </td>
         <td/>
         <td>
          <p>
           0.0078
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0087
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0080
          </p>
         </td>
         <td>
          <p>
           0.0090
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0074
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0087
          </p>
         </td>
        </tr>
       </tbody>
      </table>
      <table-wrap-foot>
       <p>
        MAPE is the mean absolute percentage error, and RMSE is the root mean square error. The best results are shown in bold. All values are averaged from ten experiments.
       </p>
      </table-wrap-foot>
     </table-wrap>
    </p>
    <p id="Par24">
     Further, to reflect the stability of the model, the training and testing process of each model on each dataset is repeated 10 times. The test results are shown in Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     b. From the figure, we can see that our proposed PINN is the most stable on all tasks and all metrics. The sample size in each batch of the XJTU battery dataset is small, causing significant fluctuations in MLP and CNN. In contrast, our method is more stable and yields a smaller test error. For HUST dataset and MIT dataset, they contain a large number of training samples, so the fluctuations of MLP and CNN become smaller, and the test errors become smaller. However, our proposed PINN is still the best-performing model.
    </p>
   </sec>
   <sec id="Sec7">
    <title>
     Experiments with small samples
    </title>
    <p id="Par25">
     Our proposed PINN models battery degradation dynamics, taking into account more physical laws and thus can be trained with less data. Compared with pure data-driven methods, our method can show greater superiority when the amount of available training data is small. To verify the above inference, small sample experiments are conducted on the XJTU dataset and HUST dataset.
    </p>
    <p id="Par26">
     Specifically, we use 1 battery data to train 3 models, and test on multiple batteries (the test set is the same as in 2.4), and record the test results. In addition, we gradually increase the number of training batteries and observe the performance change of each model on the test set. The results are given in Table
     <xref ref-type="table" rid="Tab3">
      3
     </xref>
     and Fig.
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     (only the batch 1 results are given for the XJTU dataset, more results can be found in Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      S7
     </xref>
     and Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      S5
     </xref>
     ).
     <table-wrap id="Tab3">
      <label>
       Table 3
      </label>
      <caption xml:lang="en">
       <p>
        Results of small sample experiments on the XJTU dataset batch 1 and HUST dataset
       </p>
      </caption>
      <table frame="hsides" rules="groups">
       <thead>
        <tr>
         <th>
          <p>
           Dataset
          </p>
         </th>
         <th>
          <p>
           Train batteries
          </p>
         </th>
         <th colspan="2">
          <p>
           Ours
          </p>
         </th>
         <th colspan="2">
          <p>
           MLP
          </p>
         </th>
         <th colspan="2">
          <p>
           CNN
          </p>
         </th>
        </tr>
        <tr>
         <th/>
         <th/>
         <th>
          <p>
           MAPE
          </p>
         </th>
         <th>
          <p>
           RMSE
          </p>
         </th>
         <th>
          <p>
           MAPE
          </p>
         </th>
         <th>
          <p>
           RMSE
          </p>
         </th>
         <th>
          <p>
           MAPE
          </p>
         </th>
         <th>
          <p>
           RMSE
          </p>
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td>
          <p>
           XJTU
          </p>
         </td>
         <td>
          <p>
           1
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0141
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0184
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0343
          </p>
         </td>
         <td>
          <p>
           0.0390
          </p>
         </td>
         <td>
          <p>
           0.0929
          </p>
         </td>
         <td>
          <p>
           0.0949
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           2
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0105
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0134
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0267
          </p>
         </td>
         <td>
          <p>
           0.0304
          </p>
         </td>
         <td>
          <p>
           0.0728
          </p>
         </td>
         <td>
          <p>
           0.0826
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           3
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0069
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0096
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0347
          </p>
         </td>
         <td>
          <p>
           0.0383
          </p>
         </td>
         <td>
          <p>
           0.0548
          </p>
         </td>
         <td>
          <p>
           0.0666
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           4
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0056
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0076
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0292
          </p>
         </td>
         <td>
          <p>
           0.0327
          </p>
         </td>
         <td>
          <p>
           0.0560
          </p>
         </td>
         <td>
          <p>
           0.0647
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           HUST
          </p>
         </td>
         <td>
          <p>
           1
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0446
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0485
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0601
          </p>
         </td>
         <td>
          <p>
           0.0682
          </p>
         </td>
         <td>
          <p>
           0.3614
          </p>
         </td>
         <td>
          <p>
           0.1550
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           2
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0178
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0202
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0391
          </p>
         </td>
         <td>
          <p>
           0.0461
          </p>
         </td>
         <td>
          <p>
           0.0826
          </p>
         </td>
         <td>
          <p>
           0.0925
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           3
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0154
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0181
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0251
          </p>
         </td>
         <td>
          <p>
           0.0287
          </p>
         </td>
         <td>
          <p>
           0.0514
          </p>
         </td>
         <td>
          <p>
           0.0618
          </p>
         </td>
        </tr>
        <tr>
         <td/>
         <td>
          <p>
           4
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0144
           </bold>
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0173
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0253
          </p>
         </td>
         <td>
          <p>
           0.0288
          </p>
         </td>
         <td>
          <p>
           0.0429
          </p>
         </td>
         <td>
          <p>
           0.0521
          </p>
         </td>
        </tr>
       </tbody>
      </table>
      <table-wrap-foot>
       <p>
        MAPE is the mean absolute percentage error, and RMSE is the root mean square error. The best results are shown in bold. All values are averaged from ten experiments. The “Train Batteries” means that we use 1, 2, 3, and 4 batteries to train the model respectively, and then test it on test set.
       </p>
      </table-wrap-foot>
     </table-wrap>
     <fig id="Fig5" position="float">
      <label>
       Fig. 5
      </label>
      <caption xml:lang="en">
       <title>
        An illustration of test root mean square error (RMSE) distributions for three models (the proposed PINN (Ours), multi-layer perceptron (MLP), and convolutional neural network (CNN)) on two datasets.
       </title>
       <p>
        Each error bar contains 10 points (10 experiment) and is marked with mean and standard deviation lines. The “1 battery” in the legend means that we only use the data of 1 battery to train the model. Others are similar. As the number of batteries increases, the performance of the three models is getting better. However, our method still performs best among them.
        <bold>
         a
        </bold>
        The results on the XJTU dataset batch 1.
        <bold>
         b
        </bold>
        The results on the HUST dataset. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-48779-z/41467_2024_48779_Fig5_HTML.png"/>
     </fig>
    </p>
    <p id="Par27">
     It can be observed that our proposed PINN obtains the best results in all tasks and settings. As the number of training batteries increases, the test errors decrease for all 3 models. This is a generally accepted fact: increasing the number of training samples can improve the model performance when the training data is small. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     b, due to the large number of samples in the HUST dataset, the performance of the CNN and MLP is comparable to that of our PINN. This also illustrates the fact that when the structure or number of parameters of the models are the same or similar, given enough training samples, the model performance does not differ much. However, it is evident from Fig.
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     that our method has a significant advantage when the number of training samples is small. In addition, it is worth noting that the performance of our PINN trained with only 1 battery is comparable to that of MLP and CNN trained with 3–4 batteries, which demonstrates the superiority of our PINN in the small sample scenario.
    </p>
   </sec>
   <sec id="Sec8">
    <title>
     Fine-tuning between different datasets
    </title>
    <p id="Par28">
     Fine-tuning is one implementation of transfer learning, which improves learning ability by rapidly tuning the model using a small amount of newly collected data. The advantage is that it can use the massive data collected in other scenarios (source domain) to pre-train a model and learn the essential relation between features and labels. Then a small amount of target domain data is used to quickly fine-tune the model to obtain good performance. Most of the existing studies on transfer learning for SOH estimation are transfers between different charge/discharge protocols, and there are few studies on transfers between different datasets (different chemical compositions). In this paper, we combined 4 datasets in pairs for fine-tuning experiments.
    </p>
    <p id="Par29">
     We believe that the degradation dynamics
     <inline-formula id="IEq8">
      <alternatives>
       <mml:math id="IEq8_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq8_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq8.gif"/>
      </alternatives>
     </inline-formula>
     are independent of charge/discharge protocols and datasets, while the solution
     <inline-formula id="IEq9">
      <alternatives>
       <mml:math id="IEq9_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq9_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq9.gif"/>
      </alternatives>
     </inline-formula>
     is related to them. After learning from massive data,
     <inline-formula id="IEq10">
      <alternatives>
       <mml:math id="IEq10_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq10_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq10.gif"/>
      </alternatives>
     </inline-formula>
     should contain general information that can reflect the nature of battery degradation, which is useful for cross-scenario SOH estimation. Therefore, we only fine-tune the weights of the solution
     <inline-formula id="IEq11">
      <alternatives>
       <mml:math id="IEq11_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq11_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq11.gif"/>
      </alternatives>
     </inline-formula>
     and make the weights of dynamics
     <inline-formula id="IEq12">
      <alternatives>
       <mml:math id="IEq12_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq12_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq12.gif"/>
      </alternatives>
     </inline-formula>
     frozen, as shown in Fig.
     <xref ref-type="fig" rid="Fig6">
      6
     </xref>
     b.
     <fig id="Fig6" position="float">
      <label>
       Fig. 6
      </label>
      <caption xml:lang="en">
       <title>
        An illustration of the proposed physics-informed neural network.
       </title>
       <p>
        <bold>
         a
        </bold>
        The extracted features
        <bold>
         x
        </bold>
        and cycle
        <italic>
         t
        </italic>
        are used to estimate SOH
        <italic>
         u
        </italic>
        . The
        <inline-formula id="IEq16">
         <alternatives>
          <mml:math id="IEq16_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mover accent="true">
            <mml:mrow>
             <mml:mi>
              u
             </mml:mi>
            </mml:mrow>
            <mml:mrow>
             <mml:mo>
              ̂
             </mml:mo>
            </mml:mrow>
           </mml:mover>
          </mml:math>
          <tex-math id="IEq16_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{u}$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq16.gif"/>
         </alternatives>
        </inline-formula>
        represent the estimated SOH, and the subscripts
        <italic>
         t
        </italic>
        and
        <bold>
         x
        </bold>
        represent the corresponding partial derivatives. Neural networks
        <inline-formula id="IEq17">
         <alternatives>
          <mml:math id="IEq17_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
            F
           </mml:mi>
           <mml:mrow>
            <mml:mo>
             (
            </mml:mo>
            <mml:mrow>
             <mml:mo>
              ⋅
             </mml:mo>
            </mml:mrow>
            <mml:mo>
             )
            </mml:mo>
           </mml:mrow>
          </mml:math>
          <tex-math id="IEq17_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq17.gif"/>
         </alternatives>
        </inline-formula>
        and
        <inline-formula id="IEq18">
         <alternatives>
          <mml:math id="IEq18_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
            G
           </mml:mi>
           <mml:mrow>
            <mml:mo>
             (
            </mml:mo>
            <mml:mrow>
             <mml:mo>
              ⋅
             </mml:mo>
            </mml:mrow>
            <mml:mo>
             )
            </mml:mo>
           </mml:mrow>
          </mml:math>
          <tex-math id="IEq18_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq18.gif"/>
         </alternatives>
        </inline-formula>
        is used to model the mapping between features to SOH and the degradation dynamics of battery, respectively.
        <bold>
         b
        </bold>
        When the proposed PINN is applied to transfer learning scenarios, the dynamics
        <inline-formula id="IEq19">
         <alternatives>
          <mml:math id="IEq19_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
            G
           </mml:mi>
           <mml:mrow>
            <mml:mo>
             (
            </mml:mo>
            <mml:mrow>
             <mml:mo>
              ⋅
             </mml:mo>
            </mml:mrow>
            <mml:mo>
             )
            </mml:mo>
           </mml:mrow>
          </mml:math>
          <tex-math id="IEq19_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq19.gif"/>
         </alternatives>
        </inline-formula>
        is frozen and only solution
        <inline-formula id="IEq20">
         <alternatives>
          <mml:math id="IEq20_Math" xmlns="http://www.w3.org/1998/Math/MathML">
           <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
            F
           </mml:mi>
           <mml:mrow>
            <mml:mo>
             (
            </mml:mo>
            <mml:mrow>
             <mml:mo>
              ⋅
             </mml:mo>
            </mml:mrow>
            <mml:mo>
             )
            </mml:mo>
           </mml:mrow>
          </mml:math>
          <tex-math id="IEq20_TeX">
           \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
          </tex-math>
          <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq20.gif"/>
         </alternatives>
        </inline-formula>
        is fine-tuned.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-48779-z/41467_2024_48779_Fig6_HTML.png"/>
     </fig>
    </p>
    <p id="Par30">
     We carried out fine-tuning experiments and source-only experiments, and also compared them with the small sample experiments. All results are given in Table
     <xref ref-type="table" rid="Tab4">
      4
     </xref>
     . It can be seen from the figure that the fine-tuned model is significantly better than the source-only method. What is more, when there is only 1 labeled target domain battery, the models following the “pre-training—fine-tuning” paradigm perform better than models trained directly using 1 target domain battery. This demonstrates the effectiveness of the “pre-training—fine-tuning” paradigm. For the XJTU dataset and TJU dataset, even if the model is trained with 2 target domain batteries, its performance is not as good as that of the model fine-tuned with 1 target domain battery. This also proves that dynamics
     <inline-formula id="IEq13">
      <alternatives>
       <mml:math id="IEq13_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq13_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq13.gif"/>
      </alternatives>
     </inline-formula>
     has learned useful information from a large amount of data in the source domain.
     <table-wrap id="Tab4">
      <label>
       Table 4
      </label>
      <caption xml:lang="en">
       <p>
        The test root mean square error (RMSE) of fine-tuning experiments among four datasets
       </p>
      </caption>
      <table frame="hsides" rules="groups">
       <thead>
        <tr>
         <th/>
         <th colspan="4">
          <p>
           Fine-tuning
          </p>
         </th>
         <th colspan="4">
          <p>
           Source-only
          </p>
         </th>
         <th colspan="2">
          <p>
           Train with target cell
          </p>
         </th>
        </tr>
        <tr>
         <th/>
         <th>
          <p>
           XJTU
          </p>
         </th>
         <th>
          <p>
           TJU
          </p>
         </th>
         <th>
          <p>
           MIT
          </p>
         </th>
         <th>
          <p>
           HUST
          </p>
         </th>
         <th>
          <p>
           XJTU
          </p>
         </th>
         <th>
          <p>
           TJU
          </p>
         </th>
         <th>
          <p>
           MIT
          </p>
         </th>
         <th>
          <p>
           HUST
          </p>
         </th>
         <th>
          <p>
           1
          </p>
         </th>
         <th>
          <p>
           2
          </p>
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td>
          <p>
           XJTU
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0100
           </bold>
          </p>
         </td>
         <td>
          <p>
           0.0145
          </p>
         </td>
         <td>
          <p>
           <italic>
            0.0104
           </italic>
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           0.0967
          </p>
         </td>
         <td>
          <p>
           0.1329
          </p>
         </td>
         <td>
          <p>
           0.0733
          </p>
         </td>
         <td>
          <p>
           0.0184
          </p>
         </td>
         <td>
          <p>
           <underline>
            0.0134
           </underline>
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           TJU
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0093
           </bold>
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           <italic>
            0.0119
           </italic>
          </p>
         </td>
         <td>
          <p>
           0.0146
          </p>
         </td>
         <td>
          <p>
           0.1266
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           0.1674
          </p>
         </td>
         <td>
          <p>
           0.1266
          </p>
         </td>
         <td>
          <p>
           <underline>
            0.0121
           </underline>
          </p>
         </td>
         <td>
          <p>
           0.0202
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           MIT
          </p>
         </td>
         <td>
          <p>
           <italic>
            0.0239
           </italic>
          </p>
         </td>
         <td>
          <p>
           0.0272
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           <underline>
            0.0248
           </underline>
          </p>
         </td>
         <td>
          <p>
           0.0347
          </p>
         </td>
         <td>
          <p>
           0.1277
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           0.0561
          </p>
         </td>
         <td>
          <p>
           0.0324
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0142
           </bold>
          </p>
         </td>
        </tr>
        <tr>
         <td>
          <p>
           HUST
          </p>
         </td>
         <td>
          <p>
           <underline>
            0.0333
           </underline>
          </p>
         </td>
         <td>
          <p>
           0.0343
          </p>
         </td>
         <td>
          <p>
           <italic>
            0.0307
           </italic>
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           0.1131
          </p>
         </td>
         <td>
          <p>
           0.2008
          </p>
         </td>
         <td>
          <p>
           0.0801
          </p>
         </td>
         <td>
          <p>
           –
          </p>
         </td>
         <td>
          <p>
           0.0485
          </p>
         </td>
         <td>
          <p>
           <bold>
            0.0202
           </bold>
          </p>
         </td>
        </tr>
       </tbody>
      </table>
      <table-wrap-foot>
       <p>
        The top 3 results are in bold, italic, and underlined respectively. All values are averaged from ten experiments. View the table in terms of rows. The first row represents that the XJTU dataset is used as the target domain, and other datasets are used as the source domain. “Fine-tuning” means that the PINN was trained on the source domain, then fine-tuned with the data from the 1st battery in the target domain, and tested on the test set of the target domain. “Source-only” means that the PINN was trained on the source domain, and then tested on the test set of target domain directly. “Train with target cell” represents that the PINN was trained with 1 or 2 batteries from the target domain and then tested on the test set of the target domain (the same as the small sample experiments). For convenience, we only select the data in XJTU batch 1 to represent the XJTU dataset. Similarly, batch 3 of the TJU dataset is used to represent the TJU dataset.
       </p>
      </table-wrap-foot>
     </table-wrap>
    </p>
    <p id="Par31">
     There also seem to be some intuitively correct but less obvious insights if Table
     <xref ref-type="table" rid="Tab4">
      4
     </xref>
     is revisited from a fairer perspective, i.e., ignoring the last column of the table. Both the XJTU dataset and the TJU dataset are LiNiCo-x batteries, and the correlation between the features and SOH is more similar (see section “Feature extraction” for correlations), so the fine-tuning effect between them is better. Similarly, both MIT and HUST are LiFePO
     <sub>
      4
     </sub>
     batteries, and the fine-tuning effect between them is also promising. This may be a meaningful finding, and we will continue to study it in the future.
    </p>
   </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
   <title>
    Discussion
   </title>
   <p id="Par32">
    Accurate SOH estimation facilitates health management and maintenance decisions of lithium-ion batteries. Existing SOH estimation methods need to extract different features for different datasets, and the performance of the model fluctuates greatly. In this work, we propose a general PINN for battery SOH estimation. Specifically, we propose a general feature extraction method to extract statistical features from a short period of data before the battery is fully charged, which is included in batteries charged with a constant-current and constant-voltage mode. Then, we modeled the battery degradation dynamics with a PINN, and the SOH was estimated by taking the extracted features as inputs.
   </p>
   <p id="Par33">
    To validate our approach, we performed battery aging experiments and developed a dataset with 55 batteries. Finally, we validate our method on 387 batteries with different chemistries and charge/discharge protocols from 4 large-scale datasets. The results demonstrated the effectiveness and feasibility of our proposed method. Further, we conduct small sample experiments and transfer experiments, proving that considering physical knowledge helps data-driven models to learn faster and better from data. Our study highlights the promise of physics-informed machine learning in battery degradation modeling and SOH estimation. It can facilitate the rapid development of battery management systems for next-generation batteries using existing experimental data and small new data.
   </p>
   <p id="Par34">
    Battery degradation modeling and SOH estimation are research hotspots in the field of battery health management. As batteries aging, various interface degradation processes occur, along with the loss of lithium inventory and active materials, leading to increased resistance in ion and electron transfer as well as intercalation reactions, thereby resulting in changes in their charging curves
    <sup>
     <xref ref-type="bibr" rid="CR46">
      46
     </xref>
    </sup>
    . Consequently, the charging curve contains rich information on the degradation process. However, using charge and discharge curves to estimate battery SOH may fall into the trap of information leakage. Geslin et al.
    <sup>
     <xref ref-type="bibr" rid="CR47">
      47
     </xref>
    </sup>
    pointed out that inconsistent charging and discharging protocols, usage conditions, etc. may lead to information leakage, which is a serious problem that may be ignored by scholars. They believe that a fixed CC-CV mode can alleviate the problem of information leakage. Hence, it is advisable to avoid incorporating factors related to internal battery quality, manufacturing variability, and usage conditions as much as possible when performing SOH estimation tasks. In our study, the features are extracted from a small segment of data from the CC-CV stage before the battery is fully charged, which is independent of the battery usage conditions. This ensures the usefulness and versatility of the features we extracted, while avoiding the problem of information leakage caused by inconsistent charging protocols or battery usage conditions. During the training and test stage, we train the model with data from battery A and test it on battery B; instead of training the model with early data from battery A and testing it with later data, which avoids information leakage from the training set to the test set.
   </p>
   <p id="Par35">
    When building the SOH estimation model, we proposed a PINN for battery SOH estimation. Physics-informed neural network holds promise as an effective avenue for leveraging artificial intelligence to address practical engineering problems. By amalgamating traditional physics models with neural networks models, it can more accurately capture the intricate dynamic behavior of battery systems, thereby facilitating more reliable and precise state estimation. However, this burgeoning field still requires further exploration by scholars. Within the framework proposed by Aykol et al.
    <sup>
     <xref ref-type="bibr" rid="CR38">
      38
     </xref>
    </sup>
    , Hybrid methods, which utilize physical equations to constrain neural networks or integrate physical equations into neural networks, will become dominant in the long term. This class of hybrid methods have the potential to blend the causality and extrapolation capabilities of physics-based models with the speed, flexibility, and high-dimensional capabilities of neural networks. However, the limitation of these methods lies in the complexity of the battery’s physical model (e.g., the P2D model), which contains numerous parameters, and the internal parameters of the battery are difficult to collect. There is currently no satisfactory method to seamlessly integrate physical models and neural networks. The PINN proposed in this paper is modeled from the perspective of empirical degradation and state space equations, serving merely as an exploration of such hybrid methods and acting as a catalyst for further research. Additionally, we only consider extracting features from easily accessible current and voltage data. As more data and internal variables become available, more complex electrochemical models can be considered. The optimal integration of battery governing equations and neural networks for health management within the constraints of existing data and computational resources remains ripe for further exploration.
   </p>
  </sec>
  <sec id="Sec10" sec-type="methods">
   <title>
    Methods
   </title>
   <sec id="Sec11">
    <title>
     Battery degradation modeling
    </title>
    <p id="Par36">
     Battery aging is primarily characterized by a decrease in available capacity and an increase in internal resistance, typically following a declining trajectory. To accurately describe the battery degradation trajectory, scholars have proposed various empirical models to describe the loss of battery capacity as a function of time or cycle numbers, including the linear model
     <sup>
      <xref ref-type="bibr" rid="CR48">
       48
      </xref>
     </sup>
     , exponential model
     <sup>
      <xref ref-type="bibr" rid="CR49">
       49
      </xref>
      ,
      <xref ref-type="bibr" rid="CR50">
       50
      </xref>
     </sup>
     , power-law model
     <sup>
      <xref ref-type="bibr" rid="CR51">
       51
      </xref>
     </sup>
     , and failure forecast model (FFM)
     <sup>
      <xref ref-type="bibr" rid="CR52">
       52
      </xref>
     </sup>
     , etc. These models all describe the battery’s degradation trajectory as a univariate function of time.
    </p>
    <p id="Par37">
     However, representing the degradation trajectory of batteries solely as a univariate function of time oversimplifies the process. In fact, battery degradation is not only related to time but also related to charging rate, discharging rate, calendar time, temperature, depth of discharge (DOD), etc. For example, Xu et al.
     <sup>
      <xref ref-type="bibr" rid="CR53">
       53
      </xref>
     </sup>
     divided battery aging into calendar aging and cycle aging, which considered factors such as state-of-charge (SOC), DOD, cell temperature, and solid electrolyte interphase (SEI) film growth. They modeled calendar aging and cycle aging as functions of calendar time, SOC, DOD, and temperature.
    </p>
    <p id="Par38">
     Therefore, modeling the degradation trajectory of a battery solely as a function of time is inadequate. In this study, we propose to model it as a multivariate function:
     <disp-formula id="Equ1">
      <label>
       1
      </label>
      <alternatives>
       <mml:math id="Equ1_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi>
         u
        </mml:mi>
        <mml:mo>
         =
        </mml:mo>
        <mml:mi>
         f
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ1_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u=f(t,\, {{{{{{{\bf{x}}}}}}}}),$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ1.gif"/>
      </alternatives>
     </disp-formula>
     where
     <italic>
      t
     </italic>
     represents time and
     <bold>
      x
     </bold>
     represents a vector composed of SOC, DOD, temperature, charge rate, discharge rate, health indicators (HIs), and all other factors. In our work,
     <bold>
      x
     </bold>
     represents the HIs extracted from the charging data (see “Feature extraction” section for more details).
    </p>
    <p id="Par39">
     Without loss of generality, to describe the degradation dynamics of the battery, its SOH decay rate can be described as:
     <disp-formula id="Equ2">
      <label>
       2
      </label>
      <alternatives>
       <mml:math id="Equ2_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mfrac>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi>
           u
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi>
           t
          </mml:mi>
         </mml:mrow>
        </mml:mfrac>
        <mml:mo>
         =
        </mml:mo>
        <mml:mi>
         g
        </mml:mi>
        <mml:mfenced close=")" open="(">
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>
           u
          </mml:mi>
          <mml:mo>
           ;
          </mml:mo>
          <mml:mi>
           θ
          </mml:mi>
         </mml:mrow>
        </mml:mfenced>
        <mml:mo>
         .
        </mml:mo>
       </mml:math>
       <tex-math id="Equ2_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\partial u}{\partial t}=g\left(t,\, {{{{{{{\bf{x}}}}}}}},\, u;\theta \right).$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ2.gif"/>
      </alternatives>
     </disp-formula>
     The above equation is an explicit partial differential equation (PDE) parameterized by
     <italic>
      θ
     </italic>
     , and
     <italic>
      g
     </italic>
     ( ⋅ ) represents the nonlinear function of
     <italic>
      t
     </italic>
     ,
     <bold>
      x
     </bold>
     , and
     <italic>
      u
     </italic>
     . The function
     <italic>
      g
     </italic>
     ( ⋅ ) characterizes the internal degradation dynamics of the battery, and by altering this nonlinear function, various forms of degradation can be represented. Models such as linear model, exponential model, power-law model, and FFM can be viewed as particular cases of Eq. (
     <xref ref-type="disp-formula" rid="Equ2">
      2
     </xref>
     ) when only the time is considered.
    </p>
   </sec>
   <sec id="Sec12">
    <title>
     Physics-informed neural network
    </title>
    <p id="Par40">
     An unavoidable problem is that the explicit form of
     <italic>
      g
     </italic>
     ( ⋅ ) is unknown and difficult to obtain. In response to similar problems, Sun et al.
     <sup>
      <xref ref-type="bibr" rid="CR36">
       36
      </xref>
     </sup>
     proposed a sparse regression physics-informed neural network that exploits sparsity to learn the parameters
     <italic>
      θ
     </italic>
     of
     <italic>
      g
     </italic>
     ( ⋅ ) from a given candidate set. Raissi et al.
     <sup>
      <xref ref-type="bibr" rid="CR54">
       54
      </xref>
     </sup>
     proposed deep hidden physics models to model
     <italic>
      g
     </italic>
     ( ⋅ ). Inspired by
     <sup>
      <xref ref-type="bibr" rid="CR54">
       54
      </xref>
      ,
      <xref ref-type="bibr" rid="CR55">
       55
      </xref>
     </sup>
     , we propose to use a more generalized function approximator
     <inline-formula id="IEq14">
      <alternatives>
       <mml:math id="IEq14_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           g
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ′
          </mml:mo>
         </mml:mrow>
        </mml:msup>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq14_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}^{{\prime} }(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq14.gif"/>
      </alternatives>
     </inline-formula>
     with parameters
     <inline-formula id="IEq15">
      <alternatives>
       <mml:math id="IEq15_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           θ
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ′
          </mml:mo>
         </mml:mrow>
        </mml:msup>
       </mml:math>
       <tex-math id="IEq15_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq15.gif"/>
      </alternatives>
     </inline-formula>
     to represent the nonlinear dynamics
     <italic>
      g
     </italic>
     ( ⋅ ). Therefore, Eq. (
     <xref ref-type="disp-formula" rid="Equ2">
      2
     </xref>
     ) becomes:
     <disp-formula id="Equ3">
      <label>
       3
      </label>
      <alternatives>
       <mml:math id="Equ3_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi>
           u
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         ≈
        </mml:mo>
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           g
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ′
          </mml:mo>
         </mml:mrow>
        </mml:msup>
        <mml:mfenced close=")" open="(">
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>
           u
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msub>
           <mml:mrow>
            <mml:mi>
             u
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             t
            </mml:mi>
           </mml:mrow>
          </mml:msub>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msub>
           <mml:mrow>
            <mml:mi>
             u
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi mathvariant="bold">
             x
            </mml:mi>
           </mml:mrow>
          </mml:msub>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msub>
           <mml:mrow>
            <mml:mi>
             u
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi mathvariant="bold">
             xx
            </mml:mi>
           </mml:mrow>
          </mml:msub>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mo>
           ⋯
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>
           ;
          </mml:mo>
          <mml:msup>
           <mml:mrow>
            <mml:mi>
             θ
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mo>
             ′
            </mml:mo>
           </mml:mrow>
          </mml:msup>
         </mml:mrow>
        </mml:mfenced>
        <mml:mo>
         .
        </mml:mo>
       </mml:math>
       <tex-math id="Equ3_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${u}_{t}\approx {g}^{{\prime} }\left(t,\, {{{{{{{\bf{x}}}}}}}},\, u,\, {u}_{t},\, {u}_{{{{{{{{\bf{x}}}}}}}}},\,{u}_{{{{{{{{\bf{xx}}}}}}}}},\cdots \,;{\theta }^{{\prime} }\right).$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ3.gif"/>
      </alternatives>
     </disp-formula>
     In the equation,
     <inline-formula id="IEq016">
      <alternatives>
       <mml:math id="IEq016_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi>
           u
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         =
        </mml:mo>
        <mml:mfrac>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi>
           u
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi>
           t
          </mml:mi>
         </mml:mrow>
        </mml:mfrac>
       </mml:math>
       <tex-math id="IEq016_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${u}_{t}=\frac{\partial u}{\partial t}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq016.gif"/>
      </alternatives>
     </inline-formula>
     , we employ a neural network
     <inline-formula id="IEq017">
      <alternatives>
       <mml:math id="IEq017_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mfenced close=")" open="(">
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
          <mml:mo>
           ;
          </mml:mo>
          <mml:mi mathvariant="normal">
           Φ
          </mml:mi>
         </mml:mrow>
        </mml:mfenced>
       </mml:math>
       <tex-math id="IEq017_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}\left(t,{{{{{{{\bf{x}}}}}}}};{{\Phi }}\right)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq017.gif"/>
      </alternatives>
     </inline-formula>
     with learnable parameters Φ to model
     <italic>
      f
     </italic>
     (
     <italic>
      t
     </italic>
     ,
     <bold>
      x
     </bold>
     ) and utilize automatic differentiation mechanisms to compute
     <italic>
      u
     </italic>
     <sub>
      <italic>
       t
      </italic>
     </sub>
     .
     <inline-formula id="IEq018">
      <alternatives>
       <mml:math id="IEq018_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi>
           u
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         =
        </mml:mo>
        <mml:msup>
         <mml:mrow>
          <mml:mfenced close="]" open="[">
           <mml:mrow>
            <mml:mfrac>
             <mml:mrow>
              <mml:mi>
               ∂
              </mml:mi>
              <mml:mi>
               u
              </mml:mi>
             </mml:mrow>
             <mml:mrow>
              <mml:mi>
               ∂
              </mml:mi>
              <mml:msub>
               <mml:mrow>
                <mml:mi>
                 x
                </mml:mi>
               </mml:mrow>
               <mml:mrow>
                <mml:mn>
                 1
                </mml:mn>
               </mml:mrow>
              </mml:msub>
             </mml:mrow>
            </mml:mfrac>
            <mml:mo>
             ,
            </mml:mo>
            <mml:mfrac>
             <mml:mrow>
              <mml:mi>
               ∂
              </mml:mi>
              <mml:mi>
               u
              </mml:mi>
             </mml:mrow>
             <mml:mrow>
              <mml:mi>
               ∂
              </mml:mi>
              <mml:msub>
               <mml:mrow>
                <mml:mi>
                 x
                </mml:mi>
               </mml:mrow>
               <mml:mrow>
                <mml:mn>
                 2
                </mml:mn>
               </mml:mrow>
              </mml:msub>
             </mml:mrow>
            </mml:mfrac>
            <mml:mo>
             ,
            </mml:mo>
            <mml:mo>
             ⋯
            </mml:mo>
           </mml:mrow>
          </mml:mfenced>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ⊤
          </mml:mo>
         </mml:mrow>
        </mml:msup>
       </mml:math>
       <tex-math id="IEq018_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${u}_{{{{{{{{\bf{x}}}}}}}}}={\left[\frac{\partial u}{\partial {x}_{1}},\frac{\partial u}{\partial {x}_{2}},\cdots \right]}^{\top }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq018.gif"/>
      </alternatives>
     </inline-formula>
     represents the first-order partial derivative of
     <italic>
      u
     </italic>
     with respect to
     <bold>
      x
     </bold>
     , and
     <italic>
      u
     </italic>
     <sub>
      <bold>
       xx
      </bold>
     </sub>
     represents the second-order partial derivative. One advantage of this approach is that we do not need to specify a candidate basis function set for
     <italic>
      g
     </italic>
     ( ⋅ ), but instead employ a more generalized approximators
     <inline-formula id="IEq019">
      <alternatives>
       <mml:math id="IEq019_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           g
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ′
          </mml:mo>
         </mml:mrow>
        </mml:msup>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq019_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}^{{\prime} }(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq019.gif"/>
      </alternatives>
     </inline-formula>
     . The function approximator
     <inline-formula id="IEq020">
      <alternatives>
       <mml:math id="IEq020_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           g
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ′
          </mml:mo>
         </mml:mrow>
        </mml:msup>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq020_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}^{{\prime} }(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq020.gif"/>
      </alternatives>
     </inline-formula>
     propose a more flexible relationship to
     <italic>
      t
     </italic>
     ,
     <italic>
      u
     </italic>
     ,
     <bold>
      x
     </bold>
     , and their arbitrary order partial derivatives. A neural network
     <inline-formula id="IEq21">
      <alternatives>
       <mml:math id="IEq21_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mfenced close=")" open="(">
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
        </mml:mfenced>
       </mml:math>
       <tex-math id="IEq21_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}\left(\cdot \right)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq21.gif"/>
      </alternatives>
     </inline-formula>
     with learnable parameters Θ is used to model
     <inline-formula id="IEq22">
      <alternatives>
       <mml:math id="IEq22_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           g
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mo>
           ′
          </mml:mo>
         </mml:mrow>
        </mml:msup>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq22_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}^{{\prime} }(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq22.gif"/>
      </alternatives>
     </inline-formula>
     so that it can learn the aging mechanism of the battery from the given
     <bold>
      x,
     </bold>
     <italic>
      t
     </italic>
     , and other partial derivatives. To balance accuracy and computational complexity, we only consider the influence of first-order partial derivatives, discarding higher-order derivatives.
    </p>
    <p id="Par41">
     Building upon the aforementioned analysis, we define a physics-informed neural network
     <inline-formula id="IEq23">
      <alternatives>
       <mml:math id="IEq23_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         H
        </mml:mi>
       </mml:math>
       <tex-math id="IEq23_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{H}}}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq23.gif"/>
      </alternatives>
     </inline-formula>
     <sup>
      <xref ref-type="bibr" rid="CR37">
       37
      </xref>
      ,
      <xref ref-type="bibr" rid="CR55">
       55
      </xref>
     </sup>
     for battery aging:
     <disp-formula id="Equ4">
      <label>
       4
      </label>
      <alternatives>
       <mml:math id="Equ4_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         H
        </mml:mi>
        <mml:mo>
         :
        </mml:mo>
        <mml:mo>
         =
        </mml:mo>
        <mml:mfrac>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           F
          </mml:mi>
          <mml:mfenced close=")" open="(">
           <mml:mrow>
            <mml:mi>
             t
            </mml:mi>
            <mml:mo>
             ,
            </mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="bold">
             x
            </mml:mi>
            <mml:mo>
             ;
            </mml:mo>
            <mml:mi mathvariant="normal">
             Φ
            </mml:mi>
           </mml:mrow>
          </mml:mfenced>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi>
           t
          </mml:mi>
         </mml:mrow>
        </mml:mfrac>
        <mml:mo>
         −
        </mml:mo>
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mfenced close=")" open="(">
         <mml:mrow>
          <mml:mi>
           t
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>
           u
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msub>
           <mml:mrow>
            <mml:mi>
             u
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             t
            </mml:mi>
           </mml:mrow>
          </mml:msub>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msub>
           <mml:mrow>
            <mml:mi>
             u
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi mathvariant="bold">
             x
            </mml:mi>
           </mml:mrow>
          </mml:msub>
          <mml:mo>
           ;
          </mml:mo>
          <mml:mi mathvariant="normal">
           Θ
          </mml:mi>
         </mml:mrow>
        </mml:mfenced>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ4_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{H}}}}}}}}:=\frac{\partial {{{{{{{\mathcal{F}}}}}}}}\left(t,\, {{{{{{{\bf{x}}}}}}}};{{\Phi }}\right)}{\partial t}-{{{{{{{\mathcal{G}}}}}}}}\left(t,\, {{{{{{{\bf{x}}}}}}}},\, u,\, {u}_{t},\, {u}_{{{{{{{{\bf{x}}}}}}}}};{{\Theta }}\right),$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ4.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq24">
      <alternatives>
       <mml:math id="IEq24_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mfrac>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           F
          </mml:mi>
          <mml:mfenced close=")" open="(">
           <mml:mrow>
            <mml:mi>
             t
            </mml:mi>
            <mml:mo>
             ,
            </mml:mo>
            <mml:mi mathvariant="bold">
             x
            </mml:mi>
            <mml:mo>
             ;
            </mml:mo>
            <mml:mi mathvariant="normal">
             Φ
            </mml:mi>
           </mml:mrow>
          </mml:mfenced>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           ∂
          </mml:mi>
          <mml:mi>
           t
          </mml:mi>
         </mml:mrow>
        </mml:mfrac>
       </mml:math>
       <tex-math id="IEq24_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\partial {{{{{{{\mathcal{F}}}}}}}}\left(t,{{{{{{{\bf{x}}}}}}}};{{\Phi }}\right)}{\partial t}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq24.gif"/>
      </alternatives>
     </inline-formula>
     represents the partial derivation of solution neural network
     <inline-formula id="IEq25">
      <alternatives>
       <mml:math id="IEq25_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq25_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq25.gif"/>
      </alternatives>
     </inline-formula>
     with respect to
     <italic>
      t
     </italic>
     , and
     <inline-formula id="IEq26">
      <alternatives>
       <mml:math id="IEq26_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq26_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq26.gif"/>
      </alternatives>
     </inline-formula>
     denotes the battery degradation dynamic equation modeled by the neural network. The structure of the proposed PINN is shown in Fig.
     <xref ref-type="fig" rid="Fig6">
      6
     </xref>
     .
    </p>
    <p id="Par42">
     Equation (
     <xref ref-type="disp-formula" rid="Equ4">
      4
     </xref>
     ) is derived from Eqs. (
     <xref ref-type="disp-formula" rid="Equ2">
      2
     </xref>
     ) and (
     <xref ref-type="disp-formula" rid="Equ3">
      3
     </xref>
     ). However, since it is fitted by a neural network, its training process is discrete, so it does not strictly satisfy Eq. (
     <xref ref-type="disp-formula" rid="Equ2">
      2
     </xref>
     ). For battery SOH, the calculation formula is
     <sup>
      <xref ref-type="bibr" rid="CR13">
       13
      </xref>
     </sup>
     :
     <disp-formula id="Equ5">
      <label>
       5
      </label>
      <alternatives>
       <mml:math id="Equ5_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mi>
           u
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           k
          </mml:mi>
         </mml:mrow>
        </mml:msup>
        <mml:mo>
         =
        </mml:mo>
        <mml:mi>
         f
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mi>
           k
          </mml:mi>
          <mml:mo>
           ,
          </mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi mathvariant="bold">
           x
          </mml:mi>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
        <mml:mo>
         =
        </mml:mo>
        <mml:mfrac>
         <mml:mrow>
          <mml:msup>
           <mml:mrow>
            <mml:mi>
             Q
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             k
            </mml:mi>
           </mml:mrow>
          </mml:msup>
         </mml:mrow>
         <mml:mrow>
          <mml:msup>
           <mml:mrow>
            <mml:mi>
             Q
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mn>
             0
            </mml:mn>
           </mml:mrow>
          </mml:msup>
         </mml:mrow>
        </mml:mfrac>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ5_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${u}^{k}=f(k,\, {{{{{{{\bf{x}}}}}}}})=\frac{{Q}^{k}}{{Q}^{0}},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ5.gif"/>
      </alternatives>
     </disp-formula>
     where
     <italic>
      Q
     </italic>
     <sup>
      <italic>
       k
      </italic>
     </sup>
     represents the capacity of cycle
     <italic>
      k
     </italic>
     and
     <italic>
      Q
     </italic>
     <sup>
      0
     </sup>
     represents the nominal capacity. The SOH value
     <italic>
      u
     </italic>
     <sup>
      <italic>
       k
      </italic>
     </sup>
     coincides with the point on the degradation trajectory
     <italic>
      f
     </italic>
     ( ⋅ ) when
     <italic>
      t
     </italic>
     =
     <italic>
      k
     </italic>
     . We need to make
     <inline-formula id="IEq27">
      <alternatives>
       <mml:math id="IEq27_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         H
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:msup>
           <mml:mrow>
            <mml:mi>
             t
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             i
            </mml:mi>
           </mml:mrow>
          </mml:msup>
          <mml:mo>
           ,
          </mml:mo>
          <mml:msup>
           <mml:mrow>
            <mml:mi mathvariant="bold">
             x
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             i
            </mml:mi>
           </mml:mrow>
          </mml:msup>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
        <mml:mo>
         =
        </mml:mo>
        <mml:mn>
         0
        </mml:mn>
       </mml:math>
       <tex-math id="IEq27_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{H}}}}}}}}({t}^{i},{{{{{{{{\bf{x}}}}}}}}}^{i})=0$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq27.gif"/>
      </alternatives>
     </inline-formula>
     hold at sample point
     <italic>
      i
     </italic>
     to approximate Eq. (
     <xref ref-type="disp-formula" rid="Equ2">
      2
     </xref>
     ). Therefore, the optimization process of the PINN needs to adhere to the PDE loss specified by Eq. (
     <xref ref-type="disp-formula" rid="Equ2">
      2
     </xref>
     ), i.e.:
     <disp-formula id="Equ6">
      <label>
       6
      </label>
      <alternatives>
       <mml:math id="Equ6_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           PDE
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         =
        </mml:mo>
        <mml:msubsup>
         <mml:mrow>
          <mml:mo mathsize="big">
           ∑
          </mml:mo>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           i
          </mml:mi>
          <mml:mo>
           =
          </mml:mo>
          <mml:mn>
           1
          </mml:mn>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           N
          </mml:mi>
         </mml:mrow>
        </mml:msubsup>
        <mml:msup>
         <mml:mrow>
          <mml:mfenced close="∣" open="∣">
           <mml:mrow>
            <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
             H
            </mml:mi>
            <mml:mfenced close=")" open="(">
             <mml:mrow>
              <mml:msup>
               <mml:mrow>
                <mml:mi>
                 t
                </mml:mi>
               </mml:mrow>
               <mml:mrow>
                <mml:mi>
                 i
                </mml:mi>
               </mml:mrow>
              </mml:msup>
              <mml:mo>
               ,
              </mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:msup>
               <mml:mrow>
                <mml:mi mathvariant="bold">
                 x
                </mml:mi>
               </mml:mrow>
               <mml:mrow>
                <mml:mi>
                 i
                </mml:mi>
               </mml:mrow>
              </mml:msup>
             </mml:mrow>
            </mml:mfenced>
           </mml:mrow>
          </mml:mfenced>
         </mml:mrow>
         <mml:mrow>
          <mml:mn>
           2
          </mml:mn>
         </mml:mrow>
        </mml:msup>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ6_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{PDE}}}}}}}}}={\sum }_{i=1}^{N}{\left\vert {{{{{{{\mathcal{H}}}}}}}}\left({t}^{i},\, {{{{{{{{\bf{x}}}}}}}}}^{i}\right)\right\vert }^{2},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ6.gif"/>
      </alternatives>
     </disp-formula>
     where superscript
     <italic>
      i
     </italic>
     denotes the
     <italic>
      i
     </italic>
     th sample and
     <italic>
      N
     </italic>
     denotes the number of samples. Also, the optimization objective includes data item loss and monotonicity loss:
     <disp-formula id="Equ7">
      <label>
       7
      </label>
      <alternatives>
       <mml:math id="Equ7_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           data
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         =
        </mml:mo>
        <mml:msubsup>
         <mml:mrow>
          <mml:mo mathsize="big">
           ∑
          </mml:mo>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           i
          </mml:mi>
          <mml:mo>
           =
          </mml:mo>
          <mml:mn>
           1
          </mml:mn>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           N
          </mml:mi>
         </mml:mrow>
        </mml:msubsup>
        <mml:msup>
         <mml:mrow>
          <mml:mfenced close="∣" open="∣">
           <mml:mrow>
            <mml:msup>
             <mml:mrow>
              <mml:mi>
               u
              </mml:mi>
             </mml:mrow>
             <mml:mrow>
              <mml:mi>
               i
              </mml:mi>
             </mml:mrow>
            </mml:msup>
            <mml:mo>
             −
            </mml:mo>
            <mml:msup>
             <mml:mrow>
              <mml:mover accent="true">
               <mml:mrow>
                <mml:mi>
                 u
                </mml:mi>
               </mml:mrow>
               <mml:mrow>
                <mml:mo>
                 ̂
                </mml:mo>
               </mml:mrow>
              </mml:mover>
             </mml:mrow>
             <mml:mrow>
              <mml:mi>
               i
              </mml:mi>
             </mml:mrow>
            </mml:msup>
           </mml:mrow>
          </mml:mfenced>
         </mml:mrow>
         <mml:mrow>
          <mml:mn>
           2
          </mml:mn>
         </mml:mrow>
        </mml:msup>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ7_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{data}}}}}}}}}={\sum }_{i=1}^{N}{\left\vert {u}^{i}-{\hat{u}}^{i}\right\vert }^{2},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ7.gif"/>
      </alternatives>
     </disp-formula>
     <disp-formula id="Equ8">
      <label>
       8
      </label>
      <alternatives>
       <mml:math id="Equ8_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           mono
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         =
        </mml:mo>
        <mml:msubsup>
         <mml:mrow>
          <mml:mo mathsize="big">
           ∑
          </mml:mo>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           j
          </mml:mi>
          <mml:mo>
           =
          </mml:mo>
          <mml:mn>
           1
          </mml:mn>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           M
          </mml:mi>
         </mml:mrow>
        </mml:msubsup>
        <mml:msubsup>
         <mml:mrow>
          <mml:mo mathsize="big">
           ∑
          </mml:mo>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           k
          </mml:mi>
          <mml:mo>
           =
          </mml:mo>
          <mml:mn>
           1
          </mml:mn>
         </mml:mrow>
         <mml:mrow>
          <mml:msub>
           <mml:mrow>
            <mml:mi>
             N
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             j
            </mml:mi>
           </mml:mrow>
          </mml:msub>
         </mml:mrow>
        </mml:msubsup>
        <mml:mi mathvariant="normal">
         ReLU
        </mml:mi>
        <mml:mfenced close=")" open="(">
         <mml:mrow>
          <mml:msup>
           <mml:mrow>
            <mml:mover accent="true">
             <mml:mrow>
              <mml:mi>
               u
              </mml:mi>
             </mml:mrow>
             <mml:mrow>
              <mml:mo>
               ̂
              </mml:mo>
             </mml:mrow>
            </mml:mover>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             k
            </mml:mi>
            <mml:mo>
             +
            </mml:mo>
            <mml:mn>
             1
            </mml:mn>
           </mml:mrow>
          </mml:msup>
          <mml:mo>
           −
          </mml:mo>
          <mml:msup>
           <mml:mrow>
            <mml:mover accent="true">
             <mml:mrow>
              <mml:mi>
               u
              </mml:mi>
             </mml:mrow>
             <mml:mrow>
              <mml:mo>
               ̂
              </mml:mo>
             </mml:mrow>
            </mml:mover>
           </mml:mrow>
           <mml:mrow>
            <mml:mi>
             k
            </mml:mi>
           </mml:mrow>
          </mml:msup>
         </mml:mrow>
        </mml:mfenced>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ8_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{mono}}}}}}}}}={\sum }_{j=1}^{M}{\sum }_{k=1}^{{N}_{j}}{{{{{{{\rm{ReLU}}}}}}}}\left({\hat{u}}^{k+1}-{\hat{u}}^{k}\right),$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ8.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq28">
      <alternatives>
       <mml:math id="IEq28_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msup>
         <mml:mrow>
          <mml:mover accent="true">
           <mml:mrow>
            <mml:mi>
             u
            </mml:mi>
           </mml:mrow>
           <mml:mrow>
            <mml:mo>
             ̂
            </mml:mo>
           </mml:mrow>
          </mml:mover>
         </mml:mrow>
         <mml:mrow>
          <mml:mi>
           i
          </mml:mi>
         </mml:mrow>
        </mml:msup>
       </mml:math>
       <tex-math id="IEq28_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{u}}^{i}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq28.gif"/>
      </alternatives>
     </inline-formula>
     represents the estimated SOH,
     <italic>
      M
     </italic>
     represents the number of batteries,
     <italic>
      N
     </italic>
     <sub>
      <italic>
       j
      </italic>
     </sub>
     denotes the number of cycles of battery
     <italic>
      j
     </italic>
     , and ReLU( ⋅ ) is Rectified Linear Unit. The monotonicity loss
     <inline-formula id="IEq29">
      <alternatives>
       <mml:math id="IEq29_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           mono
          </mml:mi>
         </mml:mrow>
        </mml:msub>
       </mml:math>
       <tex-math id="IEq29_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{mono}}}}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq29.gif"/>
      </alternatives>
     </inline-formula>
     is based on the physical properties of battery degradation, that is, the SOH of the next cycle should be less than or equal to that of the previous cycle (unless capacity regeneration occurs). The total function is formulated as:
     <disp-formula id="Equ9">
      <label>
       9
      </label>
      <alternatives>
       <mml:math id="Equ9_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         L
        </mml:mi>
        <mml:mo>
         =
        </mml:mo>
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           data
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         +
        </mml:mo>
        <mml:mi>
         α
        </mml:mi>
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           PDE
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         +
        </mml:mo>
        <mml:mi>
         β
        </mml:mi>
        <mml:msub>
         <mml:mrow>
          <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mml:mi>
         </mml:mrow>
         <mml:mrow>
          <mml:mi mathvariant="normal">
           mono
          </mml:mi>
         </mml:mrow>
        </mml:msub>
        <mml:mo>
         ,
        </mml:mo>
       </mml:math>
       <tex-math id="Equ9_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{L}}}}}}}}={{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{data}}}}}}}}}+\alpha {{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{PDE}}}}}}}}}+\beta {{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\rm{mono}}}}}}}}},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_Equ9.gif"/>
      </alternatives>
     </disp-formula>
     where the
     <italic>
      α
     </italic>
     and
     <italic>
      β
     </italic>
     are trade-off parameters. More details about our model can be found in Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      3
     </xref>
     .
    </p>
   </sec>
   <sec id="Sec13">
    <title>
     Transfer learning with physics-informed neural network
    </title>
    <p id="Par43">
     Our PINN for battery aging consists of two parts: a solution neural network
     <inline-formula id="IEq30">
      <alternatives>
       <mml:math id="IEq30_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq30_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq30.gif"/>
      </alternatives>
     </inline-formula>
     that builds the feature-to-SOH mapping and a neural network
     <inline-formula id="IEq31">
      <alternatives>
       <mml:math id="IEq31_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq31_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq31.gif"/>
      </alternatives>
     </inline-formula>
     that models battery degradation dynamics, as shown in Fig.
     <xref ref-type="fig" rid="Fig6">
      6
     </xref>
     . We believe that the degradation dynamics
     <inline-formula id="IEq32">
      <alternatives>
       <mml:math id="IEq32_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq32_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq32.gif"/>
      </alternatives>
     </inline-formula>
     are independent of charge/discharge protocols and datasets, while the solution
     <inline-formula id="IEq33">
      <alternatives>
       <mml:math id="IEq33_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq33_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq33.gif"/>
      </alternatives>
     </inline-formula>
     is related to them. Therefore, when our PINN is applied to transfer learning scenarios, dynamics
     <inline-formula id="IEq34">
      <alternatives>
       <mml:math id="IEq34_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         G
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq34_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{G}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq34.gif"/>
      </alternatives>
     </inline-formula>
     is frozen, and only solution
     <inline-formula id="IEq35">
      <alternatives>
       <mml:math id="IEq35_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mml:mi class="MJX-tex-caligraphic" mathvariant="script">
         F
        </mml:mi>
        <mml:mrow>
         <mml:mo>
          (
         </mml:mo>
         <mml:mrow>
          <mml:mo>
           ⋅
          </mml:mo>
         </mml:mrow>
         <mml:mo>
          )
         </mml:mo>
        </mml:mrow>
       </mml:math>
       <tex-math id="IEq35_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\mathcal{F}}}}}}}}(\cdot )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_48779_Article_IEq35.gif"/>
      </alternatives>
     </inline-formula>
     is fine-tuned, as shown in Fig.
     <xref ref-type="fig" rid="Fig6">
      6
     </xref>
     b.
    </p>
   </sec>
  </sec>
 </body>
 <back>
  <ack>
   <title>
    Acknowledgements
   </title>
   <p>
    This work was supported in part by the National Natural Science Foundation of China under Grand 52105116 (Z.Z. (Zhibin Zhao)) and Grand 92060302 (X.C.); the Fundamental Research Funds for the Central Universities (xzy022023060) (F.W.).
   </p>
  </ack>
  <sec sec-type="author-contribution">
   <title>
    Author contributions
   </title>
   <p>
    F.W. was responsible for conceptualization, methodology design, conducting experiments, and drafting the original manuscript. Z.Z. (Zhi Zhai) extensively reviewed and edited the manuscript, providing valuable suggestions and revisions. Z.Z. (Zhibin Zhao) contributed to conceptualization and methodology discussions, playing a significant role in the editing process. Y.D. conducted comprehensive reviews and edits, significantly contributing to the refinement of the article. X.C. spearheaded the acquisition of funds necessary for this research, providing crucial support.
   </p>
  </sec>
  <sec sec-type="peer-review">
   <title>
    Peer review
   </title>
   <sec id="FPar1">
    <title>
     Peer review information
    </title>
    <p id="Par44">
     <italic>
      Nature Communications
     </italic>
     thanks the anonymous reviewers for their contribution to the peer review of this work. A peer review file is available.
    </p>
   </sec>
  </sec>
  <sec sec-type="data-availability">
   <title>
    Data availability
   </title>
   <p>
    The XJTU battery dataset generated in this study is publicly available in the Zenodo database under accession code [
    <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10963339">
     https://doi.org/10.5281/zenodo.10963339
    </ext-link>
    ], as reference
    <sup>
     <xref ref-type="bibr" rid="CR56">
      56
     </xref>
    </sup>
    . The TJU dataset is available at:
    <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/6405084">
     https://zenodo.org/record/6405084
    </ext-link>
    . The HUST dataset is available at:
    <ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/nsc7hnsg4s/2">
     https://data.mendeley.com/datasets/nsc7hnsg4s/2
    </ext-link>
    . The MIT dataset is available at:
    <ext-link ext-link-type="uri" xlink:href="https://data.matr.io/1/projects/5c48dd2bc625d700019f3204">
     https://data.matr.io/1/projects/5c48dd2bc625d700019f3204
    </ext-link>
    .
    <xref ref-type="sec" rid="Sec15">
     Source data
    </xref>
    are provided with this paper.
   </p>
  </sec>
  <sec sec-type="data-availability">
   <title>
    Code availability
   </title>
   <p>
    Our code is available on Github [
    <ext-link ext-link-type="uri" xlink:href="https://github.com/wang-fujin/PINN4SOH">
     https://github.com/wang-fujin/PINN4SOH
    </ext-link>
    ] or on Zenodo database under accession code [
    <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.11046967">
     https://doi.org/10.5281/zenodo.11046967
    </ext-link>
    ], as reference
    <sup>
     <xref ref-type="bibr" rid="CR57">
      57
     </xref>
    </sup>
    .
   </p>
  </sec>
  <sec sec-type="ethics-statement">
   <sec id="FPar2" sec-type="COI-statement">
    <title>
     Competing interests
    </title>
    <p id="Par45">
     The authors declare no competing interests.
    </p>
   </sec>
  </sec>
  <ref-list id="Bib1">
   <title>
    References
   </title>
   <ref-list>
    <ref id="CR1">
     <label>
      1.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Schmuch
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Wagner
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Hörpel
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <name>
        <surname>
         Placke
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <name>
        <surname>
         Winter
        </surname>
        <given-names>
         M
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Performance and cost of materials for lithium-based rechargeable automotive batteries
      </article-title>
      <source>
       Nat. Energy
      </source>
      <year>
       2018
      </year>
      <volume>
       3
      </volume>
      <fpage>
       267
      </fpage>
      <lpage>
       278
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2018NatEn...3..267S
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXos1KhtLs%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41560-018-0107-2
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR2">
     <label>
      2.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Harper
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Recycling lithium-ion batteries from electric vehicles
      </article-title>
      <source>
       Nature
      </source>
      <year>
       2019
      </year>
      <volume>
       575
      </volume>
      <fpage>
       75
      </fpage>
      <lpage>
       86
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019Natur.575...75H
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1MXitFWnurvF
      </pub-id>
      <pub-id pub-id-type="pmid">
       31695206
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41586-019-1682-5
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR3">
     <label>
      3.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zubi
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <name>
        <surname>
         Adhikari
        </surname>
        <given-names>
         RS
        </given-names>
       </name>
       <name>
        <surname>
         Sánchez
        </surname>
        <given-names>
         NE
        </given-names>
       </name>
       <name>
        <surname>
         Acuña-Bravo
        </surname>
        <given-names>
         W
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Lithium-ion battery-packs for solar home systems: layout, cost and implementation perspectives
      </article-title>
      <source>
       J. Energy Storage
      </source>
      <year>
       2020
      </year>
      <volume>
       32
      </volume>
      <fpage>
       101985
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.est.2020.101985
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR4">
     <label>
      4.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhao
        </surname>
        <given-names>
         D
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Online estimation of satellite lithium-ion battery capacity based on approximate belief rule base and hidden Markov model
      </article-title>
      <source>
       Energy
      </source>
      <year>
       2022
      </year>
      <volume>
       256
      </volume>
      <fpage>
       124632
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.energy.2022.124632
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR5">
     <label>
      5.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Yun
        </surname>
        <given-names>
         S-T
        </given-names>
       </name>
       <name>
        <surname>
         Kong
        </surname>
        <given-names>
         S-H
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Data-driven in-orbit current and voltage prediction using Bi-LSTM for LEO satellite lithium-ion battery SOC estimation
      </article-title>
      <source>
       IEEE Trans. Aerosp. Electron. Syst.
      </source>
      <year>
       2022
      </year>
      <volume>
       58
      </volume>
      <fpage>
       5292
      </fpage>
      <lpage>
       5306
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2022ITAES..58.5292Y
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1109/TAES.2022.3167624
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR6">
     <label>
      6.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Shen
        </surname>
        <given-names>
         L
        </given-names>
       </name>
       <name>
        <surname>
         Cheng
        </surname>
        <given-names>
         Q
        </given-names>
       </name>
       <name>
        <surname>
         Cheng
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Wei
        </surname>
        <given-names>
         L
        </given-names>
       </name>
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Hierarchical control of DC micro-grid for photovoltaic EV charging station based on flywheel and battery energy storage system
      </article-title>
      <source>
       Electr. Power Syst. Res.
      </source>
      <year>
       2020
      </year>
      <volume>
       179
      </volume>
      <fpage>
       106079
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.epsr.2019.106079
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR7">
     <label>
      7.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Deng
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Bae
        </surname>
        <given-names>
         C
        </given-names>
       </name>
       <name>
        <surname>
         Denlinger
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Miller
        </surname>
        <given-names>
         T
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Electric vehicles batteries: requirements and challenges
      </article-title>
      <source>
       Joule
      </source>
      <year>
       2020
      </year>
      <volume>
       4
      </volume>
      <fpage>
       511
      </fpage>
      <lpage>
       515
      </lpage>
      <pub-id pub-id-type="doi">
       10.1016/j.joule.2020.01.013
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR8">
     <label>
      8.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Liang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A review of rechargeable batteries for portable electronic devices
      </article-title>
      <source>
       InfoMat
      </source>
      <year>
       2019
      </year>
      <volume>
       1
      </volume>
      <fpage>
       6
      </fpage>
      <lpage>
       32
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXhsVKnsbnM
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/inf2.12000
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR9">
     <label>
      9.
     </label>
     <mixed-citation publication-type="other">
      Markets, R. Global and China Li-ion power battery industry report, 2019-2025. Research and Markets.
      <ext-link ext-link-type="uri" xlink:href="https://www.researchandmarkets.com/reports/5021667/globaland-china-li-ion-power-battery-industry">
       https://www.researchandmarkets.com/reports/5021667/globaland-china-li-ion-power-battery-industry
      </ext-link>
      (2020).
     </mixed-citation>
    </ref>
    <ref id="CR10">
     <label>
      10.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Miao
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Liu
        </surname>
        <given-names>
         L
        </given-names>
       </name>
       <name>
        <surname>
         Zhang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Tan
        </surname>
        <given-names>
         Q
        </given-names>
       </name>
       <name>
        <surname>
         Li
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       An overview of global power lithium-ion batteries and associated critical metal recycling
      </article-title>
      <source>
       J. Hazard. Mater.
      </source>
      <year>
       2022
      </year>
      <volume>
       425
      </volume>
      <fpage>
       127900
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXislSgsrbK
      </pub-id>
      <pub-id pub-id-type="pmid">
       34896721
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jhazmat.2021.127900
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR11">
     <label>
      11.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Li
        </surname>
        <given-names>
         Y-F
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Prognostics and health management of lithium-ion battery using deep learning methods: a review
      </article-title>
      <source>
       Renew. Sustain. Energy Rev.
      </source>
      <year>
       2022
      </year>
      <volume>
       161
      </volume>
      <fpage>
       112282
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XovF2rsL0%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.rser.2022.112282
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR12">
     <label>
      12.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Berecibar
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Critical review of state of health estimation methods of Li-ion batteries for real applications
      </article-title>
      <source>
       Renew. Sustain. Energy Rev.
      </source>
      <year>
       2016
      </year>
      <volume>
       56
      </volume>
      <fpage>
       572
      </fpage>
      <lpage>
       587
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2MXhvFGkt7rK
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.rser.2015.11.042
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR13">
     <label>
      13.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ng
        </surname>
        <given-names>
         M-F
        </given-names>
       </name>
       <name>
        <surname>
         Zhao
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Yan
        </surname>
        <given-names>
         Q
        </given-names>
       </name>
       <name>
        <surname>
         Conduit
        </surname>
        <given-names>
         GJ
        </given-names>
       </name>
       <name>
        <surname>
         Seh
        </surname>
        <given-names>
         ZW
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Predicting the state of charge and health of batteries using data-driven machine learning
      </article-title>
      <source>
       Nat. Mach. Intell.
      </source>
      <year>
       2020
      </year>
      <volume>
       2
      </volume>
      <fpage>
       161
      </fpage>
      <lpage>
       170
      </lpage>
      <pub-id pub-id-type="doi">
       10.1038/s42256-020-0156-7
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR14">
     <label>
      14.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Che
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Hu
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <name>
        <surname>
         Lin
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <name>
        <surname>
         Guo
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Teodorescu
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Health prognostics for lithium-ion batteries: mechanisms, methods, and prospects
      </article-title>
      <source>
       Energy Environ. Sci.
      </source>
      <year>
       2023
      </year>
      <volume>
       16
      </volume>
      <fpage>
       338
      </fpage>
      <lpage>
       371
      </lpage>
      <pub-id pub-id-type="doi">
       10.1039/D2EE03019E
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR15">
     <label>
      15.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A transferable lithium-ion battery remaining useful life prediction method from cycle-consistency of degradation trend
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2022
      </year>
      <volume>
       521
      </volume>
      <fpage>
       230975
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XlsFCltg%3D%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2022.230975
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR16">
     <label>
      16.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Baghdadi
        </surname>
        <given-names>
         I
        </given-names>
       </name>
       <name>
        <surname>
         Briat
        </surname>
        <given-names>
         O
        </given-names>
       </name>
       <name>
        <surname>
         Delétage
        </surname>
        <given-names>
         J-Y
        </given-names>
       </name>
       <name>
        <surname>
         Gyan
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <name>
        <surname>
         Vinassa
        </surname>
        <given-names>
         J-M
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Lithium battery aging model based on Dakin’s degradation approach
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2016
      </year>
      <volume>
       325
      </volume>
      <fpage>
       273
      </fpage>
      <lpage>
       285
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2016JPS...325..273B
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC28XhtVSktrrP
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2016.06.036
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR17">
     <label>
      17.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Xu
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Remaining useful life prediction of lithium-ion batteries based on wiener process under time-varying temperature condition
      </article-title>
      <source>
       Reliab. Eng. Syst. Saf.
      </source>
      <year>
       2021
      </year>
      <volume>
       214
      </volume>
      <fpage>
       107675
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.ress.2021.107675
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR18">
     <label>
      18.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Dong
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <name>
        <surname>
         Wei
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       A physics-based aging model for lithium-ion battery with coupled chemical/mechanical degradation mechanisms
      </article-title>
      <source>
       Electrochim. Acta
      </source>
      <year>
       2021
      </year>
      <volume>
       395
      </volume>
      <fpage>
       139133
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXitVClt7rE
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.electacta.2021.139133
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR19">
     <label>
      19.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lui
        </surname>
        <given-names>
         YH
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Physics-based prognostics of implantable-grade lithium-ion battery for remaining useful life prediction
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2021
      </year>
      <volume>
       485
      </volume>
      <fpage>
       229327
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXis1Wku7bN
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2020.229327
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR20">
     <label>
      20.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Attia
        </surname>
        <given-names>
         PM
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Closed-loop optimization of fast-charging protocols for batteries with machine learning
      </article-title>
      <source>
       Nature
      </source>
      <year>
       2020
      </year>
      <volume>
       578
      </volume>
      <fpage>
       397
      </fpage>
      <lpage>
       402
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2020Natur.578..397A
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXksFKmtLc%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       32076218
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41586-020-1994-5
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR21">
     <label>
      21.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Rauf
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Khalid
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Arshad
        </surname>
        <given-names>
         N
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Machine learning in state of health and remaining useful life estimation: theoretical and technological development in battery degradation modelling
      </article-title>
      <source>
       Renew. Sustain. Energy Rev.
      </source>
      <year>
       2022
      </year>
      <volume>
       156
      </volume>
      <fpage>
       111903
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.rser.2021.111903
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR22">
     <label>
      22.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Li
        </surname>
        <given-names>
         W
        </given-names>
       </name>
       <name>
        <surname>
         Zhang
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         van Vlijmen
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Dechent
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <name>
        <surname>
         Sauer
        </surname>
        <given-names>
         DU
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Forecasting battery capacity and power degradation with multi-task learning
      </article-title>
      <source>
       Energy Storage Mater.
      </source>
      <year>
       2022
      </year>
      <volume>
       53
      </volume>
      <fpage>
       453
      </fpage>
      <lpage>
       466
      </lpage>
      <pub-id pub-id-type="doi">
       10.1016/j.ensm.2022.09.013
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR23">
     <label>
      23.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Explainability-driven model improvement for SOH estimation of lithium-ion battery
      </article-title>
      <source>
       Reliab. Eng. Syst. Saf.
      </source>
      <year>
       2023
      </year>
      <volume>
       232
      </volume>
      <fpage>
       109046
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.ress.2022.109046
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR24">
     <label>
      24.
     </label>
     <mixed-citation publication-type="other">
      Berecibar, M. Machine-learning techniques used to accurately predict battery life.
      <italic>
       Nature
      </italic>
      <bold>
       568
      </bold>
      , 325-326 (2019).
     </mixed-citation>
    </ref>
    <ref id="CR25">
     <label>
      25.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Severson
        </surname>
        <given-names>
         KA
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Data-driven prediction of battery cycle life before capacity degradation
      </article-title>
      <source>
       Nat. Energy
      </source>
      <year>
       2019
      </year>
      <volume>
       4
      </volume>
      <fpage>
       383
      </fpage>
      <lpage>
       391
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019NatEn...4..383S
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41560-019-0356-8
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR26">
     <label>
      26.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Nuhic
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Terzimehic
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <name>
        <surname>
         Soczka-Guth
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <name>
        <surname>
         Buchholz
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Dietmayer
        </surname>
        <given-names>
         K
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Health diagnosis and remaining useful life prognostics of lithium-ion batteries using data-driven methods
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2013
      </year>
      <volume>
       239
      </volume>
      <fpage>
       680
      </fpage>
      <lpage>
       688
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3sXot1Wi
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2012.11.146
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR27">
     <label>
      27.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Richardson
        </surname>
        <given-names>
         RR
        </given-names>
       </name>
       <name>
        <surname>
         Osborne
        </surname>
        <given-names>
         MA
        </given-names>
       </name>
       <name>
        <surname>
         Howey
        </surname>
        <given-names>
         DA
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Gaussian process regression for forecasting battery state of health
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2017
      </year>
      <volume>
       357
      </volume>
      <fpage>
       209
      </fpage>
      <lpage>
       219
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2017JPS...357..209R
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2sXnsFSitLs%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2017.05.004
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR28">
     <label>
      28.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Luo
        </surname>
        <given-names>
         K
        </given-names>
       </name>
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <name>
        <surname>
         Zheng
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Shi
        </surname>
        <given-names>
         Z
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       A review of deep learning approach to predicting the state of health and state of charge of lithium-ion batteries
      </article-title>
      <source>
       J. Energy Chem.
      </source>
      <year>
       2022
      </year>
      <volume>
       74
      </volume>
      <fpage>
       159
      </fpage>
      <lpage>
       173
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XisFOisb7J
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jechem.2022.06.049
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR29">
     <label>
      29.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Feature disentanglement and tendency retainment with domain adaptation for lithium-ion battery capacity estimation
      </article-title>
      <source>
       Reliab. Eng. Syst. Saf.
      </source>
      <year>
       2023
      </year>
      <volume>
       230
      </volume>
      <fpage>
       108897
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.ress.2022.108897
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR30">
     <label>
      30.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Xia
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         K
        </given-names>
       </name>
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       State of health and remaining useful life prediction of lithium-ion batteries based on a disturbance-free incremental capacity and differential voltage analysis method
      </article-title>
      <source>
       J. Energy Storage
      </source>
      <year>
       2023
      </year>
      <volume>
       64
      </volume>
      <fpage>
       107161
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.est.2023.107161
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR31">
     <label>
      31.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       High-efficient prediction of state of health for lithium-ion battery based on AC impedance feature tuned with Gaussian process regression
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2023
      </year>
      <volume>
       561
      </volume>
      <fpage>
       232737
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXit1Kqt7w%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2023.232737
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR32">
     <label>
      32.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Fuller
        </surname>
        <given-names>
         TF
        </given-names>
       </name>
       <name>
        <surname>
         Doyle
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Newman
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Simulation and optimization of the dual lithium ion insertion cell
      </article-title>
      <source>
       J. Electrochem. Soc.
      </source>
      <year>
       1994
      </year>
      <volume>
       141
      </volume>
      <fpage>
       1
      </fpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       1994JElS..141....1F
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DyaK2cXhtFWltrg%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1149/1.2054684
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR33">
     <label>
      33.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Liu
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A generalizable, data-driven online approach to forecast capacity degradation trajectory of lithium batteries
      </article-title>
      <source>
       J. Energy Chem.
      </source>
      <year>
       2022
      </year>
      <volume>
       68
      </volume>
      <fpage>
       548
      </fpage>
      <lpage>
       555
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XisFOju7rP
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jechem.2021.12.004
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR34">
     <label>
      34.
     </label>
     <mixed-citation publication-type="other">
      Wang, F. et al. Remaining useful life prediction of lithium-ion battery based on cycle-consistency learning. in
      <italic>
       2021 International Conference on Sensing, Measurement &amp; Data Analytics in the era of Artificial Intelligence (ICSMD)
      </italic>
      1–6 (IEEE, 2021).
     </mixed-citation>
    </ref>
    <ref id="CR35">
     <label>
      35.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lin
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A data-driven approach for estimating state-of-health of lithium-ion batteries considering internal resistance
      </article-title>
      <source>
       Energy
      </source>
      <year>
       2023
      </year>
      <volume>
       277
      </volume>
      <fpage>
       127675
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXptlSit7c%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.energy.2023.127675
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR36">
     <label>
      36.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         Z
        </given-names>
       </name>
       <name>
        <surname>
         Liu
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Sun
        </surname>
        <given-names>
         H
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Physics-informed learning of governing equations from scarce data
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2021
      </year>
      <volume>
       12
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2021NatCo..12.6136C
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXit12gsb7K
      </pub-id>
      <pub-id pub-id-type="pmid">
       34675223
      </pub-id>
      <pub-id pub-id-type="pmcid">
       8531004
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-021-26434-1
      </pub-id>
      <elocation-id>
       6136
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR37">
     <label>
      37.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Karniadakis
        </surname>
        <given-names>
         GE
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Physics-informed machine learning
      </article-title>
      <source>
       Nat. Rev. Phys.
      </source>
      <year>
       2021
      </year>
      <volume>
       3
      </volume>
      <fpage>
       422
      </fpage>
      <lpage>
       440
      </lpage>
      <pub-id pub-id-type="doi">
       10.1038/s42254-021-00314-5
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR38">
     <label>
      38.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Aykol
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Perspective—Combining physics and machine learning to predict battery lifetime
      </article-title>
      <source>
       J. Electrochem. Soc.
      </source>
      <year>
       2021
      </year>
      <volume>
       168
      </volume>
      <fpage>
       030525
      </fpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2021JElS..168c0525A
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXptFaqtbs%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1149/1945-7111/abec55
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR39">
     <label>
      39.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Nascimento
        </surname>
        <given-names>
         RG
        </given-names>
       </name>
       <name>
        <surname>
         Viana
        </surname>
        <given-names>
         FA
        </given-names>
       </name>
       <name>
        <surname>
         Corbetta
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Kulkarni
        </surname>
        <given-names>
         CS
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       A framework for Li-ion battery prognosis based on hybrid Bayesian physics-informed neural networks
      </article-title>
      <source>
       Sci. Rep.
      </source>
      <year>
       2023
      </year>
      <volume>
       13
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2023NatSR..1313856N
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXhslOntrvK
      </pub-id>
      <pub-id pub-id-type="pmid">
       37620364
      </pub-id>
      <pub-id pub-id-type="pmcid">
       10449926
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41598-023-33018-0
      </pub-id>
      <elocation-id>
       13856
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR40">
     <label>
      40.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Thelen
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Integrating physics-based modeling and machine learning for degradation diagnostics of lithium-ion batteries
      </article-title>
      <source>
       Energy Storage Mater.
      </source>
      <year>
       2022
      </year>
      <volume>
       50
      </volume>
      <fpage>
       668
      </fpage>
      <lpage>
       695
      </lpage>
      <pub-id pub-id-type="doi">
       10.1016/j.ensm.2022.05.047
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR41">
     <label>
      41.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Shi
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Rivera
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Wu
        </surname>
        <given-names>
         D
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Battery health management using physics-informed machine learning: online degradation modeling and remaining useful life prediction
      </article-title>
      <source>
       Mech. Syst. Signal Process.
      </source>
      <year>
       2022
      </year>
      <volume>
       179
      </volume>
      <fpage>
       109347
      </fpage>
      <pub-id pub-id-type="doi">
       10.1016/j.ymssp.2022.109347
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR42">
     <label>
      42.
     </label>
     <mixed-citation publication-type="other">
      Wang, F. et al. Inherently interpretable physics-informed neural network for battery modeling and prognosis.
      <italic>
       IEEE Trans. Neural Netw. Learn. Syst.
      </italic>
      1–15
      <ext-link ext-link-type="doi" xlink:href="10.1109/TNNLS.2023.3329368">
       https://doi.org/10.1109/TNNLS.2023.3329368
      </ext-link>
      (2023).
     </mixed-citation>
    </ref>
    <ref id="CR43">
     <label>
      43.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Hofmann
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Physics-informed neural networks for state of health estimation in lithium-ion batteries
      </article-title>
      <source>
       J. Electrochem. Soc.
      </source>
      <year>
       2023
      </year>
      <volume>
       170
      </volume>
      <fpage>
       090524
      </fpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2023JElS..170i0524H
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1149/1945-7111/acf0ef
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR44">
     <label>
      44.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhu
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Data-driven capacity estimation of commercial lithium-ion batteries from voltage relaxation
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2022
      </year>
      <volume>
       13
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2022NatCo..13.2261Z
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XhtFGgtb%2FN
      </pub-id>
      <pub-id pub-id-type="pmid">
       35477711
      </pub-id>
      <pub-id pub-id-type="pmcid">
       9046220
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-022-29837-w
      </pub-id>
      <elocation-id>
       2261
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR45">
     <label>
      45.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ma
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Real-time personalized health status prediction of lithium-ion batteries using deep transfer learning
      </article-title>
      <source>
       Energy Environ. Sci.
      </source>
      <year>
       2022
      </year>
      <volume>
       15
      </volume>
      <fpage>
       4083
      </fpage>
      <lpage>
       4094
      </lpage>
      <pub-id pub-id-type="doi">
       10.1039/D2EE01676A
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR46">
     <label>
      46.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Jiang
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Bayesian learning for rapid prediction of lithium-ion battery-cycling protocols
      </article-title>
      <source>
       Joule
      </source>
      <year>
       2021
      </year>
      <volume>
       5
      </volume>
      <fpage>
       3187
      </fpage>
      <lpage>
       3203
      </lpage>
      <pub-id assigning-authority="American Mathematical Society" pub-id-type="other">
       4211601
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXis12hs7vN
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.joule.2021.10.010
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR47">
     <label>
      47.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Geslin
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Chueh, selecting the appropriate features in battery lifetime predictions
      </article-title>
      <source>
       Joule
      </source>
      <year>
       2023
      </year>
      <volume>
       7
      </volume>
      <fpage>
       1956
      </fpage>
      <lpage>
       1965
      </lpage>
      <pub-id pub-id-type="doi">
       10.1016/j.joule.2023.07.021
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR48">
     <label>
      48.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Spotnitz
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Simulation of capacity fade in lithium-ion batteries
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2003
      </year>
      <volume>
       113
      </volume>
      <fpage>
       72
      </fpage>
      <lpage>
       80
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2003JPS...113...72S
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD38XpsFSju7s%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/S0378-7753(02)00490-1
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR49">
     <label>
      49.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         He
        </surname>
        <given-names>
         W
        </given-names>
       </name>
       <name>
        <surname>
         Williard
        </surname>
        <given-names>
         N
        </given-names>
       </name>
       <name>
        <surname>
         Osterman
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Pecht
        </surname>
        <given-names>
         M
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Prognostics of lithium-ion batteries based on Dempster–Shafer theory and the Bayesian Monte Carlo method
      </article-title>
      <source>
       J. Power Sources
      </source>
      <year>
       2011
      </year>
      <volume>
       196
      </volume>
      <fpage>
       10314
      </fpage>
      <lpage>
       10321
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2011JPS...19610314H
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3MXht1CktbzJ
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jpowsour.2011.08.040
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR50">
     <label>
      50.
     </label>
     <mixed-citation publication-type="other">
      Chen, C. &amp; Pecht, M. Prognostics of lithium-ion batteries using model-based and data-driven methods. in
      <italic>
       Proceedings of the IEEE 2012 Prognostics and System Health Management Conference (PHM-2012 Beijing)
      </italic>
      , 1–6 (IEEE, 2012).
     </mixed-citation>
    </ref>
    <ref id="CR51">
     <label>
      51.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ramadesigan
        </surname>
        <given-names>
         V
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Parameter estimation and capacity fade analysis of lithium-ion batteries using reformulated models
      </article-title>
      <source>
       J. Electrochem. Soc.
      </source>
      <year>
       2011
      </year>
      <volume>
       158
      </volume>
      <fpage>
       A1048
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3MXpt1Onu7o%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1149/1.3609926
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR52">
     <label>
      52.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Najera-Flores
        </surname>
        <given-names>
         DA
        </given-names>
       </name>
       <name>
        <surname>
         Hu
        </surname>
        <given-names>
         Z
        </given-names>
       </name>
       <name>
        <surname>
         Chadha
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Todd
        </surname>
        <given-names>
         MD
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       A physics-constrained Bayesian neural network for battery remaining useful life prediction
      </article-title>
      <source>
       Appl. Math. Model.
      </source>
      <year>
       2023
      </year>
      <volume>
       122
      </volume>
      <fpage>
       42
      </fpage>
      <lpage>
       59
      </lpage>
      <pub-id assigning-authority="American Mathematical Society" pub-id-type="other">
       4597361
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.apm.2023.05.038
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR53">
     <label>
      53.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Xu
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Oudalov
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Ulbig
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Andersson
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <name>
        <surname>
         Kirschen
        </surname>
        <given-names>
         DS
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Modeling of lithium-ion battery degradation for cell life assessment
      </article-title>
      <source>
       IEEE Trans. Smart Grid
      </source>
      <year>
       2016
      </year>
      <volume>
       9
      </volume>
      <fpage>
       1131
      </fpage>
      <lpage>
       1140
      </lpage>
      <pub-id pub-id-type="doi">
       10.1109/TSG.2016.2578950
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR54">
     <label>
      54.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Raissi
        </surname>
        <given-names>
         M
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Deep hidden physics models: deep learning of nonlinear partial differential equations
      </article-title>
      <source>
       J. Mach. Learn. Res.
      </source>
      <year>
       2018
      </year>
      <volume>
       19
      </volume>
      <fpage>
       932
      </fpage>
      <lpage>
       955
      </lpage>
      <pub-id assigning-authority="American Mathematical Society" pub-id-type="other">
       3862432
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR55">
     <label>
      55.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Raissi
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Perdikaris
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <name>
        <surname>
         Karniadakis
        </surname>
        <given-names>
         GE
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Physics-informed neural networks: a deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations
      </article-title>
      <source>
       J. Comput. Phys.
      </source>
      <year>
       2019
      </year>
      <volume>
       378
      </volume>
      <fpage>
       686
      </fpage>
      <lpage>
       707
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019JCoPh.378..686R
      </pub-id>
      <pub-id assigning-authority="American Mathematical Society" pub-id-type="other">
       3881695
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jcp.2018.10.045
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR56">
     <label>
      56.
     </label>
     <mixed-citation publication-type="other">
      Wang, F. Project—Physics-informed neural network for lithium-ion battery degradation stable modeling and prognosis.
      <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.10963339">
       https://doi.org/10.5281/zenodo.10963339
      </ext-link>
      (2024).
     </mixed-citation>
    </ref>
    <ref id="CR57">
     <label>
      57.
     </label>
     <mixed-citation publication-type="other">
      Wang, F. wang-fujin/PINN4SOH: physics-informed neural network for lithium-ion battery degradation stable modeling and prognosis.
      <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.11046967">
       https://doi.org/10.5281/zenodo.11046967
      </ext-link>
      (2024).
     </mixed-citation>
    </ref>
   </ref-list>
  </ref-list>
  <app-group>
   <app id="App1" specific-use="web-only">
    <sec id="Sec14">
     <title>
      Supplementary information
     </title>
     <p id="Par46">
      <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_48779_MOESM1_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Supplementary Information
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_48779_MOESM2_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Peer Review File
         </p>
        </caption>
       </media>
      </supplementary-material>
     </p>
    </sec>
    <sec id="Sec15">
     <title>
      Source data
     </title>
     <p id="Par47">
      <supplementary-material content-type="local-data" id="MOESM3" xlink:title="Source data">
       <media mime-subtype="vnd.ms-excel" mimetype="application" xlink:href="MediaObjects/41467_2024_48779_MOESM3_ESM.xlsx">
        <caption xml:lang="en">
         <p>
          Source Data
         </p>
        </caption>
       </media>
      </supplementary-material>
     </p>
    </sec>
   </app>
  </app-group>
  <notes notes-type="ESMHint">
   <title>
    Supplementary information
   </title>
   <p>
    The online version contains supplementary material available at
    <ext-link ext-link-type="doi" xlink:href="10.1038/s41467-024-48779-z">
     https://doi.org/10.1038/s41467-024-48779-z
    </ext-link>
    .
   </p>
  </notes>
  <notes notes-type="Misc">
   <p>
    <bold>
     Publisher’s note
    </bold>
    Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
   </p>
  </notes>
 </back>
</article>
