<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/xsl' href='/w/ProjectMundo-Anon-106A/style/jats-html.xsl'?>
<!DOCTYPE response>
<article article-type="research-article" dtd-version="1.2" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
 <front>
  <journal-meta>
   <journal-id journal-id-type="publisher-id">
    41467
   </journal-id>
   <journal-id journal-id-type="doi">
    10.1038/41467.2041-1723
   </journal-id>
   <journal-title-group>
    <journal-title>
     Nature Communications
    </journal-title>
    <abbrev-journal-title abbrev-type="publisher">
     Nat Commun
    </abbrev-journal-title>
   </journal-title-group>
   <issn pub-type="epub">
    2041-1723
   </issn>
   <publisher>
    <publisher-name>
     Nature Publishing Group UK
    </publisher-name>
    <publisher-loc>
     London
    </publisher-loc>
   </publisher>
  </journal-meta>
  <article-meta>
   <article-id pub-id-type="publisher-id">
    s41467-024-46089-y
   </article-id>
   <article-id pub-id-type="manuscript">
    46089
   </article-id>
   <article-id pub-id-type="doi">
    10.1038/s41467-024-46089-y
   </article-id>
   <article-categories>
    <subj-group subj-group-type="heading">
     <subject>
      Article
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /631/114/1305
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /631/154/555
     </subject>
    </subj-group>
    <subj-group subj-group-type="TechniquePath">
     <subject>
      /38
     </subject>
    </subj-group>
    <subj-group subj-group-type="TechniquePath">
     <subject>
      /139
     </subject>
    </subj-group>
    <subj-group subj-group-type="TechniquePath">
     <subject>
      /119
     </subject>
    </subj-group>
    <subj-group subj-group-type="NatureArticleTypeID">
     <subject>
      article
     </subject>
    </subj-group>
   </article-categories>
   <title-group>
    <article-title xml:lang="en">
     Drug target prediction through deep learning functional representation of gene signatures
    </article-title>
   </title-group>
   <contrib-group>
    <contrib contrib-type="author" corresp="yes" id="Au1">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0002-3424-835X
     </contrib-id>
     <name name-style="western">
      <surname>
       Chen
      </surname>
      <given-names>
       Hao
      </given-names>
     </name>
     <address>
      <email>
       hchen4@andrew.cmu.edu
      </email>
     </address>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
     <xref ref-type="aff" rid="Aff3">
      3
     </xref>
     <xref ref-type="corresp" rid="IDs4146702446089y_cor1">
      a
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au2">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0001-5958-5451
     </contrib-id>
     <name name-style="western">
      <surname>
       King
      </surname>
      <given-names>
       Frederick J.
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au3">
     <name name-style="western">
      <surname>
       Zhou
      </surname>
      <given-names>
       Bin
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au4">
     <name name-style="western">
      <surname>
       Wang
      </surname>
      <given-names>
       Yu
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au5">
     <name name-style="western">
      <surname>
       Canedy
      </surname>
      <given-names>
       Carter J.
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au6">
     <name name-style="western">
      <surname>
       Hayashi
      </surname>
      <given-names>
       Joel
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au7">
     <name name-style="western">
      <surname>
       Zhong
      </surname>
      <given-names>
       Yang
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au8">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0002-4526-489X
     </contrib-id>
     <name name-style="western">
      <surname>
       Chang
      </surname>
      <given-names>
       Max W.
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff4">
      4
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au9">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0002-4193-1042
     </contrib-id>
     <name name-style="western">
      <surname>
       Pache
      </surname>
      <given-names>
       Lars
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff5">
      5
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au10">
     <name name-style="western">
      <surname>
       Wong
      </surname>
      <given-names>
       Julian L.
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au11">
     <name name-style="western">
      <surname>
       Jia
      </surname>
      <given-names>
       Yong
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au12">
     <name name-style="western">
      <surname>
       Joslin
      </surname>
      <given-names>
       John
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au13">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0003-3833-4498
     </contrib-id>
     <name name-style="western">
      <surname>
       Jiang
      </surname>
      <given-names>
       Tao
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au14">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0002-4618-0719
     </contrib-id>
     <name name-style="western">
      <surname>
       Benner
      </surname>
      <given-names>
       Christopher
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff4">
      4
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au15">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0001-9399-7927
     </contrib-id>
     <name name-style="western">
      <surname>
       Chanda
      </surname>
      <given-names>
       Sumit K.
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff6">
      6
     </xref>
    </contrib>
    <contrib contrib-type="author" corresp="yes" id="Au16">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0009-0005-7496-152X
     </contrib-id>
     <name name-style="western">
      <surname>
       Zhou
      </surname>
      <given-names>
       Yingyao
      </given-names>
     </name>
     <address>
      <email>
       yingyao.zhou@novartis.com
      </email>
     </address>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="corresp" rid="IDs4146702446089y_cor16">
      s
     </xref>
    </contrib>
    <aff id="Aff1">
     <label>
      1
     </label>
     <institution-wrap>
      <institution content-type="org-name">
       Novartis Biomedical Research
      </institution>
     </institution-wrap>
     <addr-line content-type="street">
      10675 John Jay Hopkins Drive
     </addr-line>
     <addr-line content-type="postcode">
      92121
     </addr-line>
     <addr-line content-type="city">
      San Diego
     </addr-line>
     <addr-line content-type="state">
      CA
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
    <aff id="Aff2">
     <label>
      2
     </label>
     <institution-wrap>
      <institution-id institution-id-type="GRID">
       grid.266097.c
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 2222 1582
      </institution-id>
      <institution content-type="org-division">
       Department of Computer Science and Engineering
      </institution>
      <institution content-type="org-name">
       University of California, Riverside
      </institution>
     </institution-wrap>
     <addr-line content-type="street">
      900 University Avenue
     </addr-line>
     <addr-line content-type="postcode">
      92521
     </addr-line>
     <addr-line content-type="city">
      Riverside
     </addr-line>
     <addr-line content-type="state">
      CA
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
    <aff id="Aff3">
     <label>
      3
     </label>
     <institution-wrap>
      <institution-id institution-id-type="ROR">
       https://ror.org/05x2bcf33
      </institution-id>
      <institution-id institution-id-type="GRID">
       grid.147455.6
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 2097 0344
      </institution-id>
      <institution content-type="org-division">
       Computational Biology Department, School of Computer Science
      </institution>
      <institution content-type="org-name">
       Carnegie Mellon University
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      15213
     </addr-line>
     <addr-line content-type="city">
      Pittsburgh
     </addr-line>
     <addr-line content-type="state">
      PA
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
    <aff id="Aff4">
     <label>
      4
     </label>
     <institution-wrap>
      <institution-id institution-id-type="GRID">
       grid.266100.3
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 2107 4242
      </institution-id>
      <institution content-type="org-division">
       Department of Medicine
      </institution>
      <institution content-type="org-name">
       University of California, San Diego
      </institution>
     </institution-wrap>
     <addr-line content-type="street">
      9500 Gilman Drive
     </addr-line>
     <addr-line content-type="postcode">
      92093
     </addr-line>
     <addr-line content-type="city">
      La Jolla
     </addr-line>
     <addr-line content-type="state">
      CA
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
    <aff id="Aff5">
     <label>
      5
     </label>
     <institution-wrap>
      <institution-id institution-id-type="ROR">
       https://ror.org/03m1g2s55
      </institution-id>
      <institution-id institution-id-type="GRID">
       grid.479509.6
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 0163 8573
      </institution-id>
      <institution content-type="org-division">
       NCI Designated Cancer Center
      </institution>
      <institution content-type="org-name">
       Sanford Burnham Prebys Medical Discovery Institute
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      92037
     </addr-line>
     <addr-line content-type="city">
      La Jolla
     </addr-line>
     <addr-line content-type="state">
      CA
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
    <aff id="Aff6">
     <label>
      6
     </label>
     <institution-wrap>
      <institution-id institution-id-type="GRID">
       grid.214007.0
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000000122199231
      </institution-id>
      <institution content-type="org-division">
       Department of Immunology and Microbiology
      </institution>
      <institution content-type="org-name">
       Scripps Research
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      92037
     </addr-line>
     <addr-line content-type="city">
      La Jolla
     </addr-line>
     <addr-line content-type="state">
      CA
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
   </contrib-group>
   <author-notes>
    <corresp id="IDs4146702446089y_cor1">
     <label>
      a
     </label>
     <email>
      hchen4@andrew.cmu.edu
     </email>
    </corresp>
    <corresp id="IDs4146702446089y_cor16">
     <label>
      s
     </label>
     <email>
      yingyao.zhou@novartis.com
     </email>
    </corresp>
   </author-notes>
   <pub-date date-type="pub" publication-format="electronic">
    <day>
     29
    </day>
    <month>
     2
    </month>
    <year>
     2024
    </year>
   </pub-date>
   <pub-date date-type="collection" publication-format="electronic">
    <month>
     12
    </month>
    <year>
     2024
    </year>
   </pub-date>
   <volume>
    15
   </volume>
   <issue seq="1853">
    1
   </issue>
   <elocation-id>
    1853
   </elocation-id>
   <history>
    <date date-type="registration">
     <day>
      14
     </day>
     <month>
      2
     </month>
     <year>
      2024
     </year>
    </date>
    <date date-type="received">
     <day>
      20
     </day>
     <month>
      9
     </month>
     <year>
      2023
     </year>
    </date>
    <date date-type="accepted">
     <day>
      14
     </day>
     <month>
      2
     </month>
     <year>
      2024
     </year>
    </date>
    <date date-type="online">
     <day>
      29
     </day>
     <month>
      2
     </month>
     <year>
      2024
     </year>
    </date>
   </history>
   <permissions>
    <copyright-statement content-type="compact">
     © The Author(s) 2024
    </copyright-statement>
    <copyright-year>
     2024
    </copyright-year>
    <copyright-holder>
     The Author(s)
    </copyright-holder>
    <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
     <license-p>
      <bold>
       Open Access
      </bold>
      This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit
      <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">
       http://creativecommons.org/licenses/by/4.0/
      </ext-link>
      .
     </license-p>
    </license>
   </permissions>
   <abstract id="Abs1" xml:lang="en">
    <title>
     Abstract
    </title>
    <p id="Par1">
     Many machine learning applications in bioinformatics currently rely on matching gene identities when analyzing input gene signatures and fail to take advantage of preexisting knowledge about gene functions. To further enable comparative analysis of OMICS datasets, including target deconvolution and mechanism of action studies, we develop an approach that represents gene signatures projected onto their biological functions, instead of their identities, similar to how the word2vec technique works in natural language processing. We develop the Functional Representation of Gene Signatures (FRoGS) approach by training a deep learning model and demonstrate that its application to the Broad Institute’s L1000 datasets results in more effective compound-target predictions than models based on gene identities alone. By integrating additional pharmacological activity data sources, FRoGS significantly increases the number of high-quality compound-target predictions relative to existing approaches, many of which are supported by in silico and/or experimental evidence. These results underscore the general utility of FRoGS in machine learning-based bioinformatics applications. Prediction networks pre-equipped with the knowledge of gene functions may help uncover new relationships among gene signatures acquired by large-scale OMICs studies on compounds, cell types, disease models, and patient cohorts.
    </p>
   </abstract>
   <abstract abstract-type="ShortSummary" id="Abs2" xml:lang="en">
    <p id="Par2">
     Large-scale OMICs investigations of biological systems can be used to predict functional relationships between compounds, genes and proteins. Here, the authors develop a deep learning-based approach that significantly increases the number of high-quality compound-target predictions relative to existing methods.
    </p>
   </abstract>
   <funding-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        U.S. Department of Health &amp; Human Services | NIH | National Institute of Allergy and Infectious Diseases (NIAID)
       </institution>
       <institution-id institution-id-type="doi" vocab="open-funder-registry">
        https://doi.org/10.13039/100000060
       </institution-id>
      </institution-wrap>
     </funding-source>
     <award-id award-type="FundRef grant">
      5U19AI135972
     </award-id>
     <award-id award-type="FundRef grant">
      75N93019C00046
     </award-id>
     <principal-award-recipient>
      <name name-style="western">
       <surname>
        Chanda
       </surname>
       <given-names>
        Sumit K.
       </given-names>
      </name>
     </principal-award-recipient>
     <principal-award-recipient>
      <name name-style="western">
       <surname>
        Chanda
       </surname>
       <given-names>
        Sumit K.
       </given-names>
      </name>
     </principal-award-recipient>
    </award-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        U.S. Department of Health &amp; Human Services | NIH | National Institute of Allergy and Infectious Diseases (NIAID)
       </institution>
      </institution-wrap>
     </funding-source>
    </award-group>
    <award-group>
     <funding-source>
      <institution-wrap>
       <institution>
        U.S. Department of Defense (United States Department of Defense)
       </institution>
       <institution-id institution-id-type="doi" vocab="open-funder-registry">
        https://doi.org/10.13039/100000005
       </institution-id>
      </institution-wrap>
     </funding-source>
     <award-id award-type="FundRef grant">
      W81XWH-20-1-0270
     </award-id>
     <principal-award-recipient>
      <name name-style="western">
       <surname>
        Chanda
       </surname>
       <given-names>
        Sumit K.
       </given-names>
      </name>
     </principal-award-recipient>
    </award-group>
   </funding-group>
   <custom-meta-group>
    <custom-meta>
     <meta-name>
      publisher-imprint-name
     </meta-name>
     <meta-value>
      Nature Portfolio
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      volume-issue-count
     </meta-name>
     <meta-value>
      1
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-article-count
     </meta-name>
     <meta-value>
      1853
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-pricelist-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-copyright-holder
     </meta-name>
     <meta-value>
      Springer Nature Limited
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-copyright-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-contains-esm
     </meta-name>
     <meta-value>
      Yes
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-numbering-style
     </meta-name>
     <meta-value>
      Unnumbered
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-month
     </meta-name>
     <meta-value>
      2
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-day
     </meta-name>
     <meta-value>
      14
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      volume-type
     </meta-name>
     <meta-value>
      Regular
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-product
     </meta-name>
     <meta-value>
      NonStandardArchiveJournal
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      numbering-style
     </meta-name>
     <meta-value>
      Unnumbered
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-grants-type
     </meta-name>
     <meta-value>
      OpenChoice
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      metadata-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      abstract-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bodypdf-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bodyhtml-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bibliography-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      esm-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      online-first
     </meta-name>
     <meta-value>
      false
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      pdf-file-reference
     </meta-name>
     <meta-value>
      BodyRef/PDF/41467_2024_Article_46089.pdf
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      pdf-type
     </meta-name>
     <meta-value>
      Typeset
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      target-type
     </meta-name>
     <meta-value>
      OnlinePDF
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-type
     </meta-name>
     <meta-value>
      Regular
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-type
     </meta-name>
     <meta-value>
      OriginalPaper
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-primary
     </meta-name>
     <meta-value>
      Science, Humanities and Social Sciences, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-secondary
     </meta-name>
     <meta-value>
      Science, Humanities and Social Sciences, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-secondary
     </meta-name>
     <meta-value>
      Science, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-collection
     </meta-name>
     <meta-value>
      Science (multidisciplinary)
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      open-access
     </meta-name>
     <meta-value>
      true
     </meta-value>
    </custom-meta>
   </custom-meta-group>
  </article-meta>
 </front>
 <body>
  <sec id="Sec1" sec-type="introduction">
   <title>
    Introduction
   </title>
   <p id="Par3">
    Large-scale OMICs investigations of biological systems can produce “gene signatures” represented as lists of gene candidates that are surmised to be relevant to the biological activity under interrogation. Similarity comparisons between gene signatures derived from related biological assays or technology platforms are used to predict functional relationships between compounds, genes, and proteins. For example, the Library of Integrated Network-Based Cellular Signatures (LINCS) L1000 program systematically generated 1.3 million gene expression profiles in human cell lines with ~22,000 genomic and 20,000 pharmacological perturbations
    <sup>
     <xref ref-type="bibr" rid="CR1">
      1
     </xref>
    </sup>
    . As compounds and short hairpin RNAs (shRNA)/complementary DNAs (cDNA) perturbing the same target are expected to generate correlated modulations in downstream gene expression, similar L1000 transcriptional signatures can offer an unbiased data-driven mechanism to identify compound-target pairs
    <sup>
     <xref ref-type="bibr" rid="CR2">
      2
     </xref>
     ,
     <xref ref-type="bibr" rid="CR3">
      3
     </xref>
     ,
     <xref ref-type="bibr" rid="CR4">
      4
     </xref>
     ,
     <xref ref-type="bibr" rid="CR5">
      5
     </xref>
     –
     <xref ref-type="bibr" rid="CR6">
      6
     </xref>
    </sup>
    .
   </p>
   <p id="Par4">
    The underlying molecular governance for a single gene signature can be extracted using well-established statistical frameworks known as pathway enrichment analyses, where the calculations are based on the number of gene members that overlap with known pathways curated by bioinformatics knowledgebases
    <sup>
     <xref ref-type="bibr" rid="CR7">
      7
     </xref>
     ,
     <xref ref-type="bibr" rid="CR8">
      8
     </xref>
    </sup>
    . Unfortunately, adopting similar statistical metrics to compare two experimentally derived gene signatures are ineffective in many cases: influenza host dependency factors identified by eight published studies only shared a modest overlap
    <sup>
     <xref ref-type="bibr" rid="CR9">
      9
     </xref>
    </sup>
    ; very few genetic interactions are replicated across multiple studies measuring synthetic lethality
    <sup>
     <xref ref-type="bibr" rid="CR10">
      10
     </xref>
    </sup>
    ; and cell type-specific gene signatures identified from two mouse embryonic single cell studies showed little overlap
    <sup>
     <xref ref-type="bibr" rid="CR11">
      11
     </xref>
    </sup>
    . According to studies comparing the performance of compound target predictions using multiple data types
    <sup>
     <xref ref-type="bibr" rid="CR12">
      12
     </xref>
     ,
     <xref ref-type="bibr" rid="CR13">
      13
     </xref>
     –
     <xref ref-type="bibr" rid="CR14">
      14
     </xref>
    </sup>
    , predictions based on transcriptional response alone tended to underperform when compared to models using structural or pharmacological features
    <sup>
     <xref ref-type="bibr" rid="CR12">
      12
     </xref>
    </sup>
    . This challenge occurred regardless of whether the L1000 landmark genes or their extrapolated whole-transcription counterparts are used. Therefore, understanding and addressing the limitations in existing gene signature comparison algorithms can enhance our understanding of how transcriptional data can be employed to predict the mechanism of action of small molecules. As target identification of these chemical leads in cell-based assays presents a major impediment to their progression in drug discovery, effective elucidation of their efficacy and potential side effects will accelerate the drug discovery and development process
    <sup>
     <xref ref-type="bibr" rid="CR15">
      15
     </xref>
    </sup>
    .
   </p>
   <p id="Par5">
    We hypothesized that the difficulty of comparing experimentally derived signatures originates from the fact that each signature consists of only a sparse sampling of the genes underlying regulated pathways. For example, if we randomly sample 10 genes from a hypothetical 100-gene pathway twice, the chance of having three or more common genes is only 6%, despite representing the same pathway. Such sparseness is intrinsic to all experimental signatures, as it can arise from the technical alterations of signal in RNA-seq studies
    <sup>
     <xref ref-type="bibr" rid="CR16">
      16
     </xref>
    </sup>
    , read dropouts with lower gene expression levels
    <sup>
     <xref ref-type="bibr" rid="CR17">
      17
     </xref>
    </sup>
    , the regulatory variations in transcriptional factor binding sites
    <sup>
     <xref ref-type="bibr" rid="CR18">
      18
     </xref>
    </sup>
    , the stochastic gene expression in single cell studies
    <sup>
     <xref ref-type="bibr" rid="CR19">
      19
     </xref>
    </sup>
    , or the rare variants in genome-wide association studies
    <sup>
     <xref ref-type="bibr" rid="CR20">
      20
     </xref>
    </sup>
    . In most popular gene-signature-similarity calculations, genes are treated as identifiers and their underlying functional roles are ignored. For example, the Connectivity Map (CMap) score used in the LINCS workflow evaluates similarities based on the weighted Kolmogorov-Smirnov enrichment statistic
    <sup>
     <xref ref-type="bibr" rid="CR21">
      21
     </xref>
    </sup>
    . Likewise, BANDIT
    <sup>
     <xref ref-type="bibr" rid="CR12">
      12
     </xref>
    </sup>
    uses the Pearson correlation to measure the degree of similarity for two gene signatures. These methods, along with other recent machine-learning-based models
    <sup>
     <xref ref-type="bibr" rid="CR5">
      5
     </xref>
     ,
     <xref ref-type="bibr" rid="CR21">
      21
     </xref>
    </sup>
    , compute gene signature similarities purely by matching gene identities (Fig.
    <xref ref-type="fig" rid="Fig1">
     1a
    </xref>
    ), e.g.,
    <italic>
     TLR7
    </italic>
    and
    <italic>
     MYD88
    </italic>
    are treated independently even though they play remarkably similar biological roles in innate immune signaling.
    <fig id="Fig1" position="float">
     <label>
      Fig. 1
     </label>
     <caption xml:lang="en">
      <title>
       FRoGS can extract weak pathway signals.
      </title>
      <p>
       <bold>
        a
       </bold>
       Comparison between two hypothetical gene signatures. Only gene A and B in Pathway
       <italic>
        W
       </italic>
       are considered overlapped based on gene identity (top), similar to the use of one-hot encoding in NLP. Genes A-F contribute to signature overlap if all genes of the same functions
       <italic>
        W
       </italic>
       are considered (bottom), similar to the use of word2vec.
       <bold>
        b
       </bold>
       <italic>
        t
       </italic>
       -SNE projection of gene embedding vectors, where each marker represents a gene. Markers are colored by their top-level functions annotated in GO.
       <bold>
        c
       </bold>
       Each of the 460 Reactome
       <sup>
        <xref ref-type="bibr" rid="CR41">
         41
        </xref>
       </sup>
       pathways was used to simulate foreground gene signatures generated under varying signal levels with
       <italic>
        λ
       </italic>
       at 5, 10, 15, and 20. The separation between foreground-foreground and foreground-background pairs is defined as -log
       <sub>
        10
       </sub>
       (
       <italic>
        p
       </italic>
       ) based on the one-sided Wilcoxon signed-rank test (
       <italic>
        n
       </italic>
       = 200 simulations). The larger the value, the more sensitive the method can separate the two types of signature pairs. Each pathway contributes to one data point in each box plot. Box-and-whisker plots show the median (center line), 25th, and 75th percentile (lower and upper boundary), with 1.5 × inter-quartile range indicated by whiskers and outliers shown as individual data points. Source data are provided as a Source Data file.
      </p>
     </caption>
     <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-46089-y/41467_2024_46089_Fig1_HTML.png"/>
    </fig>
   </p>
   <p id="Par6">
    The weakness in extracting functional relationships from gene signatures by gene identity counting has a strong analogy in the natural language processing (NLP) field. Early NLP analyses used one-hot encoding of words: each word was encoded by its identity and two words such as “cat” and “kitty” were considered as equally distant as “cat” and “rock” (Fig.
    <xref ref-type="fig" rid="Fig1">
     1a
    </xref>
    ). This limitation has been addressed by exciting breakthroughs in various NLP machine-learning applications following the introduction of word-embedding technologies, such as word2vec
    <sup>
     <xref ref-type="bibr" rid="CR22">
      22
     </xref>
    </sup>
    . The semantic meanings of words can now be accounted for in word vectors leading to “cat” and “kitty” being correctly recognized as synonyms.
   </p>
   <p id="Par7">
    Inspired by how NLP captures word semantics, we hypothesized that capturing functional instead of identity overlap between two gene signatures could overcome the sparseness limitation of identity overlap and lead to greater sensitivity in extracting common pathways induced by co-targeting compound-shRNA/cDNA pairs (Fig.
    <xref ref-type="fig" rid="Fig1">
     1a
    </xref>
    ). Although methods were previously proposed for the representation learning of individual genes
    <sup>
     <xref ref-type="bibr" rid="CR23">
      23
     </xref>
     ,
     <xref ref-type="bibr" rid="CR24">
      24
     </xref>
     ,
     <xref ref-type="bibr" rid="CR25">
      25
     </xref>
     ,
     <xref ref-type="bibr" rid="CR26">
      26
     </xref>
     ,
     <xref ref-type="bibr" rid="CR27">
      27
     </xref>
     –
     <xref ref-type="bibr" rid="CR28">
      28
     </xref>
    </sup>
    and some of them were applied to drug target predictions
    <sup>
     <xref ref-type="bibr" rid="CR3">
      3
     </xref>
     ,
     <xref ref-type="bibr" rid="CR26">
      26
     </xref>
     ,
     <xref ref-type="bibr" rid="CR29">
      29
     </xref>
     ,
     <xref ref-type="bibr" rid="CR30">
      30
     </xref>
    </sup>
    , they either do not directly encode genes’ functions or do not embed signatures involving multiple functionally related genes. A critical advance of this study is to introduce a form of “word2vec” for bioinformatics named Functional Representation of Gene Signature (FRoGS), where FRoGS vectors encode known human genes’ functions based on hypergraphs formed by Gene Ontology (GO)
    <sup>
     <xref ref-type="bibr" rid="CR31">
      31
     </xref>
    </sup>
    , as well as their empirical functions proxied by experimental expression profiles from ARCHS4
    <sup>
     <xref ref-type="bibr" rid="CR32">
      32
     </xref>
    </sup>
    . The machine-learning utility of FRoGS is demonstrated in the L1000-based compound target prediction application introduced above. Different from previous protein-network-based methods
    <sup>
     <xref ref-type="bibr" rid="CR4">
      4
     </xref>
     ,
     <xref ref-type="bibr" rid="CR33">
      33
     </xref>
    </sup>
    , we used a neural network that takes the FRoGS vector representations as input to directly compute the similarity between the signatures of compound perturbation and target gene modulation. Compared to multiple L1000-based transcriptional models, our FRoGS-based model significantly outperformed identity-based methods and methods based on other gene-embedding schemes. When existing models based on other data sources were augmented with our model, consistent performance boosts were observed, suggesting the broad utility of FRoGS to enhance comparative analysis of gene-signatures in large-scale datasets
    <sup>
     <xref ref-type="bibr" rid="CR34">
      34
     </xref>
     ,
     <xref ref-type="bibr" rid="CR35">
      35
     </xref>
     ,
     <xref ref-type="bibr" rid="CR36">
      36
     </xref>
     ,
     <xref ref-type="bibr" rid="CR37">
      37
     </xref>
     –
     <xref ref-type="bibr" rid="CR38">
      38
     </xref>
    </sup>
    .
   </p>
   <p id="Par8">
    In this study, we present the FRoGS vector, which is a functional embedding of human genes. We showcase its potential with an example machine learning application, where FRoGS substantially improves the success rate of discovering compound targets.
   </p>
  </sec>
  <sec id="Sec2" sec-type="results">
   <title>
    Results
   </title>
   <sec id="Sec3">
    <title>
     FRoGS extracts weak pathway signals from gene signatures
    </title>
    <p id="Par9">
     FRoGS vectors were trained such that individual human genes are mapped into high dimensional coordinates encoding their functions. Our deep learning model aimed to assign coordinates so that neighboring genes tend to share similar GO annotations as well as correlated experimental expression profiles as defined in ARCHS4
     <sup>
      <xref ref-type="bibr" rid="CR32">
       32
      </xref>
     </sup>
     . During gene set analysis, vectors associated with individual gene members are then aggregated into a single vector encoding the whole gene set signature (see Methods).
    </p>
    <p id="Par10">
     For the purpose of visually confirming the validity of the FRoGS vectors, we used a 2-dimensional t-SNE projection
     <sup>
      <xref ref-type="bibr" rid="CR39">
       39
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig1">
      1b
     </xref>
     ) to confirm whether individual genes were grouped based on their functions in the embedding space, in a manner similar to how synonyms are co-located in the word2vec embedding. Genes closely positioned in the same clusters tend to share the same biological function (i.e., node color in Fig.
     <xref ref-type="fig" rid="Fig1">
      1b
     </xref>
     ) with
     <italic>
      p
     </italic>
     &lt; 10
     <sup>
      −100
     </sup>
     , indicating that similarities among FRoGS embeddings indeed proximate their functional closeness. To further validate our hypothesis that functional gene-set embedding could boost sensitivity in detecting shared functionality between two perturbation signatures, we simulated experimentally derived signature pairs. Specifically, we randomly generated two foreground gene sets and a background gene set, each with 100 genes, for a given pathway
     <inline-formula id="IEq1">
      <alternatives>
       <math id="IEq1_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         W
        </mi>
       </math>
       <tex-math id="IEq1_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq1.gif"/>
      </alternatives>
     </inline-formula>
     . The foreground gene sets simulated experimentally derived gene signatures from two perturbations co-targeting
     <inline-formula id="IEq2">
      <alternatives>
       <math id="IEq2_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         W
        </mi>
       </math>
       <tex-math id="IEq2_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq2.gif"/>
      </alternatives>
     </inline-formula>
     . Both were seeded with
     <inline-formula id="IEq3">
      <alternatives>
       <math id="IEq3_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq3_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq3.gif"/>
      </alternatives>
     </inline-formula>
     random genes within
     <inline-formula id="IEq4">
      <alternatives>
       <math id="IEq4_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         W
        </mi>
       </math>
       <tex-math id="IEq4_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq4.gif"/>
      </alternatives>
     </inline-formula>
     and 100 -
     <inline-formula id="IEq5">
      <alternatives>
       <math id="IEq5_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq5_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq5.gif"/>
      </alternatives>
     </inline-formula>
     random genes outside
     <inline-formula id="IEq6">
      <alternatives>
       <math id="IEq6_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         W
        </mi>
       </math>
       <tex-math id="IEq6_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq6.gif"/>
      </alternatives>
     </inline-formula>
     , while the background gene set contains no gene in
     <inline-formula id="IEq7">
      <alternatives>
       <math id="IEq7_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         W
        </mi>
       </math>
       <tex-math id="IEq7_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq7.gif"/>
      </alternatives>
     </inline-formula>
     . More sensitive methods were expected to find the proper foreground gene signature pair (
     <inline-formula id="IEq8">
      <alternatives>
       <math id="IEq8_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq8_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq8.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq9">
      <alternatives>
       <math id="IEq9_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq9_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq9.gif"/>
      </alternatives>
     </inline-formula>
     ) to be more similar than the foreground-background pair (
     <inline-formula id="IEq10">
      <alternatives>
       <math id="IEq10_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq10_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq10.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq11">
      <alternatives>
       <math id="IEq11_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq11_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{bg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq11.gif"/>
      </alternatives>
     </inline-formula>
     ). Parameter
     <inline-formula id="IEq12">
      <alternatives>
       <math id="IEq12_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq12_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq12.gif"/>
      </alternatives>
     </inline-formula>
     , the number of pathway genes, modulates the strength of the pathway signals in foreground gene sets (see Methods).
    </p>
    <p id="Par11">
     We compared the performance of multiple state-of-the-art gene and GO embedding methods, including OPA2Vec
     <sup>
      <xref ref-type="bibr" rid="CR24">
       24
      </xref>
     </sup>
     , Gene2vec
     <sup>
      <xref ref-type="bibr" rid="CR23">
       23
      </xref>
     </sup>
     , clusDCA
     <sup>
      <xref ref-type="bibr" rid="CR25">
       25
      </xref>
     </sup>
     , and Fisher’s exact test (Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     ). Comparison with Fisher’s exact test was particularly informative, as it represents the popular gene identity-based similarity measurement that is currently adopted by most bioinformatics algorithms, and is conceptually similar to the principles underlying the CMap score
     <sup>
      <xref ref-type="bibr" rid="CR1">
       1
      </xref>
      ,
      <xref ref-type="bibr" rid="CR40">
       40
      </xref>
     </sup>
     . The above-described sampling process was repeated 200 times and the resulting similarity score distributions were compared using one-sided Wilcoxon signed-rank test to characterize if the (
     <inline-formula id="IEq13">
      <alternatives>
       <math id="IEq13_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq13_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq13.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq14">
      <alternatives>
       <math id="IEq14_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq14_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq14.gif"/>
      </alternatives>
     </inline-formula>
     ) similarity scores were larger than the (
     <inline-formula id="IEq15">
      <alternatives>
       <math id="IEq15_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq15_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq15.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq16">
      <alternatives>
       <math id="IEq16_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq16_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{bg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq16.gif"/>
      </alternatives>
     </inline-formula>
     ) similarity scores, where higher -log(
     <italic>
      p
     </italic>
     ) values are more desirable. We considered all 460 human pathways with numbers of associated genes in the range of 50–200 as captured in the Reactome database
     <sup>
      <xref ref-type="bibr" rid="CR41">
       41
      </xref>
     </sup>
     and summarized the results in Fig.
     <xref ref-type="fig" rid="Fig1">
      1c
     </xref>
     . We observed most embedding methods outperformed Fisher’s exact test when challenged with weak signals (
     <inline-formula id="IEq17">
      <alternatives>
       <math id="IEq17_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq17_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq17.gif"/>
      </alternatives>
     </inline-formula>
     = 5) (Fig.
     <xref ref-type="fig" rid="Fig1">
      1c
     </xref>
     ), while Fisher’s exact test performed well only under strong signals (
     <inline-formula id="IEq18">
      <alternatives>
       <math id="IEq18_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq18_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq18.gif"/>
      </alternatives>
     </inline-formula>
     ≥ 15). FRoGS remained superior across the whole range of
     <inline-formula id="IEq19">
      <alternatives>
       <math id="IEq19_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq19_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq19.gif"/>
      </alternatives>
     </inline-formula>
     values. More detailed analyses using pathway R-HSA-5576891 (cardiac conduction) as an example are provided in Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      1a
     </xref>
     , further supporting the conclusion presented in Fig.
     <xref ref-type="fig" rid="Fig1">
      1c
     </xref>
     , even as the size of gene lists vary (Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      1b–c
     </xref>
     ). These observations not only explain the difficulty encountered by current gene identity-based algorithms in extracting weak molecular signals, but also demonstrate that FRoGS provided a more sensitive approach to gene signature overlap analysis, providing the foundation for its application in bioinformatics gene signature comparisons.
    </p>
   </sec>
   <sec id="Sec4">
    <title>
     FRoGS recalls more known compound targets
    </title>
    <p id="Par12">
     With each compound and genomic perturbation represented by an aggregated FRoGS signature vector corresponding to their extrapolated whole-transcriptome L1000 profiles
     <sup>
      <xref ref-type="bibr" rid="CR1">
       1
      </xref>
     </sup>
     (see Methods), we trained a Siamese neural network model that applies the same network to a pair of signature vector inputs representing the transcriptional landscape after compound perturbation or shRNA/cDNA modulation (knockdown or overexpression of a target gene, respectively) (Fig.
     <xref ref-type="fig" rid="Fig2">
      2a
     </xref>
     ). Each compound signature
     <inline-formula id="IEq20">
      <alternatives>
       <math id="IEq20_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq20_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq20.gif"/>
      </alternatives>
     </inline-formula>
     was paired with every genomic signature
     <inline-formula id="IEq21">
      <alternatives>
       <math id="IEq21_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq21_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq21.gif"/>
      </alternatives>
     </inline-formula>
     acquired within the same cell line to predict the probability of a (
     <inline-formula id="IEq22">
      <alternatives>
       <math id="IEq22_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq22_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq22.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq23">
      <alternatives>
       <math id="IEq23_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq23_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq23.gif"/>
      </alternatives>
     </inline-formula>
     ) pair sharing the same target within the given biological context. Our positive training dataset consisted of 2340 (
     <inline-formula id="IEq24">
      <alternatives>
       <math id="IEq24_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq24_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq24.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq25">
      <alternatives>
       <math id="IEq25_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq25_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq25.gif"/>
      </alternatives>
     </inline-formula>
     ) pairs formed between 1438 compounds and 499 targets annotated in the L1000 database
     <sup>
      <xref ref-type="bibr" rid="CR42">
       42
      </xref>
     </sup>
     ; compounds with more than five targets were excluded from the training to reduce the impact of polypharmacology. Importantly, we adopted a balanced data sampling strategy for model training, in which each target occurred in equal frequency in both positive and negative training pairs, to avoid bias towards popular known targets (Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      2
     </xref>
     and Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      2
     </xref>
     ).
     <fig id="Fig2" position="float">
      <label>
       Fig. 2
      </label>
      <caption xml:lang="en">
       <title>
        FRoGS model predicts compound-target associations.
       </title>
       <p>
        <bold>
         a
        </bold>
        The neural network architecture predicting the probability of a compound binding to a target based on their L1000 gene set signature embeddings.
        <bold>
         b
        </bold>
        The comparison of multiple L1000-based prediction models. The FRoGS model performed the best and CMap score, OPA2Vec GO performed similarly to random models. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-46089-y/41467_2024_46089_Fig2_HTML.png"/>
     </fig>
    </p>
    <p id="Par13">
     The multiple predictions obtained for the same (
     <inline-formula id="IEq26">
      <alternatives>
       <math id="IEq26_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq26_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq26.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq27">
      <alternatives>
       <math id="IEq27_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq27_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq27.gif"/>
      </alternatives>
     </inline-formula>
     ) pair across different cell lines and perturbagen types were further aggregated into a consensus target ranking, and then mapped into a probability score using an adjusted logistic regression (LR) model (see Methods), which is referred to as Model
     <italic>
      L
     </italic>
     hereafter, where
     <italic>
      L
     </italic>
     stands for L1000. A well-adopted convention for comparing transcriptional models is to calculate the recall
     <sup>
      <xref ref-type="bibr" rid="CR3">
       3
      </xref>
      ,
      <xref ref-type="bibr" rid="CR5">
       5
      </xref>
     </sup>
     , i.e., the percentage of compounds having their Broad-annotated known targets
     <sup>
      <xref ref-type="bibr" rid="CR42">
       42
      </xref>
     </sup>
     predicted among the top
     <italic>
      N
     </italic>
     % of the candidate list, with
     <italic>
      N
     </italic>
     set to 5 here (see Methods). For comparison, we trained the same Siamese networks using gene signatures represented by other state-of-the-art gene and GO embeddings as input. The recall-rank plot in Fig.
     <xref ref-type="fig" rid="Fig2">
      2b
     </xref>
     demonstrated a significant performance boost in our FRoGS-based model compared to other approaches. With the baseline recall value estimated to be 8.0 ± 2.7% based on 100 random permutations, CMap
     <sup>
      <xref ref-type="bibr" rid="CR1">
       1
      </xref>
      ,
      <xref ref-type="bibr" rid="CR40">
       40
      </xref>
     </sup>
     and OPA2Vec GO
     <sup>
      <xref ref-type="bibr" rid="CR24">
       24
      </xref>
     </sup>
     methods performed similarly to random models with recalls at 9.6% and 9.5%, respectively. Fisher’s exact test, another identify-based model, performed poorly at 12.3%. The other three methods, OPA2Vec gene
     <sup>
      <xref ref-type="bibr" rid="CR24">
       24
      </xref>
     </sup>
     , Gene2Vec
     <sup>
      <xref ref-type="bibr" rid="CR23">
       23
      </xref>
     </sup>
     , and clusDCA
     <sup>
      <xref ref-type="bibr" rid="CR25">
       25
      </xref>
     </sup>
     , obtained recalls of 15.9%, 20.7%, and 24.9%, respectively. Our FRoGS embedding-empowered prediction model achieved a recall of 36.3%, marking a significant advancement in the application of L1000-based gene signatures for compound target prediction. We also compared our FRoGS model with additional state-of-the-art L1000-based compound target prediction models
     <sup>
      <xref ref-type="bibr" rid="CR3">
       3
      </xref>
      ,
      <xref ref-type="bibr" rid="CR4">
       4
      </xref>
      –
      <xref ref-type="bibr" rid="CR5">
       5
      </xref>
     </sup>
     and demonstrated our model could achieve higher top-30 and top-100 accuracy scores
     <sup>
      <xref ref-type="bibr" rid="CR4">
       4
      </xref>
     </sup>
     (Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      3
     </xref>
     , Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      2
     </xref>
     ).
    </p>
   </sec>
   <sec id="Sec5">
    <title>
     FRoGS predicts compound targets supported by structure and activity data sources
    </title>
    <p id="Par14">
     The application of Model
     <italic>
      L
     </italic>
     to all compound-gene pairs, captured in the full L1000 dataset regardless of whether target annotations were available, resulted in the prediction of 780,438 compound-target pairs with probability values above 0.8. The predictions on the training dataset were carried out by fivefold cross validation without data leak. Predicted compound-target pairs found in the Broad annotation were flagged as “known”
     <sup>
      <xref ref-type="bibr" rid="CR42">
       42
      </xref>
     </sup>
     . We inspected relevant Novartis historical pIC
     <sub>
      50
     </sub>
     data for experimental support of a target prediction; those pairs with pIC
     <sub>
      50
     </sub>
     (measure of compound potency) ≤ 1 µM against the relevant target in enzymatic or cellular assays are flagged as “pIC
     <sub>
      50
     </sub>
     ”. Queried compounds with a structure–activity relationship (SAR) probability above 0.95 to a reference compound of the same predicted target are flagged as “structure sure”, and those with SAR probability between 0.8 and 0.95 are flagged as “structure likely” (Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      3
     </xref>
     ).
    </p>
    <p id="Par15">
     A compound’s pharmacological activities are useful for target prediction in the knowledge-based framework
     <sup>
      <xref ref-type="bibr" rid="CR13">
       13
      </xref>
     </sup>
     . They rely on the guilt-by-association (GBA) principle that compound pairs sharing similar activity patterns across a large assay panel tend to interact with the same targets or perturb the same underlying pathway
     <sup>
      <xref ref-type="bibr" rid="CR43">
       43
      </xref>
     </sup>
     . We therefore trained several activity-based models using compound activities for validation purposes in biological assays, including a profile-quantitative structure-activity relationship (pQSAR) dataset
     <sup>
      <xref ref-type="bibr" rid="CR44">
       44
      </xref>
     </sup>
     , Promotor Signature Profiling (PSP) dataset
     <sup>
      <xref ref-type="bibr" rid="CR45">
       45
      </xref>
     </sup>
     , and NCI
     <sub>
      60
     </sub>
     growth inhibition dataset
     <sup>
      <xref ref-type="bibr" rid="CR46">
       46
      </xref>
     </sup>
     , covering 1601, 93, and 321 Broad compounds, respectively (see Methods, Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      4
     </xref>
     ).
    </p>
    <p id="Par16">
     Due to their orthogonal nature (Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      5
     </xref>
     , Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      4
     </xref>
     ), predictions from structural and activity models can serve as in silico validations for Model
     <italic>
      L
     </italic>
     predictions. Predictions flagged as “known”, “pIC
     <sub>
      50
     </sub>
     ”, or “structure sure” were considered as “super-confident” predictions that were either validated or expected to be validated. Predictions labeled “structure likely” were the “high-confident” SAR extrapolations of existing target annotations. Candidates predictable by one of the activity models were considered “medium-confident”. In total, 2491 predictions fall into the three categories assigned based on their best supporting evidence (Fig.
     <xref ref-type="fig" rid="Fig3">
      3a
     </xref>
     ). Below we enumerate a few “known” cases that otherwise would have been placed into different categories, as they provide an initial validation of successful target deconvolution for orphan compounds solely based on transcriptional signatures.
     <fig id="Fig3" position="float">
      <label>
       Fig. 3
      </label>
      <caption xml:lang="en">
       <title>
        Model
        <italic>
         L
        </italic>
        predictions are supported by multiple orthogonal data sources.
       </title>
       <p>
        <bold>
         a
        </bold>
        Validation categories for 2491 Model
        <italic>
         L
        </italic>
        predictions.
        <bold>
         b
        </bold>
        A “structure-likely” example for nitrendipine targeting CHRM3 is supported by its structural similarity to the reference analog nicardipine.
        <bold>
         c
        </bold>
        –
        <bold>
         d
        </bold>
        Perphenazine targeting DRD1 and mephentermine targeting HRH1 are strongly supported by the pQSAR dataset.
        <bold>
         e
        </bold>
        Trametinib targeting MEK1/2 is supported by the NCI
        <sub>
         60
        </sub>
        dataset.
        <bold>
         f
        </bold>
        Bortezomib targeting BSMP1 is supported by the PSP dataset. Both axes in (
        <bold>
         b
        </bold>
        –
        <bold>
         e
        </bold>
        ) are normalized Z-score assay activities and in (
        <bold>
         f
        </bold>
        ) are GI
        <sub>
         50
        </sub>
        scores. Error bands in (
        <bold>
         b
        </bold>
        –
        <bold>
         e
        </bold>
        ) represent the 95% confidence interval of the regression fit. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-46089-y/41467_2024_46089_Fig3_HTML.png"/>
     </fig>
    </p>
    <p id="Par17">
     17 (0.7%) predictions are “structure sure”. Examples include afimoxifene (BRD-K93754473), which was correctly predicted to target estrogen receptor 1 (ESR1) (score 0.91) and confirmed by its structural similarity with tamoxifen (BRD-K04210847) (SAR probability 0.97). Next, 88 predictions (3.5%) are considered “structure likely”. For example, nitrendipine (BRD-A02006392) was predicted to block cholinergic receptor muscarinic 3 (CHRM3) (score 0.95), where its SAR probability against the reference compound, nicardipine (Fig.
     <xref ref-type="fig" rid="Fig3">
      3b
     </xref>
     ), was 0.85. A total of 383 predictions (15%) with SAR probability above 0.8 endorse the assumption that Model
     <italic>
      L
     </italic>
     can recover true compound-target associations as judged by SAR. The other 85% of the predictions cannot be inferred by SAR but are supported by other lines of evidence, which suggests the unique advantage of FRoGS-based transcriptional models in recalling novel targets without relying on chemical structure features.
    </p>
    <p id="Par18">
     For “medium-confident” predictions, 1756 (70%) were supported by the pQSAR activity matrix spanning 1003 unique gene targets. The prediction that perphenazine (BRD-K10995081) targets the dopamine receptor D1 (DRD1) (score 0.88, Fig.
     <xref ref-type="fig" rid="Fig3">
      3c
     </xref>
     ) was supported by the high pQSAR model score (0.94) shared between perphenazine as the query and prochlorperazine (BRD-K19352500) as the reference. Similar high confidence values were obtained for mephentermine (BRD-K18194590) targeting histamine receptor H1(HRH1), supported by pQSAR (0.94) with respect to the reference compound pseudoephedrine (BRD-K91315211) (Fig.
     <xref ref-type="fig" rid="Fig3">
      3d
     </xref>
     ). These functional similarities align with mephentermine’s ability to indirectly induce noreprinehrine
     <sup>
      <xref ref-type="bibr" rid="CR47">
       47
      </xref>
      ,
      <xref ref-type="bibr" rid="CR48">
       48
      </xref>
     </sup>
     . Similarly, 23 (0.9%) predictions are supported in the public NCI
     <sub>
      60
     </sub>
     dataset
     <sup>
      <xref ref-type="bibr" rid="CR46">
       46
      </xref>
     </sup>
     . Examples include trametinib (BRD-K12343256), which was predicted to be a MEK1/2 allosteric inhibitor (score &gt; 0.82), as it demonstrated similar biological activity profiles in reported NCI
     <sub>
      60
     </sub>
     dataset (
     <italic>
      r
     </italic>
     <sup>
      2
     </sup>
     = 0.78) against selumetinib (BRD-K57080016) despite their low structural similarity (0.13) (Fig.
     <xref ref-type="fig" rid="Fig3">
      3e
     </xref>
     ). Both molecules interact with the same allosteric pocket on MEK1/2 but contact different amino acid residues
     <sup>
      <xref ref-type="bibr" rid="CR49">
       49
      </xref>
     </sup>
     . Lastly 8 (0.3%) predictions are supported in the PSP database
     <sup>
      <xref ref-type="bibr" rid="CR40">
       40
      </xref>
     </sup>
     across a panel of 41 reporter gene assays. An example is bortezomib (BRD-K88510285) as the query and MG132 (BRD-K60230970) as the reference. These molecules share low structural similarity (0.6), yet the PSP correlation (
     <italic>
      r
     </italic>
     <sup>
      2
     </sup>
     = 0.78) suggests both target the proteasome 20S subunit beta 1 (PSMB1)
     <sup>
      <xref ref-type="bibr" rid="CR50">
       50
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig3">
      3f
     </xref>
     ).
    </p>
   </sec>
   <sec id="Sec6">
    <title>
     FRoGS-based model augments compound activity models to predict a high-quality compound-target network
    </title>
    <p id="Par19">
     Model
     <italic>
      L
     </italic>
     outperforms activity-based target prediction models based on NCI
     <sub>
      60
     </sub>
     (recall 17.2%) and PSP (recall 9.6%) datasets, marking a significant improvement compared to previous studies
     <sup>
      <xref ref-type="bibr" rid="CR12">
       12
      </xref>
      ,
      <xref ref-type="bibr" rid="CR13">
       13
      </xref>
      –
      <xref ref-type="bibr" rid="CR14">
       14
      </xref>
     </sup>
     (Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     ). Comparing Model
     <italic>
      L
     </italic>
     against the strongest model, pQSAR-activity-based target prediction, Metascape enrichment analyses
     <sup>
      <xref ref-type="bibr" rid="CR51">
       51
      </xref>
     </sup>
     suggest that outside the broad overlap in predictions between two models, Model
     <italic>
      L
     </italic>
     predicts distinct targets that are not recoverable by Model pQSAR and vice versa, indicating the unique strength of each model (Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      5
     </xref>
     –
     <xref ref-type="supplementary-material" rid="MOESM1">
      6
     </xref>
     , Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      6
     </xref>
     ). As Model
     <italic>
      L
     </italic>
     relies on transcriptional responses, while Model pQSAR is influenced by the enrichment of target classes covered by in-house assays and by focused compound screening libraries, the implicit bias of each approach to identify different targets is likely inherited from their data sources.
    </p>
    <p id="Par20">
     Given unique capabilities of Model
     <italic>
      L
     </italic>
     , we next demonstrated that our FRoGS-based Model
     <italic>
      L
     </italic>
     can be combined with existing activity-based models to boost compound target prediction performance. For that, we integrated Model
     <italic>
      L
     </italic>
     with the Model pQSAR into a multi-modality LR predictor (Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      7
     </xref>
     ). The combined model significantly improved the performance of Model pQSAR from 0.70–0.74 (
     <italic>
      p
     </italic>
     = 2 × 10
     <sup>
      −4
     </sup>
     ) (Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      5a
     </xref>
     ). Activity models based on NCI
     <sub>
      60
     </sub>
     and PSP datasets were also tested and showed consistent results (Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      7
     </xref>
     , Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     ). Multiple viable options of combining Model
     <italic>
      L
     </italic>
     with the activity models were also evaluated as (Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      8
     </xref>
     , Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      8
     </xref>
     –
     <xref ref-type="supplementary-material" rid="MOESM1">
      9
     </xref>
     ).
    </p>
    <p id="Par21">
     The combined model (Model
     <italic>
      L
     </italic>
     with Model pQSAR) predicted a compound-target network comprising 1598 compounds, 682 genes, and 146,749 associations, where the probability was above 0.8 and the target was in the top 5% (Fig.
     <xref ref-type="fig" rid="Fig4">
      4a
     </xref>
     ). We extracted subnetworks formed by compounds and their top candidate targets for each separate anatomical therapeutic chemical (ATC) classification according to DrugBank
     <sup>
      <xref ref-type="bibr" rid="CR52">
       52
      </xref>
     </sup>
     . Ontology enrichment analyses
     <sup>
      <xref ref-type="bibr" rid="CR51">
       51
      </xref>
     </sup>
     on the targets within each subnetwork showed clear biological agreements between the enriched pathways/processes and the ATC labels. For example, targets predicted for the “other antineoplastic agents” network (ATC code L01X) (Fig.
     <xref ref-type="fig" rid="Fig4">
      4b
     </xref>
     ) are highly enriched in “protein phosphorylation” processes (Fig.
     <xref ref-type="fig" rid="Fig4">
      4c
     </xref>
     ) and depict associations between kinase targets and small molecules that are both well-established modulators of cancer biology. These include “rapalogues,” which target mTOR, EGFR, and CDK4/6 inhibitors. These different mechanisms of action have related but distinct networks. Within this 129-edge subnetwork, 19% of edges are predictable by Model
     <italic>
      L
     </italic>
     alone. 19% of the predicted edges are either “known” or “pIC
     <sub>
      50
     </sub>
     ” and 54% are supported by pQSAR evidence, implying high predictive quality.
     <fig id="Fig4" position="float">
      <label>
       Fig. 4
      </label>
      <caption xml:lang="en">
       <title>
        The compound-target network predicted by the combined model.
       </title>
       <p>
        <bold>
         a
        </bold>
        The network simplified by keeping ≤ 5 best-scoring targets per compound and ≤ 10 best-scoring compounds per target. Styles of nodes and edges are explained in the figure legend.
        <bold>
         b
        </bold>
        Network for L01X “other antineoplastic agents”.
        <bold>
         c
        </bold>
        Targets in L01X subnetwork show the strong enrichment of pathways related to tyrosine phosphorylation and kinase-related signal transduction processes. One-sided fisher exact test, statistics including multi-test adjusted
        <italic>
         p
        </italic>
        -values are in source data. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-46089-y/41467_2024_46089_Fig4_HTML.png"/>
     </fig>
    </p>
    <p id="Par22">
     Among all the network edges, 2183 (1.5%) are supported by all three models: Model
     <italic>
      L
     </italic>
     , Model pQSAR, and the combined model. Furthermore, 4566 (3.1%) edges found support in orthogonal data sources (not counting pQSAR), including 113 by NCI
     <sub>
      60
     </sub>
     , 58 by PSP, 502 by structure similarity, 1271 by experimental pIC
     <sub>
      50
     </sub>
     data, and 2622 are “known” interactions. Combining these two subsets, we obtained a total of 6296 (4.5%) conceptually higher-quality predictions between 1406 compounds and 448 targets. This subset is released as a community resource that proposes valuable hypotheses for the target deconvolution of L1000 compounds, as well as supplies tool compounds for perturbing proteins of interest (Supplementary Data
     <xref ref-type="supplementary-material" rid="MOESM4">
      1
     </xref>
     ). Of note, 57% of the network edges from the combined model and 24% of the higher-quality subset would have been missed without the contribution of FRoGS-based Model
     <italic>
      L
     </italic>
     .
    </p>
   </sec>
   <sec id="Sec7">
    <title>
     Experimental validation of kinase inhibitors predicted by FRoGS
    </title>
    <p id="Par23">
     Kinases comprise 27% of compound targets in the Broad annotation, which is consistent with kinases accounting for over 30% of drug discovery efforts worldwide
     <sup>
      <xref ref-type="bibr" rid="CR53">
       53
      </xref>
     </sup>
     . Evaluation of predictions within our released network from molecules that interact with this target class is of primary importance. We selected all 1,116 compounds that were predicted to bind any of a set of 19 kinases and carried out experimental profiling to further validate these predictions (see Method). Figure
     <xref ref-type="fig" rid="Fig5">
      5a
     </xref>
     shows that in 18 out of 19 assays, predicted kinase binders have a significantly higher confirmation rate than those not predicted to bind (Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      2
     </xref>
     ). In the case of KDR, 70 out of 403 (17%) predictions were confirmed versus 9 out of 713 (1.9%) for negative predictions, signifying a 14-fold enrichment (
     <italic>
      p
     </italic>
     = 1.2 × 10
     <sup>
      −23
     </sup>
     ). Primary hits active in no more than three assays were subjected to secondary dose-response profiling against nine kinases that had the largest number of target-specific primary hits, including PDGFRA, KIT, and EGFR. Dose-response profiling validated the single-dose profiling results (Fig.
     <xref ref-type="fig" rid="Fig5">
      5b
     </xref>
     , Supplementary Fig.
     <xref ref-type="supplementary-material" rid="MOESM1">
      10
     </xref>
     , Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      3
     </xref>
     ). Figure
     <xref ref-type="fig" rid="Fig5">
      5c
     </xref>
     shows the IC
     <sub>
      50
     </sub>
     binding heatmap of 191 compounds across the 9 assays, where 96 compounds bind to three or fewer kinases (Supplementary Data
     <xref ref-type="supplementary-material" rid="MOESM5">
      2
     </xref>
     ). Kinase targets clustered based on compound activity patterns generally reflect their functional lineage relationship, which implies the biochemical validity of the data. Among the 479 true positive (TP) predictions, 213 (44.5%) that were not predicted by Model pQSAR alone were rescued by Model
     <italic>
      L
     </italic>
     or the combined model, which demonstrates the important contributions of FRoGS-enabled Model
     <italic>
      L
     </italic>
     .
     <fig id="Fig5" position="float">
      <label>
       Fig. 5
      </label>
      <caption xml:lang="en">
       <title>
        Experimental confirmation of predicted kinase inhibitors.
       </title>
       <p>
        <bold>
         a
        </bold>
        Single-dose confirmation rate for predicted kinase inhibitors (black) versus those not predicted to bind (gray).
        <bold>
         b
        </bold>
        Dose-response confirmation rate for compounds validated by single-dose confirmation versus those not validated. Error bars, mean ± SD, one-sided chi-square test. ***
        <italic>
         p
        </italic>
        &lt; 0.001.
        <bold>
         c
        </bold>
        The IC
        <sub>
         50
        </sub>
        heatmap of 191 compounds across 9 kinases. True positives are in dark blue and false negatives are in dark yellow. Light blue indicates true negatives and light yellow is for false positives. Overall, 50% of compounds are selective (bound in ≤3 assays). Statistics are provided in Supplementary Table
        <xref ref-type="supplementary-material" rid="MOESM1">
         2
        </xref>
        –
        <xref ref-type="supplementary-material" rid="MOESM1">
         3
        </xref>
        .
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-46089-y/41467_2024_46089_Fig5_HTML.png"/>
     </fig>
    </p>
    <p id="Par24">
     Commonly accepted target annotation for a compound is often incomplete. An example of this is A-443644 (BRD-K38615104), which is generally referred to as an AKT inhibitor. We predicted and demonstrated that this compound has activity against GSK3b, which also has been described by others
     <sup>
      <xref ref-type="bibr" rid="CR54">
       54
      </xref>
     </sup>
     . Among its six predicted kinase targets, four were not predicted without the contribution of Model
     <italic>
      L
     </italic>
     (Supplementary Data
     <xref ref-type="supplementary-material" rid="MOESM5">
      2
     </xref>
     ). The approach also provided additional insights to the mechanism of action of phloretin (BRD-K15563106), a compound with notable cell-based activity (e.g., differential cytotoxicity across the NCI
     <sub>
      60
     </sub>
     panel) yet a poorly defined mechanism of action
     <sup>
      <xref ref-type="bibr" rid="CR55">
       55
      </xref>
     </sup>
     . Phloretin is commonly referred to as an inhibitor of a sodium/glucose transporter, yet others have suggested it also may act as a kinase inhibitor
     <sup>
      <xref ref-type="bibr" rid="CR55">
       55
      </xref>
      ,
      <xref ref-type="bibr" rid="CR56">
       56
      </xref>
     </sup>
     . The kinase screening data confirmed this latter activity against EGFR and other receptor tyrosine kinases, which provides insight into Phloretin’s cytotoxicity.
    </p>
   </sec>
   <sec id="Sec8">
    <title>
     The discovery of ligands for aryl hydrocarbon receptor
    </title>
    <p id="Par25">
     We also investigated the use of the predictive model for non-kinase targets. The aryl hydrocarbon receptor (AhR) is implicated in many diseases that are driven by immune/inflammatory processes, including major depressive disorder, multiple sclerosis, rheumatoid arthritis, asthma, and allergic responses
     <sup>
      <xref ref-type="bibr" rid="CR57">
       57
      </xref>
     </sup>
     . AhR antagonists can expand human hematopoietic stem cells (HSC) ex vivo and can facilitate clinical HSC therapy
     <sup>
      <xref ref-type="bibr" rid="CR58">
       58
      </xref>
     </sup>
     . Our model predicted 369 compounds potentially targeting AhR, of which 333 were available for profiling. AhR agonist, AhR antagonist, and CellTiter-Glo toxicity assays were utilized to screen these compounds. Initial testing at 50 µM, in quadruplicates, identified 128 compounds that are active in at least one of the AhR assays. Follow-up dose-response screens led to 76 compounds that were confirmed to be either AhR agonists or antagonists (IC
     <sub>
      50
     </sub>
     &lt; 50 µM) without apparent cytotoxicity (Fig.
     <xref ref-type="fig" rid="Fig6">
      6a
     </xref>
     , Supplementary Data
     <xref ref-type="supplementary-material" rid="MOESM6">
      3
     </xref>
     ), which corresponds to a 23% confirmation rate for our model predictions.
     <fig id="Fig6" position="float">
      <label>
       Fig. 6
      </label>
      <caption xml:lang="en">
       <title>
        Validation of AhR binders.
       </title>
       <p>
        <bold>
         a
        </bold>
        The confirmation results of 333 compounds predicted to target AhR.
        <bold>
         b
        </bold>
        –
        <bold>
         j
        </bold>
        Dose-response data for selected AhR binders. Assays are color coded as blue for agonist, red for antagonist, and green for toxicity. X axes are concentrations in µM and Y axes are normalized response, with the agonist signals scaled for the ease of visual comparison.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-46089-y/41467_2024_46089_Fig6_HTML.png"/>
     </fig>
    </p>
    <p id="Par26">
     Among the confirmed binders, 3 known AhR agonists were recalled by our analysis, including ITE
     <sup>
      <xref ref-type="bibr" rid="CR59">
       59
      </xref>
     </sup>
     , diindolylmethane
     <sup>
      <xref ref-type="bibr" rid="CR60">
       60
      </xref>
     </sup>
     , and leflunomide
     <sup>
      <xref ref-type="bibr" rid="CR61">
       61
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig6">
      6b–d
     </xref>
     ). Consistent with their observed antagonist activities, curcumin, resveratrol, and quercetin were previously shown to indirectly activate AhR by interfering with an endogenous AhR ligand FICZ
     <sup>
      <xref ref-type="bibr" rid="CR62">
       62
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig6">
      6e–g
     </xref>
     ). Furthermore, publications report resveratrol as an antagonist
     <sup>
      <xref ref-type="bibr" rid="CR63">
       63
      </xref>
     </sup>
     , menadione to transcriptionally downregulate AhR in vivo
     <sup>
      <xref ref-type="bibr" rid="CR64">
       64
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig6">
      6h
     </xref>
     ), taxifolin suppresses gastric cancer by regulating AhR/CYP1A1
     <sup>
      <xref ref-type="bibr" rid="CR65">
       65
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig6">
      6i
     </xref>
     ), and isoliquiritigenin reduces the DNA-binding activity of AhR
     <sup>
      <xref ref-type="bibr" rid="CR66">
       66
      </xref>
     </sup>
     (Fig.
     <xref ref-type="fig" rid="Fig6">
      6j
     </xref>
     ).
    </p>
    <p id="Par27">
     In total, 38 compounds within this set were supported by Model pQSAR, while the other 38 (50%) compounds were predicted only with the contribution of Model
     <italic>
      L
     </italic>
     . This further underscores how Model
     <italic>
      L
     </italic>
     can be effectively integrated with other OMICs data to improve compound target predictions. None of these compounds could have been discovered based on their chemical features as they are not structurally similar to any of the annotated AhR binders. AhR represents a difficult target class for prediction, as there are only 6 reference compounds among the 369 predictions (1.6%) and 45% of the predictions have no additional supporting evidence other than the combined model itself. The high confirmation rate implies our compound-target network is expected to contain rich biochemical associations that can be an invaluable resource for the biomedical research community to bootstrap drug discovery projects.
    </p>
   </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
   <title>
    Discussion
   </title>
   <p id="Par28">
    A significant contribution of our study lies in the transfer of the word2vec
    <sup>
     <xref ref-type="bibr" rid="CR22">
      22
     </xref>
    </sup>
    concept from the NLP domain to bioinformatics problems, wherein genes are embedded into vectors representing diverse biological information, including their known functions in GO
    <sup>
     <xref ref-type="bibr" rid="CR31">
      31
     </xref>
    </sup>
    and empirical functions in ARCHS4
    <sup>
     <xref ref-type="bibr" rid="CR32">
      32
     </xref>
    </sup>
    . This has two significant implications. First, we validated that casting gene identities into their functional roles, via FRoGS, resulted in weak pathway signals within large-scale data becoming much more readily extractable (Fig.
    <xref ref-type="fig" rid="Fig1">
     1c
    </xref>
    ). The challenge of the weak overlap signals between two experimentally derived gene signatures is not due to the sparseness of the L1000 gene signatures, as we further tested Model
    <italic>
     L
    </italic>
    based on 1000 Landmark genes alone
    <sup>
     <xref ref-type="bibr" rid="CR1">
      1
     </xref>
    </sup>
    without seeing qualitative differences with respect to the extrapolated whole-transcriptome signatures. FRoGS’s representation of a gene or a gene list as a numerical vector incorporating the genes’ prior knowledge (Fig.
    <xref ref-type="fig" rid="Fig1">
     1b
    </xref>
    ) is conceptually much more empowering compared to a one-hot encoding representation. Another explanation for the significantly better performance of FRoGS (Fig.
    <xref ref-type="fig" rid="Fig2">
     2b
    </xref>
    ) is that other representations do not model GO, embed GO indirectly via text annotations, or do not utilize a GO hypergraph (Supplementary Note
    <xref ref-type="supplementary-material" rid="MOESM1">
     1
    </xref>
    ). We demonstrated by working in the biological functional space, Model
    <italic>
     L
    </italic>
    outperformed the model based on NCI
    <sub>
     60
    </sub>
    dataset and boosted the performance of activity-based models. This highlights the benefit of both extending FRoGS vectors to incorporate knowledge derived from data sources beyond ARCHS4 and integrating Model
    <italic>
     L
    </italic>
    with other experimentally generated datasets. Such sources include the plethora of gene signatures collected in The Cancer Genome Atlas, Gene Expression Omnibus, Human Protein Atlas, Functional Annotation of Mammalian Genome, Single Cell Expression Atlas, etc. Secondly, pre-trained gene functional embedding enabled transfer learning. Knowledge of genes’ functions are conceptually advantageous for gene signature-based analyses, such as those that identify disease-causal genes. However, identity-based machine learning models must gain such knowledge de novo, and thus require large-scale training data that are not readily available. Using FRoGS vectors as a starting point to encode genes or gene signatures, application-specific model training requires much fewer deep-learning model parameters or can leverage non-deep-learning approaches, such as SVM
    <sup>
     <xref ref-type="bibr" rid="CR67">
      67
     </xref>
    </sup>
    , random forest
    <sup>
     <xref ref-type="bibr" rid="CR68">
      68
     </xref>
    </sup>
    , and XGBoost
    <sup>
     <xref ref-type="bibr" rid="CR69">
      69
     </xref>
    </sup>
    to achieve higher performance. The ability to use small training sets is a desirable property for most bioinformatics machine-learning applications. Thus, FRoGS vectors are widely applicable to biomedical problems beyond drug target identification including identifying risk genes of diseases
    <sup>
     <xref ref-type="bibr" rid="CR27">
      27
     </xref>
    </sup>
    , uncovering disease-disease relationships
    <sup>
     <xref ref-type="bibr" rid="CR70">
      70
     </xref>
    </sup>
    , and single cell clustering and classification
    <sup>
     <xref ref-type="bibr" rid="CR71">
      71
     </xref>
    </sup>
    .
   </p>
   <p id="Par29">
    We hypothesize one reason that preventing deep learning models from further enhancing the target recall relates to the fact that both transcriptional profiling data and compound activity profiles generally capture the downstream effect of a compound/shRNA/cDNA on its target pathway. When a protein target is modulated, downstream proteins are affected. Models based on gene expression levels cannot easily distinguish the target itself from its downstream neighbors as they show similar differential expression patterns. That is a common challenge for all transcription-based models including our Model
    <italic>
     L
    </italic>
    and other activity-based models, and it contributes to the polypharmacology of the target predictions. While the target count in the positive training dataset is 1.6 genes/compound, the count in the predicted network is 4.5 genes/compound, even when only considering the high-quality subset. To overcome this, models need to further distinguish the regulation inflection point along the affected pathways by either incorporating structure-based docking simulation or narrowing the candidate pool by focusing on the densely connected protein nodes within the gene signatures. Therefore, a future direction is to scale the FRoGS framework to extract protein-protein interaction (PPI) signals in gene signatures by leveraging graph neural networks
    <sup>
     <xref ref-type="bibr" rid="CR72">
      72
     </xref>
    </sup>
    , similar to some recent reports
    <sup>
     <xref ref-type="bibr" rid="CR3">
      3
     </xref>
     ,
     <xref ref-type="bibr" rid="CR29">
      29
     </xref>
    </sup>
    .
   </p>
   <p id="Par30">
    Lastly, we demonstrated FRoGS helped predict and rescue chemical probes, as 57% of the network edges from the combined model, 45% kinase inhibitors, and 50% of AhR ligands would have been missed by using Model pQSAR alone. Going beyond the application of target deconvolution for chemical hits identified through cellular drug discovery screens, we anticipate the conceptual advance of FRoGS can replicate some of the success word2vec generated in NLP and contribute to effective bioinformatics machine learning modeling across a broad range of applications.
   </p>
  </sec>
  <sec id="Sec10" sec-type="methods">
   <title>
    Methods
   </title>
   <sec id="Sec11">
    <title>
     Datasets
    </title>
    <p id="Par31">
     pQSAR compound activity matrix is Novartis’ internal in silico activity dataset for 5.5 million compounds over ~12,000 assays. Only assays with prediction quality exceeding the standard success threshold,
     <inline-formula id="IEq28">
      <alternatives>
       <math id="IEq28_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           x
          </mi>
          <mi>
           t
          </mi>
         </mrow>
         <mrow>
          <mn>
           2
          </mn>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq28_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{{ext}}^{2}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq28.gif"/>
      </alternatives>
     </inline-formula>
     ≥ 0.3 were retained for this study, and the predicted
     <italic>
      Z
     </italic>
     -scores were used to represent compound activities. Among all the perturbagens and reference compounds, 1601 have pQSAR activity profiles across 4420 assays mapped into 1003 unique gene targets. Promoter Signature Profiling (PSP) dataset consists of 18 GR
     <sub>
      50
     </sub>
     activity data profiles aggregated across 41 original reporter gene assays
     <sup>
      <xref ref-type="bibr" rid="CR45">
       45
      </xref>
     </sup>
     . Among all the perturbagens and reference compounds, 93 have PSP profiles with at least one GR
     <sub>
      50
     </sub>
     value greater than 0.3, and 321 have NCI
     <sub>
      60
     </sub>
     profiles.
    </p>
    <p id="Par32">
     The sources of the public datasets used in this study are described in Data Availability. The L1000 Connectivity Map dataset includes both the original gene expression data for the landmark genes as well as extrapolated data for the whole transcriptome consisting of 10174 genes. 238,522 human RNA-seq samples were collected by the ARCHS4
     <sup>
      <xref ref-type="bibr" rid="CR32">
       32
      </xref>
     </sup>
     database as of December 2020. Gene counts for each sample were quantified by ARCHS4 against the GRCh38 human reference genome using Kallisto
     <sup>
      <xref ref-type="bibr" rid="CR73">
       73
      </xref>
     </sup>
     . Following the ARCHS4 workflow, gene counts were processed by log2 transformation and quantile normalization. The resultant gene counts were
     <italic>
      Z
     </italic>
     -score-normalized across samples. Genes were ranked based on their
     <italic>
      Z
     </italic>
     -scores within each sample and a set of differentially expressed genes were defined as genes ranked in the top 100 or bottom 100 and with |
     <italic>
      Z
     </italic>
     | ≥ 2.
    </p>
   </sec>
   <sec id="Sec12">
    <title>
     Embeddings of individual genes encoding functional information
    </title>
    <p id="Par33">
     Two
     <inline-formula id="IEq29">
      <alternatives>
       <math id="IEq29_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         d
        </mi>
       </math>
       <tex-math id="IEq29_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq29.gif"/>
      </alternatives>
     </inline-formula>
     -dimensional vector representations (embeddings) were created for each gene, one for GO and one for RNA-seq information. In the embedding space, functionally similar genes are embedded closely together. The same algorithm was used to learn both embeddings. Specifically, given a gene
     <inline-formula id="IEq30">
      <alternatives>
       <math id="IEq30_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq30_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq30.gif"/>
      </alternatives>
     </inline-formula>
     , we sample a set of neighbor genes that commonly appear in the same GO processes (or RNA-seq samples) with
     <inline-formula id="IEq31">
      <alternatives>
       <math id="IEq31_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq31_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq31.gif"/>
      </alternatives>
     </inline-formula>
     , denoted as
     <inline-formula id="IEq32">
      <alternatives>
       <math id="IEq32_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         N
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq32_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq32.gif"/>
      </alternatives>
     </inline-formula>
     , and encourage gene
     <inline-formula id="IEq33">
      <alternatives>
       <math id="IEq33_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq33_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq33.gif"/>
      </alternatives>
     </inline-formula>
     to have similar embeddings with its neighbor genes. To efficiently sample
     <inline-formula id="IEq34">
      <alternatives>
       <math id="IEq34_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         N
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq34_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq34.gif"/>
      </alternatives>
     </inline-formula>
     , we convert gene-GO (gene-sample) associations into a hypergraph in which, each gene is represented as a node and each GO term (RNA-seq sample) is represented as a hyperedge
     <inline-formula id="IEq35">
      <alternatives>
       <math id="IEq35_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq35_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq35.gif"/>
      </alternatives>
     </inline-formula>
     that connects all the genes associated with the GO term (regulated gene set of the RNA-seq sample). We then perform a random walk with restart (RWR) in the hypergraph to identify genes that lie close to each other in the graph.
    </p>
    <p id="Par34">
     For the GO graph, we assign each hyperedge
     <inline-formula id="IEq36">
      <alternatives>
       <math id="IEq36_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq36_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq36.gif"/>
      </alternatives>
     </inline-formula>
     a weight by the information content of the corresponding GO term
     <sup>
      <xref ref-type="bibr" rid="CR30">
       30
      </xref>
     </sup>
     , where more specific terms get higher weights:
     <disp-formula id="Equ1">
      <label>
       1
      </label>
      <alternatives>
       <math id="Equ1_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         w
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           e
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mrow>
          <mi>
           log
          </mi>
         </mrow>
         <mrow>
          <mn>
           2
          </mn>
         </mrow>
        </msub>
        <mfrac>
         <mrow>
          <msub>
           <mrow>
            <mo mathsize="big">
             ∑
            </mo>
           </mrow>
           <mrow>
            <mi>
             c
            </mi>
            <mo>
             ∈
            </mo>
            <mi>
             C
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <mi>
               e
              </mi>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
          </msub>
          <mo>
           ∣
          </mo>
          <mi>
           c
          </mi>
          <mo>
           ∣
          </mo>
         </mrow>
         <mrow>
          <msubsup>
           <mrow>
            <mo mathsize="big">
             ∑
            </mo>
           </mrow>
           <mrow>
            <msup>
             <mrow>
              <mi>
               e
              </mi>
             </mrow>
             <mrow>
              <mo>
               ′
              </mo>
             </mrow>
            </msup>
            <mo>
             ∈
            </mo>
            <mi>
             E
            </mi>
           </mrow>
           <mrow/>
          </msubsup>
          <mo>
           ∣
          </mo>
          <msup>
           <mrow>
            <mi>
             e
            </mi>
           </mrow>
           <mrow>
            <mo>
             ′
            </mo>
           </mrow>
          </msup>
          <mo>
           ∣
          </mo>
         </mrow>
        </mfrac>
        <mo>
         .
        </mo>
       </math>
       <tex-math id="Equ1_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w(e)=-{\log }_{2}\frac{{\sum }_{c\in C(e)}|c|}{{\sum }_{e^{\prime} \in E}^{\,}|e^{\prime} |}.$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ1.gif"/>
      </alternatives>
     </disp-formula>
     <inline-formula id="IEq37">
      <alternatives>
       <math id="IEq37_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mfrac>
         <mrow>
          <msub>
           <mrow>
            <mo>
             ∑
            </mo>
           </mrow>
           <mrow>
            <mi>
             c
            </mi>
            <mo>
             ∈
            </mo>
            <mi>
             C
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <mi>
               e
              </mi>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
          </msub>
          <mo>
           ∣
          </mo>
          <mi>
           c
          </mi>
          <mo>
           ∣
          </mo>
         </mrow>
         <mrow>
          <msub>
           <mrow>
            <mo>
             ∑
            </mo>
           </mrow>
           <mrow>
            <msup>
             <mrow>
              <mi>
               e
              </mi>
             </mrow>
             <mrow>
              <mo>
               ′
              </mo>
             </mrow>
            </msup>
            <mo>
             ∈
            </mo>
            <mi>
             E
            </mi>
           </mrow>
          </msub>
          <mspace width="0.25em"/>
          <mfenced close="∣" open="∣">
           <mrow>
            <msup>
             <mrow>
              <mi>
               e
              </mi>
             </mrow>
             <mrow>
              <mo>
               ′
              </mo>
             </mrow>
            </msup>
           </mrow>
          </mfenced>
         </mrow>
        </mfrac>
       </math>
       <tex-math id="IEq37_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\mathop{\sum}\nolimits_{c\in C(e)}{|c|}}{\mathop{\sum}\nolimits_{{e}^{{\prime} }\in E}\,\left|{e}^{{\prime} }\right|}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq37.gif"/>
      </alternatives>
     </inline-formula>
     is the frequency of the GO term
     <inline-formula id="IEq38">
      <alternatives>
       <math id="IEq38_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq38_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq38.gif"/>
      </alternatives>
     </inline-formula>
     , where
     <inline-formula id="IEq39">
      <alternatives>
       <math id="IEq39_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         E
        </mi>
       </math>
       <tex-math id="IEq39_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq39.gif"/>
      </alternatives>
     </inline-formula>
     is the set of all the GO terms included in the hypergraph,
     <inline-formula id="IEq40">
      <alternatives>
       <math id="IEq40_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mo>
         ∣
        </mo>
        <mi>
         e
        </mi>
        <mo>
         ∣
        </mo>
       </math>
       <tex-math id="IEq40_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${|e|}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq40.gif"/>
      </alternatives>
     </inline-formula>
     is the number of genes associated with the GO term
     <inline-formula id="IEq41">
      <alternatives>
       <math id="IEq41_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq41_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq41.gif"/>
      </alternatives>
     </inline-formula>
     , and
     <inline-formula id="IEq42">
      <alternatives>
       <math id="IEq42_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         C
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           e
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq42_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C(e)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq42.gif"/>
      </alternatives>
     </inline-formula>
     is the set of all the child terms of
     <inline-formula id="IEq43">
      <alternatives>
       <math id="IEq43_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq43_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq43.gif"/>
      </alternatives>
     </inline-formula>
     included in the graph and
     <inline-formula id="IEq44">
      <alternatives>
       <math id="IEq44_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq44_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq44.gif"/>
      </alternatives>
     </inline-formula>
     itself.
    </p>
    <p id="Par35">
     For consistency, we define the weight of a hyperedge
     <inline-formula id="IEq45">
      <alternatives>
       <math id="IEq45_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq45_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq45.gif"/>
      </alternatives>
     </inline-formula>
     in the RNA-seq graph as:
     <disp-formula id="Equ2">
      <label>
       2
      </label>
      <alternatives>
       <math id="Equ2_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         w
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           e
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mrow>
          <mi>
           log
          </mi>
         </mrow>
         <mrow>
          <mn>
           2
          </mn>
         </mrow>
        </msub>
        <mfrac>
         <mrow>
          <mo>
           ∣
          </mo>
          <mi>
           e
          </mi>
          <mo>
           ∣
          </mo>
         </mrow>
         <mrow>
          <msubsup>
           <mrow>
            <mo mathsize="big">
             ∑
            </mo>
           </mrow>
           <mrow>
            <msup>
             <mrow>
              <mi>
               e
              </mi>
             </mrow>
             <mrow>
              <mo>
               ′
              </mo>
             </mrow>
            </msup>
            <mo>
             ∈
            </mo>
            <mi>
             E
            </mi>
           </mrow>
           <mrow/>
          </msubsup>
          <mo>
           ∣
          </mo>
          <msup>
           <mrow>
            <mi>
             e
            </mi>
           </mrow>
           <mrow>
            <mo>
             ′
            </mo>
           </mrow>
          </msup>
          <mo>
           ∣
          </mo>
         </mrow>
        </mfrac>
        <mspace width="0.25em"/>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ2_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w(e)=-{\log }_{2}\frac{|e|}{{\sum }_{e^{\prime} \in E}^{\,}|e^{\prime} |}\,,$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ2.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq46">
      <alternatives>
       <math id="IEq46_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         E
        </mi>
       </math>
       <tex-math id="IEq46_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq46.gif"/>
      </alternatives>
     </inline-formula>
     is the set of all the RNA-seq samples, and
     <inline-formula id="IEq47">
      <alternatives>
       <math id="IEq47_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mo>
         ∣
        </mo>
        <mi>
         e
        </mi>
        <mo>
         ∣
        </mo>
       </math>
       <tex-math id="IEq47_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${|e|}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq47.gif"/>
      </alternatives>
     </inline-formula>
     is the number of differentially regulated genes within sample
     <inline-formula id="IEq48">
      <alternatives>
       <math id="IEq48_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq48_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq48.gif"/>
      </alternatives>
     </inline-formula>
     .
    </p>
    <p id="Par36">
     The random walk in a hypergraph can be interpreted as: given the current node
     <inline-formula id="IEq49">
      <alternatives>
       <math id="IEq49_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
        <mo>
         ∈
        </mo>
        <mi>
         V
        </mi>
       </math>
       <tex-math id="IEq49_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u\in V$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq49.gif"/>
      </alternatives>
     </inline-formula>
     (all the genes), first choose a hyperedge
     <inline-formula id="IEq50">
      <alternatives>
       <math id="IEq50_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq50_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq50.gif"/>
      </alternatives>
     </inline-formula>
     over all the hyperedges incident to
     <italic>
      u
     </italic>
     with the probability proportional to
     <inline-formula id="IEq51">
      <alternatives>
       <math id="IEq51_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         w
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           e
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq51_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w(e)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq51.gif"/>
      </alternatives>
     </inline-formula>
     , and then randomly choose a node
     <inline-formula id="IEq52">
      <alternatives>
       <math id="IEq52_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         v
        </mi>
        <mo>
         ∈
        </mo>
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq52_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\in e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq52.gif"/>
      </alternatives>
     </inline-formula>
     uniformly
     <sup>
      <xref ref-type="bibr" rid="CR74">
       74
      </xref>
     </sup>
     . Let
     <inline-formula id="IEq53">
      <alternatives>
       <math id="IEq53_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         B
        </mi>
       </math>
       <tex-math id="IEq53_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{B}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq53.gif"/>
      </alternatives>
     </inline-formula>
     denotes the transition probability matrix of random walk in the hypergraph, each entry of
     <inline-formula id="IEq54">
      <alternatives>
       <math id="IEq54_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         B
        </mi>
       </math>
       <tex-math id="IEq54_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{B}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq54.gif"/>
      </alternatives>
     </inline-formula>
     is thus computed as:
     <disp-formula id="Equ3">
      <label>
       3
      </label>
      <alternatives>
       <math id="Equ3_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         B
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           v
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <munder>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           e
          </mi>
          <mo>
           ∈
          </mo>
          <mi>
           E
          </mi>
         </mrow>
        </munder>
        <mi>
         w
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           e
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mfrac>
         <mrow>
          <mi mathvariant="bold">
           H
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             u
            </mi>
            <mo>
             ,
            </mo>
            <mspace width="0.25em"/>
            <mi>
             e
            </mi>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mrow>
          <mi>
           d
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             u
            </mi>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mi mathvariant="bold">
           H
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             v
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             e
            </mi>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mrow>
          <mo>
           ∣
          </mo>
          <mi>
           e
          </mi>
          <mo>
           ∣
          </mo>
         </mrow>
        </mfrac>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ3_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{B}}}}}}(u,v)=\,\mathop{\sum}\limits_{e\in E}w(e)\frac{{{{{{\bf{H}}}}}}(u,\,e)}{d(u)}\frac{{{{{{\bf{H}}}}}}(v,e)}{|e|},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ3.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq55">
      <alternatives>
       <math id="IEq55_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         H
        </mi>
       </math>
       <tex-math id="IEq55_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{H}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq55.gif"/>
      </alternatives>
     </inline-formula>
     is a
     <inline-formula id="IEq56">
      <alternatives>
       <math id="IEq56_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mo>
         ∣
        </mo>
        <mi>
         V
        </mi>
        <mo>
         ∣
        </mo>
        <mo>
         ×
        </mo>
        <mo>
         ∣
        </mo>
        <mi>
         E
        </mi>
        <mo>
         ∣
        </mo>
       </math>
       <tex-math id="IEq56_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${|V|}\times {|E|}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq56.gif"/>
      </alternatives>
     </inline-formula>
     matrix with entries
     <inline-formula id="IEq57">
      <alternatives>
       <math id="IEq57_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         H
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <mi>
           u
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           e
          </mi>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="IEq57_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{H}}}}}}\left(u,{e}\right)\,$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq57.gif"/>
      </alternatives>
     </inline-formula>
     = 1 if
     <inline-formula id="IEq58">
      <alternatives>
       <math id="IEq58_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
        <mo>
         ∈
        </mo>
        <mi>
         e
        </mi>
       </math>
       <tex-math id="IEq58_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u\in e$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq58.gif"/>
      </alternatives>
     </inline-formula>
     and 0 otherwise,
     <inline-formula id="IEq59">
      <alternatives>
       <math id="IEq59_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         d
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq59_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq59.gif"/>
      </alternatives>
     </inline-formula>
     is the degree of gene
     <inline-formula id="IEq60">
      <alternatives>
       <math id="IEq60_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq60_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq60.gif"/>
      </alternatives>
     </inline-formula>
     in the hypergraph, defined as
     <inline-formula id="IEq61">
      <alternatives>
       <math id="IEq61_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         d
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <msub>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mrow>
           <mo>
            {
           </mo>
           <mrow>
            <mi>
             e
            </mi>
            <mo>
             ∈
            </mo>
            <mi>
             E
            </mi>
            <mo>
             ∣
            </mo>
            <mi>
             u
            </mi>
            <mo>
             ∈
            </mo>
            <mi>
             e
            </mi>
           </mrow>
           <mo>
            }
           </mo>
          </mrow>
         </mrow>
        </msub>
        <mi>
         w
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           e
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq61_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(u)=\mathop{\sum}\nolimits_{\{e\in {E|u}\in e\}}w(e)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq61.gif"/>
      </alternatives>
     </inline-formula>
     . The RWR from a node
     <inline-formula id="IEq62">
      <alternatives>
       <math id="IEq62_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq62_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq62.gif"/>
      </alternatives>
     </inline-formula>
     is then defined as follows in matrix notation:
     <disp-formula id="Equ4">
      <label>
       4
      </label>
      <alternatives>
       <math id="Equ4_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           s
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mfenced close=")" open="(">
         <mrow>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <mi>
           q
          </mi>
         </mrow>
        </mfenced>
        <mi mathvariant="bold">
         B
        </mi>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           s
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
        </msubsup>
        <mo>
         +
        </mo>
        <mi>
         q
        </mi>
        <msub>
         <mrow>
          <mi mathvariant="bold">
           a
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ4_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{s}}}}}}}_{u}^{t+1}=\left(1-q\right){{{{{\bf{B}}}}}}{{{{{{\bf{s}}}}}}}_{u}^{t}+q{{{{{{\bf{a}}}}}}}_{u},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ4.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq63">
      <alternatives>
       <math id="IEq63_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         q
        </mi>
       </math>
       <tex-math id="IEq63_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq63.gif"/>
      </alternatives>
     </inline-formula>
     is the probability of restart,
     <inline-formula id="IEq64">
      <alternatives>
       <math id="IEq64_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           a
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq64_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{a}}}}}}}_{u}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq64.gif"/>
      </alternatives>
     </inline-formula>
     represents the initial state, which is a
     <inline-formula id="IEq65">
      <alternatives>
       <math id="IEq65_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mo>
         ∣
        </mo>
        <mi>
         V
        </mi>
        <mo>
         ∣
        </mo>
       </math>
       <tex-math id="IEq65_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${|V|}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq65.gif"/>
      </alternatives>
     </inline-formula>
     -dimensional vector with one on the
     <inline-formula id="IEq66">
      <alternatives>
       <math id="IEq66_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq66_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq66.gif"/>
      </alternatives>
     </inline-formula>
     -th element and zeros elsewhere,
     <inline-formula id="IEq67">
      <alternatives>
       <math id="IEq67_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           s
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq67_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{s}}}}}}}_{u}^{t}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq67.gif"/>
      </alternatives>
     </inline-formula>
     is a
     <inline-formula id="IEq68">
      <alternatives>
       <math id="IEq68_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mo>
         ∣
        </mo>
        <mi>
         V
        </mi>
        <mo>
         ∣
        </mo>
       </math>
       <tex-math id="IEq68_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${|V|}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq68.gif"/>
      </alternatives>
     </inline-formula>
     -dimensional distribution vector that holds the probability of each node being visited after
     <inline-formula id="IEq69">
      <alternatives>
       <math id="IEq69_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         t
        </mi>
       </math>
       <tex-math id="IEq69_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq69.gif"/>
      </alternatives>
     </inline-formula>
     steps starting from node
     <inline-formula id="IEq70">
      <alternatives>
       <math id="IEq70_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         u
        </mi>
       </math>
       <tex-math id="IEq70_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq70.gif"/>
      </alternatives>
     </inline-formula>
     . The distribution vectors of all the nodes form a matrix
     <inline-formula id="IEq71">
      <alternatives>
       <math id="IEq71_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq71_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{S}}}}}}}^{t}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq71.gif"/>
      </alternatives>
     </inline-formula>
     . After iterative updates, we get the stationary distribution matrix
     <inline-formula id="IEq72">
      <alternatives>
       <math id="IEq72_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         S
        </mi>
        <mo>
         =
        </mo>
        <msup>
         <mrow>
          <mi mathvariant="bold">
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           ∞
          </mi>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq72_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{S}}}}}}={{{{{{\bf{S}}}}}}}^{\infty }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq72.gif"/>
      </alternatives>
     </inline-formula>
     when the Frobenius norm of the difference between
     <inline-formula id="IEq73">
      <alternatives>
       <math id="IEq73_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq73_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{S}}}}}}}^{t+1}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq73.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq74">
      <alternatives>
       <math id="IEq74_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq74_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{S}}}}}}}^{t}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq74.gif"/>
      </alternatives>
     </inline-formula>
     is smaller than a predefined threshold (10
     <sup>
      −6
     </sup>
     ). A higher probability in the stationary distribution matrix indicates two corresponding genes lie closer in the hypergraph, which suggests that they share specific functions with each other compared to other genes in the graph.
    </p>
    <p id="Par37">
     For training, we adopt the contrastive learning idea, which has also been applied to learning enzyme function embeddings
     <sup>
      <xref ref-type="bibr" rid="CR75">
       75
      </xref>
     </sup>
     . For each gene
     <italic>
      u
     </italic>
     , we sample
     <inline-formula id="IEq75">
      <alternatives>
       <math id="IEq75_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         N
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq75_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq75.gif"/>
      </alternatives>
     </inline-formula>
     from other genes in the genome with probabilities proportional to the stationary distribution
     <inline-formula id="IEq76">
      <alternatives>
       <math id="IEq76_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           s
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq76_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{s}}}}}}}_{u}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq76.gif"/>
      </alternatives>
     </inline-formula>
     . We also sample a set of negative samples
     <inline-formula id="IEq77">
      <alternatives>
       <math id="IEq77_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         R
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq77_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq77.gif"/>
      </alternatives>
     </inline-formula>
     with probabilities inversely proportional to its stationary distribution
     <inline-formula id="IEq78">
      <alternatives>
       <math id="IEq78_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           s
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq78_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{s}}}}}}}_{u}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq78.gif"/>
      </alternatives>
     </inline-formula>
     . In our experiment, the ratio between the sizes of
     <inline-formula id="IEq79">
      <alternatives>
       <math id="IEq79_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         N
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq79_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq79.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq80">
      <alternatives>
       <math id="IEq80_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         R
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq80_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R(u)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq80.gif"/>
      </alternatives>
     </inline-formula>
     is 1:5. Then the overall learning objective is to minimize the following negative loglikelihood:
     <disp-formula id="Equ5">
      <label>
       5
      </label>
      <alternatives>
       <math id="Equ5_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mo>
         −
        </mo>
        <munder>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
          <mo>
           ∈
          </mo>
          <mi>
           V
          </mi>
         </mrow>
        </munder>
        <mfenced close=")" open="(">
         <mrow>
          <munder>
           <mrow>
            <mo>
             ∑
            </mo>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mo>
             ∈
            </mo>
            <mi>
             N
            </mi>
            <mfenced close=")" open="(">
             <mrow>
              <mi>
               u
              </mi>
             </mrow>
            </mfenced>
           </mrow>
          </munder>
          <mi>
           log
          </mi>
          <mi mathvariant="normal">
           σ
          </mi>
          <mfenced close=")" open="(">
           <mrow>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               v
              </mi>
             </mrow>
             <mrow>
              <mi mathvariant="normal">
               T
              </mi>
             </mrow>
            </msubsup>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               u
              </mi>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
          <mo>
           −
          </mo>
          <munder>
           <mrow>
            <mo>
             ∑
            </mo>
           </mrow>
           <mrow>
            <mi>
             z
            </mi>
            <mo>
             ∈
            </mo>
            <mi>
             R
            </mi>
            <mfenced close=")" open="(">
             <mrow>
              <mi>
               u
              </mi>
             </mrow>
            </mfenced>
           </mrow>
          </munder>
          <mi>
           log
          </mi>
          <mi mathvariant="normal">
           σ
          </mi>
          <mfenced close=")" open="(">
           <mrow>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               z
              </mi>
             </mrow>
             <mrow>
              <mi mathvariant="normal">
               T
              </mi>
             </mrow>
            </msubsup>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               u
              </mi>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
         </mrow>
        </mfenced>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ5_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\mathop{\sum}\limits_{u\in V}\left(\mathop{\sum}\limits_{v\in N\left(u\right)}\log {{{{{\rm{\sigma }}}}}}\left({{{{{{\bf{x}}}}}}}_{v}^{{{{{{\rm{T}}}}}}}{{{{{{\bf{x}}}}}}}_{u}\right)-\mathop{\sum}\limits_{z\in R\left(u\right)}\log {{{{{\rm{\sigma }}}}}}\left({{{{{{\bf{x}}}}}}}_{z}^{{{{{{\rm{T}}}}}}}{{{{{{\bf{x}}}}}}}_{u}\right)\right),$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ5.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq81">
      <alternatives>
       <math id="IEq81_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         σ
        </mi>
       </math>
       <tex-math id="IEq81_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq81.gif"/>
      </alternatives>
     </inline-formula>
     is the sigmoid function. The task is thus formulated as distinguishing the functionally similar gene pairs
     <inline-formula id="IEq82">
      <alternatives>
       <math id="IEq82_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           v
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq82_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u,{v})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq82.gif"/>
      </alternatives>
     </inline-formula>
     from functionally dissimilar gene pairs
     <inline-formula id="IEq83">
      <alternatives>
       <math id="IEq83_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           u
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           z
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq83_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u,{z})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq83.gif"/>
      </alternatives>
     </inline-formula>
     through optimizing their embeddings
     <inline-formula id="IEq84">
      <alternatives>
       <math id="IEq84_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         x
        </mi>
       </math>
       <tex-math id="IEq84_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{x}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq84.gif"/>
      </alternatives>
     </inline-formula>
     .
    </p>
    <p id="Par38">
     The method is applied to two kinds of functional information to get two 256-dimension embeddings of each gene. For a gene
     <italic>
      u
     </italic>
     , we concatenate its two embeddings,
     <inline-formula id="IEq85">
      <alternatives>
       <math id="IEq85_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           G
          </mi>
          <mi>
           O
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq85_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{u}^{{GO}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq85.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq86">
      <alternatives>
       <math id="IEq86_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           R
          </mi>
          <mi>
           N
          </mi>
          <mi>
           A
          </mi>
          <mo>
           −
          </mo>
          <mi>
           s
          </mi>
          <mi>
           e
          </mi>
          <mi>
           q
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq86_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{u}^{{RNA}-{seq}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq86.gif"/>
      </alternatives>
     </inline-formula>
     , as a joint vector representation
     <inline-formula id="IEq87">
      <alternatives>
       <math id="IEq87_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
       </math>
       <tex-math id="IEq87_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{u}=$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq87.gif"/>
      </alternatives>
     </inline-formula>
     [
     <inline-formula id="IEq88">
      <alternatives>
       <math id="IEq88_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           G
          </mi>
          <mi>
           O
          </mi>
         </mrow>
        </msubsup>
        <mo>
         ,
        </mo>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           R
          </mi>
          <mi>
           N
          </mi>
          <mi>
           A
          </mi>
          <mo>
           −
          </mo>
          <mi>
           s
          </mi>
          <mi>
           e
          </mi>
          <mi>
           q
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq88_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{u}^{{GO}},{{{{{{\bf{x}}}}}}}_{u}^{{RNA}-{seq}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq88.gif"/>
      </alternatives>
     </inline-formula>
     ].
    </p>
   </sec>
   <sec id="Sec13">
    <title>
     Embeddings of gene signatures
    </title>
    <p id="Par39">
     Due to stochastics in biological signals and different choices of parameters in data preprocessing steps
     <sup>
      <xref ref-type="bibr" rid="CR1">
       1
      </xref>
     </sup>
     , “noise genes,” which are genes that do not directly associate with the pathways underlying the phenotype of interest, may be included in the discovered gene set (non-pathway genes in Fig.
     <xref ref-type="fig" rid="Fig1">
      1a
     </xref>
     ). We thus compute the consensus embedding by a linear combination of the embeddings of genes in the set, which are assigned different weights. Specifically, for a given gene
     <italic>
      u
     </italic>
     in an input gene set
     <italic>
      G
     </italic>
     , we compute its average similarities with other genes within the set based on two kinds of embeddings, denoted as:
     <disp-formula id="Equ6">
      <label>
       6
      </label>
      <alternatives>
       <math id="Equ6_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           G
          </mi>
          <mi>
           O
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           G
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
         </mrow>
        </mfrac>
        <munder>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           v
          </mi>
          <mo>
           ∈
          </mo>
          <mi>
           G
          </mi>
         </mrow>
        </munder>
        <mi>
         cos
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             u
            </mi>
           </mrow>
           <mrow>
            <mi>
             G
            </mi>
            <mi>
             O
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
           </mrow>
           <mrow>
            <mi>
             G
            </mi>
            <mi>
             O
            </mi>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ6_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{u}^{{GO}}=\frac{1}{{{{{{\rm{|}}}}}}G{{{{{\rm{|}}}}}}}\mathop{\sum}\limits_{v\in G}\cos \left({{{{{{\bf{x}}}}}}}_{u}^{{GO}},{{{{{{\bf{x}}}}}}}_{v}^{{GO}}\right),$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ6.gif"/>
      </alternatives>
     </disp-formula>
     <disp-formula id="Equ7">
      <label>
       7
      </label>
      <alternatives>
       <math id="Equ7_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           R
          </mi>
          <mi>
           N
          </mi>
          <mi>
           A
          </mi>
          <mo>
           −
          </mo>
          <mi>
           s
          </mi>
          <mi>
           e
          </mi>
          <mi>
           q
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           G
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
         </mrow>
        </mfrac>
        <munder>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           v
          </mi>
          <mo>
           ∈
          </mo>
          <mi>
           G
          </mi>
         </mrow>
        </munder>
        <mi>
         cos
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             u
            </mi>
           </mrow>
           <mrow>
            <mi>
             R
            </mi>
            <mi>
             N
            </mi>
            <mi>
             A
            </mi>
            <mo>
             −
            </mo>
            <mi>
             s
            </mi>
            <mi>
             e
            </mi>
            <mi>
             q
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
           </mrow>
           <mrow>
            <mi>
             R
            </mi>
            <mi>
             N
            </mi>
            <mi>
             A
            </mi>
            <mo>
             −
            </mo>
            <mi>
             s
            </mi>
            <mi>
             e
            </mi>
            <mi>
             q
            </mi>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ7_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{u}^{{RNA}-{seq}}=\frac{1}{{{{{{\rm{|}}}}}}G{{{{{\rm{|}}}}}}}\mathop{\sum}\limits_{v\in G}\cos \left({{{{{{\bf{x}}}}}}}_{u}^{{RNA}-{seq}},{{{{{{\bf{x}}}}}}}_{v}^{{RNA}-{seq}}\right),$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ7.gif"/>
      </alternatives>
     </disp-formula>
     where
     <italic>
      cos
     </italic>
     is the cosine similarity.
     <inline-formula id="IEq89">
      <alternatives>
       <math id="IEq89_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           G
          </mi>
          <mi>
           O
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq89_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{u}^{{GO}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq89.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq90">
      <alternatives>
       <math id="IEq90_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           R
          </mi>
          <mi>
           N
          </mi>
          <mi>
           A
          </mi>
          <mo>
           −
          </mo>
          <mi>
           s
          </mi>
          <mi>
           e
          </mi>
          <mi>
           q
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq90_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{u}^{{RNA}-{seq}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq90.gif"/>
      </alternatives>
     </inline-formula>
     are then Z-score-normalized against the similarity distribution observed between the gene
     <italic>
      u
     </italic>
     and all the other genes in the genome, denoted as
     <inline-formula id="IEq91">
      <alternatives>
       <math id="IEq91_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           z
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           G
          </mi>
          <mi>
           O
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq91_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{u}^{{GO}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq91.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq92">
      <alternatives>
       <math id="IEq92_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           z
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
         <mrow>
          <mi>
           R
          </mi>
          <mi>
           N
          </mi>
          <mi>
           A
          </mi>
          <mo>
           −
          </mo>
          <mi>
           s
          </mi>
          <mi>
           e
          </mi>
          <mi>
           q
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq92_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{u}^{{RNA}-{seq}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq92.gif"/>
      </alternatives>
     </inline-formula>
     . The weight of gene
     <italic>
      u
     </italic>
     in the gene set
     <italic>
      G
     </italic>
     is then limited to the range [0, 1], determined by
     <inline-formula id="IEq93">
      <alternatives>
       <math id="IEq93_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           w
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <mi>
         min
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           max
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msubsup>
             <mrow>
              <mi>
               z
              </mi>
             </mrow>
             <mrow>
              <mi>
               u
              </mi>
             </mrow>
             <mrow>
              <mi>
               G
              </mi>
              <mi>
               O
              </mi>
             </mrow>
            </msubsup>
            <mo>
             ,
            </mo>
            <msubsup>
             <mrow>
              <mi>
               z
              </mi>
             </mrow>
             <mrow>
              <mi>
               u
              </mi>
             </mrow>
             <mrow>
              <mi>
               R
              </mi>
              <mi>
               N
              </mi>
              <mi>
               A
              </mi>
              <mo>
               −
              </mo>
              <mi>
               s
              </mi>
              <mi>
               e
              </mi>
              <mi>
               q
              </mi>
             </mrow>
            </msubsup>
            <mo>
             ,
            </mo>
            <mn>
             0
            </mn>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           ,
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq93_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{u}=\min (\max ({z}_{u}^{{GO}},{z}_{u}^{{RNA}-{seq}},0),1)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq93.gif"/>
      </alternatives>
     </inline-formula>
     , and the consensus embedding is computed as
     <inline-formula id="IEq94">
      <alternatives>
       <math id="IEq94_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           G
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mo>
           ∣
          </mo>
          <mi>
           G
          </mi>
          <mo>
           ∣
          </mo>
         </mrow>
        </mfrac>
        <msub>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
          <mo>
           ∈
          </mo>
          <mi>
           G
          </mi>
         </mrow>
        </msub>
        <msub>
         <mrow>
          <mi>
           w
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
        <mo>
         *
        </mo>
        <msub>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           u
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq94_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{G}=\frac{1}{{|G|}}\mathop{\sum}\nolimits_{u\in G}{w}_{u}*{{{{{{\bf{x}}}}}}}_{u}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq94.gif"/>
      </alternatives>
     </inline-formula>
     , by which the impact of outlier genes in the set will be reduced. This aggregation scheme is conceptually similar to the self-attention idea that recently gained popularity in deep learning
     <sup>
      <xref ref-type="bibr" rid="CR76">
       76
      </xref>
     </sup>
     ; however, we used rule-based aggregation instead of a transformer neural network here because the trained transformer will only be specific to the particular training set whereas the rules crafted here can be generalized to other bioinformatics applications relying on gene set signatures.
    </p>
    <p id="Par40">
     The weight values of genes in most gene signatures of L1000 come from two types of information, while in a small portion of gene signatures, the gene weights are dominated by one type of information (Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      4
     </xref>
     ), which illustrates the complementary role of the two types of information. Intriguingly, gene signatures where RNA-seq representation dominates the weight values may suggest perturbations in pathways that are not yet discovered and captured by Gene Ontology (GO).
    </p>
   </sec>
   <sec id="Sec14">
    <title>
     Statistical analysis
    </title>
    <sec id="Sec15">
     <title>
      t-SNE projection
     </title>
     <p id="Par41">
      Given a gene associated with a GO process
      <italic>
       G
      </italic>
      , we compute the mean
      <italic>
       µ
      </italic>
      and the standard error
      <italic>
       δ
      </italic>
      for its one-nearest neighbor (1-NN) to share the same GO process.
      <italic>
       Z
      </italic>
      -score is defined as (
      <italic>
       µ
      </italic>
      −
      <italic>
       µ
      </italic>
      <sub>
       0
      </sub>
      )/
      <italic>
       δ
      </italic>
      , where
      <italic>
       µ
      </italic>
      <sub>
       0
      </sub>
      is the percentage of genes in the genome that associated with
      <italic>
       G
      </italic>
      . For example, among the 2476 genes associated with “immune system process”, the average fraction of their 1-NNs to be also associated with the same process is 0.57 ± 0.01, which is higher than the probability that the “immune system process” occurs by chance (
      <italic>
       µ
      </italic>
      <sub>
       0
      </sub>
      = 0.14) with a Z- score of 43. All four GO processes examined in Fig.
      <xref ref-type="fig" rid="Fig1">
       1b
      </xref>
      have
      <italic>
       p
      </italic>
      -values &lt; 1
      <sup>
       −100
      </sup>
      .
     </p>
    </sec>
    <sec id="Sec16">
     <title>
      Confirmation rates
     </title>
     <p id="Par42">
      If a confirmation rate
      <italic>
       R
      </italic>
      <sub>
       c
      </sub>
      was calculated based on
      <italic>
       n
      </italic>
      samples, its standard error is estimates as
      <inline-formula id="IEq95">
       <alternatives>
        <math id="IEq95_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <msqrt>
          <mrow>
           <msub>
            <mrow>
             <mi>
              R
             </mi>
            </mrow>
            <mrow>
             <mi>
              c
             </mi>
            </mrow>
           </msub>
           <mrow>
            <mo>
             (
            </mo>
            <mrow>
             <mn>
              1
             </mn>
             <mo>
              −
             </mo>
             <msub>
              <mrow>
               <mi>
                R
               </mi>
              </mrow>
              <mrow>
               <mi>
                c
               </mi>
              </mrow>
             </msub>
            </mrow>
            <mo>
             )
            </mo>
           </mrow>
           <mo>
            /
           </mo>
           <mi>
            n
           </mi>
          </mrow>
         </msqrt>
        </math>
        <tex-math id="IEq95_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{{R}_{c}(1-{R}_{c})/n}$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq95.gif"/>
       </alternatives>
      </inline-formula>
      . This applies to Fig.
      <xref ref-type="fig" rid="Fig5">
       5a–b
      </xref>
      and Supplementary Fig.
      <xref ref-type="supplementary-material" rid="MOESM1">
       10
      </xref>
      .
     </p>
    </sec>
   </sec>
   <sec id="Sec17">
    <title>
     The simulation of experimental gene signatures
    </title>
    <p id="Par43">
     For a given pathway, we generated three gene sets,
     <inline-formula id="IEq96">
      <alternatives>
       <math id="IEq96_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq96_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq96.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq97">
      <alternatives>
       <math id="IEq97_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq97_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq97.gif"/>
      </alternatives>
     </inline-formula>
     , and
     <inline-formula id="IEq98">
      <alternatives>
       <math id="IEq98_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq98_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{bg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq98.gif"/>
      </alternatives>
     </inline-formula>
     , each with 100 genes.
     <inline-formula id="IEq99">
      <alternatives>
       <math id="IEq99_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq99_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq99.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq100">
      <alternatives>
       <math id="IEq100_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq100_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq100.gif"/>
      </alternatives>
     </inline-formula>
     were independently generated foreground gene sets, both containing
     <inline-formula id="IEq101">
      <alternatives>
       <math id="IEq101_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq101_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq101.gif"/>
      </alternatives>
     </inline-formula>
     genes randomly sampled from pathway-associated genes and the remaining genes were uncorrelated. Thus
     <inline-formula id="IEq102">
      <alternatives>
       <math id="IEq102_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq102_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq102.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq103">
      <alternatives>
       <math id="IEq103_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq103_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq103.gif"/>
      </alternatives>
     </inline-formula>
     simulated experimentally derived gene sets that resulted from two perturbagens co-targeting a common underlying pathway, where
     <inline-formula id="IEq104">
      <alternatives>
       <math id="IEq104_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq104_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq104.gif"/>
      </alternatives>
     </inline-formula>
     controlled the level of pathway enrichment, with smaller
     <inline-formula id="IEq105">
      <alternatives>
       <math id="IEq105_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         λ
        </mi>
       </math>
       <tex-math id="IEq105_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq105.gif"/>
      </alternatives>
     </inline-formula>
     representing weaker pathway signals (pathway
     <inline-formula id="IEq106">
      <alternatives>
       <math id="IEq106_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         W
        </mi>
       </math>
       <tex-math id="IEq106_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq106.gif"/>
      </alternatives>
     </inline-formula>
     in Fig.
     <xref ref-type="fig" rid="Fig1">
      1a
     </xref>
     ).
     <inline-formula id="IEq107">
      <alternatives>
       <math id="IEq107_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq107_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{bg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq107.gif"/>
      </alternatives>
     </inline-formula>
     was a randomly generated background gene set. The distributions of cosine similarity between gene set embeddings were computed between the foreground-foreground pairs (
     <inline-formula id="IEq108">
      <alternatives>
       <math id="IEq108_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq108_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq108.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq109">
      <alternatives>
       <math id="IEq109_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq109_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq109.gif"/>
      </alternatives>
     </inline-formula>
     ) and foreground-background pairs (
     <inline-formula id="IEq110">
      <alternatives>
       <math id="IEq110_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq110_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{fg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq110.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq111">
      <alternatives>
       <math id="IEq111_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           S
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           g
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq111_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{{bg}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq111.gif"/>
      </alternatives>
     </inline-formula>
     ).
    </p>
   </sec>
   <sec id="Sec18">
    <title>
     Siamese neural network architecture and balanced training
    </title>
    <p id="Par44">
     The Siamese neural network is a binary classifier that takes compound gene set embedding and shRNA/cDNA gene set embedding as a paired input and outputs the probability that the input pair are co-targeting. The neural network contains two components described as follows:
    </p>
    <sec id="Sec19">
     <title>
      Siamese feature extraction component
     </title>
     <p id="Par45">
      Due to the symmetric roles of two gene sets, we designed a Siamese neural network component
      <sup>
       <xref ref-type="bibr" rid="CR77">
        77
       </xref>
      </sup>
      that uses the same weights to process and extract hidden features from the compound gene signature embedding and shRNA/cDNA gene signature embedding by a single layer fully connected neural network:
      <disp-formula id="Equ8">
       <label>
        8
       </label>
       <alternatives>
        <math id="Equ8_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>
          D
         </mi>
         <mfenced close=")" open="(">
          <mrow>
           <mi mathvariant="bold">
            x
           </mi>
          </mrow>
         </mfenced>
         <mo>
          =
         </mo>
         <msub>
          <mrow>
           <mi>
            D
           </mi>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
           <mi>
            s
           </mi>
           <mi>
            e
           </mi>
          </mrow>
          <mrow>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mfenced close=")" open="(">
          <mrow>
           <mi mathvariant="bold">
            x
           </mi>
          </mrow>
         </mfenced>
         <mo>
          ,
         </mo>
        </math>
        <tex-math id="Equ8_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left({{{{{\bf{x}}}}}}\right)={{Dense}}_{1}\left({{{{{\bf{x}}}}}}\right),$$\end{document}
        </tex-math>
        <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ8.gif"/>
       </alternatives>
      </disp-formula>
      where
      <inline-formula id="IEq112">
       <alternatives>
        <math id="IEq112_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <mi mathvariant="bold">
          x
         </mi>
        </math>
        <tex-math id="IEq112_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{x}}}}}}$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq112.gif"/>
       </alternatives>
      </inline-formula>
      is the input FRoGS gene signature embedding. Following a standard operation for modeling the symmetric relations of two inputs
      <sup>
       <xref ref-type="bibr" rid="CR78">
        78
       </xref>
       ,
       <xref ref-type="bibr" rid="CR79">
        79
       </xref>
       –
       <xref ref-type="bibr" rid="CR80">
        80
       </xref>
      </sup>
      , the outputs are element-wise multiplied as
      <inline-formula id="IEq113">
       <alternatives>
        <math id="IEq113_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>
          D
         </mi>
         <mrow>
          <mo>
           (
          </mo>
          <mrow>
           <msub>
            <mrow>
             <mi mathvariant="bold">
              x
             </mi>
            </mrow>
            <mrow>
             <mi>
              c
             </mi>
             <mi>
              p
             </mi>
             <mi>
              d
             </mi>
            </mrow>
           </msub>
          </mrow>
          <mo>
           )
          </mo>
         </mrow>
         <mo>
          ⊙
         </mo>
         <mi>
          D
         </mi>
         <mrow>
          <mo>
           (
          </mo>
          <mrow>
           <msub>
            <mrow>
             <mi mathvariant="bold">
              x
             </mi>
            </mrow>
            <mrow>
             <mi>
              g
             </mi>
             <mi>
              e
             </mi>
             <mi>
              n
             </mi>
             <mi>
              e
             </mi>
            </mrow>
           </msub>
          </mrow>
          <mo>
           )
          </mo>
         </mrow>
        </math>
        <tex-math id="IEq113_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D({{{{{{\bf{x}}}}}}}_{cpd})\odot D({{{{{{\bf{x}}}}}}}_{gene})$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq113.gif"/>
       </alternatives>
      </inline-formula>
      and fed into the classification component, which is a binary operation that takes in two vectors of the same dimensions and returns a vector of the multiplied corresponding elements.
     </p>
    </sec>
    <sec id="Sec20">
     <title>
      Classification component
     </title>
     <p id="Par46">
      We built a two-layer fully connected neural network as the classifier. The sigmoid activation function is applied in the last layer, which produces a scalar output in the range [0, 1]:
      <disp-formula id="Equ9">
       <label>
        9
       </label>
       <alternatives>
        <math id="Equ9_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>
          o
         </mi>
         <mspace width="0.25em"/>
         <mo>
          =
         </mo>
         <mspace width="0.25em"/>
         <mi>
          D
         </mi>
         <mi>
          e
         </mi>
         <mi>
          n
         </mi>
         <mi>
          s
         </mi>
         <msub>
          <mrow>
           <mi>
            e
           </mi>
          </mrow>
          <mrow>
           <mn>
            3
           </mn>
          </mrow>
         </msub>
         <mrow>
          <mo>
           (
          </mo>
          <mrow>
           <mi>
            D
           </mi>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
           <mi>
            s
           </mi>
           <msub>
            <mrow>
             <mi>
              e
             </mi>
            </mrow>
            <mrow>
             <mn>
              2
             </mn>
            </mrow>
           </msub>
           <mrow>
            <mo>
             (
            </mo>
            <mrow>
             <mi>
              D
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mrow>
               <msub>
                <mrow>
                 <mi mathvariant="bold">
                  x
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  c
                 </mi>
                 <mi>
                  p
                 </mi>
                 <mi>
                  d
                 </mi>
                </mrow>
               </msub>
              </mrow>
              <mo>
               )
              </mo>
             </mrow>
             <mo>
              ⊙
             </mo>
             <mi>
              D
             </mi>
             <mrow>
              <mo>
               (
              </mo>
              <mrow>
               <msub>
                <mrow>
                 <mi mathvariant="bold">
                  x
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  g
                 </mi>
                 <mi>
                  e
                 </mi>
                 <mi>
                  n
                 </mi>
                 <mi>
                  e
                 </mi>
                </mrow>
               </msub>
              </mrow>
              <mo>
               )
              </mo>
             </mrow>
            </mrow>
            <mo>
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           )
          </mo>
         </mrow>
         <mo>
          ,
         </mo>
        </math>
        <tex-math id="Equ9_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o\,=\,Dens{e}_{3}(Dens{e}_{2}(D({{{{{{\bf{x}}}}}}}_{cpd}) \odot D({{{{{{\bf{x}}}}}}}_{gene}))),$$\end{document}
        </tex-math>
        <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ9.gif"/>
       </alternatives>
      </disp-formula>
     </p>
     <p id="Par47">
      We use the cross-entropy loss for the training of the neural network:
      <disp-formula id="Equ10">
       <label>
        10
       </label>
       <alternatives>
        <math id="Equ10_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <mo>
          −
         </mo>
         <msub>
          <mrow>
           <mo mathsize="big">
            ∑
           </mo>
          </mrow>
          <mrow>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
         <mfenced close=")" open="(">
          <mrow>
           <msub>
            <mrow>
             <mi>
              y
             </mi>
            </mrow>
            <mrow>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
           <mi>
            log
           </mi>
           <msub>
            <mrow>
             <mi>
              o
             </mi>
            </mrow>
            <mrow>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
           <mo>
            +
           </mo>
           <mfenced close=")" open="(">
            <mrow>
             <msub>
              <mrow>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <mi>
                y
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
              </mrow>
             </msub>
            </mrow>
           </mfenced>
           <mi>
            log
           </mi>
           <mfenced close=")" open="(">
            <mrow>
             <mn>
              1
             </mn>
             <mo>
              −
             </mo>
             <msub>
              <mrow>
               <mi>
                o
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
              </mrow>
             </msub>
            </mrow>
           </mfenced>
          </mrow>
         </mfenced>
         <mo>
          ,
         </mo>
        </math>
        <tex-math id="Equ10_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-{\sum }_{i}\left({y}_{i}\log {o}_{i}+\left({1-y}_{i}\right)\log \left(1-{o}_{i}\right)\right),$$\end{document}
        </tex-math>
        <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ10.gif"/>
       </alternatives>
      </disp-formula>
      where the binary label
      <inline-formula id="IEq114">
       <alternatives>
        <math id="IEq114_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <msub>
          <mrow>
           <mi>
            y
           </mi>
          </mrow>
          <mrow>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </math>
        <tex-math id="IEq114_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{i}$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq114.gif"/>
       </alternatives>
      </inline-formula>
      indicates whether the input gene is the true target of the input compound.
     </p>
     <p id="Par48">
      The quantities of neurons in the hidden layers are hyperparameters. In our experiment, we used 2048 and 512 neurons for the
      <inline-formula id="IEq115">
       <alternatives>
        <math id="IEq115_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <msub>
          <mrow>
           <mi>
            D
           </mi>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
           <mi>
            s
           </mi>
           <mi>
            e
           </mi>
          </mrow>
          <mrow>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </math>
        <tex-math id="IEq115_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{Dense}}_{1}$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq115.gif"/>
       </alternatives>
      </inline-formula>
      and
      <inline-formula id="IEq116">
       <alternatives>
        <math id="IEq116_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <msub>
          <mrow>
           <mi>
            D
           </mi>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
           <mi>
            s
           </mi>
           <mi>
            e
           </mi>
          </mrow>
          <mrow>
           <mn>
            2
           </mn>
          </mrow>
         </msub>
        </math>
        <tex-math id="IEq116_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{Dense}}_{2}$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq116.gif"/>
       </alternatives>
      </inline-formula>
      layers, respectively. A balanced training strategy was applied to train a model that is not biased towards popularly known targets. Specifically, if a gene appears in a positive pair, we sample a compound that is not annotated to target this gene to form a negative pair with it. That is, for each gene, the ratio of positive to negative pairs is 1:1. This is critical for ensuring the generalization of the model as detailed in Supplementary Note
      <xref ref-type="supplementary-material" rid="MOESM1">
       2
      </xref>
      .
     </p>
     <p id="Par49">
      The training and test set were split by compounds, where compounds with known targets were placed into the training set while the other compounds profiled in L1000 were placed into the test set. Neural network models were trained for pairs of compound and shRNA signatures, as well as pairs of compound and cDNA signatures. In the model involving compound and shRNA signatures, the positive dataset comprised 2308 compound-target pairs for 1424 compounds in 12 cell lines, resulting in 12,332 positive gene signature pairs when considering the different combinations of compounds, targets, and cell lines. In the case of the model with compound and cDNA signatures, the positive dataset consisted of 1473 compound-target pairs for 1061 compounds in 10 cell lines, resulting in 9800 positive gene signature pairs across different combinations. The number of negative gene signature pairs was sampled to match the number of positive pairs for each model. With the trained models, we performed inference for compound-target gene pairs using cDNA gene signatures and shRNA gene signatures respectively for 20,306 compounds and 4784 genes across 13 cell lines, resulting in predictions for a total of 393,525,524 combinations, which contains 73,380,830 unique compound-target gene pairs. Performance of the different models was evaluated using fivefold cross-validation on the training set. For each evaluation, we trained three models on the same data, and the average value of the predicted probabilities from the three models was computed for each
      <inline-formula id="IEq117">
       <alternatives>
        <math id="IEq117_Math" xmlns="http://www.w3.org/1998/Math/MathML">
         <mfenced close=")" open="(">
          <mrow>
           <mi>
            c
           </mi>
           <mo>
            ,
           </mo>
           <mspace width="0.25em"/>
           <mi>
            g
           </mi>
          </mrow>
         </mfenced>
        </math>
        <tex-math id="IEq117_TeX">
         \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(c,\, {g}\right)$$\end{document}
        </tex-math>
        <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq117.gif"/>
       </alternatives>
      </inline-formula>
      pair and used for target ranking. Each model underwent training for 60 epochs. For models using shRNA signatures, the average training time for each model was 93 s across five models. For models using cDNA signatures, the average training time was 82 s across five models. A K80 GPU was used for model training and inference.
     </p>
    </sec>
   </sec>
   <sec id="Sec21">
    <title>
     Similarity calculation
    </title>
    <p id="Par50">
     The structure similarity score of a compound pair,
     <italic>
      s
     </italic>
     , was calculated based on the Tanimoto score using their ECFP4 chemical fingerprints
     <sup>
      <xref ref-type="bibr" rid="CR81">
       81
      </xref>
     </sup>
     . The mapping between
     <italic>
      s
     </italic>
     and SAR probability value,
     <italic>
      p
     </italic>
     (
     <italic>
      s
     </italic>
     ), was computed based on how often compound pairs with the given similarity were found co-active in the same biological assay according to Novartis’ in-house database (Supplementary Note
     <xref ref-type="supplementary-material" rid="MOESM1">
      4
     </xref>
     ). This mapping is also labeled as Model
     <italic>
      S
     </italic>
     <sub>
      SAR
     </sub>
     . For compounds with activity profiles including pQSAR, NCI
     <sub>
      60
     </sub>
     , and PSP, the Pearson correlation coefficient across their profile vectors,
     <italic>
      q
     </italic>
     , was used as the similarity score.
    </p>
   </sec>
   <sec id="Sec22">
    <title>
     Consensus input gene set signatures
    </title>
    <p id="Par51">
     The expansive collection of gene signatures associated with the L1000 dataset is based on treatments using genomic reagents (both loss-of-function shRNA and gain-of-function cDNA treatments for each gene
     <italic>
      g
     </italic>
     ) and compounds
     <italic>
      c
     </italic>
     dosed at multiple concentrations and durations screened across multiple cell lines. Therefore, given a specific compound-target pair, (
     <italic>
      c
     </italic>
     ,
     <italic>
      g
     </italic>
     ), multiple choices of input signatures exist for
     <italic>
      c
     </italic>
     and
     <italic>
      g
     </italic>
     , individually as well as combinatorically. We reduced this ambiguity by first consolidating all versions of compound signatures, retaining only one exemplar gene set signature per cell line that had the highest Transcriptional Activity Score (TAS)
     <sup>
      <xref ref-type="bibr" rid="CR1">
       1
      </xref>
     </sup>
     . For model input, only the shRNA/cDNA signature
     <italic>
      g
     </italic>
     acquired under the same cell line was paired with each compound to form a (
     <italic>
      c
     </italic>
     ,
     <italic>
      g
     </italic>
     ) vector pair.
    </p>
   </sec>
   <sec id="Sec23">
    <title>
     Consensus predicted target ranking
    </title>
    <p id="Par52">
     For L1000-based target prediction, an established convention in the field for algorithm performance comparison is to calculate the percentage of compounds having their known target recalled, when a certain top percentage of target candidates is considered. We thus chose to combine multiple target prediction lists in a way that best reflected this practice. A target list for a given compound contained
     <italic>
      n
     </italic>
     candidate genes that were first sorted based on their decreasing probability scores, and then their rank order
     <italic>
      O
     </italic>
     <sub>
      <italic>
       g
      </italic>
     </sub>
     was identified and normalized as
     <italic>
      O
     </italic>
     <sub>
      g
     </sub>
     /
     <italic>
      n
     </italic>
     . All target candidates for the same compound were then pooled, genes were sorted based on their normalized ranks, and the first occurrence of a candidate
     <italic>
      g
     </italic>
     was retained yielding a unique consensus target list for compound
     <italic>
      c
     </italic>
     . This rank-based multi-list aggregation method was found to be more effective in target recall with value 0.36 at the top 5% compared to 0.12 obtained by pooling and sorting gene candidates based on their model-predicted probability scores.
    </p>
   </sec>
   <sec id="Sec24">
    <title>
     Logistic regression modeling
    </title>
    <p id="Par53">
     Given a feature vector
     <inline-formula id="IEq118">
      <alternatives>
       <math id="IEq118_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq118_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{i}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq118.gif"/>
      </alternatives>
     </inline-formula>
     , logistic regression (LR) model estimates the probability of the record being positive as:
     <disp-formula id="Equ11">
      <label>
       11
      </label>
      <alternatives>
       <math id="Equ11_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         p
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mn>
           1
          </mn>
          <mo>
           +
          </mo>
          <mi>
           exp
          </mi>
          <mfenced close="}" open="{">
           <mrow>
            <mo>
             −
            </mo>
            <mi>
             b
            </mi>
            <mo>
             −
            </mo>
            <mi mathvariant="bold">
             w
            </mi>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
         </mrow>
        </mfrac>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ11_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({{{{{{\bf{x}}}}}}}_{i}\right)=\frac{1}{1+\exp \left\{-b-{{{{{\bf{w}}}}}}{{{{{{\bf{x}}}}}}}_{i}\right\}},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ11.gif"/>
      </alternatives>
     </disp-formula>
     where
     <bold>
      w
     </bold>
     is a weight vector and
     <italic>
      b
     </italic>
     is a bias. Feature definition depends on the data source. For compound-target associations predicted by our deep learning model,
     <italic>
      r
     </italic>
     (
     <italic>
      c
     </italic>
     ,
     <italic>
      g
     </italic>
     ) is the normalized consensus rank of gene
     <italic>
      g
     </italic>
     in the compound’s putative target list, and feature
     <italic>
      x
     </italic>
     is defined as the odd ratio:
     <disp-formula id="Equ12">
      <label>
       12
      </label>
      <alternatives>
       <math id="Equ12_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         x
        </mi>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           r
          </mi>
         </mrow>
        </mfrac>
        <mo>
         .
        </mo>
       </math>
       <tex-math id="Equ12_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=\frac{1-r}{r}.$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ12.gif"/>
      </alternatives>
     </disp-formula>
    </p>
    <p id="Par54">
     For the compound activity profile matrix,
     <italic>
      q
     </italic>
     was the Pearson correlation coefficient of the pharmacological profiles between a query compound
     <italic>
      c
     </italic>
     and a reference compound
     <inline-formula id="IEq119">
      <alternatives>
       <math id="IEq119_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi>
           c
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq119_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq119.gif"/>
      </alternatives>
     </inline-formula>
     . Considering multiple reference compounds {
     <inline-formula id="IEq120">
      <alternatives>
       <math id="IEq120_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           c
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           ′
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq120_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i}^{{\prime} }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq120.gif"/>
      </alternatives>
     </inline-formula>
     } may exist for a target
     <italic>
      g
     </italic>
     , the maximum value of
     <italic>
      q
     </italic>
     was used as the feature:
     <disp-formula id="Equ13">
      <label>
       13
      </label>
      <alternatives>
       <math id="Equ13_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         x
        </mi>
        <mo>
         =
        </mo>
        <munder>
         <mrow>
          <mi>
           max
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
        </munder>
        <mi>
         q
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <mi>
           c
          </mi>
          <mo>
           ,
          </mo>
          <msubsup>
           <mrow>
            <mi>
             c
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mo>
             ′
            </mo>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
        <mo>
         .
        </mo>
       </math>
       <tex-math id="Equ13_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=\mathop{\max }\limits_{i}q\left(c,{c}_{i}^{{\prime} }\,\right).$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ13.gif"/>
      </alternatives>
     </disp-formula>
    </p>
    <p id="Par55">
     When NCI
     <sub>
      60
     </sub>
     or PSP activity profiles were used for modeling,
     <italic>
      q
     </italic>
     refers to the Pearson correlations in the corresponding activity matrices. In the combined Model,
     <inline-formula id="IEq121">
      <alternatives>
       <math id="IEq121_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq121_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{x}}}}}}}_{i}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq121.gif"/>
      </alternatives>
     </inline-formula>
     consists of two logits computed from Model
     <italic>
      L
     </italic>
     and Model pQSAR, respectively. Distinct from the standard LR model, we require weight
     <inline-formula id="IEq122">
      <alternatives>
       <math id="IEq122_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         w
        </mi>
       </math>
       <tex-math id="IEq122_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{w}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq122.gif"/>
      </alternatives>
     </inline-formula>
     to be non-negative to ensure the monotonic relationship between
     <italic>
      p
     </italic>
     and
     <bold>
      x
     </bold>
     , ensuring compliance with the biological guilt-by-association (GBA) principle.
    </p>
    <p id="Par56">
     The LR cost is defined as the combination of cross entropy and an
     <inline-formula id="IEq123">
      <alternatives>
       <math id="IEq123_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi>
           L
          </mi>
         </mrow>
         <mrow>
          <mn>
           2
          </mn>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq123_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{2}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq123.gif"/>
      </alternatives>
     </inline-formula>
     regularization term with sampling weighting:
     <disp-formula id="Equ14">
      <label>
       14
      </label>
      <alternatives>
       <math id="Equ14_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi class="MJX-tex-caligraphic" mathvariant="script">
         L
        </mi>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <msub>
           <mrow>
            <mi>
             n
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfrac>
        <munderover accent="false" accentunder="false">
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <msub>
           <mrow>
            <mi>
             n
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msub>
         </mrow>
        </munderover>
        <mspace width="0.25em"/>
        <mi>
         log
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           p
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
             </mrow>
            </msub>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         +
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <msub>
           <mrow>
            <mi>
             n
            </mi>
           </mrow>
           <mrow>
            <mi>
             n
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfrac>
        <munderover accent="false" accentunder="false">
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <msub>
           <mrow>
            <mi>
             n
            </mi>
           </mrow>
           <mrow>
            <mi>
             n
            </mi>
           </mrow>
          </msub>
         </mrow>
        </munderover>
        <mspace width="0.25em"/>
        <mi>
         log
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <mi>
           p
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
             </mrow>
            </msub>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         +
        </mo>
        <mi>
         λ
        </mi>
        <msup>
         <mrow>
          <mo>
           ∥
          </mo>
          <mi mathvariant="bold">
           w
          </mi>
          <mo>
           ∥
          </mo>
         </mrow>
         <mrow>
          <mn>
           2
          </mn>
         </mrow>
        </msup>
        <mo>
         ,
        </mo>
       </math>
       <tex-math id="Equ14_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal L}=\,\frac{1}{{n}_{p}}\mathop{\sum }\limits_{i=1}^{{n}_{p}}\,\log (p({{{{{{\bf{x}}}}}}}_{i}))+\frac{1}{{n}_{n}}\mathop{\sum }\limits_{i=1}^{{n}_{n}}\,\log (1-p({{{{{{\bf{x}}}}}}}_{i}))+\lambda {\Vert {{{{{\bf{w}}}}}}\Vert }^{2},$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_Equ14.gif"/>
      </alternatives>
     </disp-formula>
     where
     <italic>
      λ
     </italic>
     is the only regularization hyperparameter.
    </p>
    <p id="Par57">
     Model training used a standard nested cross-validation loop, where the inner loop searched for the optimal
     <italic>
      λ
     </italic>
     and the outer loop evaluated model performance with five-fold cross validations.
    </p>
    <p id="Par58">
     The positive training dataset consisted of 2340 (
     <inline-formula id="IEq124">
      <alternatives>
       <math id="IEq124_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq124_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq124.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq125">
      <alternatives>
       <math id="IEq125_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq125_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq125.gif"/>
      </alternatives>
     </inline-formula>
     ) pairs formed between 1438 compounds and 499 targets. A total of 5,614,766 (
     <inline-formula id="IEq126">
      <alternatives>
       <math id="IEq126_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq126_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq126.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq127">
      <alternatives>
       <math id="IEq127_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq127_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq127.gif"/>
      </alternatives>
     </inline-formula>
     ) combinations of the 1438 compounds with genes that are not annotated as targets formed the negative training dataset. During the training, we randomly sampled 231,660 negative pairs, so that the final training set consists of 1% positive labels and 99% negative labels. The positive and negative labels made equal contributions to the model training after weighting. The test dataset consisted of 67,763,724 (
     <inline-formula id="IEq128">
      <alternatives>
       <math id="IEq128_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq128_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq128.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq129">
      <alternatives>
       <math id="IEq129_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq129_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq129.gif"/>
      </alternatives>
     </inline-formula>
     ) pairs formed between 18,855 compounds and 4784 targets, which included 2433 (
     <inline-formula id="IEq130">
      <alternatives>
       <math id="IEq130_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         c
        </mi>
       </math>
       <tex-math id="IEq130_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq130.gif"/>
      </alternatives>
     </inline-formula>
     ,
     <inline-formula id="IEq131">
      <alternatives>
       <math id="IEq131_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math>
       <tex-math id="IEq131_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_46089_Article_IEq131.gif"/>
      </alternatives>
     </inline-formula>
     ) pairs formed by 509 polypharmacological compounds ( &gt; 5 targets/compound) and 507 targets. As Model
     <italic>
      L
     </italic>
     , Model pQSAR, and Model
     <italic>
      LQ
     </italic>
     contained only 2, 2, and 3 parameters, respectively, model training were robust against random seeds and only cost a few seconds.
    </p>
   </sec>
   <sec id="Sec25">
    <title>
     Imbalanced dataset correction for logistic regression models
    </title>
    <p id="Par59">
     Broad’s compound-gene dataset was highly imbalanced during the logistic regression model training, as only a small fraction was annotated as a known association and assigned positive labels, while the majority had no curation and were assigned negative labels. Performance metrics such as accuracy and area under the curve (AUC) for receiver operating characteristic (ROC) can be excessively optimistic for such imbalanced domains
     <sup>
      <xref ref-type="bibr" rid="CR82">
       82
      </xref>
     </sup>
     . Precision-recall curves reduce but do not eliminate the effect of sample imbalance. When models relying on different features were trained, the size and composition of training datasets varied due to different number of records containing missing features required by different models. Performance metrics for different models were therefore associated with different sample sizes and needed to be normalized for comparison. In model training, we always assigned sample weights, so that positive and negative labels were normalized into an effectively balanced (1:1) dataset.
    </p>
    <p id="Par60">
     Specifically, if there were
     <italic>
      n
     </italic>
     <sub>
      p
     </sub>
     positive samples and
     <italic>
      n
     </italic>
     <sub>
      n
     </sub>
     negative samples, sample weights were 1/
     <italic>
      n
     </italic>
     <sub>
      p
     </sub>
     and 1
     <italic>
      /n
     </italic>
     <sub>
      n
     </sub>
     , respectively. Sample counts for true positive (TP), false positive (FP), true negative (TN), and false negative (FN) were also corrected with the sample weights by multiplying 1/
     <italic>
      n
     </italic>
     <sub>
      p
     </sub>
     , 1/
     <italic>
      n
     </italic>
     <sub>
      n
     </sub>
     , 1/
     <italic>
      n
     </italic>
     <sub>
      n
     </sub>
     and 1/
     <italic>
      n
     </italic>
     <sub>
      p
     </sub>
     , respectively. Performance metrics-such as precision, recall, F1, Matthews Correlation Coefficient (MCC), AUC of ROC or precision-recall (PR) curve, etc., were adjusted accordingly by the same sample weighting scheme so that they characterize the model as if all training datasets were in balance. Metrics for all models studied are provided in Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     .
    </p>
   </sec>
   <sec id="Sec26">
    <title>
     Biochemical HTRF kinase activity inhibition assays
    </title>
    <p id="Par61">
     All biochemical kinase activity assays were carried out using the TR-FRET method as described by Yong et al.
     <sup>
      <xref ref-type="bibr" rid="CR83">
       83
      </xref>
     </sup>
     . Kinase reactions were conducted in white or black 1536-well untreated microplates (Greiner Bio-One; Monroe, NC) with conditions for each reaction listed in Supplementary Data
     <xref ref-type="supplementary-material" rid="MOESM7">
      4
     </xref>
     . ATP concentrations used were around the apparent ATP
     <italic>
      K
     </italic>
     <sub>
      m
     </sub>
     value for each enzyme. The enzymes were first pre-incubated in the presence of compounds for 15 min prior to the addition of the appropriate substrate and ATP to reach a final reaction volume of 4 μL and a final DMSO concentration of 0.5%. At a designated time point for each assay, the reactions were quenched by additional of equal volumes of a 200 mM EDTA solution and a HTRF detection solution, consisting of a Europium-cryptate-conjugated antibody and SA-XL665 (610SAXLB) (both from PerkinElmer; Beford, MA) diluted in a detection buffer (400 mM KF, 50 mM HEPES, pH 7.0, 0.1% BSA, 0.01% Tween20), bringing the final volume to 8 μL. For reactions using KinEASE kit and LANCE Ultra kit, the detections were done following manufacturer’s protocols. After addition of the detection reagents, the plates were incubated at RT for 1 h, then read using a PHERAstar FSX equipped with a compatible TR-FRET module (BMG Labtech; Cary, NC).
    </p>
    <p id="Par62">
     Compound activity was initially assayed with a single final concentration of 50 µM in triplicate, and the percentage of inhibition of each compound was calculated. Hits were selected for confirmation in 8-point dose-response assays in duplicate, with a top concentration of 50 µM and a 1:3 serial dilution. IC
     <sub>
      50
     </sub>
     values were defined as the inhibitor concentration at which 50% of the enzyme activity is inhibited. All compound dispensing was performed using an Echo 555 acoustic liquid handler (Beckman Coulter Life Sciences; Indianapolis, IN).
    </p>
   </sec>
   <sec id="Sec27">
    <title>
     AhR reporter gene assays and CellTiter-Glo cytotoxicity assay
    </title>
    <p id="Par63">
     HepG2-Lucia AhR (a human HepG2 hepatoma-derived cell line stably expressing the secreted Lucia luciferase reporter gene under the control of a minimal promoter coupled with the human Cyp1a1 gene’s entire regulatory sequence) was purchased from InvivoGen (San Diego, CA) with catalog code hpgl-ahr. The cell line was maintained in Gibco Minimum Essential Medium (MEM) supplemented with 10% fetal bovine serum (FBS) (Avantor; Radnor Township, PA), 1% Cytiva HyClone MEM non-essential amino acids (NEAA) 100X Solution, 1% Gibco antibiotic-antimycotic (Anti-Anti) 100X and 100µg/mL of Zeocin. All incubations were conducted at 37 °C with 5% CO
     <sub>
      2
     </sub>
     unless otherwise stated. Medium and other supplements were purchased from Thermo Fisher Scientific (Waltham, MA).
    </p>
    <p id="Par64">
     All assays were conducted in custom 1536-well, white, solid-bottom, tissue culture-treated assay plates (#789173-A, Greiner Bio-One; Monroe, NC). For the single-point primary screens, the wells were pre-spotted with 25nL of compounds in DMSO (50 µM final concentration) using an Echo 555 acoustic liquid handler (Beckman Coulter Life Sciences; Indianapolis, IN). A total of 2500 cells in a final 5 µL were seeded in each well in above described medium and supplements, except the Zeocin. The AhR reporter gene assays were carried out as both agonist and antagonist assays. For the agonist assay, plates were incubated for 24 h. For the antagonist and the cytotoxicity assay, plates were first incubated for 30 min, after which a final concentration of 15 nM of 2,3,7,8-Tetrachlorodibenzo-p-dioxin (TCDD) (AccuStandard; New Haven, CT) was added to induce reporter gene expression followed by an incubation of 24 h and 48 h, respectively. After incubation, 2.5 µL per well of a coelenterazine-based luminescence assay reagent QUANTI-Luc (InvivoGen; San Diego, CA) or CellTiter-Glo (Promega; Madison, WI) was dispensed into the plates for both reporter gene assays and the cytotoxicity assay, respectively. Luminescence signals were read on the Luminescence Plate Reader (LPR) (#1222-9001X1, GNF Systems; San Diego, CA) immediately following the QUANTI-Luc addition or after a 10 min incubation at room temperature following the CellTiter-Glo addition. Hit compounds from the single-point primary screens were selected for dose-response characterizations using the same assays and conditions described above. Compound hits were re-arrayed and pre-spotted in the format of 8-point, 1:3 serial dilution with a top final concentration of 50 µM.
    </p>
   </sec>
   <sec id="Sec28">
    <title>
     Reporting summary
    </title>
    <p id="Par65">
     Further information on research design is available in the
     <xref ref-type="supplementary-material" rid="MOESM8">
      Nature Portfolio Reporting Summary
     </xref>
     linked to this article.
    </p>
   </sec>
  </sec>
 </body>
 <back>
  <ack>
   <title>
    Acknowledgements
   </title>
   <p>
    This work was partially supported by the NIAID grants 5U19AI135972 and 75N93019C00046, DoD grant W81XWH-20-1-0270 to S.K.C.
   </p>
  </ack>
  <sec sec-type="author-contribution">
   <title>
    Author contributions
   </title>
   <p>
    H.C. developed prediction models. H.C., Y.Zhong, B.Z., F.J.K. and Y.Zhou performed data analyses. Y.W., J.H., C.J.C., J.L.W., Y.J. performed experimental validations. Y.Zhou, L.P., M.W.C., C.B. and S.K.C. conducted an initial proof-of-concept study. F.J.K., S.K.C., T.J., J.J. and Y.Zhou directed the project. H.C., F.J.K. and Y.Zhou wrote the manuscript.
   </p>
  </sec>
  <sec sec-type="peer-review">
   <title>
    Peer review
   </title>
   <sec id="FPar1">
    <title>
     Peer review information
    </title>
    <p id="Par66">
     <italic>
      Nature Communications
     </italic>
     thanks Slim Fourati, Anil Jegga, and Louxin Zhang for their contribution to the peer review of this work. A peer review file is available.
    </p>
   </sec>
  </sec>
  <sec sec-type="data-availability">
   <title>
    Data availability
   </title>
   <p>
    pQSAR activity dataset and PSP dataset are large-scale proprietary Novartis in-house resources, which cannot be released due to confidentiality restrictions. All other datasets were from the public domain. The level-5 perturbagen profiles for the L1000 Connectivity Map dataset were downloaded from the Gene Expression Omnibus (
    <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo">
     https://www.ncbi.nlm.nih.gov/geo
    </ext-link>
    ) under Accession IDs
    <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92742">
     GSE92742
    </ext-link>
    and
    <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE70138">
     GSE70138
    </ext-link>
    . The Broad’s compound-target annotations were extracted from the Connectivity Map website (
    <ext-link ext-link-type="uri" xlink:href="https://clue.io">
     https://clue.io
    </ext-link>
    ) using the developer API. The Reactome pathway data were downloaded from
    <ext-link ext-link-type="uri" xlink:href="https://reactome.org">
     https://reactome.org
    </ext-link>
    . Gene Ontology data were downloaded from
    <ext-link ext-link-type="uri" xlink:href="http://geneontology.org">
     http://geneontology.org
    </ext-link>
    and processed by Metascape (
    <ext-link ext-link-type="uri" xlink:href="https://metascape.org">
     https://metascape.org
    </ext-link>
    ). ARCHS4 gene expression profiles were obtained from
    <ext-link ext-link-type="uri" xlink:href="https://maayanlab.cloud/archs4">
     https://maayanlab.cloud/archs4
    </ext-link>
    with the data file link
    <ext-link ext-link-type="uri" xlink:href="https://s3.amazonaws.com/mssm-seq-matrix/human_matrix.h5">
     https://s3.amazonaws.com/mssm-seq-matrix/human_matrix.h5
    </ext-link>
    . The US National Cancer Institute 60 human tumor cell line anticancer drug screen (NCI
    <sub>
     60
    </sub>
    ) dataset were downloaded from
    <ext-link ext-link-type="uri" xlink:href="https://discover.nci.nih.gov/cellminer">
     https://discover.nci.nih.gov/cellminer
    </ext-link>
    . The experimental data for kinase binders and AhR binders can be found in Supplementary Table
    <xref ref-type="supplementary-material" rid="MOESM1">
     2
    </xref>
    –
    <xref ref-type="supplementary-material" rid="MOESM1">
     3
    </xref>
    and Supplementary Data
    <xref ref-type="supplementary-material" rid="MOESM5">
     2
    </xref>
    –
    <xref ref-type="supplementary-material" rid="MOESM6">
     3
    </xref>
    . After removing 1163 compound-target pairs that are validated only according to in-house activity database, 5133 out of the 6296 predictions with multiple lines of additional validation evidence are made available as a community resource in Supplementary Data
    <xref ref-type="supplementary-material" rid="MOESM4">
     1
    </xref>
    .
    <xref ref-type="sec" rid="Sec30">
     Source data
    </xref>
    are provided with this paper.
   </p>
  </sec>
  <sec sec-type="data-availability">
   <title>
    Code availability
   </title>
   <p>
    Custom Python code and the trained gene embedding vectors are made available at
    <ext-link ext-link-type="uri" xlink:href="https://github.com/chenhcs/FRoGS">
     https://github.com/chenhcs/FRoGS
    </ext-link>
    .
   </p>
  </sec>
  <sec sec-type="ethics-statement">
   <sec id="FPar2" sec-type="COI-statement">
    <title>
     Competing interests
    </title>
    <p id="Par67">
     The authors declare no competing interests.
    </p>
   </sec>
  </sec>
  <ref-list id="Bib1">
   <title>
    References
   </title>
   <ref-list>
    <ref id="CR1">
     <label>
      1.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Subramanian
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A next generation connectivity map: L1000 platform and the first 1,000,000 profiles
      </article-title>
      <source>
       Cell
      </source>
      <year>
       2017
      </year>
      <volume>
       171
      </volume>
      <fpage>
       1437
      </fpage>
      <lpage>
       1452.e17
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2sXhvFWmsbrE
      </pub-id>
      <pub-id pub-id-type="pmid">
       29195078
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5990023
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.cell.2017.10.049
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR2">
     <label>
      2.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Li
        </surname>
        <given-names>
         Z
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       In silico prediction of drug-target interaction networks based on drug chemical structure and protein sequences
      </article-title>
      <source>
       Sci. Rep.
      </source>
      <year>
       2017
      </year>
      <volume>
       7
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2017NatSR...711174L
      </pub-id>
      <pub-id pub-id-type="pmid">
       28894115
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5593914
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41598-017-10724-0
      </pub-id>
      <elocation-id>
       11174
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR3">
     <label>
      3.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhong
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Drug target inference by mining transcriptional data using a novel graph convolutional network framework
      </article-title>
      <source>
       Protein Cell
      </source>
      <year>
       2022
      </year>
      <volume>
       13
      </volume>
      <fpage>
       281
      </fpage>
      <lpage>
       301
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XkvFyhsA%3D%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       34677780
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1007/s13238-021-00885-0
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR4">
     <label>
      4.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Noh
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Shoemaker
        </surname>
        <given-names>
         JE
        </given-names>
       </name>
       <name>
        <surname>
         Gunawan
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Network perturbation analysis of gene transcriptional profiles reveals protein targets and mechanism of action of drugs and influenza a viral infection
      </article-title>
      <source>
       Nucleic Acids Res.
      </source>
      <year>
       2018
      </year>
      <volume>
       46
      </volume>
      <fpage>
       e34
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXitlGjurvF
      </pub-id>
      <pub-id pub-id-type="pmid">
       29325153
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5887474
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/nar/gkx1314
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR5">
     <label>
      5.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Pabon
        </surname>
        <given-names>
         NA
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Predicting protein targets for drug-like compounds using transcriptomics
      </article-title>
      <source>
       PLoS Comput. Biol.
      </source>
      <year>
       2018
      </year>
      <volume>
       14
      </volume>
      <fpage>
       e1006651
      </fpage>
      <pub-id pub-id-type="pmid">
       30532261
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6300300
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1371/journal.pcbi.1006651
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR6">
     <label>
      6.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Sawada
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Iwata
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Tabei
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Yamato
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Yamanishi
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Predicting inhibitory and activatory drug targets by chemically and genetically perturbed transcriptome signatures
      </article-title>
      <source>
       Sci. Rep.
      </source>
      <year>
       2018
      </year>
      <volume>
       8
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2018NatSR...8..156S
      </pub-id>
      <pub-id pub-id-type="pmid">
       29317676
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5760621
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41598-017-18315-9
      </pub-id>
      <elocation-id>
       156
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR7">
     <label>
      7.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Tavazoie
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Hughes
        </surname>
        <given-names>
         JD
        </given-names>
       </name>
       <name>
        <surname>
         Campbell
        </surname>
        <given-names>
         MJ
        </given-names>
       </name>
       <name>
        <surname>
         Cho
        </surname>
        <given-names>
         RJ
        </given-names>
       </name>
       <name>
        <surname>
         Church
        </surname>
        <given-names>
         GM
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Systematic determination of genetic network architecture
      </article-title>
      <source>
       Nat. Genet.
      </source>
      <year>
       1999
      </year>
      <volume>
       22
      </volume>
      <fpage>
       281
      </fpage>
      <lpage>
       285
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DyaK1MXkt1eqsbY%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       10391217
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/10343
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR8">
     <label>
      8.
     </label>
     <mixed-citation publication-type="other">
      Zar, J. H.
      <italic>
       Biostatistical Analysis
      </italic>
      .
      <italic>
       Prentice Hall New Jersey
      </italic>
      (NJ Prentice Hall, 1999).
     </mixed-citation>
    </ref>
    <ref id="CR9">
     <label>
      9.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Tripathi
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Meta- and orthogonal integration of influenza ‘oMICs’ data defines a role for UBR4 in virus budding
      </article-title>
      <source>
       Cell Host Microbe.
      </source>
      <year>
       2015
      </year>
      <volume>
       18
      </volume>
      <fpage>
       723
      </fpage>
      <lpage>
       735
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2MXhvFWlu7%2FI
      </pub-id>
      <pub-id pub-id-type="pmid">
       26651948
      </pub-id>
      <pub-id pub-id-type="pmcid">
       4829074
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.chom.2015.11.002
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR10">
     <label>
      10.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lord
        </surname>
        <given-names>
         CJ
        </given-names>
       </name>
       <name>
        <surname>
         Quinn
        </surname>
        <given-names>
         N
        </given-names>
       </name>
       <name>
        <surname>
         Ryan
        </surname>
        <given-names>
         CJ
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Integrative analysis of large-scale loss-of-function screens identifies robust cancer-associated genetic interactions
      </article-title>
      <source>
       Elife
      </source>
      <year>
       2020
      </year>
      <volume>
       9
      </volume>
      <fpage>
       1
      </fpage>
      <lpage>
       37
      </lpage>
      <pub-id pub-id-type="doi">
       10.7554/eLife.58925
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR11">
     <label>
      11.
     </label>
     <mixed-citation publication-type="other">
      Wang, T., Li, B., Nelson, C. E. &amp; Nabavi, S. Comparative analysis of differential gene expression analysis tools for single-cell RNA sequencing data.
      <italic>
       BMC Bioinform.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.1186/s12859-019-2599-6">
       https://doi.org/10.1186/s12859-019-2599-6
      </ext-link>
      (2019).
     </mixed-citation>
    </ref>
    <ref id="CR12">
     <label>
      12.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Fakhraei
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Huang
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Raschid
        </surname>
        <given-names>
         L
        </given-names>
       </name>
       <name>
        <surname>
         Getoor
        </surname>
        <given-names>
         L
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Network-based drug-target interaction prediction with probabilistic soft logic
      </article-title>
      <source>
       IEEE/ACM Trans. Comput. Biol. Bioinform.
      </source>
      <year>
       2014
      </year>
      <volume>
       11
      </volume>
      <fpage>
       775
      </fpage>
      <lpage>
       787
      </lpage>
      <pub-id pub-id-type="pmid">
       26356852
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1109/TCBB.2014.2325031
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR13">
     <label>
      13.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Madhukar
        </surname>
        <given-names>
         NS
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A Bayesian machine learning approach for drug target identification using diverse data types
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2019
      </year>
      <volume>
       10
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019NatCo..10.5221M
      </pub-id>
      <pub-id pub-id-type="pmid">
       31745082
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6863850
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-019-12928-6
      </pub-id>
      <elocation-id>
       5221
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR14">
     <label>
      14.
     </label>
     <mixed-citation publication-type="other">
      Wang, W., Yang, S. &amp; Li, J. Drug target predictions based on heterogeneous graph inference.
      <italic>
       Pac. Symp. Biocomput.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.1142/9789814447973_0006">
       https://doi.org/10.1142/9789814447973_0006
      </ext-link>
      (2013).
     </mixed-citation>
    </ref>
    <ref id="CR15">
     <label>
      15.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Anighoro
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Bajorath
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Rastelli
        </surname>
        <given-names>
         G
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Polypharmacology: challenges and opportunities in drug discovery
      </article-title>
      <source>
       J. Med. Chem.
      </source>
      <year>
       2014
      </year>
      <volume>
       57
      </volume>
      <fpage>
       7874
      </fpage>
      <lpage>
       7887
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2cXhtVShsL3I
      </pub-id>
      <pub-id pub-id-type="pmid">
       24946140
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/jm5006463
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR16">
     <label>
      16.
     </label>
     <mixed-citation publication-type="other">
      Moutsopoulos, I. et al. noisyR: Enhancing biological signal in sequencing datasets by characterizing random technical noise.
      <italic>
       Nucleic Acids Res.
      </italic>
      <bold>
       49
      </bold>
      , e83 (2021).
     </mixed-citation>
    </ref>
    <ref id="CR17">
     <label>
      17.
     </label>
     <mixed-citation publication-type="other">
      Linderman, G. C. et al. Zero-preserving imputation of single-cell RNA-seq data.
      <italic>
       Nat. Commun
      </italic>
      .
      <bold>
       13
      </bold>
      , 192 (2022).
     </mixed-citation>
    </ref>
    <ref id="CR18">
     <label>
      18.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lawhorn
        </surname>
        <given-names>
         CM
        </given-names>
       </name>
       <name>
        <surname>
         Schomaker
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Rowell
        </surname>
        <given-names>
         JT
        </given-names>
       </name>
       <name>
        <surname>
         Rueppell
        </surname>
        <given-names>
         O
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Simple comparative analyses of differentially expressed gene lists may overestimate gene overlap
      </article-title>
      <source>
       J. Comput. Biol.
      </source>
      <year>
       2018
      </year>
      <volume>
       25
      </volume>
      <fpage>
       606
      </fpage>
      <lpage>
       612
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXhtFamu7%2FL
      </pub-id>
      <pub-id pub-id-type="pmid">
       29658777
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5998827
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1089/cmb.2017.0262
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR19">
     <label>
      19.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Kærn
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Elston
        </surname>
        <given-names>
         TC
        </given-names>
       </name>
       <name>
        <surname>
         Blake
        </surname>
        <given-names>
         WJ
        </given-names>
       </name>
       <name>
        <surname>
         Collins
        </surname>
        <given-names>
         JJ
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Stochasticity in gene expression: from theories to phenotypes
      </article-title>
      <source>
       Nat. Rev. Genet.
      </source>
      <year>
       2005
      </year>
      <volume>
       6
      </volume>
      <fpage>
       451
      </fpage>
      <lpage>
       464
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD2MXkslSnu7g%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nrg1615
      </pub-id>
      <pub-id pub-id-type="pmid">
       15883588
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR20">
     <label>
      20.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Evangelou
        </surname>
        <given-names>
         E
        </given-names>
       </name>
       <name>
        <surname>
         Ioannidis
        </surname>
        <given-names>
         JPA
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Meta-analysis methods for genome-wide association studies and beyond
      </article-title>
      <source>
       Nat. Rev. Genet.
      </source>
      <year>
       2013
      </year>
      <volume>
       14
      </volume>
      <fpage>
       379
      </fpage>
      <lpage>
       389
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3sXnt1Sgtbc%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       23657481
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nrg3472
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR21">
     <label>
      21.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Donner
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Kazmierczak
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Fortney
        </surname>
        <given-names>
         K
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Drug repurposing using deep embeddings of gene expression profiles
      </article-title>
      <source>
       Mol. Pharm.
      </source>
      <year>
       2018
      </year>
      <volume>
       15
      </volume>
      <fpage>
       4314
      </fpage>
      <lpage>
       4325
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXhtlSmurjP
      </pub-id>
      <pub-id pub-id-type="pmid">
       30001141
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/acs.molpharmaceut.8b00284
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR22">
     <label>
      22.
     </label>
     <mixed-citation publication-type="other">
      Mikolov, T., Chen, K., Corrado, G. &amp; Dean, J. Efficient estimation of word representations in vector space.
      <italic>
       arXiv
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.48550/arXiv.1301.3781">
       https://doi.org/10.48550/arXiv.1301.3781
      </ext-link>
      (2013).
     </mixed-citation>
    </ref>
    <ref id="CR23">
     <label>
      23.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Du
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Gene2vec: distributed representation of genes based on co-expression
      </article-title>
      <source>
       BMC Genomics
      </source>
      <year>
       2019
      </year>
      <volume>
       20
      </volume>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXpsV2jsbw%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       30712510
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6360648
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1186/s12864-018-5370-x
      </pub-id>
      <elocation-id>
       82
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR24">
     <label>
      24.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Smaili
        </surname>
        <given-names>
         FZ
        </given-names>
       </name>
       <name>
        <surname>
         Gao
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <name>
        <surname>
         Hoehndorf
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       OPA2Vec: combining formal and informal content of biomedical ontologies to improve similarity-based prediction
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2019
      </year>
      <volume>
       35
      </volume>
      <fpage>
       2133
      </fpage>
      <lpage>
       2140
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXhs1Wksbw%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       30407490
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/bty933
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR25">
     <label>
      25.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Cho
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Zhai
        </surname>
        <given-names>
         C
        </given-names>
       </name>
       <name>
        <surname>
         Berger
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Peng
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Exploiting ontology graph for predicting sparsely annotated gene function
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2015
      </year>
      <volume>
       31
      </volume>
      <fpage>
       i357
      </fpage>
      <lpage>
       i364
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC28Xht1Cit7fI
      </pub-id>
      <pub-id pub-id-type="pmid">
       26072504
      </pub-id>
      <pub-id pub-id-type="pmcid">
       4542782
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/btv260
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR26">
     <label>
      26.
     </label>
     <mixed-citation publication-type="other">
      Cousins, H. et al. Gene set proximity analysis: expanding gene set enrichment analysis through learned geometric embeddings, with drug-repurposing applications in COVID-19.
      <italic>
       Bioinformatics
      </italic>
      .
      <bold>
       39
      </bold>
      <italic>
       ,
      </italic>
      btac735 (2023).
     </mixed-citation>
    </ref>
    <ref id="CR27">
     <label>
      27.
     </label>
     <mixed-citation publication-type="other">
      Lagisetty, Y. et al. Identification of risk genes for Alzheimer’s disease by gene embedding.
      <italic>
       Cell Genomics
      </italic>
      .
      <bold>
       2
      </bold>
      , 100162 (2022)
     </mixed-citation>
    </ref>
    <ref id="CR28">
     <label>
      28.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Pesaranghader
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       deepSimDEF: Deep neural embeddings of gene products and gene ontology terms for functional analysis of genes
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2022
      </year>
      <volume>
       38
      </volume>
      <fpage>
       3051
      </fpage>
      <lpage>
       3061
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XhslalurzE
      </pub-id>
      <pub-id pub-id-type="pmid">
       35536192
      </pub-id>
      <pub-id pub-id-type="pmcid">
       9154256
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/btac304
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR29">
     <label>
      29.
     </label>
     <mixed-citation publication-type="other">
      Lee, H. &amp; Kim, W. Comparison of target features for predicting drug-target interactions by deep neural network based on large-scale drug-induced transcriptome data.
      <italic>
       Pharmaceutics.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.3390/pharmaceutics11080377">
       https://doi.org/10.3390/pharmaceutics11080377
      </ext-link>
      (2019).
     </mixed-citation>
    </ref>
    <ref id="CR30">
     <label>
      30.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Resnik
        </surname>
        <given-names>
         P
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Semantic Similarity in a taxonomy: an information-based measure and its application to problems of ambiguity in natural language
      </article-title>
      <source>
       J. Artif. Intell. Res.
      </source>
      <year>
       1999
      </year>
      <volume>
       11
      </volume>
      <fpage>
       95
      </fpage>
      <lpage>
       130
      </lpage>
      <pub-id pub-id-type="doi">
       10.1613/jair.514
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR31">
     <label>
      31.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ashburner
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Gene ontology: tool for the unification of biology the gene ontology consortium
      </article-title>
      <source>
       Nat. Genet.
      </source>
      <year>
       2000
      </year>
      <volume>
       25
      </volume>
      <fpage>
       25
      </fpage>
      <lpage>
       29
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD3cXjtFSlsbc%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       10802651
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3037419
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/75556
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR32">
     <label>
      32.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lachmann
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Massive mining of publicly available RNA-seq data from human and mouse
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2018
      </year>
      <volume>
       9
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2018NatCo...9.1366L
      </pub-id>
      <pub-id pub-id-type="pmid">
       29636450
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5893633
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-018-03751-6
      </pub-id>
      <elocation-id>
       1366
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR33">
     <label>
      33.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Bernardo
        </surname>
        <given-names>
         DD
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Chemogenomic profiling on a genome-wide scale using reverse-engineered gene networks
      </article-title>
      <source>
       Nat. Biotechnol.
      </source>
      <year>
       2005
      </year>
      <volume>
       23
      </volume>
      <fpage>
       377
      </fpage>
      <lpage>
       383
      </lpage>
      <pub-id pub-id-type="pmid">
       15765094
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nbt1075
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR34">
     <label>
      34.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Weinstein
        </surname>
        <given-names>
         JN
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       The cancer genome atlas pan-cancer analysis project
      </article-title>
      <source>
       Nat. Genet
      </source>
      <year>
       2013
      </year>
      <volume>
       45
      </volume>
      <fpage>
       1113
      </fpage>
      <lpage>
       1120
      </lpage>
      <pub-id pub-id-type="pmid">
       24071849
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3919969
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/ng.2764
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR35">
     <label>
      35.
     </label>
     <mixed-citation publication-type="other">
      Edgar, R., Domrachev, M. &amp; Lash, A. E. Gene expression omnibus: NCBI gene expression and hybridization array data repository.
      <italic>
       Nucleic Acids Res.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.1093/nar/30.1.207">
       https://doi.org/10.1093/nar/30.1.207
      </ext-link>
      (2002).
     </mixed-citation>
    </ref>
    <ref id="CR36">
     <label>
      36.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Uhlen
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Towards a knowledge-based human protein Atlas
      </article-title>
      <source>
       Nat. Biotechnol.
      </source>
      <year>
       2010
      </year>
      <volume>
       28
      </volume>
      <fpage>
       1248
      </fpage>
      <lpage>
       1250
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3cXhsFals7nO
      </pub-id>
      <pub-id pub-id-type="pmid">
       21139605
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nbt1210-1248
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR37">
     <label>
      37.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Abugessaisa
        </surname>
        <given-names>
         I
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       FANTOM enters 20th year: expansion of transcriptomic atlases and functional annotation of non-coding RNAs
      </article-title>
      <source>
       Nucleic Acids Res.
      </source>
      <year>
       2021
      </year>
      <volume>
       49
      </volume>
      <fpage>
       D892
      </fpage>
      <lpage>
       D898
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXntlejtL0%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       33211864
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/nar/gkaa1054
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR38">
     <label>
      38.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Papatheodorou
        </surname>
        <given-names>
         I
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Expression Atlas update: from tissues to single cells
      </article-title>
      <source>
       Nucleic Acids Res.
      </source>
      <year>
       2020
      </year>
      <volume>
       48
      </volume>
      <fpage>
       D77
      </fpage>
      <lpage>
       D83
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXhslWltbvN
      </pub-id>
      <pub-id pub-id-type="pmid">
       31665515
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR39">
     <label>
      39.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Van Der Maaten
        </surname>
        <given-names>
         L
        </given-names>
       </name>
       <name>
        <surname>
         Hinton
        </surname>
        <given-names>
         G
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Visualizing data using t-SNE
      </article-title>
      <source>
       J. Mach. Learn. Res.
      </source>
      <year>
       2008
      </year>
      <volume>
       9
      </volume>
      <fpage>
       2579
      </fpage>
      <lpage>
       2605
      </lpage>
     </mixed-citation>
    </ref>
    <ref id="CR40">
     <label>
      40.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lamb
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       The connectivity map: using gene-expression signatures to connect small molecules, genes and disease
      </article-title>
      <source>
       Science
      </source>
      <year>
       2006
      </year>
      <volume>
       313
      </volume>
      <fpage>
       1929
      </fpage>
      <lpage>
       1935
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2006Sci...313.1929L
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD28XhtVSnsrbN
      </pub-id>
      <pub-id pub-id-type="pmid">
       17008526
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.1132939
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR41">
     <label>
      41.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Gillespie
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       The reactome pathway knowledgebase 2022
      </article-title>
      <source>
       Nucleic Acids Res.
      </source>
      <year>
       2022
      </year>
      <volume>
       50
      </volume>
      <fpage>
       D687
      </fpage>
      <lpage>
       D692
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38Xit1Gqs7o%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       34788843
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/nar/gkab1028
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR42">
     <label>
      42.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Corsello
        </surname>
        <given-names>
         SM
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       The drug repurposing hub: a next-generation drug library and information resource
      </article-title>
      <source>
       Nat. Med.
      </source>
      <year>
       2017
      </year>
      <volume>
       23
      </volume>
      <fpage>
       405
      </fpage>
      <lpage>
       408
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2sXotVKhsbs%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       28388612
      </pub-id>
      <pub-id pub-id-type="pmcid">
       5568558
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nm.4306
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR43">
     <label>
      43.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Cheng
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <name>
        <surname>
         Li
        </surname>
        <given-names>
         Q
        </given-names>
       </name>
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Bryant
        </surname>
        <given-names>
         SH
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Identifying compound-target associations by combining bioactivity profile similarity search and public databases mining
      </article-title>
      <source>
       J. Chem. Inf. Model
      </source>
      <year>
       2011
      </year>
      <volume>
       51
      </volume>
      <fpage>
       2440
      </fpage>
      <lpage>
       2448
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3MXhtValsb3N
      </pub-id>
      <pub-id pub-id-type="pmid">
       21834535
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3180241
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/ci200192v
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR44">
     <label>
      44.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Martin
        </surname>
        <given-names>
         EJ
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       All-Assay-Max2 pQSAR: activity predictions as accurate as four-concentration IC50s for 8558 Novartis assays
      </article-title>
      <source>
       J. Chem. Inf. Model
      </source>
      <year>
       2019
      </year>
      <volume>
       59
      </volume>
      <fpage>
       4450
      </fpage>
      <lpage>
       4459
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019tosf.book.....M
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1MXhslOqurbK
      </pub-id>
      <pub-id pub-id-type="pmid">
       31518124
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/acs.jcim.9b00375
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR45">
     <label>
      45.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         King
        </surname>
        <given-names>
         FJ
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Pathway reporter assays reveal small molecule mechanisms of action
      </article-title>
      <source>
       J. Lab Autom.
      </source>
      <year>
       2009
      </year>
      <volume>
       14
      </volume>
      <fpage>
       374
      </fpage>
      <lpage>
       382
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3cXjsVyrtQ%3D%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jala.2009.08.001
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR46">
     <label>
      46.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Shoemaker
        </surname>
        <given-names>
         RH
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       The NCI60 human tumour cell line anticancer drug screen
      </article-title>
      <source>
       Nat. Rev. Cancer
      </source>
      <year>
       2006
      </year>
      <volume>
       6
      </volume>
      <fpage>
       813
      </fpage>
      <lpage>
       823
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD28XpvVCmu7c%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       16990858
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nrc1951
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR47">
     <label>
      47.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Chidsey
        </surname>
        <given-names>
         CA
        </given-names>
       </name>
       <name>
        <surname>
         Harrison
        </surname>
        <given-names>
         DC
        </given-names>
       </name>
       <name>
        <surname>
         Braunwald
        </surname>
        <given-names>
         E
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Release of norepinephrine from the heart by vasoactive amines
      </article-title>
      <source>
       Proc. Soc. Exp. Biol. Med.
      </source>
      <year>
       1962
      </year>
      <volume>
       109
      </volume>
      <fpage>
       488
      </fpage>
      <lpage>
       490
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DyaF38XktF2mt7o%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       13878935
      </pub-id>
      <pub-id pub-id-type="doi">
       10.3181/00379727-109-27244
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR48">
     <label>
      48.
     </label>
     <mixed-citation publication-type="other">
      Clarke, Z. Mephentermine.
      <italic>
       xPharm: The Comprehensive Pharmacology Reference
      </italic>
      1–4 (Elsevier, 2007).
     </mixed-citation>
    </ref>
    <ref id="CR49">
     <label>
      49.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         C
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Research progress of MEK1/2 inhibitors and degraders in the treatment of cancer
      </article-title>
      <source>
       Eur. J. Med. Chem.
      </source>
      <year>
       2021
      </year>
      <volume>
       218
      </volume>
      <fpage>
       113386
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXns1ehs7o%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       33774345
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.ejmech.2021.113386
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR50">
     <label>
      50.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Mofers
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Selvaraju
        </surname>
        <given-names>
         K
        </given-names>
       </name>
       <name>
        <surname>
         Gubat
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         D’Arcy
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <name>
        <surname>
         Linder
        </surname>
        <given-names>
         S
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Identification of proteasome inhibitors using analysis of gene expression profiles
      </article-title>
      <source>
       Eur. J. Pharm.
      </source>
      <year>
       2020
      </year>
      <volume>
       889
      </volume>
      <fpage>
       173709
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXitlelsrbM
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.ejphar.2020.173709
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR51">
     <label>
      51.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhou
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Metascape provides a biologist-oriented resource for the analysis of systems-level datasets
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2019
      </year>
      <volume>
       10
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019NatCo..10.1523Z
      </pub-id>
      <pub-id pub-id-type="pmid">
       30944313
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6447622
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-019-09234-6
      </pub-id>
      <elocation-id>
       1523
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR52">
     <label>
      52.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wishart
        </surname>
        <given-names>
         DS
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       DrugBank 5.0: a major update to the drugbank database for 2018
      </article-title>
      <source>
       Nucleic Acids Res.
      </source>
      <year>
       2018
      </year>
      <volume>
       46
      </volume>
      <fpage>
       D1074
      </fpage>
      <lpage>
       D1082
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXitlGisbvI
      </pub-id>
      <pub-id pub-id-type="pmid">
       29126136
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/nar/gkx1037
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR53">
     <label>
      53.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Roskoski
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Properties of FDA-approved small molecule protein kinase inhibitors: a 2020 update
      </article-title>
      <source>
       Pharm. Res.
      </source>
      <year>
       2020
      </year>
      <volume>
       152
      </volume>
      <fpage>
       104609
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1MXisV2ktbrE
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.phrs.2019.104609
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR54">
     <label>
      54.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Luo
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Potent and selective inhibitors of Akt kinases slow the progress of tumors in vivo
      </article-title>
      <source>
       Mol. Cancer Ther.
      </source>
      <year>
       2005
      </year>
      <volume>
       4
      </volume>
      <fpage>
       977
      </fpage>
      <lpage>
       986
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD2MXltFWrtr4%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       15956255
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1158/1535-7163.MCT-05-0005
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR55">
     <label>
      55.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Tuli
        </surname>
        <given-names>
         HS
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Phloretin, as a potent anticancer compound: from chemistry to cellular interactions
      </article-title>
      <source>
       Molecules
      </source>
      <year>
       2022
      </year>
      <volume>
       27
      </volume>
      <fpage>
       8819
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXktlahsg%3D%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       36557950
      </pub-id>
      <pub-id pub-id-type="pmcid">
       9787340
      </pub-id>
      <pub-id pub-id-type="doi">
       10.3390/molecules27248819
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR56">
     <label>
      56.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Hytti
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Phloretin inhibits glucose transport and reduces inflammation in human retinal pigment epithelial cells
      </article-title>
      <source>
       Mol. Cell Biochem.
      </source>
      <year>
       2023
      </year>
      <volume>
       478
      </volume>
      <fpage>
       215
      </fpage>
      <lpage>
       227
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38Xhs12msLvL
      </pub-id>
      <pub-id pub-id-type="pmid">
       35771396
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1007/s11010-022-04504-2
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR57">
     <label>
      57.
     </label>
     <mixed-citation publication-type="other">
      Neavin, D. R., Liu, D., Ray, B. &amp; Weinshilboum, R. M. The role of the aryl hydrocarbon receptor (AHR) in immune and inflammatory diseases.
      <italic>
       Int. J. Mol. Sci.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.3390/ijms19123851">
       https://doi.org/10.3390/ijms19123851
      </ext-link>
      (2018).
     </mixed-citation>
    </ref>
    <ref id="CR58">
     <label>
      58.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Boitano
        </surname>
        <given-names>
         AE
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Aryl hydrocarbon receptor antagonists promote the expansion of human hematopoietic stem cells
      </article-title>
      <source>
       Science
      </source>
      <year>
       2010
      </year>
      <volume>
       329
      </volume>
      <fpage>
       1345
      </fpage>
      <lpage>
       1348
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2010Sci...329.1345B
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3cXhtFajs7rE
      </pub-id>
      <pub-id pub-id-type="pmid">
       20688981
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3033342
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.1191536
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR59">
     <label>
      59.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Dolciami
        </surname>
        <given-names>
         D
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Binding mode and structure-activity relationships of ITE as an aryl hydrocarbon receptor (AhR) Agonist
      </article-title>
      <source>
       Chem. Med. Chem.
      </source>
      <year>
       2018
      </year>
      <volume>
       13
      </volume>
      <fpage>
       270
      </fpage>
      <lpage>
       279
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXhsVemtbs%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       29266750
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/cmdc.201700669
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR60">
     <label>
      60.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Yin
        </surname>
        <given-names>
         X-F
        </given-names>
       </name>
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Mao
        </surname>
        <given-names>
         W
        </given-names>
       </name>
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         Y-H
        </given-names>
       </name>
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         M-H
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       A selective aryl hydrocarbon receptor modulator 3,3’-Diindolylmethane inhibits gastric cancer cell growth
      </article-title>
      <source>
       J. Exp. Clin. Cancer Res.
      </source>
      <year>
       2012
      </year>
      <volume>
       31
      </volume>
      <fpage>
       46
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC38XhtFCqsL3E
      </pub-id>
      <pub-id pub-id-type="pmid">
       22592002
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3403951
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1186/1756-9966-31-46
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR61">
     <label>
      61.
     </label>
     <mixed-citation publication-type="other">
      O’Donnell, E. F. et al. The anti-inflammatory drug leflunomide is an agonist of the aryl hydrocarbon receptor.
      <italic>
       PLoS One
      </italic>
      <bold>
       5
      </bold>
      , e13128 (2010).
     </mixed-citation>
    </ref>
    <ref id="CR62">
     <label>
      62.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Mohammadi-Bardbori
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Bengtsson
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Rannug
        </surname>
        <given-names>
         U
        </given-names>
       </name>
       <name>
        <surname>
         Rannug
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Wincent
        </surname>
        <given-names>
         E
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Quercetin, resveratrol and curcumin are indirect activators of the aryl hydrocarbon receptor (AHR)
      </article-title>
      <source>
       Chem. Res. Toxicol.
      </source>
      <year>
       2012
      </year>
      <volume>
       25
      </volume>
      <fpage>
       1878
      </fpage>
      <lpage>
       1884
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC38XhtFClurbE
      </pub-id>
      <pub-id pub-id-type="pmid">
       22867086
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/tx300169e
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR63">
     <label>
      63.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Revel
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Resveratrol, a natural aryl hydrocarbon receptor antagonist, protects lung from DNA damage and apoptosis caused by benzo[a]pyrene
      </article-title>
      <source>
       J. Appl Toxicol.
      </source>
      <year>
       2003
      </year>
      <volume>
       23
      </volume>
      <fpage>
       255
      </fpage>
      <lpage>
       261
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD3sXmtF2qtLc%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       12884409
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/jat.916
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR64">
     <label>
      64.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Sidorova
        </surname>
        <given-names>
         YA
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Menadione suppresses benzo(α)pyrene-induced activation of cytochromes P450 1A: insights into a possible molecular mechanism
      </article-title>
      <source>
       PLoS One
      </source>
      <year>
       2016
      </year>
      <volume>
       11
      </volume>
      <fpage>
       e0155135
      </fpage>
      <pub-id pub-id-type="pmid">
       27167070
      </pub-id>
      <pub-id pub-id-type="pmcid">
       4864395
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1371/journal.pone.0155135
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR65">
     <label>
      65.
     </label>
     <mixed-citation publication-type="other">
      Xie, J., Pang, Y. &amp; Wu, X. Taxifolin suppresses the malignant progression of gastric cancer by regulating the AhR/CYP1A1 signaling pathway.
      <italic>
       Int. J. Mol. Med.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.3892/ijmm.2021.5030">
       https://doi.org/10.3892/ijmm.2021.5030
      </ext-link>
      (2021).
     </mixed-citation>
    </ref>
    <ref id="CR66">
     <label>
      66.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wong
        </surname>
        <given-names>
         TY
        </given-names>
       </name>
       <name>
        <surname>
         Lin
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Poon
        </surname>
        <given-names>
         CH
        </given-names>
       </name>
       <name>
        <surname>
         Leung
        </surname>
        <given-names>
         LK
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       The licorice flavonoid isoliquiritigenin reduces DNA-binding activity of AhR in MCF-7 cells
      </article-title>
      <source>
       Chem. Biol. Interact.
      </source>
      <year>
       2014
      </year>
      <volume>
       221
      </volume>
      <fpage>
       70
      </fpage>
      <lpage>
       76
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2cXhtleitLzF
      </pub-id>
      <pub-id pub-id-type="pmid">
       25110319
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.cbi.2014.07.015
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR67">
     <label>
      67.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Cortes
        </surname>
        <given-names>
         C
        </given-names>
       </name>
       <name>
        <surname>
         Vapnik
        </surname>
        <given-names>
         V
        </given-names>
       </name>
       <name>
        <surname>
         Saitta
        </surname>
        <given-names>
         L
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Support-vector networks
      </article-title>
      <source>
       Mach. Learn
      </source>
      <year>
       1995
      </year>
      <volume>
       20
      </volume>
      <fpage>
       273
      </fpage>
      <lpage>
       297
      </lpage>
      <pub-id pub-id-type="doi">
       10.1007/BF00994018
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR68">
     <label>
      68.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ho
        </surname>
        <given-names>
         TK
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Random decision forests
      </article-title>
      <source>
       Proc. Int. Conf. Doc. Anal. Recognit.
      </source>
      <year>
       1995
      </year>
      <volume>
       1
      </volume>
      <fpage>
       278
      </fpage>
      <lpage>
       282
      </lpage>
      <pub-id pub-id-type="doi">
       10.1109/ICDAR.1995.598994
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR69">
     <label>
      69.
     </label>
     <mixed-citation publication-type="other">
      Chen, T. &amp; Guestrin, C. XGBoost: A scalable tree boosting system. In
      <italic>
       Proc. 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining
      </italic>
      . 785–794 (ACM, Inc., 2016).
     </mixed-citation>
    </ref>
    <ref id="CR70">
     <label>
      70.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Menche
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Uncovering disease-disease relationships through the incomplete interactome
      </article-title>
      <source>
       Science (1979)
      </source>
      <year>
       2015
      </year>
      <volume>
       347
      </volume>
      <fpage>
       841
      </fpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2MXivFSru7s%3D
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR71">
     <label>
      71.
     </label>
     <mixed-citation publication-type="other">
      Zhao, Y., Cai, H., Zhang, Z., Tang, J. &amp; Li, Y. Learning interpretable cellular and gene signature embeddings from single-cell transcriptomic data.
      <italic>
       Nat Commun.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.1038/s41467-021-25534-2">
       https://doi.org/10.1038/s41467-021-25534-2
      </ext-link>
      (2021).
     </mixed-citation>
    </ref>
    <ref id="CR72">
     <label>
      72.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Scarselli
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <name>
        <surname>
         Gori
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Tsoi
        </surname>
        <given-names>
         AC
        </given-names>
       </name>
       <name>
        <surname>
         Hagenbuchner
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Monfardini
        </surname>
        <given-names>
         G
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       The graph neural network model
      </article-title>
      <source>
       IEEE Trans. Neural Netw.
      </source>
      <year>
       2009
      </year>
      <volume>
       20
      </volume>
      <fpage>
       61
      </fpage>
      <lpage>
       80
      </lpage>
      <pub-id pub-id-type="pmid">
       19068426
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1109/TNN.2008.2005605
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR73">
     <label>
      73.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Bray
        </surname>
        <given-names>
         NL
        </given-names>
       </name>
       <name>
        <surname>
         Pimentel
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Melsted
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <name>
        <surname>
         Pachter
        </surname>
        <given-names>
         L
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Near-optimal probabilistic RNA-seq quantification
      </article-title>
      <source>
       Nat. Biotechnol.
      </source>
      <year>
       2016
      </year>
      <volume>
       34
      </volume>
      <fpage>
       525
      </fpage>
      <lpage>
       527
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC28XlsVansL8%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       27043002
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nbt.3519
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR74">
     <label>
      74.
     </label>
     <mixed-citation publication-type="other">
      Zhou, D., Huang, J. &amp; Schölkopf, B. Learning with hypergraphs: clustering, classification and embedding.
      <italic>
       Adv. Neural Inf. Process Syst.
      </italic>
      <bold>
       19
      </bold>
      , 1601–1608 (2006).
     </mixed-citation>
    </ref>
    <ref id="CR75">
     <label>
      75.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Yu
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Enzyme function prediction using contrastive learning
      </article-title>
      <source>
       Science
      </source>
      <year>
       2023
      </year>
      <volume>
       379
      </volume>
      <fpage>
       1358
      </fpage>
      <lpage>
       1363
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2023Sci...379.1358Y
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXmslGksbY%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       36996195
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.adf2465
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR76">
     <label>
      76.
     </label>
     <mixed-citation publication-type="other">
      Vaswani, A. et al. Attention is all you need.
      <italic>
       Adv. Neural Inf. Process Syst.
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.48550/arXiv.1706.03762">
       https://doi.org/10.48550/arXiv.1706.03762
      </ext-link>
      (2017).
     </mixed-citation>
    </ref>
    <ref id="CR77">
     <label>
      77.
     </label>
     <mixed-citation publication-type="other">
      Bromley, J. et al. Signature verification using a ‘Siamese’ time delay neural network. In
      <italic>
       Proc. 6th International Conference on Neural Information Processing Systems
      </italic>
      . 737–744 (ACM, Inc., 1993).
     </mixed-citation>
    </ref>
    <ref id="CR78">
     <label>
      78.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Multifaceted protein-protein interaction prediction based on siamese residual RCNN
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2019
      </year>
      <volume>
       35
      </volume>
      <fpage>
       i305
      </fpage>
      <lpage>
       i314
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXjvF2mt78%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       31510705
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6681469
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/btz328
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR79">
     <label>
      79.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Hashemifar
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Neyshabur
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Khan
        </surname>
        <given-names>
         AA
        </given-names>
       </name>
       <name>
        <surname>
         Xu
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Predicting protein-protein interactions through sequence-based deep learning
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2018
      </year>
      <volume>
       34
      </volume>
      <fpage>
       i802
      </fpage>
      <lpage>
       i810
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1MXhtVWisrvE
      </pub-id>
      <pub-id pub-id-type="pmid">
       30423091
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6129267
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/bty573
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR80">
     <label>
      80.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Jiang
        </surname>
        <given-names>
         JY
        </given-names>
       </name>
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <name>
        <surname>
         Chen
        </surname>
        <given-names>
         YY
        </given-names>
       </name>
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         W
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Learning to disentangle interleaved conversational threads with a siamese hierarchical network and similarity ranking
      </article-title>
      <source>
       NAACL
      </source>
      <year>
       2018
      </year>
      <volume>
       1
      </volume>
      <fpage>
       1812
      </fpage>
      <lpage>
       1822
      </lpage>
     </mixed-citation>
    </ref>
    <ref id="CR81">
     <label>
      81.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Rogers
        </surname>
        <given-names>
         D
        </given-names>
       </name>
       <name>
        <surname>
         Hahn
        </surname>
        <given-names>
         M
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Extended-connectivity fingerprints
      </article-title>
      <source>
       J. Chem. Inf. Model
      </source>
      <year>
       2010
      </year>
      <volume>
       50
      </volume>
      <fpage>
       742
      </fpage>
      <lpage>
       754
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3cXlt1Onsbg%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       20426451
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/ci100050t
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR82">
     <label>
      82.
     </label>
     <mixed-citation publication-type="other">
      Branco, P., Torgo, L. &amp; Ribeiro, R. P. A survey of predictive modeling on imbalanced domains.
      <italic>
       ACM Comput. Surv. (CSUR).
      </italic>
      <ext-link ext-link-type="doi" xlink:href="10.1145/2907070">
       https://doi.org/10.1145/2907070
      </ext-link>
      (2016).
     </mixed-citation>
    </ref>
    <ref id="CR83">
     <label>
      83.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Jia
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Manuia
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Juarez
        </surname>
        <given-names>
         J
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       HTRF kinase assay development and methods in inhibitor characterization
      </article-title>
      <source>
       Methods Mol. Biol.
      </source>
      <year>
       2016
      </year>
      <volume>
       1360
      </volume>
      <fpage>
       1
      </fpage>
      <lpage>
       18
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2sXntVemsrs%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       26501898
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1007/978-1-4939-3073-9_1
      </pub-id>
     </mixed-citation>
    </ref>
   </ref-list>
  </ref-list>
  <app-group>
   <app id="App1" specific-use="web-only">
    <sec id="Sec29">
     <title>
      Supplementary information
     </title>
     <p id="Par68">
      <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM1_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Supplementary Information
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM2_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Peer Review File
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM3_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Description of Additional Supplementary Files
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4" xlink:title="Supplementary information">
       <media mime-subtype="vnd.ms-excel" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM4_ESM.xlsx">
        <caption xml:lang="en">
         <p>
          Supplementary Data 1
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5" xlink:title="Supplementary information">
       <media mime-subtype="vnd.ms-excel" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM5_ESM.xlsx">
        <caption xml:lang="en">
         <p>
          Supplementary Data 2
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6" xlink:title="Supplementary information">
       <media mime-subtype="vnd.ms-excel" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM6_ESM.xlsx">
        <caption xml:lang="en">
         <p>
          Supplementary Data 3
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM7" xlink:title="Supplementary information">
       <media mime-subtype="vnd.ms-excel" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM7_ESM.xlsx">
        <caption xml:lang="en">
         <p>
          Supplementary Data 4
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM8" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM8_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Reporting Summary
         </p>
        </caption>
       </media>
      </supplementary-material>
     </p>
    </sec>
    <sec id="Sec30">
     <title>
      Source data
     </title>
     <p id="Par69">
      <supplementary-material content-type="local-data" id="MOESM9" xlink:title="Source data">
       <media mime-subtype="x-zip-compressed" mimetype="application" xlink:href="MediaObjects/41467_2024_46089_MOESM9_ESM.zip">
        <caption xml:lang="en">
         <p>
          Source Data
         </p>
        </caption>
       </media>
      </supplementary-material>
     </p>
    </sec>
   </app>
  </app-group>
  <notes notes-type="ESMHint">
   <title>
    Supplementary information
   </title>
   <p>
    The online version contains supplementary material available at
    <ext-link ext-link-type="doi" xlink:href="10.1038/s41467-024-46089-y">
     https://doi.org/10.1038/s41467-024-46089-y
    </ext-link>
    .
   </p>
  </notes>
  <notes notes-type="Misc">
   <p>
    <bold>
     Publisher’s note
    </bold>
    Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
   </p>
  </notes>
 </back>
</article>
