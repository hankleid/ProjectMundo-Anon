<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/xsl' href='/w/ProjectMundo-Anon-106A/style/jats-html.xsl'?>
<!DOCTYPE response>
<article article-type="research-article" dtd-version="1.2" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
 <front>
  <journal-meta>
   <journal-id journal-id-type="publisher-id">
    41467
   </journal-id>
   <journal-id journal-id-type="doi">
    10.1038/41467.2041-1723
   </journal-id>
   <journal-title-group>
    <journal-title>
     Nature Communications
    </journal-title>
    <abbrev-journal-title abbrev-type="publisher">
     Nat Commun
    </abbrev-journal-title>
   </journal-title-group>
   <issn pub-type="epub">
    2041-1723
   </issn>
   <publisher>
    <publisher-name>
     Nature Publishing Group UK
    </publisher-name>
    <publisher-loc>
     London
    </publisher-loc>
   </publisher>
  </journal-meta>
  <article-meta>
   <article-id pub-id-type="publisher-id">
    s41467-024-45461-2
   </article-id>
   <article-id pub-id-type="manuscript">
    45461
   </article-id>
   <article-id pub-id-type="doi">
    10.1038/s41467-024-45461-2
   </article-id>
   <article-categories>
    <subj-group subj-group-type="heading">
     <subject>
      Article
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /631/114/2411
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /631/154/1435
     </subject>
    </subj-group>
    <subj-group subj-group-type="SubjectPath">
     <subject>
      /631/114/2248
     </subject>
    </subj-group>
    <subj-group subj-group-type="NatureArticleTypeID">
     <subject>
      article
     </subject>
    </subj-group>
   </article-categories>
   <title-group>
    <article-title xml:lang="en">
     DynamicBind: predicting ligand-specific protein-ligand complex structure with a deep equivariant generative model
    </article-title>
   </title-group>
   <contrib-group>
    <contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="Au1">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0002-1572-2909
     </contrib-id>
     <name name-style="western">
      <surname>
       Lu
      </surname>
      <given-names>
       Wei
      </given-names>
     </name>
     <address>
      <email>
       luwei0917@gmail.com
      </email>
     </address>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="corresp" rid="IDs41467024454612_cor1">
      a
     </xref>
     <xref ref-type="author-notes" rid="fn1"/>
    </contrib>
    <contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="Au2">
     <name name-style="western">
      <surname>
       Zhang
      </surname>
      <given-names>
       Jixian
      </given-names>
     </name>
     <address>
      <email>
       jxzly1993@gmail.com
      </email>
     </address>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
     <xref ref-type="corresp" rid="IDs41467024454612_cor2">
      b
     </xref>
     <xref ref-type="author-notes" rid="fn1"/>
    </contrib>
    <contrib contrib-type="author" id="Au3">
     <name name-style="western">
      <surname>
       Huang
      </surname>
      <given-names>
       Weifeng
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff2">
      2
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au4">
     <name name-style="western">
      <surname>
       Zhang
      </surname>
      <given-names>
       Ziqiao
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au5">
     <name name-style="western">
      <surname>
       Jia
      </surname>
      <given-names>
       Xiangyu
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au6">
     <name name-style="western">
      <surname>
       Wang
      </surname>
      <given-names>
       Zhenyu
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au7">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0009-0000-7014-3347
     </contrib-id>
     <name name-style="western">
      <surname>
       Shi
      </surname>
      <given-names>
       Leilei
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au8">
     <name name-style="western">
      <surname>
       Li
      </surname>
      <given-names>
       Chengtao
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff1">
      1
     </xref>
    </contrib>
    <contrib contrib-type="author" id="Au9">
     <name name-style="western">
      <surname>
       Wolynes
      </surname>
      <given-names>
       Peter G.
      </given-names>
     </name>
     <xref ref-type="aff" rid="Aff3">
      3
     </xref>
    </contrib>
    <contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="Au10">
     <contrib-id contrib-id-type="orcid">
      http://orcid.org/0000-0001-9747-4285
     </contrib-id>
     <name name-style="western">
      <surname>
       Zheng
      </surname>
      <given-names>
       Shuangjia
      </given-names>
     </name>
     <address>
      <email>
       shuangjia.zheng@sjtu.edu.cn
      </email>
     </address>
     <xref ref-type="aff" rid="Aff4">
      4
     </xref>
     <xref ref-type="corresp" rid="IDs41467024454612_cor10">
      k
     </xref>
     <xref ref-type="author-notes" rid="fn1"/>
    </contrib>
    <aff id="Aff1">
     <label>
      1
     </label>
     <institution-wrap>
      <institution content-type="org-name">
       Galixir Technologies
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      200100
     </addr-line>
     <addr-line content-type="city">
      Shanghai
     </addr-line>
     <country country="CN">
      China
     </country>
    </aff>
    <aff id="Aff2">
     <label>
      2
     </label>
     <institution-wrap>
      <institution-id institution-id-type="ROR">
       https://ror.org/0064kty71
      </institution-id>
      <institution-id institution-id-type="GRID">
       grid.12981.33
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0001 2360 039X
      </institution-id>
      <institution content-type="org-division">
       School of Pharmaceutical Science
      </institution>
      <institution content-type="org-name">
       Sun Yat-sen University
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      510006
     </addr-line>
     <addr-line content-type="city">
      Guangzhou
     </addr-line>
     <country country="CN">
      China
     </country>
    </aff>
    <aff id="Aff3">
     <label>
      3
     </label>
     <institution-wrap>
      <institution-id institution-id-type="GRID">
       grid.21940.3e
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0004 1936 8278
      </institution-id>
      <institution content-type="org-division">
       Center for Theoretical Biological Physics and Department of Chemistry
      </institution>
      <institution content-type="org-name">
       Rice University
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      77005
     </addr-line>
     <addr-line content-type="city">
      Houston
     </addr-line>
     <addr-line content-type="state">
      TX
     </addr-line>
     <country country="US">
      USA
     </country>
    </aff>
    <aff id="Aff4">
     <label>
      4
     </label>
     <institution-wrap>
      <institution-id institution-id-type="ROR">
       https://ror.org/0220qvk04
      </institution-id>
      <institution-id institution-id-type="GRID">
       grid.16821.3c
      </institution-id>
      <institution-id institution-id-type="ISNI">
       0000 0004 0368 8293
      </institution-id>
      <institution content-type="org-division">
       Global Institute of Future Technology
      </institution>
      <institution content-type="org-name">
       Shanghai Jiao Tong University
      </institution>
     </institution-wrap>
     <addr-line content-type="postcode">
      200240
     </addr-line>
     <addr-line content-type="city">
      Shanghai
     </addr-line>
     <country country="CN">
      China
     </country>
    </aff>
   </contrib-group>
   <author-notes>
    <fn fn-type="equal" id="fn1">
     <p>
      These authors contributed equally: Wei Lu, Jixian Zhang, Shuangjia Zheng.
     </p>
    </fn>
    <corresp id="IDs41467024454612_cor1">
     <label>
      a
     </label>
     <email>
      luwei0917@gmail.com
     </email>
    </corresp>
    <corresp id="IDs41467024454612_cor2">
     <label>
      b
     </label>
     <email>
      jxzly1993@gmail.com
     </email>
    </corresp>
    <corresp id="IDs41467024454612_cor10">
     <label>
      k
     </label>
     <email>
      shuangjia.zheng@sjtu.edu.cn
     </email>
    </corresp>
   </author-notes>
   <pub-date date-type="pub" publication-format="electronic">
    <day>
     5
    </day>
    <month>
     2
    </month>
    <year>
     2024
    </year>
   </pub-date>
   <pub-date date-type="collection" publication-format="electronic">
    <month>
     12
    </month>
    <year>
     2024
    </year>
   </pub-date>
   <volume>
    15
   </volume>
   <issue seq="1071">
    1
   </issue>
   <elocation-id>
    1071
   </elocation-id>
   <history>
    <date date-type="registration">
     <day>
      25
     </day>
     <month>
      1
     </month>
     <year>
      2024
     </year>
    </date>
    <date date-type="received">
     <day>
      24
     </day>
     <month>
      8
     </month>
     <year>
      2023
     </year>
    </date>
    <date date-type="accepted">
     <day>
      24
     </day>
     <month>
      1
     </month>
     <year>
      2024
     </year>
    </date>
    <date date-type="online">
     <day>
      5
     </day>
     <month>
      2
     </month>
     <year>
      2024
     </year>
    </date>
   </history>
   <permissions>
    <copyright-statement content-type="compact">
     © The Author(s) 2024
    </copyright-statement>
    <copyright-year>
     2024
    </copyright-year>
    <copyright-holder>
     The Author(s)
    </copyright-holder>
    <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
     <license-p>
      <bold>
       Open Access
      </bold>
      This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit
      <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">
       http://creativecommons.org/licenses/by/4.0/
      </ext-link>
      .
     </license-p>
    </license>
   </permissions>
   <abstract id="Abs1" xml:lang="en">
    <title>
     Abstract
    </title>
    <p id="Par1">
     While significant advances have been made in predicting static protein structures, the inherent dynamics of proteins, modulated by ligands, are crucial for understanding protein function and facilitating drug discovery. Traditional docking methods, frequently used in studying protein-ligand interactions, typically treat proteins as rigid. While molecular dynamics simulations can propose appropriate protein conformations, they’re computationally demanding due to rare transitions between biologically relevant equilibrium states. In this study, we present DynamicBind, a deep learning method that employs equivariant geometric diffusion networks to construct a smooth energy landscape, promoting efficient transitions between different equilibrium states. DynamicBind accurately recovers ligand-specific conformations from unbound protein structures without the need for holo-structures or extensive sampling. Remarkably, it demonstrates state-of-the-art performance in docking and virtual screening benchmarks. Our experiments reveal that DynamicBind can accommodate a wide range of large protein conformational changes and identify cryptic pockets in unseen protein targets. As a result, DynamicBind shows potential in accelerating the development of small molecules for previously undruggable targets and expanding the horizons of computational drug discovery.
    </p>
   </abstract>
   <abstract abstract-type="ShortSummary" id="Abs2" xml:lang="en">
    <p id="Par2">
     Proteins often function by changing conformations upon ligand binding. Efficient structural modelling of these interactions, crucial for drug discovery, is limited: here the authors address this with DynamicBind, a diffusion-based deep generative model.
    </p>
   </abstract>
   <kwd-group kwd-group-type="hierarchical" vocab="FoR" vocab-identifier="ANZSRC 2008">
    <kwd content-type="term" vocab-term-identifier="03">
     Chemical Sciences
    </kwd>
    <nested-kwd>
     <kwd content-type="term" vocab-term-identifier="0307">
      Theoretical and Computational Chemistry
     </kwd>
    </nested-kwd>
    <kwd content-type="term" vocab-term-identifier="02">
     Physical Sciences
    </kwd>
    <nested-kwd>
     <kwd content-type="term" vocab-term-identifier="0299">
      Other Physical Sciences
     </kwd>
    </nested-kwd>
   </kwd-group>
   <custom-meta-group>
    <custom-meta>
     <meta-name>
      publisher-imprint-name
     </meta-name>
     <meta-value>
      Nature Portfolio
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      volume-issue-count
     </meta-name>
     <meta-value>
      1
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-article-count
     </meta-name>
     <meta-value>
      1071
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-pricelist-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-copyright-holder
     </meta-name>
     <meta-value>
      Springer Nature Limited
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-copyright-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-contains-esm
     </meta-name>
     <meta-value>
      Yes
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-numbering-style
     </meta-name>
     <meta-value>
      Unnumbered
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-year
     </meta-name>
     <meta-value>
      2024
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-month
     </meta-name>
     <meta-value>
      1
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-registration-date-day
     </meta-name>
     <meta-value>
      25
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      toc-levels
     </meta-name>
     <meta-value>
      0
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      volume-type
     </meta-name>
     <meta-value>
      Regular
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-product
     </meta-name>
     <meta-value>
      NonStandardArchiveJournal
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      numbering-style
     </meta-name>
     <meta-value>
      Unnumbered
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-grants-type
     </meta-name>
     <meta-value>
      OpenChoice
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      metadata-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      abstract-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bodypdf-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bodyhtml-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      bibliography-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      esm-grant
     </meta-name>
     <meta-value>
      OpenAccess
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      online-first
     </meta-name>
     <meta-value>
      false
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      pdf-file-reference
     </meta-name>
     <meta-value>
      BodyRef/PDF/41467_2024_Article_45461.pdf
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      pdf-type
     </meta-name>
     <meta-value>
      Typeset
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      target-type
     </meta-name>
     <meta-value>
      OnlinePDF
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      issue-type
     </meta-name>
     <meta-value>
      Regular
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      article-type
     </meta-name>
     <meta-value>
      OriginalPaper
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-primary
     </meta-name>
     <meta-value>
      Science, Humanities and Social Sciences, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-secondary
     </meta-name>
     <meta-value>
      Science, Humanities and Social Sciences, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-secondary
     </meta-name>
     <meta-value>
      Science, multidisciplinary
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      journal-subject-collection
     </meta-name>
     <meta-value>
      Science (multidisciplinary)
     </meta-value>
    </custom-meta>
    <custom-meta>
     <meta-name>
      open-access
     </meta-name>
     <meta-value>
      true
     </meta-value>
    </custom-meta>
   </custom-meta-group>
  </article-meta>
 </front>
 <body>
  <sec id="Sec1" sec-type="introduction">
   <title>
    Introduction
   </title>
   <p id="Par3">
    Remarkable progress has been achieved in the realm of protein structure prediction from sequence data. Some prediction techniques use machine learning in concert with molecular dynamics or Monte Carlo
    <sup>
     <xref ref-type="bibr" rid="CR1">
      1
     </xref>
     ,
     <xref ref-type="bibr" rid="CR2">
      2
     </xref>
     ,
     <xref ref-type="bibr" rid="CR3">
      3
     </xref>
     –
     <xref ref-type="bibr" rid="CR4">
      4
     </xref>
    </sup>
    . These generate an ensemble of structures. AlphaFold, which leads the way in the prediction of nearly all structures in the human proteome
    <sup>
     <xref ref-type="bibr" rid="CR5">
      5
     </xref>
     ,
     <xref ref-type="bibr" rid="CR6">
      6
     </xref>
     ,
     <xref ref-type="bibr" rid="CR7">
      7
     </xref>
     –
     <xref ref-type="bibr" rid="CR8">
      8
     </xref>
    </sup>
    , however, typically generates only a few conformations for each protein sequence, despite the fact that proteins are inherently dynamic and generally adopt multiple conformations to perform their functions
    <sup>
     <xref ref-type="bibr" rid="CR9">
      9
     </xref>
     ,
     <xref ref-type="bibr" rid="CR10">
      10
     </xref>
    </sup>
    . The ability of proteins to interconvert between different conformations is central to their biological activities in all domains of life. The therapeutic effect of drug molecules arises from their specific binding to only some conformations of the target proteins and thereby modulating essential biological activities by altering the conformational landscape of these proteins
    <sup>
     <xref ref-type="bibr" rid="CR11">
      11
     </xref>
     ,
     <xref ref-type="bibr" rid="CR12">
      12
     </xref>
     ,
     <xref ref-type="bibr" rid="CR13">
      13
     </xref>
     –
     <xref ref-type="bibr" rid="CR14">
      14
     </xref>
    </sup>
    . In practice, nowadays the interactions between proteins and ligands are studied through molecular docking methods computationally. Docking is a key component of structure-based drug discovery
    <sup>
     <xref ref-type="bibr" rid="CR15">
      15
     </xref>
    </sup>
    . Nevertheless, despite the widespread recognition of the importance of protein dynamics, traditional docking methods often treat proteins as rigid, or in some cases, as being only partially flexible, permitting only selected side chains to move, to manage computational costs
    <sup>
     <xref ref-type="bibr" rid="CR16">
      16
     </xref>
     ,
     <xref ref-type="bibr" rid="CR17">
      17
     </xref>
    </sup>
    . As a result, AlphaFold-predicted structures of apoproteins, when used as inputs for docking, will yield ligand pose predictions that do not align well with the ligand-bound co-crystallized holo-structures
    <sup>
     <xref ref-type="bibr" rid="CR18">
      18
     </xref>
     ,
     <xref ref-type="bibr" rid="CR19">
      19
     </xref>
    </sup>
    . The AlphaFold-predicted structures often do not present the most favorable side-chain rotamer configurations for ligand binding, and consequently the relevant binding pocket will appear to be inaccessible since the apoprotein adopts a conformation substantially different from the holo state.
   </p>
   <p id="Par4">
    Here, we present DynamicBind, a geometric deep generative model designed for “dynamic docking”. Unlike traditional docking methods that treat proteins as mostly rigid entities, DynamicBind efficiently adjusts the protein conformation from its initial AlphaFold prediction to a holo-like state. Our model is capable of handling a wide range of large conformational changes during prediction, such as the well-known DFG-in to DFG-out transition in kinase proteins, a challenge that has been formidable for other methods, such as molecular dynamics (MD) simulations
    <sup>
     <xref ref-type="bibr" rid="CR20">
      20
     </xref>
     ,
     <xref ref-type="bibr" rid="CR21">
      21
     </xref>
    </sup>
    . We have attained this efficiency in sampling large protein conformational changes by learning a funneled energy landscape, where the transitions between biologically relevant states are minimally frustrated
    <sup>
     <xref ref-type="bibr" rid="CR22">
      22
     </xref>
    </sup>
    . This is made possible through the innovative employment of a morph-like transformation for decoy generation during training (more in “DynamicBind architectures” and “Methods”). The present method shares similarities with the Boltzmann generator
    <sup>
     <xref ref-type="bibr" rid="CR23">
      23
     </xref>
     ,
     <xref ref-type="bibr" rid="CR24">
      24
     </xref>
    </sup>
    , as it allows for direct and efficient sampling of low-energy states from the learned model. Unlike traditional Boltzmann generators, which are typically constrained to the systems for which they are trained on, however, DynamicBind is a generalizable model that can handle new proteins and ligands.
   </p>
   <p id="Par5">
    In the upcoming results section, we present a comprehensive evaluation of DynamicBind, illustrating its potential to aid drug discovery. Our presentation is organized into six segments: first, outlining the DynamicBind model; then benchmarking DynamicBind against current docking methods; then highlighting the method’s ability to sample large protein conformational changes in a ligand-specific manner; then specifically demonstrating the scope of conformational changes it can handle; illustrating its capacity to predict cryptic pockets through a case study; and finally showcasing its application to the proteome-wide virtual screening task using an antibiotics dataset
    <sup>
     <xref ref-type="bibr" rid="CR25">
      25
     </xref>
    </sup>
    . These investigations collectively highlight the potential of DynamicBind, setting the stage for further understanding and manipulating the protein–ligand interaction landscape.
   </p>
  </sec>
  <sec id="Sec2" sec-type="results">
   <title>
    Results
   </title>
   <sec id="Sec3">
    <title>
     DynamicBind architectures
    </title>
    <p id="Par6">
     DynamicBind executes “dynamic docking”, a process that performs prediction of the protein–ligand complex structure while accommodating substantial protein conformational changes. DynamicBind accepts apo-like structures (in the present study, AlphaFold-predicted conformations) in PDB format and small-molecule ligands in several widely available formats, such as Simplified Molecular Input Line Entry System (SMILES) or structure-data file (SDF) format. During inference, the model randomly places the ligand, whose seed conformation is generated using RDKit
     <sup>
      <xref ref-type="bibr" rid="CR26">
       26
      </xref>
     </sup>
     , around the protein. Then, over the course of 20 iterations (more details in “Model architecture”), using progressively smaller time steps, the model gradually translates and rotates the ligand while adjusting its internal torsional angles. After the initial five steps where only the ligand conformation is changed, the model then simultaneously translates and rotates the protein residues, while modifying the side-chain chi angles
     <sup>
      <xref ref-type="bibr" rid="CR27">
       27
      </xref>
     </sup>
     , in the remaining steps.
    </p>
    <p id="Par7">
     As illustrated in Fig.
     <xref ref-type="fig" rid="Fig1">
      1
     </xref>
     a, at each step, the features and the coordinates of the protein and the ligand are fed into an SE(3)-equivariant interaction module. Subsequently, the protein and readout modules generate the predicted translation, rotation, and dihedral updates for the current state. Further details about the model are given in “Transformation of the protein conformation”. Unlike the traditional protocol employed in diffusion-based model training, which generates decoys by perturbing the native state with Gaussian noise of varying magnitudes
     <sup>
      <xref ref-type="bibr" rid="CR28">
       28
      </xref>
      ,
      <xref ref-type="bibr" rid="CR29">
       29
      </xref>
      ,
      <xref ref-type="bibr" rid="CR30">
       30
      </xref>
      ,
      <xref ref-type="bibr" rid="CR31">
       31
      </xref>
      –
      <xref ref-type="bibr" rid="CR32">
       32
      </xref>
     </sup>
     , our method employs a morph-like transformation to produce protein decoys. In the process of doing this, the native conformation is gradually transitioned towards the AlphaFold-predicted conformation. The structure of proteins is highly constrained in many ways, with residues linked by peptide bonds, and the bond lengths are governed by chemical principles. When decoys are generated using Gaussian noise, the model primarily learns only to revert to the most chemically stable conformation, often the conformation before the noise was added. In the present task, the ligand-bound holo conformation is unknown, and the most readily available protein structure is the one predicted by AlphaFold, which often significantly differs from the holo conformation. Given that the AlphaFold-predicted structure often already complies with most chemical constraints, it is challenging to anticipate how the model trained on decoys made merely from Gaussian noise could accurately predict long timescale transformations of biological relevance, which are our primary concern. In contrast, the decoys generated by our morph-like transformation generally satisfy the basic chemical constraints, allowing our model to concentrate on learning biophysically relevant state-changing events. In unbiased molecular dynamics simulations, transitions between meta-stable states, such as the DFG ‘in’ and ‘out’ transition, are infrequent due to the realistic yet rugged energy landscape inherent in the all-atom force field
     <sup>
      <xref ref-type="bibr" rid="CR21">
       21
      </xref>
     </sup>
     . Our method, in contrast, features a significantly more funneled energy landscape, effectively lowering the free energy barrier between biologically meaningful states. Consequently, akin to other Boltzmann generator methods
     <sup>
      <xref ref-type="bibr" rid="CR23">
       23
      </xref>
      ,
      <xref ref-type="bibr" rid="CR33">
       33
      </xref>
     </sup>
     , the present approach demonstrates markedly enhanced efficiency in sampling alternate states pertinent to ligand binding. A schematic figure has been included to elucidate these differences (Fig.
     <xref ref-type="fig" rid="Fig1">
      1
     </xref>
     b).
     <fig id="Fig1" position="float">
      <label>
       Fig. 1
      </label>
      <caption xml:lang="en">
       <title>
        Overview of DynamicBind model.
       </title>
       <p>
        <bold>
         a
        </bold>
        The holo state is represented in pink, the initial apo and the model-predicted conformation in green. The native ligand is depicted in cyan, and the predicted ligand shown in orange. The model accepts as input both the features and the current conformation of the protein and ligand. The output readouts include the predicted updates: global translation and rotation for both the ligand and each protein residue, the rotation of torsional angles for the ligands and chi angles for the protein residues, and two prediction modules (binding affinity, A and confidence score, D). During the training phase, the model is designed to learn the transformation from the apo-like conformation into the holo conformation. During inference, the model iteratively updates the initial input structure twenty times.
        <bold>
         b
        </bold>
        A schematic figure shows that our model could predict the two different holo conformations when the protein binds with two different ligands. Our model could predict the bounded protein conformation within 20 steps, while millions of steps of all-atom MD simulations are needed to find the same bounded state.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-45461-2/41467_2024_45461_Fig1_HTML.png"/>
     </fig>
    </p>
   </sec>
   <sec id="Sec4">
    <title>
     DynamicBind achieves higher accuracy in ligand pose prediction and improves the initial AlphaFold-predicted protein conformations
    </title>
    <p id="Par8">
     To evaluate our method, we first utilized the PDBbind dataset
     <sup>
      <xref ref-type="bibr" rid="CR34">
       34
      </xref>
     </sup>
     and, in line with previous works
     <sup>
      <xref ref-type="bibr" rid="CR19">
       19
      </xref>
      ,
      <xref ref-type="bibr" rid="CR35">
       35
      </xref>
      ,
      <xref ref-type="bibr" rid="CR36">
       36
      </xref>
     </sup>
     , we trained the model using a chronological, time-based split of the training, validation, and test sets. Since the PDBbind test set, comprising around 300 structures from 2019, includes many non-small-molecule ligands (53 cases being polypeptides), we extended the scope of our assessment using a curated Major Drug Target (MDT) test set. The MDT set includes 599 structures that were deposited in or after 2020, with both drug-like ligands and proteins from four major protein families: kinases, GPCRs, nuclear receptors, and ion channels (refer to “Dataset construction” for more details). These protein families represent the targets of about 70% of FDA-approved small-molecule drugs
     <sup>
      <xref ref-type="bibr" rid="CR37">
       37
      </xref>
     </sup>
     .
    </p>
    <p id="Par9">
     Instead of using holo-structures as the input, we adopted a more challenging and realistic scenario during testing, where we assumed the holo protein conformation is not available and only use the protein conformations predicted by AlphaFold as our input. Holo conformations exhibit strong shape and charge complementarity to co-crystallized ligands, which already, unrealistically, simplify ligand pose prediction
     <sup>
      <xref ref-type="bibr" rid="CR11">
       11
      </xref>
     </sup>
     . In contrast, the apo conformations or those predicted by AlphaFold may clash with transplanted ligands obtained by superimposing crystal structures
     <sup>
      <xref ref-type="bibr" rid="CR14">
       14
      </xref>
     </sup>
     .
    </p>
    <p id="Par10">
     As shown in Fig.
     <xref ref-type="fig" rid="Fig2">
      2
     </xref>
     a and b, DynamicBind predicts more cases with ligand RMSD below various thresholds than other baselines. In particular, it achieves the fraction of ligand RMSD below 2 Å (5 Å), being 33% (65%) on the PDBbind test set and 39% (68%) on the MDT test set, respectively.
     <fig id="Fig2" position="float">
      <label>
       Fig. 2
      </label>
      <caption xml:lang="en">
       <title>
        Benchmark results overview.
       </title>
       <p>
        <bold>
         a
        </bold>
        ,
        <bold>
         b
        </bold>
        DynamicBind outperforms other methods in predicting ligand poses for both the PDBbind dataset (
        <bold>
         a
        </bold>
        ) and major drug targets (MDT) dataset (
        <bold>
         b
        </bold>
        ) across different RMSD thresholds.
        <bold>
         c
        </bold>
        Dark and light shades represent success rates under stringent (ligand RMSD &lt; 2 Å, clash score  &lt; 0.35) and relaxed (ligand RMSD &lt; 5 Å, clash score  &lt;0.5) criteria, respectively.
        <bold>
         d
        </bold>
        The protein conformations predicted by DynamicBind are more native-like, as evidenced by the lower pocket RMSD around the binding sites.
        <bold>
         e
        </bold>
        The contact-LDDT (cLDDT) score predicted by DynamicBind correlates well with the ligand RMSD and is a good predictor of the true ligand RMSD below 2 Å (auROC 0.764).
        <bold>
         f
        </bold>
        As the number of generated samples increases, the success rate increases.
        <bold>
         c
        </bold>
        –
        <bold>
         f
        </bold>
        display results for the combined PDBbind and MDT test sets. Results for individual datasets, as well as those filtered at 30%, 60%, and 90% maximum ligand and protein sequence similarity cutoffs, are detailed in Supplementary Figs.
        <xref ref-type="supplementary-material" rid="MOESM1">
         1
        </xref>
        –
        <xref ref-type="supplementary-material" rid="MOESM1">
         4
        </xref>
        . Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-45461-2/41467_2024_45461_Fig2_HTML.png"/>
     </fig>
    </p>
    <p id="Par11">
     Evaluating models solely on ligand RMSD may favor deep learning-based models (DiffDock, TankBind, and DynamicBind) due to their higher clash tolerance, while may disadvantage force field-based methods (GNINA, GLIDE, VINA) that strictly enforce Van der Waals forces. Significant clashes can impede interaction analysis in structure-based drug design, obscuring crucial molecular interactions and complicating the design of molecule improvements. Consequently, we use both ligand RMSD and clash scores (as defined by Hekkelman et al.
     <sup>
      <xref ref-type="bibr" rid="CR14">
       14
      </xref>
     </sup>
     ) to assess success rates. Figure
     <xref ref-type="fig" rid="Fig2">
      2
     </xref>
     c, shows the success rates using both a stringent criterion, ligand RMSD &lt; 2 Å, clash score &lt;0.35, and a more relaxed criterion, ligand RMSD &lt; 5 Å, clash score &lt; 0.5. The success rate of DynamicBind (0.33) is 1.7 times higher than the best baseline DiffDock (0.19) under the more stringent condition. Furthermore, DynamicBind has demonstrated the ability to reduce the pocket RMSD relative to the initial AlphaFold structure, even in cases with large original pocket RMSDs (Fig.
     <xref ref-type="fig" rid="Fig2">
      2
     </xref>
     d). This observation highlights that the present approach is capable of managing substantial conformational changes, recovering holo-structures when other methods may struggle. Given our model’s ability to generate diverse conformations, we developed the contact-LDDT (cLDDT) scoring module, a concept inspired by AlphaFold’s LDDT score. The module’s purpose is to select the most suitable complex structure from the predicted outputs. As shown in Fig.
     <xref ref-type="fig" rid="Fig2">
      2
     </xref>
     e, our predicted cLDDT correlates well with the actual ligand RMSD, indicating its effectiveness in selecting high-quality complex structures. The auROC score, with ligand RMSD below 2 Å as the true positive, is 0.764. While our cLDDT scoring function is effective, there is potential for improvement. Perfect selection could enhance our success rate from 0.33 to 0.5, as illustrated in Fig.
     <xref ref-type="fig" rid="Fig2">
      2
     </xref>
     f. Even in the absence of an ideal selection model, our method considerably outperforms DiffDock and the top force field-based method, GLIDE. Due to the variability in the number of samples produced by Glide, often because of its filtering scheme eliminating unrealistic conformations, Glide’s best performance is represented using a flat line. This line reflects the success rate determined by the most effective sample from Glide. DynamicBind’s exceptional performance stems from its ability to undergo significant protein conformational changes, leading to a better fit between the protein and the ligand.
    </p>
    <p id="Par12">
     To assess the model’s generalization to new proteins and ligands, we analyzed results stratified by maximum ligand and protein sequence similarity to the training set (Supplementary Figs.
     <xref ref-type="supplementary-material" rid="MOESM1">
      3
     </xref>
     and
     <xref ref-type="supplementary-material" rid="MOESM1">
      4
     </xref>
     ). This analysis reveals that DynamicBind performs well with new ligands, outperforming others, but is less effective with new proteins, where it is outperformed by classical docking methods with predefined ground-truth binding pockets. Other deep learning methods also show similar declines with new proteins, hinting at a need for larger training set and improved inductive biases. Moreover, considering that the identification of binding sites on new proteins is an active research area, the challenges encountered in blind global docking by deep learning methods, including ours, are likely shared across different approaches. Overall, DynamicBind’s proficiency with new ligands is significant in drug discovery, highlighting its potential in identifying protein conformational changes vital for creating effective, specific drugs.
    </p>
   </sec>
   <sec id="Sec5">
    <title>
     DynamicBind can capture ligand-specific protein conformational changes
    </title>
    <p id="Par13">
     Conventional docking protocols usually perform protein conformation sampling as a separate step from the docking process
     <sup>
      <xref ref-type="bibr" rid="CR15">
       15
      </xref>
      ,
      <xref ref-type="bibr" rid="CR38">
       38
      </xref>
     </sup>
     . In many instances, however, two distinct ligands may fit into mutually exclusive protein conformations. For example, c-Met kinase can adopt two different conformations, corresponding to active and inactive states, typically referred to as the Asp–Phe–Gly (DFG)-in and DFG-out conformations (Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     b, d). The DFG motif can flip out, subsequently blocking or opening up different regions of the protein. In previous docking models, the protein must be preset to the correct conformation to have a chance of identifying the appropriate binding pose for the ligand
     <sup>
      <xref ref-type="bibr" rid="CR20">
       20
      </xref>
     </sup>
     . In contrast, DynamicBind, utilizing the protein conformation predicted by AlphaFold (Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     a), can dynamically adjust the protein conformation to find the optimal conformation that accommodates the ligand of interest. As a representative case, for PDB 6UBW, the predicted ligand RMSD is 0.49 Å, and pocket RMSD is 1.97 Å, while the pocket RMSD for the AlphaFold structure is 9.44 Å. For PDB 7V3S, the predicted ligand RMSD is 0.51 Å, and the pocket RMSD is 1.19 Å, (AlphaFold 6.02 Å). Neither of the two ligands have been seen before in the training set (Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     c, e). In our quantitative analysis, only seven proteins from the test set, represented in 79 PDB structures, were found to adopt both DFG-in and DFG-out conformations, as annotated by the Kinase–Ligand Interaction Fingerprints and Structures (KLIFS) web server
     <sup>
      <xref ref-type="bibr" rid="CR39">
       39
      </xref>
     </sup>
     . Figure
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     f and g demonstrates how these proteins (denoted by their UniProt IDs), starting from the same initial structure, move progressively towards the DFG-in conformation upon type-I inhibitor binding, and incline towards the DFG-out conformation when interacting with a type-II inhibitor. Further, Fig.
     <xref ref-type="fig" rid="Fig3">
      3
     </xref>
     h reveals that the majority of the predicted protein structures show a lower pocket RMSD compared to the initial AlphaFold structures. These results demonstrate that, DynamicBind, is capable of capturing ligand-specific conformational changes. This feature is critical in preventing the overlooking of potential “hit” compounds that could bind well with conformations distinct from the initially provided protein structure.
     <fig id="Fig3" position="float">
      <label>
       Fig. 3
      </label>
      <caption xml:lang="en">
       <title>
        DynamicBind captures ligand-specific protein conformational changes.
       </title>
       <p>
        AlphaFold-predicted structures are depicted in white, the crystal structure with protein, and ligand in pink and cyan, respectively. Our model’s predictions are shown in green and orange, for the protein and ligand, respectively. The side chains of the Asp–Phe–Gly (DFG) residues are shown in stick. Red arrows highlight significant conformational changes of the crystal structure from the AlphaFold structure. The input conformation is the AlphaFold-predicted conformation.
        <bold>
         a
        </bold>
        When the ligand 84S (
        <bold>
         b
        </bold>
        ) binds to c-Met protein, the protein adopts a DFG-in conformation. When the ligand 5I9 (
        <bold>
         d
        </bold>
        ) binds to the same protein, the protein adopts a DFG-out conformation. Our prediction for both ligands (
        <bold>
         c
        </bold>
        ,
        <bold>
         e
        </bold>
        ) agrees well with the crystal structure. Ligand RMSD is 0.49 Å and 0.51 Å. Improvement of Pocket RMSD from initial AlphaFold is 7.47 Å and 4.83 Å for DFG-in and DFG-out, respectively. Among the test set, seven proteins (identified by their UniProt IDs), contains both DFG-in and DFG-out crystallized holo conformations, their pocket RMSD of both initial AlphaFold and predicted structures are shown in (
        <bold>
         f
        </bold>
        ,
        <italic>
         n
        </italic>
        = 39) and (
        <bold>
         g
        </bold>
        ,
        <italic>
         n
        </italic>
        = 34) for DFG-in holo conformations and DFG-out holo conformations separately, where central line marking the median, box edges indicating the upper and lower quartiles, whiskers extending up to 1.5 times the interquartile range, and individual points in dots.
        <bold>
         h
        </bold>
        The histogram of the improvement in pocket RMSD from AlphaFold for all 79 PDBs. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-45461-2/41467_2024_45461_Fig3_HTML.png"/>
     </fig>
    </p>
   </sec>
   <sec id="Sec6">
    <title>
     DynamicBind covers multi-scale protein conformation changes
    </title>
    <p id="Par14">
     The DFG-in/out conformation has been extensively studied, and some challenges can be partially addressed by employing ensemble docking, wherein proteins in both conformations are utilized for docking
     <sup>
      <xref ref-type="bibr" rid="CR40">
       40
      </xref>
      ,
      <xref ref-type="bibr" rid="CR41">
       41
      </xref>
     </sup>
     . Ensemble docking, however, elevates computational costs and may not be suitable for less well-characterized conformations. In this section, we provide a comprehensive analysis of six distinct conformational changes across the picosecond level to millisecond level, each exemplified by a case found in our PDBbind test set. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     , the crystal structure is depicted in pink, the AlphaFold structure in white, and our prediction in green. The native ligand is illustrated in cyan, and our predicted ligand is in orange. Δpocket RMSD measures the difference in pocket RMSD between the predicted protein structure and the AlphaFold structure, based on comparison with the crystal structure. A negative Δpocket RMSD indicates that the predicted aligns more closely with the crystal structure compared with the AlphaFold prediction. Δclash measures the difference in clash scores between the predicted protein–ligand pair and the AlphaFold structure with the transplanted ligand
     <sup>
      <xref ref-type="bibr" rid="CR14">
       14
      </xref>
     </sup>
     . A negative Δclash indicates fewer clashes in the predicted complex. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     a, the native ligand clashes with a side chain of the superimposed AlphaFold structure; in our prediction, this side chain shifts towards the native conformation, thus resolving the clash. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     b, a part of the pocket is blocked by a Tyrosine in the AlphaFold structure; it becomes accessible in both our predicted and native structures. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     c, a flexible loop intersects with the ligand, and it moves away in our prediction, consistent with the native structure. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     d, alpha helices transform into loops near the ligand-binding site. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     e, a substantial secondary structure motion is observed in the Heat shock protein, Hsp90
     <italic>
      α
     </italic>
     , transitioning from the closed state to the open state. In Fig.
     <xref ref-type="fig" rid="Fig4">
      4
     </xref>
     f, two domains of AKT1 kinase coalesce, forming a pocket that did not previously exist. Taken together, the present model can predict diverse types of conformational changes associated with ligand binding when the ligand-binding pocket is either insufficiently spacious or unformed in the AlphaFold-predicted conformations.
     <fig id="Fig4" position="float">
      <label>
       Fig. 4
      </label>
      <caption xml:lang="en">
       <title>
        DynamicBind effectively captures protein dynamics across diverse time scales.
       </title>
       <p>
        Proteins undergo conformational changes that can occur across a range of time scales upon binding with small-molecule ligands. A negative Δpocket RMSD indicates the predicted structure has a lower RMSD with the ground truth relative to the AlphaFold structure. A negative Δclash implies that the predicted ligand has lower clash score with the predicted structure compared to the transplanted ligand with the AlphaFold structure.
        <bold>
         a
        </bold>
        The side chain of Arginine rotates, mitigating clashes with the ligand.
        <bold>
         b
        </bold>
        The Tyrosine in the AlphaFold structure that was obstructing the binding pocket, shifts away in the predicted structure.
        <bold>
         c
        </bold>
        The loop region of the AlphaFold structure intersects with the ligand, and it is re-positioned in the predicted structure.
        <bold>
         d
        </bold>
        Alpha helices near the binding site transform into loops, aligning with the crystal structure.
        <bold>
         e
        </bold>
        The alpha helix of Hsp90 experiences a considerable relocation.
        <bold>
         f
        </bold>
        Two domains coalesce, thereby forming the binding pocket. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-45461-2/41467_2024_45461_Fig4_HTML.png"/>
     </fig>
    </p>
   </sec>
   <sec id="Sec7">
    <title>
     DynamicBind reveals cryptic pockets significant to drug discovery
    </title>
    <p id="Par15">
     The dynamic nature of proteins often gives rise to cryptic pockets. These cryptic pockets, which appear during protein dynamics, can reveal druggable sites not found in static structures, thus making previously ‘undruggable’ proteins into potential drug targets. We demonstrate the utility of DynamicBind in revealing these cryptic pockets using the SET domain-containing protein 2 (SETD2), a histone methyltransferase, as a case study. SETD2, critical for the treatment of multiple myeloma (MM) and diffuse large B-cell lymphoma (DLBCL)
     <sup>
      <xref ref-type="bibr" rid="CR42">
       42
      </xref>
      ,
      <xref ref-type="bibr" rid="CR43">
       43
      </xref>
     </sup>
     , has a cryptic pocket targeted by a highly selective compound, EZM0414, currently undergoing Phase I clinical trials. As illustrated in Fig.
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     a, b, all SETD2 homologs in the training set, defined by a protein Smith–Waterman similarity
     <sup>
      <xref ref-type="bibr" rid="CR44">
       44
      </xref>
     </sup>
     over 0.4, are co-crystallized with S-Adenosyl methionine (SAM) or Sinefungin analogs, depicted in lines. Sinefungin and its analogs broadly inhibit methyltransferases by occupying the SAM site
     <sup>
      <xref ref-type="bibr" rid="CR45">
       45
      </xref>
     </sup>
     , making the selective inhibition of SETD2 challenging. Before 2019, no structure of SETD2 or its homologs had been crystallized with a compound bound at the site targeted by EZM0414 (depicted in cyan sticks). Consequently, our model had not been trained on any structures with a compound bound to this newly identified site. In Fig.
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     c, the AlphaFold structure and its surface are shown in white. The cryptic site appears blocked, causing substantial clashes with the transplanted EZM0414. Figure
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     d confirms EZM0414 as an unseen ligand, with even the most similar Tanimoto ligands deviating substantially from EZM0414. Figure
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     e displays the protein–ligand complex structure predicted by our model, taking the AlphaFold-predicted structure of SETD2 and the SMILES representation of EZM0414 as inputs. Figure
     <xref ref-type="fig" rid="Fig5">
      5
     </xref>
     f overlays our prediction with the crystal structure of the SETD2-EZM0414 complex (PDB 7TY2). The resultant ligand RMSD is 1.4 Å, and the pocket RMSD is 2.16 Å. Furthermore, we have included in the Supplementary Information several cases from the Cryptosite dataset
     <sup>
      <xref ref-type="bibr" rid="CR46">
       46
      </xref>
     </sup>
     that have low sequence similarity to our training set.
     <fig id="Fig5" position="float">
      <label>
       Fig. 5
      </label>
      <caption xml:lang="en">
       <title>
        DynamicBind reveals cryptic pocket for ligand EZM0414.
       </title>
       <p>
        <bold>
         a
        </bold>
        Only six PDBs in the training set have a protein Smith–Waterman similarity greater than 0.4 with the SETD2 protein, and all are co-crystallized with SAM-like ligands, also shown in lines in (
        <bold>
         b
        </bold>
        ). The ligand of PDB 7TY2, EZM0414, is displayed in cyan sticks, with the protein shown in pink.
        <bold>
         c
        </bold>
        The binding pocket for EZM0414 is absent in the AlphaFold structure, depicted in white.
        <bold>
         d
        </bold>
        This panel shows the Tanimoto similarity of ligands in the training set compared to EZM0414, and the top three most similar ligands are drawn out.
        <bold>
         e
        </bold>
        The protein–ligand complex structure as predicted by DynamicBind, with the protein represented in green and the ligand in orange.
        <bold>
         f
        </bold>
        The superposition of the complex as predicted by DynamicBind and the corresponding crystal structure. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-45461-2/41467_2024_45461_Fig5_HTML.png"/>
     </fig>
    </p>
   </sec>
   <sec id="Sec8">
    <title>
     DynamicBind achieves better screening performance in an antibiotics benchmark
    </title>
    <p id="Par16">
     In target-based drug discovery, both screening of potential drug candidates and reverse screening, where protein targets are identified for specific compounds, are crucial. These processes require accurate prediction of binding affinities, the measure of the interaction strength between a protein and a compound, at a proteome level. Therefore, we have added an affinity prediction module to our model, trained using experimentally measured binding affinity data from the PDBbind dataset. To assess DynamicBind in a real-world virtual screening scenario, we used a recently published antibiotic experimental benchmark
     <sup>
      <xref ref-type="bibr" rid="CR25">
       25
      </xref>
     </sup>
     . This dataset includes a panel of 2616 protein-compound pairs, none of which were encountered during our training phase. It features 12 proteins from the essential proteome of Escherichia coli paired with 218 active antibacterial compounds. Figure
     <xref ref-type="fig" rid="Fig6">
      6
     </xref>
     a shows that DynamicBind surpasses both common docking methods like VINA and DOCK6.9 and the best machine learning-based re-scoring methods, achieving the mean average area under the receiver operating characteristic curve (auROC) of 0.68. Baseline numbers are directly sourced from the benchmark paper
     <sup>
      <xref ref-type="bibr" rid="CR25">
       25
      </xref>
     </sup>
     . This performance improvement is due to DynamicBind’s dynamic docking capability, which refines the AlphaFold structure towards a more native-like state, leading to a more precise binding affinity estimation. As depicted in Fig.
     <xref ref-type="fig" rid="Fig6">
      6
     </xref>
     b, the predicted structures of protein murD conform more closely around the ligand, forming more interactions that were not possible with the initial AlphaFold structure. This evaluation on the antibiotics benchmark agrees with our benchmarks on PDBbind test sets for binding affinity predictions (Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     ), where DynamicBind consistently outperforms traditional docking methods and deep learning-based rigid docking methods. These results indicate that DynamicBind, with its binding affinity prediction capability, exhibits significant potential for proteome-level virtual screening applications.
     <fig id="Fig6" position="float">
      <label>
       Fig. 6
      </label>
      <caption xml:lang="en">
       <title>
        DynamicBind achieves better screening performance in an antibiotics benchmark.
       </title>
       <p>
        <bold>
         a
        </bold>
        Comparative evaluation of the virtual screening performance on the antibiotics benchmark by different methods, measured in terms of auROC (area under the ROC curve). The benchmark encompasses
        <italic>
         n
        </italic>
        = 12 distinct protein systems. Each box plot shows the median (central line), upper and lower quartiles (box edges), whiskers extending up to 1.5 times the interquartile range, and individual data points (dots). We faithfully incorporated all six baseline numbers as presented in the benchmark paper
        <sup>
         <xref ref-type="bibr" rid="CR25">
          25
         </xref>
        </sup>
        .
        <bold>
         b
        </bold>
        The AlphaFold-predicted protein structure is shown in white, while the protein structures generated by DynamicBind for three active compounds are shown in green. Red arrows indicate the regions where the protein moves closer to the ligand, forming additional interactions. Source data are provided as a Source Data file.
       </p>
      </caption>
      <graphic mime-subtype="PNG" specific-use="web" xlink:href="/ProjectMundo/MediaObjects/10X1038_s41467-024-45461-2/41467_2024_45461_Fig6_HTML.png"/>
     </fig>
    </p>
   </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
   <title>
    Discussion
   </title>
   <p id="Par17">
    DynamicBind unifies two conventionally separated steps, protein conformation generation, and ligand pose prediction, into a single framework. As an end-to-end deep learning method, it is orders of magnitude faster than traditional MD simulations in sampling extensive protein conformational changes. Unlike traditional docking methods that demand predefined binding pockets, DynamicBind has the capability to perform global docking, a feature that becomes essential when the binding pocket has yet to be identified. These advantages empower DynamicBind for the virtual screening of compounds that bind to cryptic pockets. Such compounds are likely to bind exclusively to the target protein, thereby potentially minimizing side effects. In addition, DynamicBind can predict whether a new drug candidate may bind to an unintended protein target or can aid in identifying the binding target when an active compound is discovered via phenotype screening.
   </p>
   <p id="Par18">
    DynamicBind, while demonstrating state-of-the-art performance in our benchmarks, still presents opportunities for improvement, especially in enhancing its ability to generalize to proteins with low sequence homology compared to those in the training set
    <sup>
     <xref ref-type="bibr" rid="CR47">
      47
     </xref>
     ,
     <xref ref-type="bibr" rid="CR48">
      48
     </xref>
    </sup>
    . As a data-driven model, it significantly benefits from rapid advancements in Cryo-EM methods
    <sup>
     <xref ref-type="bibr" rid="CR49">
      49
     </xref>
     ,
     <xref ref-type="bibr" rid="CR50">
      50
     </xref>
     –
     <xref ref-type="bibr" rid="CR51">
      51
     </xref>
    </sup>
    . These technological progressions will broaden the diversity and comprehensiveness of our training data, providing more varied conformations of protein–ligand complexes at a faster rate. There is also potential to improve DynamicBind by utilizing a large amount of non-structural binding affinity data, which are currently more abundant than crystallized structures. By adopting a self-distillation approach analogous to AlphaFold
    <sup>
     <xref ref-type="bibr" rid="CR5">
      5
     </xref>
    </sup>
    , we could augment our training set by integrating high-confidence predictions of the complex structures of protein–ligand pairs that previously only had affinity data available.
   </p>
   <p id="Par19">
    In summary, DynamicBind presents a “dynamic docking” approach for investigating protein–ligand interactions, setting it apart from traditional docking methods that treat proteins as static and molecular dynamics (MD) simulations that are computationally demanding. Its capacity for large-scale protein dynamics carries particularly significant implications for the discovery of drug molecules, especially those targeting cryptic pockets. In addition, the ligand-specific protein conformations generated by DynamicBind may offer valuable insights into the influence of ligands on proteins, potentially clarifying structure-function relationships and augmenting our mechanistic understanding.
   </p>
  </sec>
  <sec id="Sec10" sec-type="methods">
   <title>
    Methods
   </title>
   <sec id="Sec11">
    <title>
     Overview
    </title>
    <p id="Par20">
     Our model is an E(3)-equivariant, diffusion-based, graph neural network utilizing a coarse-grained representation.
    </p>
    <p id="Par21">
     An E(3)-equivariant model transforms the output,
     <italic>
      y
     </italic>
     , according to the trans-rotation and parity operations applied to the input
     <italic>
      x
     </italic>
     in 3D space
     <sup>
      <xref ref-type="bibr" rid="CR52">
       52
      </xref>
     </sup>
     . Research has demonstrated that equivariant models can be trained with 1000 times less data while yielding superior results on the structures of bulk water
     <sup>
      <xref ref-type="bibr" rid="CR53">
       53
      </xref>
     </sup>
     . Despite substantial advancements in cryo-electron microscopy and crystallography, the existing protein–ligand complex database remains relatively limited, only extending to tens of thousands in size. Consequently, an efficient model is required, capable of discerning the most relevant information and avoiding superficial information that does not hold true upon relocating or rotating the entire structure. The traditional approach to fulfilling the SO(3) symmetry involves exclusively using or predicting invariant quantities, such as the contact map. However, a contact or distance map does not always correlate with physically feasible configurations. For instance, a residue may be predicted to be in contact with two vastly distant atoms. In addition, a contact map may overlook chirality, a significant aspect in drug discovery
     <sup>
      <xref ref-type="bibr" rid="CR54">
       54
      </xref>
     </sup>
     .
    </p>
    <p id="Par22">
     As a diffusion-based model, DynamicBind is trained through a process that incrementally distorts the native conformation at various degrees, enabling the model to learn how to restore the correct conformation. Distorting the original configuration commonly involves adding trans-locational Gaussian noise to the atoms. With bond distance constraints imposed by chemical bonds and excluded volume effects enforced by Van der Waals forces, restoring from such distortions is straightforward when the distortion is relatively small. However, we observed that merely adding Gaussian noise is insufficient to train a model that can predict the transformation from one biologically meaningful configuration to another. To address this, we introduced a morph-like transformation that interpolates between the crystal protein structure and the structure predicted by AlphaFold, thereby reducing the transition barriers between meta-stable configurations, such as the AlphaFold-predicted conformation, and the ligand-bounded holo configuration. Unlike other generative models that train a score function,
     <inline-formula id="IEq1">
      <alternatives>
       <math id="IEq1_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold-italic">
           s
          </mi>
         </mrow>
         <mrow>
          <mi>
           θ
          </mi>
         </mrow>
        </msub>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mspace width="0.25em"/>
        <mo>
         ≈
        </mo>
        <mspace width="0.25em"/>
        <mo>
         ∇
        </mo>
        <mi>
         log
        </mi>
        <msub>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
        </msub>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq1_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\boldsymbol{s}}}}}}}}}_{\theta }({{{{{{{\bf{x}}}}}}}},t) \, \approx \, \nabla \log {p}_{t}({{{{{{{\bf{x}}}}}}}})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq1.gif"/>
      </alternatives>
     </inline-formula>
     , our diffusion architectures aim to map perturbed structures directly back to the original conformations, akin to the consistency model
     <sup>
      <xref ref-type="bibr" rid="CR29">
       29
      </xref>
      ,
      <xref ref-type="bibr" rid="CR55">
       55
      </xref>
     </sup>
     . The outputs of the model are denoted as
     <inline-formula id="IEq2">
      <alternatives>
       <math id="IEq2_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold-italic">
           f
          </mi>
         </mrow>
         <mrow>
          <mi>
           θ
          </mi>
         </mrow>
        </msub>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
          <mo>
           ,
          </mo>
          <mi>
           t
          </mi>
         </mrow>
        </mfenced>
        <mo>
         =
        </mo>
        <mo>
         −
        </mo>
        <mi mathvariant="bold-italic">
         ϕ
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
          <mo>
           ,
          </mo>
          <mi>
           t
          </mi>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="IEq2_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\boldsymbol{f}}}}}}}}}_{\theta }\left({{{{{{{{\bf{x}}}}}}}}}_{t},t\right)=-{{{{{{{\boldsymbol{\phi }}}}}}}}\left({{{{{{{{\bf{x}}}}}}}}}_{t},t\right)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq2.gif"/>
      </alternatives>
     </inline-formula>
     , where
     <inline-formula id="IEq3">
      <alternatives>
       <math id="IEq3_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold-italic">
         ϕ
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
          <mo>
           ,
          </mo>
          <mi>
           t
          </mi>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="IEq3_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\boldsymbol{\phi }}}}}}}}\left({{{{{{{{\bf{x}}}}}}}}}_{t},t\right)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq3.gif"/>
      </alternatives>
     </inline-formula>
     represents the added morph-like transformation to the native conformation.
    </p>
    <p id="Par23">
     Traditional methods use an all-atom representation, modeling the coordinates of every atom explicitly. However, atoms do not move independently due to their connections via chemical bonds, and local geometry is highly constrained—for example, a benzene ring is generally flat. To reduce the number of degrees of freedom of these nonphysical configurations, we adopted a coarse-grained representation for both the protein and the ligand. In our model, each protein residue is represented by a node with two vectors—coordinates and directions, and side-chain dihedral angles. More details are provided in “Featurization”. For the ligand, every heavy atom is represented by a node, and these nodes transform in an extrinsic-to-intrinsic manner, wherein changes in torsional angles are converted into changes in Cartesian coordinates
     <sup>
      <xref ref-type="bibr" rid="CR33">
       33
      </xref>
     </sup>
     . Additional details can be found in “Transformation of the ligand conformation”. Notably, despite being a coarse-grained representation, the coordinates of all non-hydrogen atoms can still be mapped in a one-to-one manner.
    </p>
    <p id="Par24">
     The input to our model is the current conformation of the protein and the ligand. The outputs include the predicted updates to
     <italic>
      k
     </italic>
     <sup>
      <italic>
       l
      </italic>
     </sup>
     scalar torsion angles and two translation–rotation vectors for each ligand, along with updates to
     <inline-formula id="IEq4">
      <alternatives>
       <math id="IEq4_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq4_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{i}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq4.gif"/>
      </alternatives>
     </inline-formula>
     scalar dihedral angles of the side-chain and two translation–rotation vectors of the backbone for each protein residue. Further details can be found in “Transformation of the protein conformation”. In addition, the model produces two scalar outputs: one to estimate the degree of the native conformation as assessed by cLDDT (contact-LDDT), and another to predict the binding affinity between the protein and ligand.
    </p>
   </sec>
   <sec id="Sec12">
    <title>
     Featurization
    </title>
    <p id="Par25">
     The ligand in our model is the attributed graph
     <inline-formula id="IEq5">
      <alternatives>
       <math id="IEq5_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           G
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msup>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             V
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
          <mo>
           ,
          </mo>
          <msup>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             E
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq5_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}^{l}=({{{{{{{{\mathcal{V}}}}}}}}}^{l},{{{{{{{{\mathcal{E}}}}}}}}}^{l})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq5.gif"/>
      </alternatives>
     </inline-formula>
     , in which each node
     <inline-formula id="IEq6">
      <alternatives>
       <math id="IEq6_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="fraktur">
           v
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         ∈
        </mo>
        <msup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           V
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq6_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathfrak{v}}}_{i}^{l}\in {{{{{{{{\mathcal{V}}}}}}}}}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq6.gif"/>
      </alternatives>
     </inline-formula>
     represents a heavy atom and the aromatic, single, double, or triple bonds as the edges. The node features of the ligand graph include atomic number, chirality, degree, and formal charge. In addition to bond type, edge length embedding is also used as scalar edge features.
    </p>
    <p id="Par26">
     The protein graph is denoted as
     <inline-formula id="IEq7">
      <alternatives>
       <math id="IEq7_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           G
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msup>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             V
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msup>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msup>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             E
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq7_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}^{p}=({{{{{{{{\mathcal{V}}}}}}}}}^{p},\, {{{{{{{{\mathcal{E}}}}}}}}}^{p})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq7.gif"/>
      </alternatives>
     </inline-formula>
     , where each node
     <inline-formula id="IEq8">
      <alternatives>
       <math id="IEq8_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="fraktur">
         v
        </mi>
        <msup>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msup>
        <mo>
         ∈
        </mo>
        <msup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           V
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq8_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathfrak{v}}{i}^{p}\in {{{{{{{{\mathcal{V}}}}}}}}}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq8.gif"/>
      </alternatives>
     </inline-formula>
     corresponds to a residue at the
     <italic>
      C
     </italic>
     <sub>
      <italic>
       α
      </italic>
     </sub>
     position. The node features in the protein graph include amino acid type, language model embedding from
     <bold>
      esm
     </bold>
     <sup>
      <xref ref-type="bibr" rid="CR7">
       7
      </xref>
     </sup>
     , and side-chain dihedral angles, which are represented as (7 × 2)-dimensional zero-padded scalar features (five rotatable chi angles [chi1, chi2, ..., chi5] and two symmetric chi angles [altchi1, altchi2] for each amino acid, and these angles are transformed into sine and cosine values). To ensure the uniqueness of the side-chain angles for a given structure, we consistently handle it as [
     <inline-formula id="IEq9">
      <alternatives>
       <math id="IEq9_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         max
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mspace width="0.25em"/>
          <mstyle>
           <mtext>
            chi1
           </mtext>
          </mstyle>
          <mo>
           ,
          </mo>
          <mstyle>
           <mtext>
            altchi1
           </mtext>
          </mstyle>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         ,
        </mo>
        <mi>
         min
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mstyle>
           <mtext>
            chi1
           </mtext>
          </mstyle>
          <mo>
           ,
          </mo>
          <mstyle>
           <mtext>
            altchi1
           </mtext>
          </mstyle>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         ,
        </mo>
        <mi>
         max
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mstyle>
           <mtext>
            chi2
           </mtext>
          </mstyle>
          <mo>
           ,
          </mo>
          <mstyle>
           <mtext>
            altchi2
           </mtext>
          </mstyle>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         ,
        </mo>
        <mi>
         min
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mstyle>
           <mtext>
            chi2
           </mtext>
          </mstyle>
          <mo>
           ,
          </mo>
          <mstyle>
           <mtext>
            altchi2
           </mtext>
          </mstyle>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq9_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max (\,{{\mbox{chi1}}},{{\mbox{altchi1}}}),\min ({{\mbox{chi1}}},{{\mbox{altchi1}}}),\max ({{\mbox{chi2}}},{{\mbox{altchi2}}}),\min ({{\mbox{chi2}}},{{\mbox{altchi2}}}\,)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq9.gif"/>
      </alternatives>
     </inline-formula>
     , chi3, chi4, chi5]. In addition, the backbone orientation is represented as two unit vector features, which are
     <inline-formula id="IEq10">
      <alternatives>
       <math id="IEq10_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mfrac>
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             N
            </mi>
           </mrow>
          </msub>
          <mo>
           −
          </mo>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow>
              <mi>
               C
              </mi>
             </mrow>
             <mrow>
              <mi>
               α
              </mi>
             </mrow>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <mrow>
          <mfenced close="∥" open="∥">
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               N
              </mi>
             </mrow>
            </msub>
            <mo>
             −
            </mo>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <msub>
               <mrow>
                <mi>
                 C
                </mi>
               </mrow>
               <mrow>
                <mi>
                 α
                </mi>
               </mrow>
              </msub>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
         </mrow>
        </mfrac>
       </math>
       <tex-math id="IEq10_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{{{{{{{{\bf{x}}}}}}}}}_{N}-{{{{{{{{\bf{x}}}}}}}}}_{{C}_{\alpha }}}{\left\Vert {{{{{{{{\bf{x}}}}}}}}}_{N}-{{{{{{{{\bf{x}}}}}}}}}_{{C}_{\alpha }}\right\Vert }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq10.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq11">
      <alternatives>
       <math id="IEq11_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mfrac>
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             C
            </mi>
           </mrow>
          </msub>
          <mo>
           −
          </mo>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow>
              <mi>
               C
              </mi>
             </mrow>
             <mrow>
              <mi>
               α
              </mi>
             </mrow>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <mrow>
          <mfenced close="∥" open="∥">
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               C
              </mi>
             </mrow>
            </msub>
            <mo>
             −
            </mo>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <msub>
               <mrow>
                <mi>
                 C
                </mi>
               </mrow>
               <mrow>
                <mi>
                 α
                </mi>
               </mrow>
              </msub>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
         </mrow>
        </mfrac>
       </math>
       <tex-math id="IEq11_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{{{{{{{{\bf{x}}}}}}}}}_{C}-{{{{{{{{\bf{x}}}}}}}}}_{{C}_{\alpha }}}{\left\Vert {{{{{{{{\bf{x}}}}}}}}}_{C}-{{{{{{{{\bf{x}}}}}}}}}_{{C}_{\alpha }}\right\Vert }$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq11.gif"/>
      </alternatives>
     </inline-formula>
     . For edges, length embedding is used as scalar features. Our featurization of the amino acid enable the model to infer the positions of all heavy atoms.
    </p>
   </sec>
   <sec id="Sec13">
    <title>
     Model architecture
    </title>
    <p id="Par27">
     DynamicBind is a graph neural network that uses both equivariant and invariant features. It propagates information using tensor products of irreducible representations (irreps) as per the definitions in the e3nn library
     <sup>
      <xref ref-type="bibr" rid="CR52">
       52
      </xref>
     </sup>
     .
    </p>
    <p id="Par28">
     The input scalar features of nodes and edges are concatenated with sinusoidal embeddings
     <sup>
      <xref ref-type="bibr" rid="CR56">
       56
      </xref>
     </sup>
     of diffusion time and then encoded by different multilayer perceptrons (MLPs). For the protein node, the two unit vector features of amino acids are combined with the new scalar representations to form the initial features for interaction layers. Similar to DiffDock
     <sup>
      <xref ref-type="bibr" rid="CR19">
       19
      </xref>
     </sup>
     , in each step of the graph propagation process, the ligand and protein graphs undergo one intra-interaction and one inter-interaction. In the ligand’s intra-interaction, the representation of each ligand atom is updated by other ligand atoms within a distance of 5 Å. For the protein, each amino acid is updated by other amino acids within a distance of 15 Å. To reduce the training runtime and memory usage of the model, a maximum of 24 neighbors is allowed for each residue. The edges for inter-interaction are determined based on whether an amino acid is within a distance of (3
     <italic>
      σ
     </italic>
     <sub>
      <italic>
       t
      </italic>
      <italic>
       r
      </italic>
     </sub>
     + 12) Å from any ligand atom, where
     <italic>
      σ
     </italic>
     <sub>
      <italic>
       t
      </italic>
      <italic>
       r
      </italic>
     </sub>
     is the current standard deviation of the diffusion translational noise. This dynamic cutoff is designed to ensure interconnections exist even when the ligand is far from the receptor when
     <italic>
      σ
     </italic>
     <sub>
      <italic>
       t
      </italic>
      <italic>
       r
      </italic>
     </sub>
     is large. After the connected graph is determined, the messages of the node is updated by the TensorProductLayer. Specifically, for each node a belonging to category
     <italic>
      c
     </italic>
     <sub>
      <italic>
       a
      </italic>
     </sub>
     :
     <disp-formula id="Equ1">
      <label>
       1
      </label>
      <alternatives>
       <math id="Equ1_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
         </mrow>
        </msub>
        <mo>
         ←
        </mo>
        <msub>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
         </mrow>
        </msub>
        <munder>
         <mrow>
          <mo>
           ⊕
          </mo>
         </mrow>
         <mrow>
          <mi>
           c
          </mi>
          <mo>
           ∈
          </mo>
          <mrow>
           <mo>
            {
           </mo>
           <mrow>
            <mi>
             ℓ
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             r
            </mi>
           </mrow>
           <mo>
            }
           </mo>
          </mrow>
         </mrow>
        </munder>
        <msup>
         <mrow>
          <mi mathvariant="normal">
           BN
          </mi>
         </mrow>
         <mrow>
          <mfenced close=")" open="(">
           <mrow>
            <msub>
             <mrow>
              <mi>
               c
              </mi>
             </mrow>
             <mrow>
              <mi>
               a
              </mi>
             </mrow>
            </msub>
            <mo>
             ,
            </mo>
            <mi>
             c
            </mi>
           </mrow>
          </mfenced>
         </mrow>
        </msup>
        <mfenced close=")" open="(">
         <mrow>
          <mfrac>
           <mrow>
            <mn>
             1
            </mn>
           </mrow>
           <mrow>
            <mo>
             ∣
            </mo>
            <msubsup>
             <mrow>
              <mi class="MJX-tex-caligraphic" mathvariant="script">
               N
              </mi>
             </mrow>
             <mrow>
              <mi>
               a
              </mi>
             </mrow>
             <mrow>
              <mrow>
               <mo>
                (
               </mo>
               <mrow>
                <mi>
                 c
                </mi>
               </mrow>
               <mo>
                )
               </mo>
              </mrow>
             </mrow>
            </msubsup>
            <mo>
             ∣
            </mo>
           </mrow>
          </mfrac>
          <munder>
           <mrow>
            <mo>
             ∑
            </mo>
           </mrow>
           <mrow>
            <mi>
             b
            </mi>
            <mo>
             ∈
            </mo>
            <msubsup>
             <mrow>
              <mi class="MJX-tex-caligraphic" mathvariant="script">
               N
              </mi>
             </mrow>
             <mrow>
              <mi>
               a
              </mi>
             </mrow>
             <mrow>
              <mrow>
               <mo>
                (
               </mo>
               <mrow>
                <mi>
                 c
                </mi>
               </mrow>
               <mo>
                )
               </mo>
              </mrow>
             </mrow>
            </msubsup>
           </mrow>
          </munder>
          <mi>
           Y
          </mi>
          <mfenced close=")" open="(">
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               r
              </mi>
             </mrow>
             <mrow>
              <mi>
               a
              </mi>
              <mi>
               b
              </mi>
             </mrow>
            </msub>
           </mrow>
          </mfenced>
          <msub>
           <mrow>
            <mo>
             ⊗
            </mo>
           </mrow>
           <mrow>
            <msub>
             <mrow>
              <mi>
               ψ
              </mi>
             </mrow>
             <mrow>
              <mi>
               a
              </mi>
              <mi>
               b
              </mi>
             </mrow>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             b
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <msub>
         <mrow>
          <mi>
           ψ
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
          <mi>
           b
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <msup>
         <mrow>
          <mi mathvariant="normal">
           Ψ
          </mi>
         </mrow>
         <mrow>
          <mfenced close=")" open="(">
           <mrow>
            <msub>
             <mrow>
              <mi>
               c
              </mi>
             </mrow>
             <mrow>
              <mi>
               a
              </mi>
             </mrow>
            </msub>
            <mo>
             ,
            </mo>
            <mi>
             c
            </mi>
           </mrow>
          </mfenced>
         </mrow>
        </msup>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi>
             e
            </mi>
           </mrow>
           <mrow>
            <mi>
             a
            </mi>
            <mi>
             b
            </mi>
           </mrow>
          </msub>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             a
            </mi>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             b
            </mi>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ1_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{h}}}}}}}}}_{a}\leftarrow 	{{{{{{{{\bf{h}}}}}}}}}_{a}\mathop{\oplus }\limits_{c\in \{\ell,r\}} {{{{{{{{\rm{BN}}}}}}}}}^{\left({c}_{a},c\right)}\left(\frac{1}{| {{{{{{{{\mathcal{N}}}}}}}}}_{a}^{(c)}| }\mathop{\sum}\limits_{b\in {{{{{{{{\mathcal{N}}}}}}}}}_{a}^{(c)}}Y\left({{{{{{{{\bf{r}}}}}}}}}_{ab}\right){\otimes }_{{\psi }_{ab}}{{{{{{{{\bf{h}}}}}}}}}_{b}\right)\\ 	\,{{\mbox{with}}}\,\,{\psi }_{ab}={\Psi }^{\left({c}_{a},c\right)}\left({e}_{ab},\, {{{{{{{{\bf{h}}}}}}}}}_{a}^{0},\, {{{{{{{{\bf{h}}}}}}}}}_{b}^{0}\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ1.gif"/>
      </alternatives>
     </disp-formula>
     Here,
     <bold>
      h
     </bold>
     <sub>
      <italic>
       a
      </italic>
     </sub>
     represents the features of a node, and
     <inline-formula id="IEq12">
      <alternatives>
       <math id="IEq12_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
         </mrow>
         <mrow>
          <mn>
           0
          </mn>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq12_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{h}}}}}}}}}_{a}^{0}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq12.gif"/>
      </alternatives>
     </inline-formula>
     denotes its scalar features.
     <inline-formula id="IEq13">
      <alternatives>
       <math id="IEq13_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           N
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
         </mrow>
         <mrow>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             c
            </mi>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq13_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{N}}}}}}}}}_{a}^{(c)}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq13.gif"/>
      </alternatives>
     </inline-formula>
     refers to the neighbors of node
     <italic>
      a
     </italic>
     of category
     <italic>
      c
     </italic>
     (either ligand, or protein). The spherical harmonics are denoted as
     <italic>
      Y
     </italic>
     , and BN represents the (equivariant) batch normalization. The module Ψ is a MLP which contains learnable weights for the tensor product, which are computed based on the edge embeddings,
     <italic>
      e
     </italic>
     <sub>
      <italic>
       a
      </italic>
      <italic>
       b
      </italic>
     </sub>
     , and scalar features,
     <inline-formula id="IEq14">
      <alternatives>
       <math id="IEq14_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
         </mrow>
         <mrow>
          <mn>
           0
          </mn>
         </mrow>
        </msubsup>
        <mo>
         ,
        </mo>
        <mspace width="0.25em"/>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
         </mrow>
         <mrow>
          <mn>
           0
          </mn>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq14_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{h}}}}}}}}}_{a}^{0},\, {{{{{{{{\bf{h}}}}}}}}}_{b}^{0}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq14.gif"/>
      </alternatives>
     </inline-formula>
     .
    </p>
    <p id="Par29">
     After the final interaction layer, the node representations are used to produce the outputs. For generating the cLDDT, binding affinity, ligand’s translation and rotation predictions, a convolution of each ligand atom with the geometric center of the ligand is employed:
     <disp-formula id="Equ2">
      <label>
       2
      </label>
      <alternatives>
       <math id="Equ2_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi mathvariant="bold">
         v
        </mi>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mo>
           ∣
          </mo>
          <msup>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             V
            </mi>
           </mrow>
           <mrow>
            <mi>
             ℓ
            </mi>
           </mrow>
          </msup>
          <mo>
           ∣
          </mo>
         </mrow>
        </mfrac>
        <munder>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
          <mo>
           ∈
          </mo>
          <msup>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             V
            </mi>
           </mrow>
           <mrow>
            <mi>
             ℓ
            </mi>
           </mrow>
          </msup>
         </mrow>
        </munder>
        <mi>
         Y
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             a
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
        <msub>
         <mrow>
          <mo>
           ⊗
          </mo>
         </mrow>
         <mrow>
          <msub>
           <mrow>
            <mi>
             ψ
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             a
            </mi>
           </mrow>
          </msub>
         </mrow>
        </msub>
        <msub>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
         </mrow>
        </msub>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <msub>
         <mrow>
          <mi>
           ψ
          </mi>
         </mrow>
         <mrow>
          <mi>
           o
          </mi>
          <mi>
           a
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <mi mathvariant="normal">
         Ψ
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi>
             e
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             a
            </mi>
           </mrow>
          </msub>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             a
            </mi>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ2_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\bf{v}}}}}}}}=	\frac{1}{| {{{{{{{{\mathcal{V}}}}}}}}}^{\ell }| }\mathop{\sum}\limits_{a\in {{{{{{{{\mathcal{V}}}}}}}}}^{\ell }}Y\left({{{{{{{{\bf{r}}}}}}}}}_{oa}\right){\otimes }_{{\psi }_{oa}}{{{{{{{{\bf{h}}}}}}}}}_{a}\\ 	{{\mbox{with}}}\,\,{\psi }_{oa}=\Psi \left({e}_{oa},\, {{{{{{{{\bf{h}}}}}}}}}_{a}^{0}\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ2.gif"/>
      </alternatives>
     </disp-formula>
     where
     <italic>
      e
     </italic>
     <sub>
      <italic>
       o
      </italic>
      <italic>
       a
      </italic>
     </sub>
     is the edge embedding between the geometric center of the ligand and a ligand node a. The output
     <bold>
      v
     </bold>
     consists of 144 even scalars, 2 odd parity vectors and 2 even vectors. The scalars are used for predicting the cLDDT (D) and negative logarithm of the binding affinity (A) as measured in the unit of concentration.
     <disp-formula id="Equ3">
      <label>
       3
      </label>
      <alternatives>
       <math id="Equ3_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         D
        </mi>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             v
            </mi>
           </mrow>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             c
            </mi>
            <mi>
             a
            </mi>
            <mi>
             l
            </mi>
            <mi>
             a
            </mi>
            <mi>
             r
            </mi>
           </mrow>
          </msub>
          <mrow>
           <mo>
            [
           </mo>
           <mrow>
            <mo>
             :
            </mo>
            <mn>
             72
            </mn>
           </mrow>
           <mo>
            ]
           </mo>
          </mrow>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="Equ3_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D=\,{{\mbox{MLP}}}\,({{{{{{{{\bf{v}}}}}}}}}_{scalar}[:72])$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ3.gif"/>
      </alternatives>
     </disp-formula>
     <disp-formula id="Equ4">
      <label>
       4
      </label>
      <alternatives>
       <math id="Equ4_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         A
        </mi>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          clamp
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <mfrac>
           <mrow>
            <mspace width="0.25em"/>
            <mstyle>
             <mtext>
              MLP
             </mtext>
            </mstyle>
            <mspace width="0.25em"/>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <msub>
               <mrow>
                <mi mathvariant="bold">
                 v
                </mi>
               </mrow>
               <mrow>
                <mi>
                 s
                </mi>
                <mi>
                 c
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 l
                </mi>
                <mi>
                 a
                </mi>
                <mi>
                 r
                </mi>
               </mrow>
              </msub>
              <mrow>
               <mo>
                [
               </mo>
               <mrow>
                <mn>
                 72
                </mn>
                <mo>
                 :
                </mo>
                <mn>
                 144
                </mn>
               </mrow>
               <mo>
                ]
               </mo>
              </mrow>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
           <mrow>
            <mi>
             D
            </mi>
            <mo>
             +
            </mo>
            <mspace width="0.25em"/>
            <mstyle>
             <mtext>
              eps
             </mtext>
            </mstyle>
           </mrow>
          </mfrac>
          <mo>
           ,
          </mo>
          <mi>
           min
          </mi>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
          <mo>
           ,
          </mo>
          <mi>
           max
          </mi>
          <mo>
           =
          </mo>
          <mn>
           15
          </mn>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ4_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A=\,{{\mbox{clamp}}}\,\left(\frac{\,{{\mbox{MLP}}}\,({{{{{{{{\bf{v}}}}}}}}}_{scalar}[72:144])}{D+\,{{\mbox{eps}}}\,},\min=0,\max=15\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ4.gif"/>
      </alternatives>
     </disp-formula>
     The odd vectors are used to predict ligand translation, while the even vectors are used to predict ligand rotation:
     <disp-formula id="Equ5">
      <label>
       5
      </label>
      <alternatives>
       <math id="Equ5_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               v
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               v
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           +
          </mo>
          <mspace width="0.25em"/>
          <mstyle>
           <mtext>
            eps
           </mtext>
          </mstyle>
         </mrow>
        </mfrac>
        <mo>
         ×
        </mo>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               v
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             s
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ5_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{tr}}}}}}}}}^{l}=\frac{{\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}^{odd}}{\parallel {\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}^{odd}\parallel+\,{{\mbox{eps}}}}\times {{\mbox{MLP}}}\,\left(\parallel {\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}^{odd}\parallel,\, {{{{{{{{\bf{s}}}}}}}}}_{t}\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ5.gif"/>
      </alternatives>
     </disp-formula>
     <disp-formula id="Equ6">
      <label>
       6
      </label>
      <alternatives>
       <math id="Equ6_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               v
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               v
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           +
          </mo>
          <mspace width="0.25em"/>
          <mstyle>
           <mtext>
            eps
           </mtext>
          </mstyle>
         </mrow>
        </mfrac>
        <mo>
         ×
        </mo>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               v
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             s
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <msub>
         <mrow>
          <mover accent="true">
           <mrow>
            <mi mathvariant="bold">
             v
            </mi>
           </mrow>
           <mo accent="true">
            ¯
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           v
          </mi>
          <mi>
           e
          </mi>
          <mi>
           c
          </mi>
          <mi>
           t
          </mi>
          <mi>
           o
          </mi>
          <mi>
           r
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             v
            </mi>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
          </msub>
          <mrow>
           <mo>
            [
           </mo>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
           <mo>
            ]
           </mo>
          </mrow>
          <mo>
           +
          </mo>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             v
            </mi>
           </mrow>
           <mrow>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
          </msub>
          <mrow>
           <mo>
            [
           </mo>
           <mrow>
            <mn>
             1
            </mn>
           </mrow>
           <mo>
            ]
           </mo>
          </mrow>
         </mrow>
         <mrow>
          <mn>
           2
          </mn>
         </mrow>
        </mfrac>
       </math>
       <tex-math id="Equ6_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{rot}}}}}}}}}^{l}=	\frac{{\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}^{even}}{\parallel {\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}^{even}\parallel+\,{{\mbox{eps}}}}\times {{\mbox{MLP}}}\,\left(\parallel {\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}^{even}\parallel,\, {{{{{{{{\bf{s}}}}}}}}}_{t}\right)\\ 	{{\mbox{with}}}\,\,{\overline{{{{{{{{\bf{v}}}}}}}}}}_{vector}=\frac{{{{{{{{{\bf{v}}}}}}}}}_{vector}[0]+{{{{{{{{\bf{v}}}}}}}}}_{vector}[1]}{2}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ6.gif"/>
      </alternatives>
     </disp-formula>
     Here,
     <bold>
      s
     </bold>
     <sub>
      <italic>
       t
      </italic>
     </sub>
     is the sinusoidal embeddings of the diffusion time, eps = 10
     <sup>
      −12
     </sup>
     is added for numerical stability. Following Jing et al.
     <sup>
      <xref ref-type="bibr" rid="CR33">
       33
      </xref>
     </sup>
     , our model predicts a scalar torsion update for each rotatable bond of ligand. For bond
     <italic>
      b
     </italic>
     , the torsion update
     <inline-formula id="IEq15">
      <alternatives>
       <math id="IEq15_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq15_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{b}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq15.gif"/>
      </alternatives>
     </inline-formula>
     is generated by a convolution of every atom on a radius graph with the bond center
     <italic>
      o
     </italic>
     :
     <disp-formula id="Equ7">
      <label>
       7
      </label>
      <alternatives>
       <math id="Equ7_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           b
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <mfrac>
           <mrow>
            <mn>
             1
            </mn>
           </mrow>
           <mrow>
            <mo>
             ∣
            </mo>
            <msub>
             <mrow>
              <mi class="MJX-tex-caligraphic" mathvariant="script">
               N
              </mi>
             </mrow>
             <mrow>
              <mi>
               b
              </mi>
             </mrow>
            </msub>
            <mo>
             ∣
            </mo>
           </mrow>
          </mfrac>
          <munder>
           <mrow>
            <mo>
             ∑
            </mo>
           </mrow>
           <mrow>
            <mi>
             a
            </mi>
            <mo>
             ∈
            </mo>
            <msub>
             <mrow>
              <mi class="MJX-tex-caligraphic" mathvariant="script">
               N
              </mi>
             </mrow>
             <mrow>
              <mi>
               b
              </mi>
             </mrow>
            </msub>
           </mrow>
          </munder>
          <mi>
           Y
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               r
              </mi>
             </mrow>
             <mrow>
              <mi mathvariant="bold">
               oa
              </mi>
             </mrow>
            </msub>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           ⊗
          </mo>
          <msup>
           <mrow>
            <mi>
             Y
            </mi>
           </mrow>
           <mrow>
            <mn>
             2
            </mn>
           </mrow>
          </msup>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msub>
             <mrow>
              <mi mathvariant="bold">
               r
              </mi>
             </mrow>
             <mrow>
              <mi>
               b
              </mi>
             </mrow>
            </msub>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <msub>
           <mrow>
            <mo>
             ⊗
            </mo>
           </mrow>
           <mrow>
            <msub>
             <mrow>
              <mi>
               γ
              </mi>
             </mrow>
             <mrow>
              <mi>
               o
              </mi>
              <mi>
               a
              </mi>
             </mrow>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             a
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <msub>
         <mrow>
          <mi>
           γ
          </mi>
         </mrow>
         <mrow>
          <mi>
           o
          </mi>
          <mi>
           a
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <mi mathvariant="normal">
         Γ
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msub>
           <mrow>
            <mi>
             e
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             a
            </mi>
           </mrow>
          </msub>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             a
            </mi>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <mspace width="0.25em"/>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow>
              <mi>
               b
              </mi>
             </mrow>
             <mrow>
              <mn>
               0
              </mn>
             </mrow>
            </msub>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
          </msubsup>
          <mo>
           +
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow>
              <mi>
               b
              </mi>
             </mrow>
             <mrow>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ7_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{b}^{l}=	{{\mbox{MLP}}}\,\left(\frac{1}{| {{{{{{{{\mathcal{N}}}}}}}}}_{b}| }\mathop{\sum}\limits_{a\in {{{{{{{{\mathcal{N}}}}}}}}}_{b}}Y({{{{{{{{\bf{r}}}}}}}}}_{{{{{{{{\bf{oa}}}}}}}}})\otimes {Y}^{2}({{{{{{{{\bf{r}}}}}}}}}_{b}){\otimes }_{{\gamma }_{oa}}{{{{{{{{\bf{h}}}}}}}}}_{a}\right)\\ 	{{\mbox{with}}}\,\,{\gamma }_{oa}=\Gamma \left({e}_{oa},\, {{{{{{{{\bf{h}}}}}}}}}_{a}^{0},\, {{{{{{{{\bf{h}}}}}}}}}_{{b}_{0}}^{0}+{{{{{{{{\bf{h}}}}}}}}}_{{b}_{1}}^{0}\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ7.gif"/>
      </alternatives>
     </disp-formula>
    </p>
    <p id="Par30">
     To predict the conformation changes of protein, we require updates of the side-chain chis, translation, and rotation for each protein node. These operations are generated from the final interaction representations
     <bold>
      h
     </bold>
     <sub>
      <italic>
       i
      </italic>
     </sub>
     of each amino acid:
     <disp-formula id="Equ8">
      <label>
       8
      </label>
      <alternatives>
       <math id="Equ8_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             s
            </mi>
            <mi>
             c
            </mi>
            <mi>
             a
            </mi>
            <mi>
             l
            </mi>
            <mi>
             a
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             s
            </mi>
            <mi>
             c
            </mi>
            <mi>
             a
            </mi>
            <mi>
             l
            </mi>
            <mi>
             a
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ8_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{i}^{p}=\,{{\mbox{MLP}}}\,\left({{{{{{{{\bf{h}}}}}}}}}_{i,scalar}^{odd},{{{{{{{{\bf{h}}}}}}}}}_{i,scalar}^{even}\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ8.gif"/>
      </alternatives>
     </disp-formula>
     <disp-formula id="Equ9">
      <label>
       9
      </label>
      <alternatives>
       <math id="Equ9_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               h
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               h
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           +
          </mo>
          <mspace width="0.25em"/>
          <mstyle>
           <mtext>
            eps
           </mtext>
          </mstyle>
         </mrow>
        </mfrac>
        <mo>
         ×
        </mo>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               h
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             o
            </mi>
            <mi>
             d
            </mi>
            <mi>
             d
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           ,
          </mo>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             s
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ9_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{tr}}}}}}}}}_{i}^{p}=\frac{{\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}^{odd}}{\parallel {\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}^{odd}\parallel+\,{{\mbox{eps}}}}\times {{\mbox{MLP}}}\,\left(\parallel {\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}^{odd}\parallel,{{{{{{{{\bf{s}}}}}}}}}_{t}\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ9.gif"/>
      </alternatives>
     </disp-formula>
     <disp-formula id="Equ10">
      <label>
       10
      </label>
      <alternatives>
       <math id="Equ10_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               h
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               h
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           +
          </mo>
          <mspace width="0.25em"/>
          <mstyle>
           <mtext>
            eps
           </mtext>
          </mstyle>
         </mrow>
        </mfrac>
        <mo>
         ×
        </mo>
        <mstyle>
         <mtext>
          MLP
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <mo>
           ∥
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               h
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             e
            </mi>
            <mi>
             v
            </mi>
            <mi>
             e
            </mi>
            <mi>
             n
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∥
          </mo>
          <mo>
           ,
          </mo>
          <msub>
           <mrow>
            <mi mathvariant="bold">
             s
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
          </msub>
         </mrow>
        </mfenced>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <msub>
         <mrow>
          <mover accent="true">
           <mrow>
            <mi mathvariant="bold">
             h
            </mi>
           </mrow>
           <mo accent="true">
            ¯
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           v
          </mi>
          <mi>
           e
          </mi>
          <mi>
           c
          </mi>
          <mi>
           t
          </mi>
          <mi>
           o
          </mi>
          <mi>
           r
          </mi>
         </mrow>
        </msub>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mo>
           ∣
          </mo>
          <msub>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             N
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           ∣
          </mo>
         </mrow>
        </mfrac>
        <munder>
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           j
          </mi>
          <mo>
           ∈
          </mo>
          <msub>
           <mrow>
            <mi class="MJX-tex-caligraphic" mathvariant="script">
             N
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
         </mrow>
        </munder>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           h
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           v
          </mi>
          <mi>
           e
          </mi>
          <mi>
           c
          </mi>
          <mi>
           t
          </mi>
          <mi>
           o
          </mi>
          <mi>
           r
          </mi>
         </mrow>
         <mrow>
          <mi>
           j
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="Equ10_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{rot}}}}}}}}}_{i}^{p}=	 \frac{{\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}^{even}}{\parallel {\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}^{even}\parallel+\,{{\mbox{eps}}}}\times {{\mbox{MLP}}}\,\left(\parallel {\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}^{even}\parallel,{{{{{{{{\bf{s}}}}}}}}}_{t}\right)\\ 	 {{\mbox{with}}}\,\,{\overline{{{{{{{{\bf{h}}}}}}}}}}_{i,vector}=\frac{1}{| {{{{{{{{\mathcal{N}}}}}}}}}_{i}| }\mathop{\sum}\limits_{j\in {{{{{{{{\mathcal{N}}}}}}}}}_{i}}{{{{{{{{\bf{h}}}}}}}}}_{i,vector}^{j}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ10.gif"/>
      </alternatives>
     </disp-formula>
     Here,
     <inline-formula id="IEq16">
      <alternatives>
       <math id="IEq16_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq16_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{i}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq16.gif"/>
      </alternatives>
     </inline-formula>
     is a five-dimensional scalar output representing torsion updates for [chi1, chi2, ..., chi5].
    </p>
   </sec>
   <sec id="Sec14">
    <title>
     Transformation of the ligand conformation
    </title>
    <p id="Par31">
     To update the ligand conformation, we employ a unified global translation
     <inline-formula id="IEq17">
      <alternatives>
       <math id="IEq17_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         ∈
        </mo>
        <msup>
         <mrow>
          <mi mathvariant="double-struck">
           R
          </mi>
         </mrow>
         <mrow>
          <mn>
           3
          </mn>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq17_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{tr}}}}}}}}}^{l}\in {{\mathbb{R}}}^{3}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq17.gif"/>
      </alternatives>
     </inline-formula>
     and rotation
     <inline-formula id="IEq18">
      <alternatives>
       <math id="IEq18_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         ∈
        </mo>
        <msup>
         <mrow>
          <mi mathvariant="double-struck">
           R
          </mi>
         </mrow>
         <mrow>
          <mn>
           3
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           3
          </mn>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq18_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}^{l}\in {{\mathbb{R}}}^{3\times 3}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq18.gif"/>
      </alternatives>
     </inline-formula>
     . All atoms of the ligand will be simultaneously translated and rotated around the geometric center of the ligand, which is calculated as
     <inline-formula id="IEq19">
      <alternatives>
       <math id="IEq19_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mover accent="true">
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mo accent="true">
            ¯
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mi>
           n
          </mi>
         </mrow>
        </mfrac>
        <mo>
         ∑
        </mo>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq19_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{{{{{{{{\bf{x}}}}}}}}}}^{l}=\frac{1}{n}\sum {{{{{{{{\bf{x}}}}}}}}}_{i}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq19.gif"/>
      </alternatives>
     </inline-formula>
     , where
     <italic>
      n
     </italic>
     is the total number of heavy atoms of the ligand and
     <inline-formula id="IEq20">
      <alternatives>
       <math id="IEq20_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq20_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}_{i}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq20.gif"/>
      </alternatives>
     </inline-formula>
     denotes the position vector of atom
     <italic>
      i
     </italic>
     . Specifically, the transformed position vector
     <bold>
      x
     </bold>
     <sup>
      <italic>
       l
      </italic>
     </sup>
     is obtained as
     <inline-formula id="IEq21">
      <alternatives>
       <math id="IEq21_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <msup>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
          <mo>
           −
          </mo>
          <msup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         +
        </mo>
        <msup>
         <mrow>
          <mover accent="true">
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mo accent="true">
            ¯
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         +
        </mo>
        <msup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
       </math>
       <tex-math id="IEq21_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}^{l}={R}^{l}({{{{{{{{\bf{x}}}}}}}}}^{l}-{\overline{{{{{{{{\bf{x}}}}}}}}}}^{l})+{\overline{{{{{{{{\bf{x}}}}}}}}}}^{l}+{{{{{{{{\bf{tr}}}}}}}}}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq21.gif"/>
      </alternatives>
     </inline-formula>
     .
    </p>
    <p id="Par32">
     In addition to translation and rotation, torsion angles are also crucial factors in determining the ligand conformation. However, modifying torsion angles can perturb the position of the center of mass of the ligand. To address this issue, Corso et al.
     <sup>
      <xref ref-type="bibr" rid="CR19">
       19
      </xref>
     </sup>
     demonstrated that performing an RMSD alignment after updating the torsion angles can ensure that the effect of the torsion updates is orthogonal to the roto-translation updates, and thus decouple the consequences of torsional updates and roto-translation updates. Overall, the updated ligand pose is obtained as
     <inline-formula id="IEq22">
      <alternatives>
       <math id="IEq22_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mi mathvariant="normal">
         RMSDAlign
        </mi>
        <mspace width="0.25em"/>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msubsup>
             <mrow>
              <mi>
               T
              </mi>
             </mrow>
             <mrow>
              <mn>
               0
              </mn>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
            <mo>
             ∘
            </mo>
            <mo>
             ⋯
            </mo>
            <msubsup>
             <mrow>
              <mi>
               T
              </mi>
             </mrow>
             <mrow>
              <mi>
               k
              </mi>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msup>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           ,
          </mo>
          <msup>
           <mrow>
            <mi>
             R
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msup>
            <mo>
             −
            </mo>
            <msup>
             <mrow>
              <mover accent="true">
               <mrow>
                <mi mathvariant="bold">
                 x
                </mi>
               </mrow>
               <mo accent="true">
                ¯
               </mo>
              </mover>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msup>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           +
          </mo>
          <msup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
          <mo>
           +
          </mo>
          <msup>
           <mrow>
            <mi mathvariant="bold">
             tr
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq22_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}^{l}={{{{{{\mathrm{RMSDAlign}}}}}}}\,(({T}_{0}^{l}\circ \cdots {T}_{k}^{l})({{{{{{{{\bf{x}}}}}}}}}^{l}),{R}^{l}({{{{{{{{\bf{x}}}}}}}}}^{l}-{\overline{{{{{{{{\bf{x}}}}}}}}}}^{l})+{\overline{{{{{{{{\bf{x}}}}}}}}}}^{l}+{{{{{{{{\bf{tr}}}}}}}}}^{l})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq22.gif"/>
      </alternatives>
     </inline-formula>
     , where
     <inline-formula id="IEq23">
      <alternatives>
       <math id="IEq23_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq23_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{k}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq23.gif"/>
      </alternatives>
     </inline-formula>
     is the torsion rotation.
    </p>
   </sec>
   <sec id="Sec15">
    <title>
     Transformation of the protein conformation
    </title>
    <p id="Par33">
     Following AlphaFold
     <sup>
      <xref ref-type="bibr" rid="CR5">
       5
      </xref>
     </sup>
     , we use C
     <italic>
      α
     </italic>
     as the residue node to perform global translation and rotation. Additionally, the model predicts the updates of side-chain torsion angles. For 180
     <sup>
      ∘
     </sup>
     -rotation-symmetric side-chain parts, considering symmetry is unnecessary in the inference stage, but we introduce symmetry side-chain torsion features during training to correctly compute the loss function. Since the position of the C
     <italic>
      α
     </italic>
     is independent of the side-chain torsion angles, rotating the side chain does not affect the residue-level translation and rotation. Thus, we can perform roto-translations and torsion rotations in any order. Finally, the updated conformation of each protein residue is represented as
     <inline-formula id="IEq24">
      <alternatives>
       <math id="IEq24_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msubsup>
           <mrow>
            <mi>
             T
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mn>
             0
            </mn>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∘
          </mo>
          <mo>
           ⋯
          </mo>
          <msubsup>
           <mrow>
            <mi>
             T
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             k
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msubsup>
           <mrow>
            <mi>
             R
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
             </mrow>
             <mrow>
              <mi>
               p
              </mi>
             </mrow>
            </msubsup>
            <mo>
             −
            </mo>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
              <mo>
               ,
              </mo>
              <msub>
               <mrow>
                <mi>
                 c
                </mi>
               </mrow>
               <mrow>
                <mi>
                 α
                </mi>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mi>
               p
              </mi>
             </mrow>
            </msubsup>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           +
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <msub>
             <mrow>
              <mi>
               c
              </mi>
             </mrow>
             <mrow>
              <mi>
               α
              </mi>
             </mrow>
            </msub>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
          <mo>
           +
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             tr
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq24_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}_{i}^{p}=({T}_{i,0}^{p}\circ \cdots {T}_{i,k}^{p})({R}_{i}^{p}({{{{{{{{\bf{x}}}}}}}}}_{i}^{p}-{{{{{{{{\bf{x}}}}}}}}}_{i,{c}_{\alpha }}^{p})+{{{{{{{{\bf{x}}}}}}}}}_{i,{c}_{\alpha }}^{p}+{{{{{{{{\bf{tr}}}}}}}}}_{i}^{p})$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq24.gif"/>
      </alternatives>
     </inline-formula>
     , where
     <inline-formula id="IEq25">
      <alternatives>
       <math id="IEq25_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq25_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{i,k}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq25.gif"/>
      </alternatives>
     </inline-formula>
     is the side-chain torsion rotation of
     <italic>
      i
     </italic>
     th residue.
    </p>
   </sec>
   <sec id="Sec16">
    <title>
     Training and inference
    </title>
    <p id="Par34">
     During the training process, the input are the protein structure in decoy conformation constructed by adding morph-like transformation to the native conformation and the ligand structure in conformation with Gaussian noise added. The expected output are the denoising operations. The input protein structure at time t is defined as
     <inline-formula id="IEq26">
      <alternatives>
       <math id="IEq26_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mi>
         ϕ
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             h
            </mi>
            <mi>
             o
            </mi>
            <mi>
             l
            </mi>
            <mi>
             o
            </mi>
           </mrow>
          </msup>
          <mo>
           ,
          </mo>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq26_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}_{t}^{p}=\phi ({{{{{{{{\bf{x}}}}}}}}}^{holo},t)$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq26.gif"/>
      </alternatives>
     </inline-formula>
     . Specifically, for the
     <italic>
      i
     </italic>
     th amino acid, the Kabsch algorithm
     <sup>
      <xref ref-type="bibr" rid="CR57">
       57
      </xref>
     </sup>
     is used to calculate the translation
     <inline-formula id="IEq27">
      <alternatives>
       <math id="IEq27_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq27_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{tr}}}}}}}}}_{i}^{*}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq27.gif"/>
      </alternatives>
     </inline-formula>
     and rotation
     <inline-formula id="IEq28">
      <alternatives>
       <math id="IEq28_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq28_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{rot}}}}}}}}}_{i}^{*}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq28.gif"/>
      </alternatives>
     </inline-formula>
     around
     <italic>
      C
     </italic>
     <italic>
      α
     </italic>
     that aligns the backbone atoms
     <italic>
      N
     </italic>
     −
     <italic>
      C
     </italic>
     <italic>
      α
     </italic>
     −
     <italic>
      C
     </italic>
     of the holo-structure to the apo structure:
     <disp-formula id="Equ11">
      <label>
       11
      </label>
      <alternatives>
       <math id="Equ11_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mtable>
         <mtr>
          <mtd columnalign="right">
           <msubsup>
            <mrow>
             <mi mathvariant="bold">
              tr
             </mi>
            </mrow>
            <mrow>
             <mi>
              i
             </mi>
            </mrow>
            <mrow>
             <mo>
              *
             </mo>
            </mrow>
           </msubsup>
           <mo>
            ,
           </mo>
           <mspace width="0.25em"/>
           <msubsup>
            <mrow>
             <mi mathvariant="bold">
              rot
             </mi>
            </mrow>
            <mrow>
             <mi>
              i
             </mi>
            </mrow>
            <mrow>
             <mo>
              *
             </mo>
            </mrow>
           </msubsup>
           <mo>
            =
           </mo>
           <mspace width="0.25em"/>
           <mstyle>
            <mtext>
             Kabsch
            </mtext>
           </mstyle>
           <mspace width="0.25em"/>
           <mfenced close=")" open="(">
            <mrow>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                x
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <mrow>
                <mo>
                 (
                </mo>
                <mrow>
                 <mi>
                  N
                 </mi>
                 <mo>
                  ,
                 </mo>
                 <msub>
                  <mrow>
                   <mi>
                    C
                   </mi>
                  </mrow>
                  <mrow>
                   <mi>
                    α
                   </mi>
                  </mrow>
                 </msub>
                 <mo>
                  ,
                 </mo>
                 <mi>
                  C
                 </mi>
                </mrow>
                <mo>
                 )
                </mo>
               </mrow>
              </mrow>
              <mrow>
               <mi>
                h
               </mi>
               <mi>
                o
               </mi>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
              </mrow>
             </msubsup>
             <mo>
              −
             </mo>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                x
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <msub>
                <mrow>
                 <mi>
                  C
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  α
                 </mi>
                </mrow>
               </msub>
              </mrow>
              <mrow>
               <mi>
                h
               </mi>
               <mi>
                o
               </mi>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
              </mrow>
             </msubsup>
             <mo>
              ,
             </mo>
             <mspace width="0.25em"/>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                x
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <mrow>
                <mo>
                 (
                </mo>
                <mrow>
                 <mi>
                  N
                 </mi>
                 <mo>
                  ,
                 </mo>
                 <msub>
                  <mrow>
                   <mi>
                    C
                   </mi>
                  </mrow>
                  <mrow>
                   <mi>
                    α
                   </mi>
                  </mrow>
                 </msub>
                 <mo>
                  ,
                 </mo>
                 <mi>
                  C
                 </mi>
                </mrow>
                <mo>
                 )
                </mo>
               </mrow>
              </mrow>
              <mrow>
               <mi>
                a
               </mi>
               <mi>
                p
               </mi>
               <mi>
                o
               </mi>
              </mrow>
             </msubsup>
             <mo>
              −
             </mo>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                x
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <msub>
                <mrow>
                 <mi>
                  C
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  α
                 </mi>
                </mrow>
               </msub>
              </mrow>
              <mrow>
               <mi>
                h
               </mi>
               <mi>
                o
               </mi>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
              </mrow>
             </msubsup>
            </mrow>
           </mfenced>
          </mtd>
         </mtr>
        </mtable>
       </math>
       <tex-math id="Equ11_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{r}{{{{{{{{\bf{tr}}}}}}}}}_{i}^{*},\, {{{{{{{{\bf{rot}}}}}}}}}_{i}^{*}=\,{{\mbox{Kabsch}}}\,\left({{{{{{{{\bf{x}}}}}}}}}_{i,(N,{C}_{\alpha },C)}^{holo}-{{{{{{{{\bf{x}}}}}}}}}_{i,{C}_{\alpha }}^{holo},\, {{{{{{{{\bf{x}}}}}}}}}_{i,(N,{C}_{\alpha },C)}^{apo}-{{{{{{{{\bf{x}}}}}}}}}_{i,{C}_{\alpha }}^{holo}\right)\end{array}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ11.gif"/>
      </alternatives>
     </disp-formula>
     Considering the differences in torsion angles, we can draw the conformation changes of
     <italic>
      i
     </italic>
     th residue:
     <disp-formula id="Equ12">
      <label>
       12
      </label>
      <alternatives>
       <math id="Equ12_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mtable>
         <mtr>
          <mtd columnalign="right">
           <msubsup>
            <mrow>
             <mi mathvariant="bold">
              x
             </mi>
            </mrow>
            <mrow>
             <mi>
              i
             </mi>
            </mrow>
            <mrow>
             <mi>
              a
             </mi>
             <mi>
              p
             </mi>
             <mi>
              o
             </mi>
            </mrow>
           </msubsup>
           <mo>
            =
           </mo>
           <mi>
            ϕ
           </mi>
           <mfenced close=")" open="(">
            <mrow>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                x
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
              </mrow>
              <mrow>
               <mi>
                h
               </mi>
               <mi>
                o
               </mi>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
              </mrow>
             </msubsup>
            </mrow>
           </mfenced>
           <mo>
            =
           </mo>
           <mrow>
            <mo>
             (
            </mo>
            <mrow>
             <msubsup>
              <mrow>
               <mi>
                T
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <mn>
                0
               </mn>
              </mrow>
              <mrow>
               <mo>
                *
               </mo>
              </mrow>
             </msubsup>
             <mo>
              ∘
             </mo>
             <mo>
              ⋯
             </mo>
             <msubsup>
              <mrow>
               <mi>
                T
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <mi>
                k
               </mi>
              </mrow>
              <mrow>
               <mo>
                *
               </mo>
              </mrow>
             </msubsup>
            </mrow>
            <mo>
             )
            </mo>
           </mrow>
           <mfenced close=")" open="(">
            <mrow>
             <msubsup>
              <mrow>
               <mi>
                R
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
              </mrow>
              <mrow>
               <mo>
                *
               </mo>
              </mrow>
             </msubsup>
             <mfenced close=")" open="(">
              <mrow>
               <msubsup>
                <mrow>
                 <mi mathvariant="bold">
                  x
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  i
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  h
                 </mi>
                 <mi>
                  o
                 </mi>
                 <mi>
                  l
                 </mi>
                 <mi>
                  o
                 </mi>
                </mrow>
               </msubsup>
               <mo>
                −
               </mo>
               <msubsup>
                <mrow>
                 <mi mathvariant="bold">
                  x
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  ,
                 </mo>
                 <msub>
                  <mrow>
                   <mi>
                    C
                   </mi>
                  </mrow>
                  <mrow>
                   <mi>
                    α
                   </mi>
                  </mrow>
                 </msub>
                </mrow>
                <mrow>
                 <mi>
                  h
                 </mi>
                 <mi>
                  o
                 </mi>
                 <mi>
                  l
                 </mi>
                 <mi>
                  o
                 </mi>
                </mrow>
               </msubsup>
              </mrow>
             </mfenced>
             <mo>
              +
             </mo>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                x
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                ,
               </mo>
               <msub>
                <mrow>
                 <mi>
                  C
                 </mi>
                </mrow>
                <mrow>
                 <mi>
                  α
                 </mi>
                </mrow>
               </msub>
              </mrow>
              <mrow>
               <mi>
                h
               </mi>
               <mi>
                o
               </mi>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
              </mrow>
             </msubsup>
             <mo>
              +
             </mo>
             <msubsup>
              <mrow>
               <mi mathvariant="bold">
                tr
               </mi>
              </mrow>
              <mrow>
               <mi>
                i
               </mi>
              </mrow>
              <mrow>
               <mo>
                *
               </mo>
              </mrow>
             </msubsup>
            </mrow>
           </mfenced>
          </mtd>
         </mtr>
        </mtable>
       </math>
       <tex-math id="Equ12_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{r}{{{{{{{{\bf{x}}}}}}}}}_{i}^{apo}=\phi \left({{{{{{{{\bf{x}}}}}}}}}_{i}^{holo}\right)=({T}_{i,0}^{*}\circ \cdots {T}_{i,k}^{*})\left({R}_{i}^{*}\left({{{{{{{{\bf{x}}}}}}}}}_{i}^{holo}-{{{{{{{{\bf{x}}}}}}}}}_{i,{C}_{\alpha }}^{holo}\right)+{{{{{{{{\bf{x}}}}}}}}}_{i,{C}_{\alpha }}^{holo}+{{{{{{{{\bf{tr}}}}}}}}}_{i}^{*}\right)\end{array}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ12.gif"/>
      </alternatives>
     </disp-formula>
     Here,
     <inline-formula id="IEq29">
      <alternatives>
       <math id="IEq29_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           a
          </mi>
          <mi>
           p
          </mi>
          <mi>
           o
          </mi>
         </mrow>
        </msubsup>
        <mo>
         −
        </mo>
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           o
          </mi>
          <mi>
           l
          </mi>
          <mi>
           o
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq29_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{i,k}^{*}={T}_{i,k}^{apo}-{T}_{i,k}^{holo}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq29.gif"/>
      </alternatives>
     </inline-formula>
     are in radian and the
     <inline-formula id="IEq30">
      <alternatives>
       <math id="IEq30_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq30_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{i}^{*}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq30.gif"/>
      </alternatives>
     </inline-formula>
     is the rotation matrix of
     <inline-formula id="IEq31">
      <alternatives>
       <math id="IEq31_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq31_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{rot}}}}}}}}}_{i}^{*}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq31.gif"/>
      </alternatives>
     </inline-formula>
     . At any given moment, we aim to perturb the protein structure using a factor, denoted as
     <italic>
      u
     </italic>
     (
     <italic>
      t
     </italic>
     ), such that the perturbed data is an intermediate state between the holo-structure and apo structure:
     <disp-formula id="Equ13">
      <label>
       13
      </label>
      <alternatives>
       <math id="Equ13_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         ϕ
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mi>
             h
            </mi>
            <mi>
             o
            </mi>
            <mi>
             l
            </mi>
            <mi>
             o
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <mi>
           t
          </mi>
         </mrow>
        </mfenced>
        <mo>
         =
        </mo>
        <mfenced close=")" open="(">
         <mrow>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msubsup>
           <mrow>
            <mi>
             T
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mn>
             0
            </mn>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∘
          </mo>
          <mo>
           ⋯
          </mo>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msubsup>
           <mrow>
            <mi>
             T
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             k
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
        <mfenced close=")" open="(">
         <mrow>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msubsup>
           <mrow>
            <mi>
             R
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
          <mfenced close=")" open="(">
           <mrow>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
             </mrow>
             <mrow>
              <mi>
               h
              </mi>
              <mi>
               o
              </mi>
              <mi>
               l
              </mi>
              <mi>
               o
              </mi>
             </mrow>
            </msubsup>
            <mo>
             −
            </mo>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               i
              </mi>
              <mo>
               ,
              </mo>
              <msub>
               <mrow>
                <mi>
                 C
                </mi>
               </mrow>
               <mrow>
                <mi>
                 α
                </mi>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mi>
               h
              </mi>
              <mi>
               o
              </mi>
              <mi>
               l
              </mi>
              <mi>
               o
              </mi>
             </mrow>
            </msubsup>
           </mrow>
          </mfenced>
          <mo>
           +
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <msub>
             <mrow>
              <mi>
               C
              </mi>
             </mrow>
             <mrow>
              <mi>
               α
              </mi>
             </mrow>
            </msub>
           </mrow>
           <mrow>
            <mi>
             h
            </mi>
            <mi>
             o
            </mi>
            <mi>
             l
            </mi>
            <mi>
             o
            </mi>
           </mrow>
          </msubsup>
          <mo>
           +
          </mo>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             tr
            </mi>
           </mrow>
           <mrow>
            <mi>
             i
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="1.0em"/>
        <mi mathvariant="normal">
         Δ
        </mi>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mi>
         u
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
        <mi mathvariant="normal">
         Δ
        </mi>
        <msubsup>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          Rotation matrix of
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <mi>
         u
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
        <mi mathvariant="normal">
         Δ
        </mi>
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mi>
         u
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           i
          </mi>
          <mo>
           ,
          </mo>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mo>
           *
          </mo>
         </mrow>
        </msubsup>
        <mo>
         +
        </mo>
        <mi class="MJX-tex-caligraphic" mathvariant="script">
         N
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mn>
           0
          </mn>
          <mo>
           ,
          </mo>
          <mn>
           0.3
          </mn>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mi>
         u
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          clamp
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mfenced close=")" open="(">
         <mrow>
          <msubsup>
           <mrow>
            <mi>
             τ
            </mi>
           </mrow>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             i
            </mi>
            <mi>
             n
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
          <mo>
           +
          </mo>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msubsup>
             <mrow>
              <mi>
               τ
              </mi>
             </mrow>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               a
              </mi>
              <mi>
               x
              </mi>
             </mrow>
             <mrow>
              <mi>
               p
              </mi>
             </mrow>
            </msubsup>
            <mo>
             −
            </mo>
            <msubsup>
             <mrow>
              <mi>
               τ
              </mi>
             </mrow>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               i
              </mi>
              <mi>
               n
              </mi>
             </mrow>
             <mrow>
              <mi>
               p
              </mi>
             </mrow>
            </msubsup>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           ×
          </mo>
          <msup>
           <mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <mn>
               5
              </mn>
              <mi>
               t
              </mi>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
           <mrow>
            <mn>
             0.3
            </mn>
           </mrow>
          </msup>
          <mo>
           ,
          </mo>
          <mi>
           min
          </mi>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
          <mo>
           ,
          </mo>
          <mi>
           max
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
         </mrow>
        </mfenced>
       </math>
       <tex-math id="Equ13_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi \left({{{{{{{{\bf{x}}}}}}}}}_{i}^{holo},t\right)=	\left(\Delta {T}_{i,0}^{p}\circ \cdots \Delta {T}_{i,k}^{p}\right)\left(\Delta {R}_{i}^{p}\left({{{{{{{{\bf{x}}}}}}}}}_{i}^{holo}-{{{{{{{{\bf{x}}}}}}}}}_{i,{C}_{\alpha }}^{holo}\right)+{{{{{{{{\bf{x}}}}}}}}}_{i,{C}_{\alpha }}^{holo}+\Delta {{{{{{{{\bf{tr}}}}}}}}}_{i}^{p}\right)\\ \,{{\mbox{with}}} \quad 	\Delta {{{{{{{{\bf{tr}}}}}}}}}_{i}^{p}=u(t){{{{{{{{\bf{tr}}}}}}}}}_{i}^{*}\\ 	\Delta {R}_{i}^{p}=\,{{\mbox{Rotation matrix of}}}\,\,u(t){{{{{{{{\bf{rot}}}}}}}}}_{i}^{*}\\ 	\Delta {T}_{i,k}^{p}=u(t){T}_{i,k}^{*}+{{{{{{{\mathcal{N}}}}}}}}(0,0.3)\\ 	u(t)=\,{{\mbox{clamp}}}\,\left({\tau }_{min}^{p}+({\tau }_{max}^{p}-{\tau }_{min}^{p})\times {(5t)}^{0.3},\min=0,\max=1\right)$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ13.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq32">
      <alternatives>
       <math id="IEq32_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           τ
          </mi>
         </mrow>
         <mrow>
          <mi>
           m
          </mi>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq32_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tau }_{min}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq32.gif"/>
      </alternatives>
     </inline-formula>
     and
     <inline-formula id="IEq33">
      <alternatives>
       <math id="IEq33_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi>
           τ
          </mi>
         </mrow>
         <mrow>
          <mi>
           m
          </mi>
          <mi>
           a
          </mi>
          <mi>
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq33_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tau }_{max}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq33.gif"/>
      </alternatives>
     </inline-formula>
     represent the parameters of the diffusion noise.
    </p>
    <p id="Par35">
     To overcome the distribution shift between training and inference that arises from the use of RDKit-generated conformations as starting points in the inference process, we replace the training objective with the conformation
     <inline-formula id="IEq34">
      <alternatives>
       <math id="IEq34_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mn>
           0
          </mn>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq34_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}_{0}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq34.gif"/>
      </alternatives>
     </inline-formula>
     that matched to the ground truth pose
     <bold>
      x
     </bold>
     <sup>
      <italic>
       g
      </italic>
      <italic>
       t
      </italic>
     </sup>
     <sup>
      <xref ref-type="bibr" rid="CR19">
       19
      </xref>
      ,
      <xref ref-type="bibr" rid="CR33">
       33
      </xref>
     </sup>
     . At time
     <italic>
      t
     </italic>
     , the input ligand pose is a random perturbed conformation:
     <disp-formula id="Equ14">
      <label>
       14
      </label>
      <alternatives>
       <math id="Equ14_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msubsup>
           <mrow>
            <mi>
             T
            </mi>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ∘
          </mo>
          <mo>
           ⋯
          </mo>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msubsup>
           <mrow>
            <mi>
             T
            </mi>
           </mrow>
           <mrow>
            <mi>
             k
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msup>
           <mrow>
            <mi>
             R
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <msubsup>
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mrow>
              <mn>
               0
              </mn>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
            <mo>
             −
            </mo>
            <msubsup>
             <mrow>
              <mover accent="true">
               <mrow>
                <mi mathvariant="bold">
                 x
                </mi>
               </mrow>
               <mo accent="true">
                ¯
               </mo>
              </mover>
             </mrow>
             <mrow>
              <mn>
               0
              </mn>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <mo>
           +
          </mo>
          <msubsup>
           <mrow>
            <mover accent="true">
             <mrow>
              <mi mathvariant="bold">
               x
              </mi>
             </mrow>
             <mo accent="true">
              ¯
             </mo>
            </mover>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msubsup>
          <mo>
           +
          </mo>
          <mi mathvariant="normal">
           Δ
          </mi>
          <msup>
           <mrow>
            <mi mathvariant="bold">
             tr
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mstyle>
         <mtext>
          with
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="1.0em"/>
        <mi mathvariant="normal">
         Δ
        </mi>
        <msup>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mfenced close=")" open="(">
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           N
          </mi>
          <mfenced close=")" open="(">
           <mrow>
            <mn>
             0
            </mn>
            <mo>
             ,
            </mo>
            <msubsup>
             <mrow>
              <mi>
               σ
              </mi>
             </mrow>
             <mrow>
              <mi>
               t
              </mi>
              <mi>
               r
              </mi>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
           </mrow>
          </mfenced>
          <mo>
           ,
          </mo>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           N
          </mi>
          <mfenced close=")" open="(">
           <mrow>
            <mn>
             0
            </mn>
            <mo>
             ,
            </mo>
            <msubsup>
             <mrow>
              <mi>
               σ
              </mi>
             </mrow>
             <mrow>
              <mi>
               t
              </mi>
              <mi>
               r
              </mi>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
           </mrow>
          </mfenced>
          <mo>
           ,
          </mo>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           N
          </mi>
          <mfenced close=")" open="(">
           <mrow>
            <mn>
             0
            </mn>
            <mo>
             ,
            </mo>
            <msubsup>
             <mrow>
              <mi>
               σ
              </mi>
             </mrow>
             <mrow>
              <mi>
               t
              </mi>
              <mi>
               r
              </mi>
             </mrow>
             <mrow>
              <mi>
               l
              </mi>
             </mrow>
            </msubsup>
           </mrow>
          </mfenced>
         </mrow>
        </mfenced>
        <mi mathvariant="normal">
         Δ
        </mi>
        <msup>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msup>
        <mo>
         =
        </mo>
        <mspace width="0.25em"/>
        <mstyle>
         <mtext>
          Rotation matrix of sampling from
         </mtext>
        </mstyle>
        <mspace width="0.25em"/>
        <mspace width="0.25em"/>
        <mi>
         p
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           ω
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mover accent="true">
         <mrow>
          <mi>
           ω
          </mi>
         </mrow>
         <mrow>
          <mo>
           ̂
          </mo>
         </mrow>
        </mover>
        <mi mathvariant="normal">
         Δ
        </mi>
        <msubsup>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           k
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         =
        </mo>
        <mi class="MJX-tex-caligraphic" mathvariant="script">
         N
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <mn>
           0
          </mn>
          <mo>
           ,
          </mo>
          <msubsup>
           <mrow>
            <mi>
             σ
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
            <mi>
             o
            </mi>
            <mi>
             r
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msubsup>
         </mrow>
        </mfenced>
        <mi>
         p
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           ω
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <mfrac>
         <mrow>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <mi>
           c
          </mi>
          <mi>
           o
          </mi>
          <mi>
           s
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             ω
            </mi>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mrow>
          <mi>
           π
          </mi>
         </mrow>
        </mfrac>
        <munderover accent="false" accentunder="false">
         <mrow>
          <mo>
           ∑
          </mo>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <mrow>
          <mi>
           ∞
          </mi>
         </mrow>
        </munderover>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mn>
           2
          </mn>
          <mi>
           l
          </mi>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mi>
         exp
        </mi>
        <mfenced close=")" open="(">
         <mrow>
          <mo>
           −
          </mo>
          <mi>
           l
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             l
            </mi>
            <mo>
             +
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
          <msup>
           <mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <msubsup>
               <mrow>
                <mi>
                 σ
                </mi>
               </mrow>
               <mrow>
                <mi>
                 r
                </mi>
                <mi>
                 o
                </mi>
                <mi>
                 t
                </mi>
               </mrow>
               <mrow>
                <mi>
                 l
                </mi>
               </mrow>
              </msubsup>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
           <mrow>
            <mn>
             2
            </mn>
           </mrow>
          </msup>
         </mrow>
        </mfenced>
        <mfrac>
         <mrow>
          <mi>
           sin
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <mi>
               l
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
              <mo>
               /
              </mo>
              <mn>
               2
              </mn>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
            <mi>
             ω
            </mi>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mrow>
          <mi>
           sin
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mi>
             ω
            </mi>
            <mo>
             /
            </mo>
            <mn>
             2
            </mn>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
        </mfrac>
       </math>
       <tex-math id="Equ14_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}_{t}^{l}=	(\Delta {T}_{0}^{l}\circ \cdots \Delta {T}_{k}^{l})(\Delta {R}^{l}({{{{{{{{\bf{x}}}}}}}}}_{0}^{l}-{\overline{{{{{{{{\bf{x}}}}}}}}}}_{0}^{l})+{\overline{{{{{{{{\bf{x}}}}}}}}}}_{0}^{l}+\Delta {{{{{{{{\bf{tr}}}}}}}}}^{l}) \\ 	{{\mbox{with}}}\,\quad\Delta {{{{{{{{\bf{tr}}}}}}}}}^{l}=\left({{{{{{{\mathcal{N}}}}}}}}\left(0,{\sigma }_{tr}^{l}\right),{{{{{{{\mathcal{N}}}}}}}}\left(0,{\sigma }_{tr}^{l}\right),{{{{{{{\mathcal{N}}}}}}}}\left(0,{\sigma }_{tr}^{l}\right)\right)\\ 	\Delta {R}^{l}=\,{{\mbox{Rotation matrix of sampling from}}}\,\,p(\omega )\hat{\omega }\\ 	\Delta {T}_{k}^{l}={{{{{{{\mathcal{N}}}}}}}}\left(0,{\sigma }_{tor}^{l}\right)\\ 	p(\omega )=\frac{1-cos(\omega )}{\pi }\mathop{\sum }\limits_{l=0}^{\infty }(2l+1)\exp \left(-l(l+1){({\sigma }_{rot}^{l})}^{2}\right)\frac{\sin ((l+1/2)\omega )}{\sin (\omega /2)}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ14.gif"/>
      </alternatives>
     </disp-formula>
     Here,
     <inline-formula id="IEq35">
      <alternatives>
       <math id="IEq35_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mover accent="true">
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mo accent="true">
            ¯
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mn>
           0
          </mn>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq35_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{{{{{{{{\bf{x}}}}}}}}}}_{0}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq35.gif"/>
      </alternatives>
     </inline-formula>
     is the geometric center of
     <inline-formula id="IEq36">
      <alternatives>
       <math id="IEq36_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi mathvariant="bold">
           x
          </mi>
         </mrow>
         <mrow>
          <mn>
           0
          </mn>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         ,
        </mo>
        <mi>
         p
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <mi>
           ω
          </mi>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
       </math>
       <tex-math id="IEq36_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\bf{x}}}}}}}}}_{0}^{l},p(\omega )$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq36.gif"/>
      </alternatives>
     </inline-formula>
     is the isotropic Gaussian distribution on SO(3) and the
     <inline-formula id="IEq37">
      <alternatives>
       <math id="IEq37_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mover accent="true">
         <mrow>
          <mi mathvariant="bold-italic">
           ω
          </mi>
         </mrow>
         <mrow>
          <mo>
           ̂
          </mo>
         </mrow>
        </mover>
       </math>
       <tex-math id="IEq37_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\hat{{{{{\boldsymbol{\omega }}}}}}}}}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq37.gif"/>
      </alternatives>
     </inline-formula>
     is a unit vector generated by random sampling.
    </p>
    <p id="Par36">
     The network is trained with eight losses. The total loss can be defined as follows
     <disp-formula id="Equ15">
      <label>
       15
      </label>
      <alternatives>
       <math id="Equ15_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mtable>
         <mtr>
          <mtd columnalign="right">
           <mi class="MJX-tex-caligraphic" mathvariant="script">
            L
           </mi>
           <mo>
            =
           </mo>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mn>
              3
             </mn>
            </mrow>
           </mfrac>
           <msubsup>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="bold">
              tr
             </mi>
            </mrow>
            <mrow>
             <mi>
              l
             </mi>
            </mrow>
           </msubsup>
           <mo>
            +
           </mo>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mn>
              3
             </mn>
            </mrow>
           </mfrac>
           <msubsup>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="bold">
              rot
             </mi>
            </mrow>
            <mrow>
             <mi>
              l
             </mi>
            </mrow>
           </msubsup>
           <mo>
            +
           </mo>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mn>
              3
             </mn>
            </mrow>
           </mfrac>
           <msubsup>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi>
              T
             </mi>
            </mrow>
            <mrow>
             <mi>
              l
             </mi>
            </mrow>
           </msubsup>
           <mo>
            +
           </mo>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mn>
              3
             </mn>
            </mrow>
           </mfrac>
           <msubsup>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="bold">
              tr
             </mi>
            </mrow>
            <mrow>
             <mi>
              p
             </mi>
            </mrow>
           </msubsup>
           <mo>
            +
           </mo>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mn>
              3
             </mn>
            </mrow>
           </mfrac>
           <msubsup>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi mathvariant="bold">
              rot
             </mi>
            </mrow>
            <mrow>
             <mi>
              p
             </mi>
            </mrow>
           </msubsup>
           <mo>
            +
           </mo>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
            </mrow>
            <mrow>
             <mn>
              3
             </mn>
            </mrow>
           </mfrac>
           <msubsup>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi>
              T
             </mi>
            </mrow>
            <mrow>
             <mi>
              p
             </mi>
            </mrow>
           </msubsup>
           <mo>
            +
           </mo>
           <mn>
            0.01
           </mn>
           <msub>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi>
              A
             </mi>
            </mrow>
           </msub>
           <mo>
            +
           </mo>
           <mn>
            0.99
           </mn>
           <msub>
            <mrow>
             <mi class="MJX-tex-caligraphic" mathvariant="script">
              L
             </mi>
            </mrow>
            <mrow>
             <mi>
              D
             </mi>
            </mrow>
           </msub>
          </mtd>
         </mtr>
        </mtable>
       </math>
       <tex-math id="Equ15_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{r}{{{{{{{\mathcal{L}}}}}}}}=\frac{1}{3}{{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{tr}}}}}}}}}^{l}+\frac{1}{3}{{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{rot}}}}}}}}}^{l}+\frac{1}{3}{{{{{{{{\mathcal{L}}}}}}}}}_{T}^{l}+\frac{1}{3}{{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{tr}}}}}}}}}^{p}+\frac{1}{3}{{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{rot}}}}}}}}}^{p}+\frac{1}{3}{{{{{{{{\mathcal{L}}}}}}}}}_{T}^{p}+0.01{{{{{{{{\mathcal{L}}}}}}}}}_{A}+0.99{{{{{{{{\mathcal{L}}}}}}}}}_{D}\end{array}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ15.gif"/>
      </alternatives>
     </disp-formula>
     where
     <inline-formula id="IEq38">
      <alternatives>
       <math id="IEq38_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         ,
        </mo>
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
        <mo>
         ,
        </mo>
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           l
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq38_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{tr}}}}}}}}}^{l},{{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{rot}}}}}}}}}^{l},{{{{{{{{\mathcal{L}}}}}}}}}_{T}^{l}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq38.gif"/>
      </alternatives>
     </inline-formula>
     are the losses for the translation, rotation, and torsion of the ligand, respectively. The
     <inline-formula id="IEq39">
      <alternatives>
       <math id="IEq39_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi mathvariant="bold">
           tr
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
        <mo>
         ,
        </mo>
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi mathvariant="bold">
           rot
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq39_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{tr}}}}}}}}}^{p},{{{{{{{{\mathcal{L}}}}}}}}}_{{{{{{{{\bf{rot}}}}}}}}}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq39.gif"/>
      </alternatives>
     </inline-formula>
     , and
     <inline-formula id="IEq40">
      <alternatives>
       <math id="IEq40_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msubsup>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi>
           T
          </mi>
         </mrow>
         <mrow>
          <mi>
           p
          </mi>
         </mrow>
        </msubsup>
       </math>
       <tex-math id="IEq40_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{T}^{p}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq40.gif"/>
      </alternatives>
     </inline-formula>
     are the losses for the protein residues. The
     <inline-formula id="IEq41">
      <alternatives>
       <math id="IEq41_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi>
           A
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq41_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{A}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq41.gif"/>
      </alternatives>
     </inline-formula>
     is binding affinity loss and the
     <inline-formula id="IEq42">
      <alternatives>
       <math id="IEq42_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mrow>
          <mi class="MJX-tex-caligraphic" mathvariant="script">
           L
          </mi>
         </mrow>
         <mrow>
          <mi>
           D
          </mi>
         </mrow>
        </msub>
       </math>
       <tex-math id="IEq42_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{L}}}}}}}}}_{D}$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq42.gif"/>
      </alternatives>
     </inline-formula>
     is contact-LDDT loss. The distance difference for computing the ground-truth cLDDT is
     <inline-formula id="IEq43">
      <alternatives>
       <math id="IEq43_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         d
        </mi>
        <mo>
         =
        </mo>
        <mo>
         ∣
        </mo>
        <mi>
         d
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mn>
             0
            </mn>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <msup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             h
            </mi>
            <mi>
             o
            </mi>
            <mi>
             l
            </mi>
            <mi>
             o
            </mi>
           </mrow>
          </msup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         −
        </mo>
        <mi>
         d
        </mi>
        <mrow>
         <mo>
          (
         </mo>
         <mrow>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
           <mrow>
            <mi>
             l
            </mi>
           </mrow>
          </msubsup>
          <mo>
           ,
          </mo>
          <msubsup>
           <mrow>
            <mi mathvariant="bold">
             x
            </mi>
           </mrow>
           <mrow>
            <mi>
             t
            </mi>
           </mrow>
           <mrow>
            <mi>
             p
            </mi>
           </mrow>
          </msubsup>
         </mrow>
         <mo>
          )
         </mo>
        </mrow>
        <mo>
         ∣
        </mo>
       </math>
       <tex-math id="IEq43_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=| d({{{{{{{{\bf{x}}}}}}}}}_{0}^{l},{{{{{{{{\bf{x}}}}}}}}}^{holo})-d({{{{{{{{\bf{x}}}}}}}}}_{t}^{l},{{{{{{{{\bf{x}}}}}}}}}_{t}^{p})|$$\end{document}
       </tex-math>
       <inline-graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_IEq43.gif"/>
      </alternatives>
     </inline-formula>
     (more details of the cLDDT score calculation can be found in “Evaluation metrics”).
    </p>
    <p id="Par37">
     Since a rotation vector
     <bold>
      u
     </bold>
     represents the same rotation as another
     <bold>
      v
     </bold>
     if
     <bold>
      u
     </bold>
     and
     <bold>
      v
     </bold>
     have opposite orientation and ∥
     <bold>
      u
     </bold>
     ∥ + ∥
     <bold>
      v
     </bold>
     ∥ = 2
     <italic>
      π
     </italic>
     . So we take the minimum of the forward and opposite orientation losses when computing the rotation loss. The torsion angle losses are computed using the cosine of the angle difference between the predicted value and the added torsion angle noise. The full training procedures can be see in Supplementary Algorithm
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     .
    </p>
    <p id="Par38">
     During the inference process, we use the ligand structure with conformations generated by RDKit and the protein structure prediction by AlphaFold as the initial complex conformation. The complex structure is updated with 20 steps. To prevent the final conformation trapped in local minimum, in each step, a small random noise is added to the denoised ligand pose. For each pair, we perform 40 samplings and rank the binding conformations based on the predicted cLDDTs. We also noticed that the weighted averaged of the predicted binding affinity is a more accurate estimator of the experimentally measured affinity (Supplementary Table
     <xref ref-type="supplementary-material" rid="MOESM1">
      1
     </xref>
     ). The predicted cLDDT values is used as the weights. The complete inference procedures can be found in Supplementary Algorithm
     <xref ref-type="supplementary-material" rid="MOESM1">
      2
     </xref>
     .
    </p>
    <p id="Par39">
     DynamicBind has 63.67 million parameters and was trained for 5 days on eight Nvidia A100 80GB GPUs.
    </p>
   </sec>
   <sec id="Sec17">
    <title>
     Evaluation metrics
    </title>
    <p id="Par40">
     To assess the interaction between the protein and the ligand within the predicted complex structure, we determine the extent of intermolecular native contact formation. We adopt a definition similar to that of the Local Distance Difference Test (LDDT) score, previously employed for quantifying the nativeness of predicted protein structures
     <sup>
      <xref ref-type="bibr" rid="CR58">
       58
      </xref>
     </sup>
     . The Contact-LDDT (cLDDT) score is computed by considering the distances less than 15 Å among all pairs of ligand atoms and protein atoms. The distance difference is determined between the ground truth and the predicted complex structure, while accounting for symmetry. The final cLDDT score is derived from the mean fraction of conserved distances across four tolerance thresholds: 0.5, 1, 2, and 4 Å.
    </p>
    <p id="Par41">
     In order to evaluate the deviation of the predicted protein structure from the native protein structure surrounding the binding pocket, we compute the pocket Root Mean Square Deviation (pocket RMSD). This is performed using protein atoms located within 5 Å of the reference ligand atoms. Initially, the predicted protein structure is aligned with the crystal protein structure. Subsequently, the RMSD between the predicted pocket atoms and the crystal pocket atoms is determined.
    </p>
    <p id="Par42">
     Similiar to AlphaFill
     <sup>
      <xref ref-type="bibr" rid="CR14">
       14
      </xref>
     </sup>
     , the clash score is the root mean square (RMS) of the van der Waals overlaps
     <sup>
      <xref ref-type="bibr" rid="CR59">
       59
      </xref>
     </sup>
     across all distances between the ligand atoms and the protein atoms, which are less than 4 Å. It is computed as follows:
     <disp-formula id="Equ16">
      <label>
       16
      </label>
      <alternatives>
       <math id="Equ16_Math" xmlns="http://www.w3.org/1998/Math/MathML">
        <mtable>
         <mtr>
          <mtd columnalign="right">
           <mspace width="0.25em"/>
           <mstyle>
            <mtext>
             clash score
            </mtext>
           </mstyle>
           <mspace width="0.25em"/>
           <mo>
            =
           </mo>
           <msqrt>
            <mrow>
             <mfrac>
              <mrow>
               <munderover accent="false" accentunder="false">
                <mrow>
                 <mo>
                  ∑
                 </mo>
                </mrow>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  =
                 </mo>
                 <mn>
                  0
                 </mn>
                </mrow>
                <mrow>
                 <mi>
                  N
                 </mi>
                </mrow>
               </munderover>
               <mspace width="0.25em"/>
               <msubsup>
                <mrow>
                 <mspace width="0.25em"/>
                 <mstyle>
                  <mtext>
                   VdW overlap
                  </mtext>
                 </mstyle>
                 <mspace width="0.25em"/>
                </mrow>
                <mrow>
                 <mi>
                  i
                 </mi>
                </mrow>
                <mrow>
                 <mn>
                  2
                 </mn>
                </mrow>
               </msubsup>
              </mrow>
              <mrow>
               <mi>
                N
               </mi>
              </mrow>
             </mfrac>
            </mrow>
           </msqrt>
          </mtd>
         </mtr>
        </mtable>
       </math>
       <tex-math id="Equ16_TeX">
        \documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{r}\,{{\mbox{clash score}}}\,=\sqrt{\frac{\mathop{\sum }\limits_{i=0}^{N}\,{\,{{\mbox{VdW overlap}}}\,\,}_{i}^{2}}{N}}\end{array}$$\end{document}
       </tex-math>
       <graphic mime-subtype="GIF" specific-use="web" xlink:href="41467_2024_45461_Article_Equ16.gif"/>
      </alternatives>
     </disp-formula>
     where
     <italic>
      N
     </italic>
     is the number of distances considered.
    </p>
   </sec>
   <sec id="Sec18">
    <title>
     Dataset construction
    </title>
    <p id="Par43">
     Our training and test dataset was built upon the PDBbind2020
     <sup>
      <xref ref-type="bibr" rid="CR34">
       34
      </xref>
     </sup>
     database, which includes a curated collection of 19,443 crystal structures of protein–ligand complexes, each paired with an experimentally measured binding affinity. We employed the same time split as previous works
     <sup>
      <xref ref-type="bibr" rid="CR19">
       19
      </xref>
      ,
      <xref ref-type="bibr" rid="CR35">
       35
      </xref>
      ,
      <xref ref-type="bibr" rid="CR36">
       36
      </xref>
     </sup>
     , using structures deposited before 2019 for training and validation, while those deposited in 2019 were reserved for testing. Each protein was aligned with the AlphaFold-predicted structure that corresponds to the same protein sequence. The aligned AlphaFold structures and the crystal structures are used to generate training samples of the protein part through morph-like interpolation. The Major Drug Targets (MDT) test set was constructed using the following criteria: PDBs deposited in 2020 or later; proteins belonging to one of the four major drug target groups - kinases, GPCRs, nuclear receptors, and ion channels; the AlphaFold-predicted protein structures have pocket RMSD above the 2 Å (or pocket LDDT below 0.8) with the crystal structure; ligands are drug-like small molecules with molecular weights between 200 and 650 Dalton; at most 10 PDBs from a single study are included. These criteria ensure that the test set is challenging, with the initial input protein differs from the native conformation, and is representative, covering a wide range of protein targets. In addition, it prevents a few proteins dominating the entire test set, as certain studies deposited significantly more PDBs, structures of the same protein co-crystallized with slightly different ligands, than other studies.
    </p>
   </sec>
   <sec id="Sec19">
    <title>
     Baselines
    </title>
    <p id="Par44">
     We performed docking on both PDBbind test set (303 ligand-receptor pairs) and Major drug targets (MDT) test set (599 ligand-receptor pairs) using different docking methods listed below. The docking ligands were extracted from the co-crystalized structures without changing their atomic coordinates and the docking receptor structures were predicted by AlphaFold. We use a symmetry-aware method, specifically the symmrmsd function from the spyrmsd package
     <sup>
      <xref ref-type="bibr" rid="CR60">
       60
      </xref>
     </sup>
     for all RMSD computations.
    </p>
   </sec>
   <sec id="Sec20">
    <title>
     Autodock VINA rigid
    </title>
    <p id="Par45">
     In Autodock Vina
     <sup>
      <xref ref-type="bibr" rid="CR17">
       17
      </xref>
     </sup>
     , ligands were converted from SDF format to PDBQT format by Meeko 2.0.0. Protein preparation was performed by using the “prepare_receptor” command in ADFR Suite 1.0. The docking box was defined using an automatic box around the native ligand with the default buffer of 4 Å on all six sides. And the box center was the center of mass of the native ligand. Because the boron atom is not a valid AutoDock atom type, ligands with this atom cannot be docked. Therefore, only 301 ligand-receptor pairs in PDBbind dataset and 597 ligand-receptor pairs in MDT dataset had docking output in VINA rigid docking.
    </p>
   </sec>
   <sec id="Sec21">
    <title>
     Autodock VINA flex
    </title>
    <p id="Par46">
     Comparing to VINA rigid docking, there is an additional flexible receptor preparation step in VINA flexible docking. It was performed by a python script called “prepare_flexreceptor.py”, which is available at
     <ext-link ext-link-type="uri" xlink:href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">
      https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts
     </ext-link>
     . Through this step, the protein PDBQT format file was divided into two PDBQT format files, one for the rigid part and one for the flexible side chains. For Vina Flex mode, flexible side chains must be predetermined. We identified all residues with side-chain atoms within 5 Å of the ligand atoms as flexible. In this mode, the protein backbone remains rigid.Ligand preparation and grid box setting were consistent with VINA rigid docking.
    </p>
   </sec>
   <sec id="Sec22">
    <title>
     GNINA rigid
    </title>
    <p id="Par47">
     The ligand input files for GNINA
     <sup>
      <xref ref-type="bibr" rid="CR61">
       61
      </xref>
     </sup>
     are in PDBQT format, created using OpenBabel after adding hydrogens with RDKit Protein input files were PDB format files. The grid box setting was consistent with VINA rigid docking. For the PDBbind dataset, all of the ligand-receptor pairs had docking output. For MDT dataset, 1 pair had no output because the ligand in the original PDB file (PDB ID:
     <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HMU/pdb">
      8HMU
     </ext-link>
     ) was not completely resolved, which had missing atoms.
    </p>
   </sec>
   <sec id="Sec23">
    <title>
     GLIDE
    </title>
    <p id="Par48">
     GLIDE
     <sup>
      <xref ref-type="bibr" rid="CR16">
       16
      </xref>
     </sup>
     is a rigid protein docking module in Schrödinger software. Ligands were prepared by using the LigPrep module. Protein preparation was performed by using the Protein Preparation Wizard module. Grid files were generated by the Receptor Grid Generation module with a 10 Å inner box and an automatic outer box around the ligand with the default buffer of 4 Å on all six sides centered on the center of mass of the ligand. Then, the SP precision docking was performed. Some of the ligands in PDBbind dataset are polypeptides, which cannot be processed by LigPrep module. In addition, ligands with severe clashes with pocket atoms had no output pose during docking. Therefore, 266 ligand-receptor pairs in PDBbind dataset and 472 ligand-receptor pairs in MDT dataset had docking output in GLIDE rigid docking.
    </p>
   </sec>
   <sec id="Sec24">
    <title>
     Induced fit docking
    </title>
    <p id="Par49">
     Induced fit docking (IFD) module
     <sup>
      <xref ref-type="bibr" rid="CR62">
       62
      </xref>
     </sup>
     in Schrödinger software provides a protein-flexible docking function for the user. Different from VINA and GNINA, not only residue side chains but also residue backbones can move slightly. Ligand preparation and protein preparation were the same as GLIDE rigid docking. The search space was defined by default parameters, a 10 Å inner box and an outer box with auto size (similar in size to ligand) centered on the center of mass of the native ligand. Amino acid residues within 5 Å of the ligand atoms were defined as flexible residues. The docking process was performed under the standard protocol, which generates up to 20 poses. In total, 284 ligand-receptor pairs in PDBbind dataset and 580 in MDT dataset were docked successfully by using the IFD module. Induced fit docking can give output poses successfully for more ligand-receptor pairs in PDBbind dataset than GLIDE rigid docking, indicating that this docking method can extend the pocket by moving pocket residues.
    </p>
   </sec>
   <sec id="Sec25">
    <title>
     Reporting summary
    </title>
    <p id="Par50">
     Further information on research design is available in the
     <xref ref-type="supplementary-material" rid="MOESM2">
      Nature Portfolio Reporting Summary
     </xref>
     linked to this article.
    </p>
   </sec>
  </sec>
 </body>
 <back>
  <ack>
   <title>
    Acknowledgements
   </title>
   <p>
    We are grateful to Meihui Song and Jiahui Tang for their visualization and inspiration. We thank Da Wei and Ziwei Huang for their assistance in web server setup and IT support. We thank James J. Collins for his valuable feedback and insightful discussions. S.Z. acknowledges funding from the Baidu scholarship. P.G.W. is supported by the Center for Theoretical Biological Physics sponsored by the NSF grant PHY-2019745 and the D.R. Bullard-Welch Chair at the Rice University Grant C-0016.
   </p>
  </ack>
  <sec sec-type="author-contribution">
   <title>
    Author contributions
   </title>
   <p>
    S.Z. and W.L. conceived and supervised the project. W.L. and J.Z. contributed to the algorithm implementation. J.Z., W.L., S.Z., and W.H. contributed to the visualization and baseline implementation. W.L., S.Z., P.G.W., and J.Z. wrote the manuscript. All authors were involved in the discussions and proofreading.
   </p>
  </sec>
  <sec sec-type="peer-review">
   <title>
    Peer review
   </title>
   <sec id="FPar1">
    <title>
     Peer review information
    </title>
    <p id="Par51">
     <italic>
      Nature Communications
     </italic>
     thanks the anonymous reviewers for their contribution to the peer review of this work. A peer review file is available.
    </p>
   </sec>
  </sec>
  <sec sec-type="data-availability">
   <title>
    Data availability
   </title>
   <p>
    Raw data were sourced from the public dataset PDBbind2020, available at
    <ext-link ext-link-type="uri" xlink:href="http://www.pdbbind.org.cn/index.php">
     http://www.pdbbind.org.cn/index.php
    </ext-link>
    . The data generated in this study and processed training data have been publicly deposited to Zenodo under
    <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.10429051">
     https://doi.org/10.5281/zenodo.10429051
    </ext-link>
    .
    <xref ref-type="sec" rid="Sec27">
     Source data
    </xref>
    are provided with this paper.
   </p>
  </sec>
  <sec sec-type="data-availability">
   <title>
    Code availability
   </title>
   <p>
    Demo, instructions, and codes for DynamicBind are available at
    <ext-link ext-link-type="uri" xlink:href="https://github.com/luwei0917/DynamicBind">
     https://github.com/luwei0917/DynamicBind
    </ext-link>
    . The version used for this publication is available in ref.
    <sup>
     <xref ref-type="bibr" rid="CR63">
      63
     </xref>
    </sup>
    . In addition, a web server is available at
    <ext-link ext-link-type="uri" xlink:href="https://m1.galixir.com/#/home/demo/dynamicDocking">
     https://m1.galixir.com/#/home/demo/dynamicDocking
    </ext-link>
    .
   </p>
  </sec>
  <sec sec-type="ethics-statement">
   <sec id="FPar2" sec-type="COI-statement">
    <title>
     Competing interests
    </title>
    <p id="Par52">
     W.L., J.Z., W.H., Z.Z., X.J., Z.W., L.S., and C.L. work directly or indirectly for Galixir Technologies. S.Z. was a former employee of Galixir Technologies. The remaining authors declare no competing interests.
    </p>
   </sec>
  </sec>
  <ref-list id="Bib1">
   <title>
    References
   </title>
   <ref-list>
    <ref id="CR1">
     <label>
      1.
     </label>
     <mixed-citation publication-type="other">
      Papoian, G. A. &amp; Wolynes, P.G. Awsem-md: from neural networks to protein structure prediction and functional dynamics of complex biomolecular assemblies.
      <italic>
       Coarse-Grained Model. Biomol.
      </italic>
      121–190 (2017).
     </mixed-citation>
    </ref>
    <ref id="CR2">
     <label>
      2.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Jin
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Protein structure prediction in casp13 using awsem-suite
      </article-title>
      <source>
       J. Chem. Theory Comput.
      </source>
      <year>
       2020
      </year>
      <volume>
       16
      </volume>
      <fpage>
       3977
      </fpage>
      <lpage>
       3988
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXpt1OltL4%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       32396727
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/acs.jctc.0c00188
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR3">
     <label>
      3.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Leman
        </surname>
        <given-names>
         JK
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Macromolecular modeling and design in rosetta: recent methods and frameworks
      </article-title>
      <source>
       Nat. Methods
      </source>
      <year>
       2020
      </year>
      <volume>
       17
      </volume>
      <fpage>
       665
      </fpage>
      <lpage>
       680
      </lpage>
      <pub-id assigning-authority="American Mathematical Society" pub-id-type="other">
       4159503
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXhtVGmu7vF
      </pub-id>
      <pub-id pub-id-type="pmid">
       32483333
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41592-020-0848-2
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR4">
     <label>
      4.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhang
        </surname>
        <given-names>
         C
        </given-names>
       </name>
       <name>
        <surname>
         Mortuza
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         He
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Wang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Zhang
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Template-based and free modeling of i-tasser and quark pipelines using predicted contact maps in casp12
      </article-title>
      <source>
       Proteins Struct. Funct. Bioinforma.
      </source>
      <year>
       2018
      </year>
      <volume>
       86
      </volume>
      <fpage>
       136
      </fpage>
      <lpage>
       151
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC2sXhvVSit7vN
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/prot.25414
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR5">
     <label>
      5.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Jumper
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Highly accurate protein structure prediction with alphafold
      </article-title>
      <source>
       Nature
      </source>
      <year>
       2021
      </year>
      <volume>
       596
      </volume>
      <fpage>
       583
      </fpage>
      <lpage>
       589
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2021Natur.596..583J
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXhvVaktrrL
      </pub-id>
      <pub-id pub-id-type="pmid">
       34265844
      </pub-id>
      <pub-id pub-id-type="pmcid">
       8371605
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41586-021-03819-2
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR6">
     <label>
      6.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Baek
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Accurate prediction of protein structures and interactions using a three-track neural network
      </article-title>
      <source>
       Science
      </source>
      <year>
       2021
      </year>
      <volume>
       373
      </volume>
      <fpage>
       871
      </fpage>
      <lpage>
       876
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2021Sci...373..871B
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXhvVCku7zM
      </pub-id>
      <pub-id pub-id-type="pmid">
       34282049
      </pub-id>
      <pub-id pub-id-type="pmcid">
       7612213
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.abj8754
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR7">
     <label>
      7.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lin
        </surname>
        <given-names>
         Z
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Evolutionary-scale prediction of atomic-level protein structure with a language model
      </article-title>
      <source>
       Science
      </source>
      <year>
       2023
      </year>
      <volume>
       379
      </volume>
      <fpage>
       1123
      </fpage>
      <lpage>
       1130
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2023Sci...379.1123L
      </pub-id>
      <pub-id assigning-authority="American Mathematical Society" pub-id-type="other">
       4567681
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXls1ertrk%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       36927031
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.ade2574
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR8">
     <label>
      8.
     </label>
     <mixed-citation publication-type="other">
      Wu, R. et al. High-resolution de novo structure prediction from primary sequence. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.07.21.500999v1">
       https://www.biorxiv.org/content/10.1101/2022.07.21.500999v1
      </ext-link>
      (2022).
     </mixed-citation>
    </ref>
    <ref id="CR9">
     <label>
      9.
     </label>
     <mixed-citation publication-type="other">
      Lane, T. J. Protein structure prediction has reached the single-structure frontier.
      <italic>
       Nat. Methods
      </italic>
      <bold>
       20
      </bold>
      , 170–173 (2023).
     </mixed-citation>
    </ref>
    <ref id="CR10">
     <label>
      10.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Frauenfelder
        </surname>
        <given-names>
         H
        </given-names>
       </name>
       <name>
        <surname>
         Sligar
        </surname>
        <given-names>
         SG
        </given-names>
       </name>
       <name>
        <surname>
         Wolynes
        </surname>
        <given-names>
         PG
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       The energy landscapes and motions of proteins
      </article-title>
      <source>
       Science
      </source>
      <year>
       1991
      </year>
      <volume>
       254
      </volume>
      <fpage>
       1598
      </fpage>
      <lpage>
       1603
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       1991Sci...254.1598F
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DyaK38XhtVWgtro%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       1749933
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.1749933
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR11">
     <label>
      11.
     </label>
     <mixed-citation publication-type="other">
      Nussinov, R., Zhang, M., Liu, Y. &amp; Jang, H. Alphafold, allosteric, and orthosteric drug discovery: ways forward.
      <italic>
       Drug Discov. Today
      </italic>
      <bold>
       28
      </bold>
      , 103551 (2023).
     </mixed-citation>
    </ref>
    <ref id="CR12">
     <label>
      12.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Boehr
        </surname>
        <given-names>
         DD
        </given-names>
       </name>
       <name>
        <surname>
         Nussinov
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Wright
        </surname>
        <given-names>
         PE
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       The role of dynamic conformational ensembles in biomolecular recognition
      </article-title>
      <source>
       Nat. Chem. Biol.
      </source>
      <year>
       2009
      </year>
      <volume>
       5
      </volume>
      <fpage>
       789
      </fpage>
      <lpage>
       796
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD1MXht1OnsLrJ
      </pub-id>
      <pub-id pub-id-type="pmid">
       19841628
      </pub-id>
      <pub-id pub-id-type="pmcid">
       2916928
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nchembio.232
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR13">
     <label>
      13.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Gunasekaran
        </surname>
        <given-names>
         K
        </given-names>
       </name>
       <name>
        <surname>
         Ma
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Nussinov
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Is allostery an intrinsic property of all dynamic proteins?
      </article-title>
      <source>
       Proteins Struct. Funct. Bioinforma.
      </source>
      <year>
       2004
      </year>
      <volume>
       57
      </volume>
      <fpage>
       433
      </fpage>
      <lpage>
       443
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD2cXovVyjs70%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/prot.20232
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR14">
     <label>
      14.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Hekkelman
        </surname>
        <given-names>
         ML
        </given-names>
       </name>
       <name>
        <surname>
         de Vries
        </surname>
        <given-names>
         I
        </given-names>
       </name>
       <name>
        <surname>
         Joosten
        </surname>
        <given-names>
         RP
        </given-names>
       </name>
       <name>
        <surname>
         Perrakis
        </surname>
        <given-names>
         A
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Alphafill: enriching alphafold models with ligands and cofactors
      </article-title>
      <source>
       Nat. Methods
      </source>
      <year>
       2023
      </year>
      <volume>
       20
      </volume>
      <fpage>
       205
      </fpage>
      <lpage>
       213
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XivFClt7bM
      </pub-id>
      <pub-id pub-id-type="pmid">
       36424442
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41592-022-01685-y
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR15">
     <label>
      15.
     </label>
     <mixed-citation publication-type="other">
      Gorgulla, C. Recent developments in structure-based virtual screening approaches. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2211.03208v1">
       https://arxiv.org/abs/2211.03208v1
      </ext-link>
      (2022).
     </mixed-citation>
    </ref>
    <ref id="CR16">
     <label>
      16.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Friesner
        </surname>
        <given-names>
         RA
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Glide: a new approach for rapid, accurate docking and scoring. 1. method and assessment of docking accuracy
      </article-title>
      <source>
       J. Med. Chem.
      </source>
      <year>
       2004
      </year>
      <volume>
       47
      </volume>
      <fpage>
       1739
      </fpage>
      <lpage>
       1749
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD2cXhsFyit74%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       15027865
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/jm0306430
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR17">
     <label>
      17.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Trott
        </surname>
        <given-names>
         O
        </given-names>
       </name>
       <name>
        <surname>
         Olson
        </surname>
        <given-names>
         AJ
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Autodock vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading
      </article-title>
      <source>
       J. Comput. Chem.
      </source>
      <year>
       2010
      </year>
      <volume>
       31
      </volume>
      <fpage>
       455
      </fpage>
      <lpage>
       461
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD1MXhsFGnur3O
      </pub-id>
      <pub-id pub-id-type="pmid">
       19499576
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3041641
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/jcc.21334
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR18">
     <label>
      18.
     </label>
     <mixed-citation publication-type="other">
      Scardino, V., Di Filippo, J. I. &amp; Cavasotto, C. N. How good are alphafold models for docking-based virtual screening?
      <italic>
       Iscience
      </italic>
      <bold>
       26
      </bold>
      , 1 (2023).
     </mixed-citation>
    </ref>
    <ref id="CR19">
     <label>
      19.
     </label>
     <mixed-citation publication-type="other">
      Corso, G., Stärk, H., Jing, B., Barzilay, R. &amp; Jaakkola, T. Diffdock: diffusion steps, twists, and turns for molecular docking. In
      <italic>
       International Conference on Learning Representations
      </italic>
      <italic>
       (ICLR)
      </italic>
      (ICIR, 2023).
     </mixed-citation>
    </ref>
    <ref id="CR20">
     <label>
      20.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Miller
        </surname>
        <given-names>
         EB
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Reliable and accurate solution to the induced fit docking problem for protein–ligand binding
      </article-title>
      <source>
       J. Chem. Theory Comput.
      </source>
      <year>
       2021
      </year>
      <volume>
       17
      </volume>
      <fpage>
       2630
      </fpage>
      <lpage>
       2639
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXnt1yntb0%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       33779166
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/acs.jctc.1c00136
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR21">
     <label>
      21.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ayaz
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Structural mechanism of a drug-binding process involving a large conformational change of the protein target
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2023
      </year>
      <volume>
       14
      </volume>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3sXnt1Clu7o%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       37019905
      </pub-id>
      <pub-id pub-id-type="pmcid">
       10076256
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-023-36956-5
      </pub-id>
      <elocation-id>
       1885
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR22">
     <label>
      22.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Ferreiro
        </surname>
        <given-names>
         DU
        </given-names>
       </name>
       <name>
        <surname>
         Hegler
        </surname>
        <given-names>
         JA
        </given-names>
       </name>
       <name>
        <surname>
         Komives
        </surname>
        <given-names>
         EA
        </given-names>
       </name>
       <name>
        <surname>
         Wolynes
        </surname>
        <given-names>
         PG
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       On the role of frustration in the energy landscapes of allosteric proteins
      </article-title>
      <source>
       Proc. Natl. Acad. Sci. USA
      </source>
      <year>
       2011
      </year>
      <volume>
       108
      </volume>
      <fpage>
       3499
      </fpage>
      <lpage>
       3503
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2011PNAS..108.3499F
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3MXivFGksLw%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       21273505
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3048099
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1073/pnas.1018980108
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR23">
     <label>
      23.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Noé
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <name>
        <surname>
         Olsson
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Köhler
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Wu
        </surname>
        <given-names>
         H
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Boltzmann generators: Sampling equilibrium states of many-body systems with deep learning
      </article-title>
      <source>
       Science
      </source>
      <year>
       2019
      </year>
      <volume>
       365
      </volume>
      <fpage>
       1147
      </fpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019Sci...365.1147N
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1126/science.aaw1147
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR24">
     <label>
      24.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Noé
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <name>
        <surname>
         De Fabritiis
        </surname>
        <given-names>
         G
        </given-names>
       </name>
       <name>
        <surname>
         Clementi
        </surname>
        <given-names>
         C
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Machine learning for protein folding and dynamics
      </article-title>
      <source>
       Curr. Opin. Struct. Biol.
      </source>
      <year>
       2020
      </year>
      <volume>
       60
      </volume>
      <fpage>
       77
      </fpage>
      <lpage>
       84
      </lpage>
      <pub-id pub-id-type="pmid">
       31881449
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.sbi.2019.12.005
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR25">
     <label>
      25.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Wong
        </surname>
        <given-names>
         F
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Benchmarking alphafold-enabled molecular docking predictions for antibiotic discovery
      </article-title>
      <source>
       Mol. Syst. Biol.
      </source>
      <year>
       2022
      </year>
      <volume>
       18
      </volume>
      <fpage>
       11081
      </fpage>
      <pub-id pub-id-type="doi">
       10.15252/msb.202211081
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR26">
     <label>
      26.
     </label>
     <mixed-citation publication-type="other">
      Landrum, G. et al.
      <italic>
       RDKit: A Software Suite For Cheminformatics, Computational Chemistry, and Predictive Modeling
      </italic>
      (Academic Press Cambridge, 2013).
     </mixed-citation>
    </ref>
    <ref id="CR27">
     <label>
      27.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lin
        </surname>
        <given-names>
         X
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Forging tools for refining predicted protein structures
      </article-title>
      <source>
       Proc. Natl. Acad. Sci. USA
      </source>
      <year>
       2019
      </year>
      <volume>
       116
      </volume>
      <fpage>
       9400
      </fpage>
      <lpage>
       9409
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2019PNAS..116.9400L
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1MXovFGltLY%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       31000596
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6511001
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1073/pnas.1900778116
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR28">
     <label>
      28.
     </label>
     <mixed-citation publication-type="other">
      Watson, J. L. et al. De novo design of protein structure and function with RFdiffusion.
      <italic>
       Nature
      </italic>
      <bold>
       620
      </bold>
      , 1089–1100 (2023).
     </mixed-citation>
    </ref>
    <ref id="CR29">
     <label>
      29.
     </label>
     <mixed-citation publication-type="other">
      Song, Y. et al. Score-based generative modeling through stochastic differential equations. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2011.13456">
       https://arxiv.org/abs/2011.13456
      </ext-link>
      (2020).
     </mixed-citation>
    </ref>
    <ref id="CR30">
     <label>
      30.
     </label>
     <mixed-citation publication-type="other">
      Qiao, Z., Nie, W., Vahdat, A., Miller III, T. F. &amp; Anandkumar, A. State-specific protein-ligand complex structure prediction with a multi-scale deep generative model. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/2209.15171.pdf">
       https://arxiv.org/pdf/2209.15171.pdf
      </ext-link>
      (2023).
     </mixed-citation>
    </ref>
    <ref id="CR31">
     <label>
      31.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Nakata
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <name>
        <surname>
         Mori
        </surname>
        <given-names>
         Y
        </given-names>
       </name>
       <name>
        <surname>
         Tanaka
        </surname>
        <given-names>
         S
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       End-to-end protein–ligand complex structure generation with diffusion-based generative models
      </article-title>
      <source>
       BMC Bioinforma.
      </source>
      <year>
       2023
      </year>
      <volume>
       24
      </volume>
      <fpage>
       1
      </fpage>
      <lpage>
       18
      </lpage>
      <pub-id pub-id-type="doi">
       10.1186/s12859-023-05354-5
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR32">
     <label>
      32.
     </label>
     <mixed-citation publication-type="other">
      Brocidiacono, M., Popov, K. I., Koes, D. R. &amp; Tropsha, A. Plantain: diffusion-inspired pose score minimization for fast and accurate molecular docking. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2307.12090">
       https://arxiv.org/abs/2307.12090
      </ext-link>
      (2023).
     </mixed-citation>
    </ref>
    <ref id="CR33">
     <label>
      33.
     </label>
     <mixed-citation publication-type="other">
      Jing, B., Corso, G., Chang, J., Barzilay, R. &amp; Jaakkola, T. Torsional diffusion for molecular conformer generation.
      <italic>
       Adv. Neural Inf. Process. Syst.
      </italic>
      <bold>
       35
      </bold>
      , 24240–24253 (2022).
     </mixed-citation>
    </ref>
    <ref id="CR34">
     <label>
      34.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Liu
        </surname>
        <given-names>
         Z
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Pdb-wide collection of binding data: current status of the pdbbind database
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2015
      </year>
      <volume>
       31
      </volume>
      <fpage>
       405
      </fpage>
      <lpage>
       412
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC28Xht1GjsrnI
      </pub-id>
      <pub-id pub-id-type="pmid">
       25301850
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/btu626
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR35">
     <label>
      35.
     </label>
     <mixed-citation publication-type="other">
      Stärk, H., Ganea, O., Pattanaik, L., Barzilay, R. &amp; Jaakkola, T. Equibind: geometric deep learning for drug binding structure prediction. In
      <italic>
       International Conference on Machine Learning
      </italic>
      20503–20521 (PMLR, 2022).
     </mixed-citation>
    </ref>
    <ref id="CR36">
     <label>
      36.
     </label>
     <mixed-citation publication-type="other">
      Lu, W. et al. Tankbind: trigonometry-aware neural networks for drug-protein binding structure prediction.
      <italic>
       Adv. Neural Inf. Process. Syst.
      </italic>
      (2022).
     </mixed-citation>
    </ref>
    <ref id="CR37">
     <label>
      37.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Santos
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A comprehensive map of molecular drug targets
      </article-title>
      <source>
       Nat. Rev. Drug Discov.
      </source>
      <year>
       2017
      </year>
      <volume>
       16
      </volume>
      <fpage>
       19
      </fpage>
      <lpage>
       34
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC28XitVSms7rK
      </pub-id>
      <pub-id pub-id-type="pmid">
       27910877
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/nrd.2016.230
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR38">
     <label>
      38.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Bender
        </surname>
        <given-names>
         BJ
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       A practical guide to large-scale docking
      </article-title>
      <source>
       Nat. Protoc.
      </source>
      <year>
       2021
      </year>
      <volume>
       16
      </volume>
      <fpage>
       4799
      </fpage>
      <lpage>
       4832
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXitFWgsL%2FE
      </pub-id>
      <pub-id pub-id-type="pmid">
       34561691
      </pub-id>
      <pub-id pub-id-type="pmcid">
       8522653
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41596-021-00597-z
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR39">
     <label>
      39.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Kanev
        </surname>
        <given-names>
         GK
        </given-names>
       </name>
       <name>
        <surname>
         de Graaf
        </surname>
        <given-names>
         C
        </given-names>
       </name>
       <name>
        <surname>
         Westerman
        </surname>
        <given-names>
         BA
        </given-names>
       </name>
       <name>
        <surname>
         de Esch
        </surname>
        <given-names>
         IJ
        </given-names>
       </name>
       <name>
        <surname>
         Kooistra
        </surname>
        <given-names>
         AJ
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Klifs: an overhaul after the first 5 years of supporting kinase research
      </article-title>
      <source>
       Nucleic Acids Res.
      </source>
      <year>
       2021
      </year>
      <volume>
       49
      </volume>
      <fpage>
       562
      </fpage>
      <lpage>
       569
      </lpage>
      <pub-id pub-id-type="doi">
       10.1093/nar/gkaa895
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR40">
     <label>
      40.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Huang
        </surname>
        <given-names>
         S-Y
        </given-names>
       </name>
       <name>
        <surname>
         Zou
        </surname>
        <given-names>
         X
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Ensemble docking of multiple protein structures: considering protein structural variations in molecular docking
      </article-title>
      <source>
       Proteins Struct. Funct. Bioinforma.
      </source>
      <year>
       2007
      </year>
      <volume>
       66
      </volume>
      <fpage>
       399
      </fpage>
      <lpage>
       421
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD2sXms1SjsQ%3D%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1002/prot.21214
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR41">
     <label>
      41.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Amaro
        </surname>
        <given-names>
         RE
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Ensemble docking in drug discovery
      </article-title>
      <source>
       Biophys. J.
      </source>
      <year>
       2018
      </year>
      <volume>
       114
      </volume>
      <fpage>
       2271
      </fpage>
      <lpage>
       2278
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2018BpJ...114.2271A
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC1cXmt1agtL0%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       29606412
      </pub-id>
      <pub-id pub-id-type="pmcid">
       6129458
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.bpj.2018.02.038
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR42">
     <label>
      42.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Lampe
        </surname>
        <given-names>
         JW
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Discovery of a first-in-class inhibitor of the histone methyltransferase setd2 suitable for preclinical studies
      </article-title>
      <source>
       ACS Med. Chem. Lett.
      </source>
      <year>
       2021
      </year>
      <volume>
       12
      </volume>
      <fpage>
       1539
      </fpage>
      <lpage>
       1545
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXhvVClu7jP
      </pub-id>
      <pub-id pub-id-type="pmid">
       34671445
      </pub-id>
      <pub-id pub-id-type="pmcid">
       8521618
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/acsmedchemlett.1c00272
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR43">
     <label>
      43.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Alford
        </surname>
        <given-names>
         JS
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Conformational-design-driven discovery of ezm0414: a selective, potent setd2 inhibitor for clinical studies
      </article-title>
      <source>
       ACS Med. Chem. Lett.
      </source>
      <year>
       2022
      </year>
      <volume>
       13
      </volume>
      <fpage>
       1137
      </fpage>
      <lpage>
       1143
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XhsVCqu7jF
      </pub-id>
      <pub-id pub-id-type="pmid">
       35859865
      </pub-id>
      <pub-id pub-id-type="pmcid">
       9290024
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1021/acsmedchemlett.2c00167
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR44">
     <label>
      44.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhao
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Lee
        </surname>
        <given-names>
         W-P
        </given-names>
       </name>
       <name>
        <surname>
         Garrison
        </surname>
        <given-names>
         EP
        </given-names>
       </name>
       <name>
        <surname>
         Marth
        </surname>
        <given-names>
         GT
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Ssw library: an simd smith-waterman c/c++ library for use in genomic applications
      </article-title>
      <source>
       PLoS ONE
      </source>
      <year>
       2013
      </year>
      <volume>
       8
      </volume>
      <fpage>
       82138
      </fpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2013PLoSO...882138Z
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1371/journal.pone.0082138
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR45">
     <label>
      45.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Krafcikova
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <name>
        <surname>
         Silhan
        </surname>
        <given-names>
         J
        </given-names>
       </name>
       <name>
        <surname>
         Nencka
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Boura
        </surname>
        <given-names>
         E
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Structural analysis of the sars-cov-2 methyltransferase complex involved in RNA cap creation bound to sinefungin
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2020
      </year>
      <volume>
       11
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2020NatCo..11.3717K
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXhsVKltLvM
      </pub-id>
      <pub-id pub-id-type="pmid">
       32709887
      </pub-id>
      <pub-id pub-id-type="pmcid">
       7381658
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-020-17495-9
      </pub-id>
      <elocation-id>
       3717
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR46">
     <label>
      46.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Cimermancic
        </surname>
        <given-names>
         P
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Cryptosite: expanding the druggable proteome by characterization and prediction of cryptic binding sites
      </article-title>
      <source>
       J. Mol. Biol.
      </source>
      <year>
       2016
      </year>
      <volume>
       428
      </volume>
      <fpage>
       709
      </fpage>
      <lpage>
       719
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC28XitFCqs78%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       26854760
      </pub-id>
      <pub-id pub-id-type="pmcid">
       4794384
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1016/j.jmb.2016.01.029
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR47">
     <label>
      47.
     </label>
     <mixed-citation publication-type="other">
      Buttenschoen, M., Morris, G. M. &amp; Deane, C. M. Posebusters: Ai-based docking methods fail to generate physically valid poses or generalise to novel sequences.
      <italic>
       Chem. Sci.
      </italic>
      (2023).
     </mixed-citation>
    </ref>
    <ref id="CR48">
     <label>
      48.
     </label>
     <mixed-citation publication-type="other">
      Bryant, P., Kelkar, A., Guljas, A., Clementi, C. &amp; Noé, F. Structure prediction of protein-ligand complexes from sequence information with Umol. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2023.11.03.565471v1">
       https://www.biorxiv.org/content/10.1101/2023.11.03.565471v1
      </ext-link>
      (2023).
     </mixed-citation>
    </ref>
    <ref id="CR49">
     <label>
      49.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhong
        </surname>
        <given-names>
         ED
        </given-names>
       </name>
       <name>
        <surname>
         Bepler
        </surname>
        <given-names>
         T
        </given-names>
       </name>
       <name>
        <surname>
         Berger
        </surname>
        <given-names>
         B
        </given-names>
       </name>
       <name>
        <surname>
         Davis
        </surname>
        <given-names>
         JH
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Cryodrgn: reconstruction of heterogeneous cryo-em structures using neural networks
      </article-title>
      <source>
       Nat. Methods
      </source>
      <year>
       2021
      </year>
      <volume>
       18
      </volume>
      <fpage>
       176
      </fpage>
      <lpage>
       185
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3MXjt1SmsLw%3D
      </pub-id>
      <pub-id pub-id-type="pmid">
       33542510
      </pub-id>
      <pub-id pub-id-type="pmcid">
       8183613
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41592-020-01049-4
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR50">
     <label>
      50.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Zhang
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Usp14-regulated allostery of the human proteasome by time-resolved cryo-em
      </article-title>
      <source>
       Nature
      </source>
      <year>
       2022
      </year>
      <volume>
       605
      </volume>
      <fpage>
       567
      </fpage>
      <lpage>
       574
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2022Natur.605..567Z
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38XhtFersLjP
      </pub-id>
      <pub-id pub-id-type="pmid">
       35477760
      </pub-id>
      <pub-id pub-id-type="pmcid">
       9117149
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41586-022-04671-8
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR51">
     <label>
      51.
     </label>
     <mixed-citation publication-type="other">
      Punjani, A. &amp; Fleet, D. J. 3DFlex: determining structure and motion of flexible proteins from cryo-EM.
      <italic>
       Nat. Methods
      </italic>
      <bold>
       20
      </bold>
      , 860–870 (2023).
     </mixed-citation>
    </ref>
    <ref id="CR52">
     <label>
      52.
     </label>
     <mixed-citation publication-type="other">
      Geiger, M. &amp; Smidt, T. e3nn: euclidean neural networks. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2207.09453">
       https://arxiv.org/abs/2207.09453
      </ext-link>
      (2022).
     </mixed-citation>
    </ref>
    <ref id="CR53">
     <label>
      53.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Batzner
        </surname>
        <given-names>
         S
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       E (3)-equivariant graph neural networks for data-efficient and accurate interatomic potentials
      </article-title>
      <source>
       Nat. Commun.
      </source>
      <year>
       2022
      </year>
      <volume>
       13
      </volume>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       2022NatCo..13.2453B
      </pub-id>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB38Xht1ShtLrE
      </pub-id>
      <pub-id pub-id-type="pmid">
       35508450
      </pub-id>
      <pub-id pub-id-type="pmcid">
       9068614
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1038/s41467-022-29939-5
      </pub-id>
      <elocation-id>
       2453
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR54">
     <label>
      54.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         McBride
        </surname>
        <given-names>
         WG
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Thalidomide and congenital abnormalities
      </article-title>
      <source>
       Lancet
      </source>
      <year>
       1961
      </year>
      <volume>
       2
      </volume>
      <fpage>
       90927
      </fpage>
      <lpage>
       8
      </lpage>
     </mixed-citation>
    </ref>
    <ref id="CR55">
     <label>
      55.
     </label>
     <mixed-citation publication-type="other">
      Song, Y., Dhariwal, P., Chen, M. &amp; Sutskever, I. Consistency models. Preprint at
      <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2303.01469">
       https://arxiv.org/abs/2303.01469
      </ext-link>
      (2023).
     </mixed-citation>
    </ref>
    <ref id="CR56">
     <label>
      56.
     </label>
     <mixed-citation publication-type="other">
      Vaswani, A. et al. Attention is all you need.
      <italic>
       Adv. Neural Inf. Process. Syst
      </italic>
      .
      <bold>
       30
      </bold>
      , (2017).
     </mixed-citation>
    </ref>
    <ref id="CR57">
     <label>
      57.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Kabsch
        </surname>
        <given-names>
         W
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       A solution for the best rotation to relate two sets of vectors
      </article-title>
      <source>
       Acta Crystallogr. Sect. A: Crystal Phys. Diffr. Theor. Gen. Crystallogr.
      </source>
      <year>
       1976
      </year>
      <volume>
       32
      </volume>
      <fpage>
       922
      </fpage>
      <lpage>
       923
      </lpage>
      <pub-id assigning-authority="NASA Astrophysics Data System" pub-id-type="other">
       1976AcCrA..32..922K
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1107/S0567739476001873
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR58">
     <label>
      58.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Mariani
        </surname>
        <given-names>
         V
        </given-names>
       </name>
       <name>
        <surname>
         Biasini
        </surname>
        <given-names>
         M
        </given-names>
       </name>
       <name>
        <surname>
         Barbato
        </surname>
        <given-names>
         A
        </given-names>
       </name>
       <name>
        <surname>
         Schwede
        </surname>
        <given-names>
         T
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       lddt: a local superposition-free score for comparing protein structures and models using distance difference tests
      </article-title>
      <source>
       Bioinformatics
      </source>
      <year>
       2013
      </year>
      <volume>
       29
      </volume>
      <fpage>
       2722
      </fpage>
      <lpage>
       2728
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BC3sXhs1CisrfK
      </pub-id>
      <pub-id pub-id-type="pmid">
       23986568
      </pub-id>
      <pub-id pub-id-type="pmcid">
       3799472
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1093/bioinformatics/btt473
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR59">
     <label>
      59.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Batsanov
        </surname>
        <given-names>
         SS
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Van der waals radii of elements
      </article-title>
      <source>
       Inorganic Mater.
      </source>
      <year>
       2001
      </year>
      <volume>
       37
      </volume>
      <fpage>
       871
      </fpage>
      <lpage>
       885
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD3MXnt1Cgsb4%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1023/A:1011625728803
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR60">
     <label>
      60.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Meli
        </surname>
        <given-names>
         R
        </given-names>
       </name>
       <name>
        <surname>
         Biggin
        </surname>
        <given-names>
         PC
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       spyrmsd: symmetry-corrected RMSD calculations in Python
      </article-title>
      <source>
       J. Cheminforma.
      </source>
      <year>
       2020
      </year>
      <volume>
       12
      </volume>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BB3cXitlWks7rF
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1186/s13321-020-00455-2
      </pub-id>
      <elocation-id>
       49
      </elocation-id>
     </mixed-citation>
    </ref>
    <ref id="CR61">
     <label>
      61.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         McNutt
        </surname>
        <given-names>
         AT
        </given-names>
       </name>
       <etal/>
      </person-group>
      <article-title xml:lang="en">
       Gnina 1.0: molecular docking with deep learning
      </article-title>
      <source>
       J. Cheminforma.
      </source>
      <year>
       2021
      </year>
      <volume>
       13
      </volume>
      <fpage>
       1
      </fpage>
      <lpage>
       20
      </lpage>
     </mixed-citation>
    </ref>
    <ref id="CR62">
     <label>
      62.
     </label>
     <mixed-citation publication-type="journal">
      <person-group person-group-type="author">
       <name>
        <surname>
         Sherman
        </surname>
        <given-names>
         W
        </given-names>
       </name>
       <name>
        <surname>
         Beard
        </surname>
        <given-names>
         HS
        </given-names>
       </name>
       <name>
        <surname>
         Farid
        </surname>
        <given-names>
         R
        </given-names>
       </name>
      </person-group>
      <article-title xml:lang="en">
       Use of an induced fit receptor structure in virtual screening
      </article-title>
      <source>
       Chem. Biol. Drug Design
      </source>
      <year>
       2006
      </year>
      <volume>
       67
      </volume>
      <fpage>
       83
      </fpage>
      <lpage>
       84
      </lpage>
      <pub-id assigning-authority="ChemPort ( Chemical Abstract Service )" pub-id-type="other">
       1:CAS:528:DC%2BD28XhsVSjtL0%3D
      </pub-id>
      <pub-id pub-id-type="doi">
       10.1111/j.1747-0285.2005.00327.x
      </pub-id>
     </mixed-citation>
    </ref>
    <ref id="CR63">
     <label>
      63.
     </label>
     <mixed-citation publication-type="other">
      Lu, W. luwei0917/DynamicBind: V1.0.
      <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.10443816">
       https://doi.org/10.5281/zenodo.10443816
      </ext-link>
      (2023).
     </mixed-citation>
    </ref>
   </ref-list>
  </ref-list>
  <app-group>
   <app id="App1" specific-use="web-only">
    <sec id="Sec26">
     <title>
      Supplementary information
     </title>
     <p id="Par53">
      <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_45461_MOESM1_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Supplementary Information
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_45461_MOESM2_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Reporting Summary
         </p>
        </caption>
       </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3" xlink:title="Supplementary information">
       <media mime-subtype="pdf" mimetype="application" xlink:href="MediaObjects/41467_2024_45461_MOESM3_ESM.pdf">
        <caption xml:lang="en">
         <p>
          Peer Review File
         </p>
        </caption>
       </media>
      </supplementary-material>
     </p>
    </sec>
    <sec id="Sec27">
     <title>
      Source data
     </title>
     <p id="Par54">
      <supplementary-material content-type="local-data" id="MOESM4" xlink:title="Source data">
       <media mime-subtype="vnd.ms-excel" mimetype="application" xlink:href="MediaObjects/41467_2024_45461_MOESM4_ESM.xlsx">
        <caption xml:lang="en">
         <p>
          Source Data file
         </p>
        </caption>
       </media>
      </supplementary-material>
     </p>
    </sec>
   </app>
  </app-group>
  <notes notes-type="ESMHint">
   <title>
    Supplementary information
   </title>
   <p>
    The online version contains supplementary material available at
    <ext-link ext-link-type="doi" xlink:href="10.1038/s41467-024-45461-2">
     https://doi.org/10.1038/s41467-024-45461-2
    </ext-link>
    .
   </p>
  </notes>
  <notes notes-type="Misc">
   <p>
    <bold>
     Publisher’s note
    </bold>
    Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
   </p>
  </notes>
 </back>
</article>
